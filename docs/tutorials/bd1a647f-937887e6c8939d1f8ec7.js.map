{"version":3,"file":"bd1a647f-937887e6c8939d1f8ec7.js","mappings":"8HAEAA,OAAOC,eAAeC,EAAS,aAA/B,CACEC,OAAO,IAGT,IAAIC,EAAQ,EAAQ,OAEhBC,EAAQ,EAAQ,OAEhBC,EAAY,EAAQ,OAEpBC,EAAkB,EAAQ,OAE1BC,EAAY,EAAQ,OAEpBC,EAAO,EAAQ,MAEfC,EAAM,EAAQ,OAElB,SAASC,EAAsBC,GAC7B,OAAOA,GAAkB,iBAANA,GAAkB,YAAaA,EAAIA,EAAI,CACxD,QAAWA,EAEf,CAEA,SAASC,EAAkBD,GACzB,GAAIA,GAAKA,EAAEE,WAAY,OAAOF,EAC9B,IAAIG,EAAIf,OAAOgB,OAAO,MAiBtB,OAfIJ,GACFZ,OAAOiB,KAAKL,GAAGM,SAAQ,SAAUC,GAC/B,GAAU,YAANA,EAAiB,CACnB,IAAIC,EAAIpB,OAAOqB,yBAAyBT,EAAGO,GAC3CnB,OAAOC,eAAec,EAAGI,EAAGC,EAAEE,IAAMF,EAAI,CACtCG,YAAY,EACZD,IAAK,WACH,OAAOV,EAAEO,EACX,GAEJ,CACF,IAGFJ,EAAW,QAAIH,EACRZ,OAAOwB,OAAOT,EACvB,CAEA,IAAIU,EAAgCZ,EAAkBR,GAElDqB,EAA8Bf,EAAsBN,GAEpDsB,EAA6BhB,EAAsBF,GASnDmB,EAAmB,SAA0BC,GAC/C,MAAO,CACLC,UAAW,SAAmBC,GAC5B,OAAOF,EAAUG,MAAK,SAAUC,GAC9B,QAASF,EAAME,EACjB,GACF,EAEJ,EAEIC,EAAqB,CACvBC,cAAeP,EAAiB,CAAC,SAAU,WAAY,SACvDQ,UAAWR,EAAiB,CAAC,UAAW,OAAQ,WAAY,aAAc,WAAY,aAAc,YAAa,gBACjHS,KAAMT,EAAiB,CAAC,SACxBU,KAAMV,EAAiB,CAAC,OAAQ,iBAChCW,MAAOX,EAAiB,CAAC,eACzBY,MAAOZ,EAAiB,CAAC,aAAc,eAAgB,eACvDa,IAAKb,EAAiB,CAAC,WAAY,QAAS,aAAc,gBAC1Dc,IAAKd,EAAiB,CAAC,QAAS,aAAc,oBAAqB,aACnEe,OAAQf,EAAiB,CAAC,cAAe,kBAAmB,qBAG9D,SAASgB,EAAaC,GACpB,IAAK,IAAIC,KAAOD,EACQ,OAAlBA,EAASC,KAED,8BAARA,EACFZ,EAAmBa,0BAA4BF,EAASC,GAExDZ,EAAmBY,GAAKE,UAAYH,EAASC,GAGnD,CAEA,IAAIG,EAAc5C,EAAM6C,cAAc,CACpCC,QAAQ,IAENC,EAAepD,OAAOiB,KAAKiB,GAC3BmB,EAAcD,EAAaE,OA6C/B,IAAIC,EAAsBlD,EAAM6C,cAAc,CAC5CM,mBAAoB,SAA4BC,GAC9C,OAAOA,CACT,EACAC,UAAU,EACVC,cAAe,UAEbC,EAAgBvD,EAAM6C,cAAc,CAAC,GAEzC,SAASW,IACP,OAAOxD,EAAMyD,WAAWF,GAAeG,aACzC,CAMA,IAAIC,EAAkB3D,EAAM6C,cAAc,MACtCe,EAAgC,oBAAbC,SACnBC,EAA4BF,EAAY5D,EAAM+D,gBAAkB/D,EAAMgE,UAEtEC,EAAuB,CACzBC,QAAS,MAEPC,GAAc,EA+ClB,SAASC,IAaP,OATCD,GAjDH,WAEE,GADAA,GAAc,EACTP,EAEL,GAAIS,OAAOC,WAAY,CACrB,IAAIC,EAAqBF,OAAOC,WAAW,4BAEvCE,EAA8B,WAChC,OAAOP,EAAqBC,QAAUK,EAAmBE,OAC3D,EAEAF,EAAmBG,YAAYF,GAC/BA,GACF,MACEP,EAAqBC,SAAU,CAEnC,CAiCkBS,GAEP5E,EAAM6E,OAAO5E,EAAM6E,SAASZ,EAAqBC,SAAU,GACxC,EAO9B,CAEA,SAASY,IACP,IAAIC,EAA0BX,IAC1Bd,EAAgBtD,EAAMyD,WAAWP,GAAqBI,cAE1D,MAAsB,UAAlBA,IAEyB,WAAlBA,GAGFyB,EAEX,CA0CA,SAASC,EAAYC,GACnB,MAAsB,iBAARA,GAAoBtF,OAAOuF,UAAUC,eAAeC,KAAKH,EAAK,UAC9E,CAqCA,SAASI,EAAgBC,GACvB,OAAOC,MAAMC,QAAQF,EACvB,CAMA,SAASG,EAAeH,GACtB,MAAoB,iBAANA,GAAkBD,EAAgBC,EAClD,CA0BA,SAASI,EAAwBhE,EAAOiE,EAAYC,EAAQC,EAAeC,GACzE,IAAIC,EAqCJ,YAnCsB,IAAlBF,IACFA,EAAgB,CAAC,QAGK,IAApBC,IACFA,EAAkB,CAAC,GAOK,mBAAfH,IACTA,EAAaA,EAAWC,QAAuCA,EAASlE,EAAMkE,OAAQC,EAAeC,IAQ7E,iBAAfH,IACTA,EAAuC,QAAzBI,EAAKrE,EAAMsE,gBAA6B,IAAPD,OAAgB,EAASA,EAAGJ,IASnD,mBAAfA,IACTA,EAAaA,EAAWC,QAAuCA,EAASlE,EAAMkE,OAAQC,EAAeC,IAGhGH,CACT,CAEA,SAASM,EAAevC,EAAeiC,EAAYC,GACjD,IAAIlE,EAAQgC,EAAcwC,WAC1B,OAAOR,EAAwBhE,EAAOiE,EAAYC,QAAuCA,EAASlE,EAAMkE,OA/D1G,SAAoBlC,GAClB,IAAIQ,EAAU,CAAC,EAIf,OAHAR,EAAcyC,cAAa,SAAUrG,EAAO2C,GAC1C,OAAOyB,EAAQzB,GAAO3C,EAAMmB,KAC9B,IACOiD,CACT,CAyDkHkC,CAAW1C,GAnD7H,SAAuBA,GACrB,IAAI2C,EAAW,CAAC,EAIhB,OAHA3C,EAAcyC,cAAa,SAAUrG,EAAO2C,GAC1C,OAAO4D,EAAS5D,GAAO3C,EAAMwG,aAC/B,IACOD,CACT,CA6C6IE,CAAc7C,GAC3J,CAEA,SAAS8C,EAA2B9E,GAClC,IAAIqE,EAEJ,MAAuF,mBAA/C,QAAxBA,EAAKrE,EAAM+E,eAA4B,IAAPV,OAAgB,EAASA,EAAGW,QAAyBjB,EAAe/D,EAAMiF,UAAYlB,EAAe/D,EAAM+E,UAAYhB,EAAe/D,EAAMkF,aAAenB,EAAe/D,EAAMmF,YAAcpB,EAAe/D,EAAMoF,WAAarB,EAAe/D,EAAMqF,aAAetB,EAAe/D,EAAMM,KAC3U,CAEA,SAASgF,EAAmBtF,GAC1B,OAAOuF,QAAQT,EAA2B9E,IAAUA,EAAMsE,SAC5D,CAeA,SAASkB,EAAuBxF,GAC9B,IAAIqE,EAdN,SAAgCrE,EAAOyF,GACrC,GAAIX,EAA2B9E,GAAQ,CACrC,IAAIiF,EAAUjF,EAAMiF,QAChBF,EAAU/E,EAAM+E,QACpB,MAAO,CACLE,SAAqB,IAAZA,GAAqBlB,EAAekB,GAAWA,OAAUS,EAClEX,QAAShB,EAAegB,GAAWA,OAAUW,EAEjD,CAEA,OAAyB,IAAlB1F,EAAM2F,QAAoBF,EAAU,CAAC,CAC9C,CAGWG,CAAuB5F,EAAO1B,EAAMyD,WAAWF,IACpDoD,EAAUZ,EAAGY,QACbF,EAAUV,EAAGU,QAEjB,OAAOzG,EAAMuH,SAAQ,WACnB,MAAO,CACLZ,QAASA,EACTF,QAASA,EAEb,GAAG,CAACe,EAA0Bb,GAAUa,EAA0Bf,IACpE,CAEA,SAASe,EAA0BC,GACjC,OAAOlC,MAAMC,QAAQiC,GAAQA,EAAKC,KAAK,KAAOD,CAChD,CAUA,SAASE,EAAYC,GACnB,IAAI3C,EAAMjF,EAAM6H,OAAO,MAMvB,OAJoB,OAAhB5C,EAAIf,UACNe,EAAIf,QAAU0D,KAGT3C,EAAIf,OACb,CAQA,IAAI4D,EAAwB,CAK1BC,wBAAwB,EAMxBC,gBAAgB,GAEdC,EAAO,EAUX,IAAIC,EAAqBlI,EAAM6C,cAAc,CAAC,GAK1CsF,EAA2BnI,EAAM6C,cAAc,CAAC,GAuCpD,IAAIuF,EAEJ,SAAUC,GAGR,SAASD,IACP,OAAkB,OAAXC,GAAmBA,EAAOC,MAAMC,KAAMC,YAAcD,IAC7D,CAwBA,OA5BAxI,EAAM0I,UAAUL,EAAsBC,GAUtCD,EAAqBlD,UAAUwD,wBAA0B,WAEvD,OADAH,KAAKI,cACE,IACT,EAEAP,EAAqBlD,UAAU0D,mBAAqB,WAAa,EAEjER,EAAqBlD,UAAUyD,YAAc,WAC3C,IAAI5C,EAAKwC,KAAK7G,MACVgC,EAAgBqC,EAAGrC,cACnBhC,EAAQqE,EAAGrE,MACXgC,GAAeA,EAAcmF,SAASnH,EAC5C,EAEA0G,EAAqBlD,UAAU4D,OAAS,WACtC,OAAOP,KAAK7G,MAAMqH,QACpB,EAEOX,CACT,CA9BA,CA8BE/G,EAAwB,QAAEsB,WAY5B,SAASqG,EAAsBjD,GAC7B,IAAIkD,EAAoBlD,EAAGkD,kBACvBC,EAAsBnD,EAAGmD,oBACzBxG,EAA4BqD,EAAGrD,0BAC/ByG,EAAYpD,EAAGoD,UACfC,EAAiBrD,EAAGqD,eACpBzG,EAAYoD,EAAGpD,UAmEnB,OAlEAsG,GAAqB1G,EAAa0G,GAkE3BjJ,EAAMqJ,YAhEb,SAAyB3H,EAAO4H,GAC9B,IAAIC,EAkER,SAAqBxD,GACnB,IAAIyD,EAEAD,EAAWxD,EAAGwD,SACdE,EAAgE,QAA/CD,EAAKxJ,EAAMyD,WAAWyE,UAAwC,IAAPsB,OAAgB,EAASA,EAAGE,GACxG,OAAOD,QAA8BrC,IAAbmC,EAAyBE,EAAgB,IAAMF,EAAWA,CACpF,CAxEmBI,CAAYjI,GAC3BA,EAAQ3B,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGlI,GAAQ,CAChD6H,SAAUA,IASZ,IAAIM,EAAS7J,EAAMyD,WAAWP,GAC1BV,EAAW,KACX2E,EAAUD,EAAuBxF,GAajCoI,EAAeD,EAAOxG,cAAW+D,EAnIhCO,GAAY,WACjB,GAAIG,EAAsBE,eACxB,OAAOC,GAEX,IAoIM8B,EAAcX,EAAe1H,EAAOmI,EAAOxG,UAwB/C,OAtBKwG,EAAOxG,UAAYO,IAOtBuD,EAAQzD,cAlYd,SAA0Bf,EAAWoH,EAAarI,EAAOwH,GACvD,IAAIc,EAAchK,EAAMyD,WAAWb,GAC/BqH,EAASzG,IACT0G,EAAkBlK,EAAMyD,WAAWE,GACnCwG,EAAqBrF,IACrBsF,EAAmBpK,EAAM6H,YAAOT,GAK/B8B,IAAqBA,EAAsBc,EAAYK,WAEvDD,EAAiBlG,SAAWgF,IAC/BkB,EAAiBlG,QAAUgF,EAAoBvG,EAAW,CACxDoH,YAAaA,EACbE,OAAQA,EACRvI,MAAOA,EACP4I,WAAYJ,aAAyD,EAASA,EAAgBR,GAC9Fa,uBAAuH,KAA/FL,aAAyD,EAASA,EAAgBvD,SAC1GwD,mBAAoBA,KAIxB,IAAIzG,EAAgB0G,EAAiBlG,QAcrC,OAbAJ,GAA0B,WACxBJ,SAA8DA,EAAc8G,YAC9E,IACAxK,EAAMgE,WAAU,WACd,IAAI+B,EAEkG,QAArGA,EAAKrC,aAAqD,EAASA,EAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAG2E,gBAC5I,IACA5G,GAA0B,WACxB,OAAO,WACL,OAAOJ,aAAqD,EAASA,EAAciH,eACrF,CACF,GAAG,IACIjH,CACT,CA4V8BkH,CAAiBjI,EAAWoH,EAAahK,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGC,GAASnI,GAAQwH,GAnI1H,SAAuBY,EAAc/D,EAAIrC,EAAemH,GACtD,IAAIrB,EAEAD,EAAWxD,EAAGwD,SACduB,EAAS/E,EAAG+E,OACZ7I,EAAO8D,EAAG9D,KACV8I,EAAkBhF,EAAGgF,gBACrBC,EAAejF,EAAGiF,aAClBC,EAAyBjL,EAAMyD,WAAW0E,GAEzC0C,GAA8BnH,KAAkBA,aAAqD,EAASA,EAAcwH,cAIjIxH,EAAcwH,WAAa,IAAIL,EAA0Bf,EAAcpG,EAAcyH,kBAAmD,QAA/B3B,EAAK9F,EAAcuG,cAA2B,IAAPT,OAAgB,EAASA,EAAG0B,YAC5KxH,EAAcwH,WAAWE,WAAW,CAClC7B,SAAUA,EACVuB,OAAQA,EACRO,oBAAqBpE,QAAQhF,IAAS8I,GAAmB/F,EAAY+F,GACrErH,cAAeA,EACf4H,eAAgB,WACd,OAAO5H,EAAc4H,gBACvB,EASAC,cAAiC,iBAAXT,EAAsBA,EAAS,OACrDG,uBAAwBA,EACxBD,aAAcA,IAElB,CAiGMQ,CAAc1B,EAAcpI,EAAOyF,EAAQzD,cAAehB,GAA6Bb,EAAmBa,2BAM1GF,EArhBN,SAAqBd,EAAOgC,EAAeuF,GACzC,IAAIzG,EAAW,GAEf,GADkBxC,EAAMyD,WAAWb,IAC9Bc,EAAe,OAAO,KAU3B,IAAK,IAAI+H,EAAI,EAAGA,EAAIzI,EAAayI,IAAK,CACpC,IAAIC,EAAS3I,EAAa0I,GACtB1F,EAAKlE,EAAmB6J,GACxBjK,EAAYsE,EAAGtE,UACfkB,EAAYoD,EAAGpD,UAOflB,EAAUC,IAAUiB,GACtBH,EAASmJ,KAAKvK,EAAiBwK,cAAcjJ,EAAW5C,EAAM6J,SAAS,CACrEnH,IAAKiJ,GACJhK,EAAO,CACRgC,cAAeA,KAGrB,CAEA,OAAOlB,CACT,CAmfiBqJ,CAAYnK,EAAOyF,EAAQzD,gBAQjCtC,EAAiBwK,cAAcxD,EAAsB,CAC1D1E,cAAeyD,EAAQzD,cACvBhC,MAAO3B,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGC,GAASnI,IACjDc,EAAUpB,EAAiBwK,cAAcrI,EAAcuI,SAAU,CAClEhM,MAAOqH,GACNgC,EAAUxG,EAAWjB,EAAOoI,EArWnC,SAAsBC,EAAarG,EAAe4F,GAChD,OAAOtJ,EAAM+L,aAAY,SAAUC,GACjC,IAAIjG,EAEJiG,IAA0C,QAA5BjG,EAAKgE,EAAYkC,aAA0B,IAAPlG,GAAyBA,EAAGX,KAAK2E,EAAaiC,IAE5FtI,IACFsI,EAAWtI,EAAcuI,MAAMD,GAAYtI,EAAcwI,WAGvD5C,IACyB,mBAAhBA,EACTA,EAAY0C,GACHhH,EAAYsE,KACrBA,EAAYpF,QAAU8H,GAG5B,GAMA,CAACtI,GACH,CA6UiDyI,CAAapC,EAAa5C,EAAQzD,cAAe4F,GAAcS,EAAaF,EAAOxG,SAAU8D,EAAQzD,gBACpJ,GAGF,CAyBA,SAAS0I,EAAkBC,GACzB,SAASzG,EAAOjD,EAAW2J,GAKzB,YAJoC,IAAhCA,IACFA,EAA8B,CAAC,GAG1BtD,EAAsBqD,EAAa1J,EAAW2J,GACvD,CAEA,GAAqB,oBAAVC,MACT,OAAO3G,EAQT,IAAI4G,EAAiB,IAAIC,IACzB,OAAO,IAAIF,MAAM3G,EAAQ,CAMvB3E,IAAK,SAAayL,EAASjK,GAQzB,OAJK+J,EAAeG,IAAIlK,IACtB+J,EAAeI,IAAInK,EAAKmD,EAAOnD,IAG1B+J,EAAevL,IAAIwB,EAC5B,GAEJ,CAOA,IAAIoK,EAAuB,CAAC,UAAW,SAAU,OAAQ,OAAQ,UAAW,IAAK,QAAS,OAAQ,SAAU,SAAU,OAAQ,WAAY,OAAQ,UAAW,UAAW,WAAY,OAAQ,OAAQ,MAAO,SAAU,SAAU,OAAQ,QAAS,MAAO,QAEvP,SAASC,EAAenK,GACtB,MAKqB,iBAAdA,IAIPA,EAAUoK,SAAS,SAMnBF,EAAqBG,QAAQrK,IAAc,GAI3C,QAAQsK,KAAKtK,GAKf,CAEA,IAAIuK,EAAkB,CAAC,EAEvB,SAASC,EAAkBC,GACzBzN,OAAO0N,OAAOH,EAAiBE,EACjC,CAOA,IAAIE,EAAgB,CAAC,GAAI,IAAK,IAAK,KAW/BC,EAAiB,CAAC,uBAAwB,IAAK,IAAK,KAUxD,SAASC,GAAmBC,EAAGC,GAC7B,OAAOH,EAAeP,QAAQS,GAAKF,EAAeP,QAAQU,EAC5D,CAjBY,CAAC,YAAa,QAAS,SAAU,QAMvC7M,SAAQ,SAAU8M,GACtB,OAAOL,EAAczM,SAAQ,SAAU+M,GACrC,OAAOL,EAAe5B,KAAKgC,EAAeC,EAC5C,GACF,IAaA,IAAIC,GAAmB,IAAIC,IAAIP,GAE/B,SAASQ,GAAgBtL,GACvB,OAAOoL,GAAiBlB,IAAIlK,EAC9B,CAMA,IAAIuL,GAAuB,IAAIF,IAAI,CAAC,UAAW,UAAW,YAE1D,SAASG,GAAsBxL,GAC7B,OAAOuL,GAAqBrB,IAAIlK,EAClC,CAEA,SAASyL,GAAoBzL,EAAKsD,GAChC,IAAI+E,EAAS/E,EAAG+E,OACZvB,EAAWxD,EAAGwD,SAClB,OAAOwE,GAAgBtL,IAAQwL,GAAsBxL,KAASqI,QAAuB1D,IAAbmC,OAA8B2D,EAAgBzK,IAAgB,YAARA,EAChI,CAEA,IAAI0L,GAAgB,SAAuBrO,GACzC,OAAOmH,QAAkB,OAAVnH,GAAmC,iBAAVA,GAAsBA,EAAMwG,YACtE,EAEI8H,GAAiB,CACnBC,EAAG,aACHC,EAAG,aACHC,EAAG,aACHC,qBAAsB,eAoExB,SAASC,GAAgBhM,GACvB,OAAOA,EAAIiM,WAAW,KACxB,CAMA,IAAIC,GAAiB,SAAwB7O,EAAO8O,GAClD,OAAOA,GAAyB,iBAAV9O,EAAqB8O,EAAKC,UAAU/O,GAASA,CACrE,EAEIgP,GAAM/O,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAG1J,EAAgB6O,QAAS,CACnEF,UAAWG,KAAKC,QAGdC,GAAmB,CAErBC,YAAajP,EAAgBkP,GAC7BC,eAAgBnP,EAAgBkP,GAChCE,iBAAkBpP,EAAgBkP,GAClCG,kBAAmBrP,EAAgBkP,GACnCI,gBAAiBtP,EAAgBkP,GACjCK,aAAcvP,EAAgBkP,GAC9BM,OAAQxP,EAAgBkP,GACxBO,oBAAqBzP,EAAgBkP,GACrCQ,qBAAsB1P,EAAgBkP,GACtCS,wBAAyB3P,EAAgBkP,GACzCU,uBAAwB5P,EAAgBkP,GAExCW,MAAO7P,EAAgBkP,GACvBY,SAAU9P,EAAgBkP,GAC1Ba,OAAQ/P,EAAgBkP,GACxBc,UAAWhQ,EAAgBkP,GAC3Be,KAAMjQ,EAAgBkP,GACtBgB,IAAKlQ,EAAgBkP,GACrBiB,MAAOnQ,EAAgBkP,GACvBkB,OAAQpQ,EAAgBkP,GACxBmB,KAAMrQ,EAAgBkP,GAEtBoB,QAAStQ,EAAgBkP,GACzBqB,WAAYvQ,EAAgBkP,GAC5BsB,aAAcxQ,EAAgBkP,GAC9BuB,cAAezQ,EAAgBkP,GAC/BwB,YAAa1Q,EAAgBkP,GAC7ByB,OAAQ3Q,EAAgBkP,GACxB0B,UAAW5Q,EAAgBkP,GAC3B2B,YAAa7Q,EAAgBkP,GAC7B4B,aAAc9Q,EAAgBkP,GAC9B6B,WAAY/Q,EAAgBkP,GAE5B8B,OAAQhR,EAAgBiR,QACxBC,QAASlR,EAAgBiR,QACzBE,QAASnR,EAAgBiR,QACzBG,QAASpR,EAAgBiR,QACzBI,MAAOrR,EAAgBqR,MACvBC,OAAQtR,EAAgBqR,MACxBE,OAAQvR,EAAgBqR,MACxBG,OAAQxR,EAAgBqR,MACxBI,KAAMzR,EAAgBiR,QACtBS,MAAO1R,EAAgBiR,QACvBU,MAAO3R,EAAgBiR,QACvBW,SAAU5R,EAAgBkP,GAC1B2C,WAAY7R,EAAgBkP,GAC5B4C,WAAY9R,EAAgBkP,GAC5B6C,WAAY/R,EAAgBkP,GAC5Bf,EAAGnO,EAAgBkP,GACnBd,EAAGpO,EAAgBkP,GACnBb,EAAGrO,EAAgBkP,GACnB8C,YAAahS,EAAgBkP,GAC7BZ,qBAAsBtO,EAAgBkP,GACtC+C,QAASjS,EAAgBkS,MACzBC,QAASnS,EAAgBoS,mBACzBC,QAASrS,EAAgBoS,mBACzBE,QAAStS,EAAgBkP,GAEzBqD,OAAQ3D,GAER4D,YAAaxS,EAAgBkS,MAC7BO,cAAezS,EAAgBkS,MAC/BQ,WAAY9D,IAGd,SAAS+D,GAAgBC,EAAOC,EAAcC,EAASC,GACrD,IAAIlN,EAEAmN,EAAQJ,EAAMI,MACdC,EAAOL,EAAMK,KACbtE,EAAYiE,EAAMjE,UAClBuE,EAAgBN,EAAMM,cACtBC,EAAkBP,EAAMO,gBAI5BD,EAAcnQ,OAAS,EAEvB,IAAIqQ,GAAe,EACfC,GAAqB,EAErBC,GAAkB,EAQtB,IAAK,IAAI/Q,KAAOsQ,EAAc,CAC5B,IAAIjT,EAAQiT,EAAatQ,GAKzB,GAAIgM,GAAgBhM,GAClB0Q,EAAK1Q,GAAO3C,MADd,CAMA,IAAI2T,EAAYvE,GAAiBzM,GAC7BiR,EAAc/E,GAAe7O,EAAO2T,GAExC,GAAI1F,GAAgBtL,GAAM,CAMxB,GAJA6Q,GAAe,EACfzE,EAAUpM,GAAOiR,EACjBN,EAAczH,KAAKlJ,IAEd+Q,EAAiB,SAElB1T,KAAwC,QAA5BiG,EAAK0N,EAAUE,eAA4B,IAAP5N,EAAgBA,EAAK,KAAIyN,GAAkB,EACjG,MAAWvF,GAAsBxL,IAC/B4Q,EAAgB5Q,GAAOiR,EAEvBH,GAAqB,GAErBL,EAAMzQ,GAAOiR,CApBf,CAsBF,CAEIJ,EACFJ,EAAMrE,UAxMV,SAAwB9I,EAAIyD,EAAIoK,EAAoBX,GAClD,IAAIpE,EAAY9I,EAAG8I,UACfuE,EAAgBrN,EAAGqN,cACnBS,EAAKrK,EAAGsK,2BACRA,OAAoC,IAAPD,GAAuBA,EACpDE,EAAKvK,EAAGwK,mBACRA,OAA4B,IAAPD,GAAuBA,EAE5CE,EAAkB,GAEtBb,EAAcc,KAAK1G,IAOnB,IAJA,IAAI2G,GAAgB,EAEhBC,EAAmBhB,EAAcnQ,OAE5BwI,EAAI,EAAGA,EAAI2I,EAAkB3I,IAAK,CACzC,IAAIhJ,EAAM2Q,EAAc3H,GACxBwI,GAAmB,GAAGI,OAAOjG,GAAe3L,IAAQA,EAAK,KAAK4R,OAAOxF,EAAUpM,GAAM,MACzE,MAARA,IAAa0R,GAAgB,EACnC,CAgBA,OAdKA,GAAiBL,EACpBG,GAAmB,gBAEnBA,EAAkBA,EAAgBK,OAKhCrB,EACFgB,EAAkBhB,EAAkBpE,EAAW+E,EAAqB,GAAKK,GAChED,GAAsBJ,IAC/BK,EAAkB,QAGbA,CACT,CAkKsBM,CAAezB,EAAOE,EAASQ,EAAiBP,GACzDA,EACTC,EAAMrE,UAAYoE,EAAkB,CAAC,EAAG,KAC9BF,EAAalE,WAAaqE,EAAMrE,YAC1CqE,EAAMrE,UAAY,QAGhB0E,IACFL,EAAMG,gBAnKV,SAA8BtN,GAC5B,IAAIyD,EAAKzD,EAAGsM,QACRA,OAAiB,IAAP7I,EAAgB,MAAQA,EAClCqK,EAAK9N,EAAGwM,QACRA,OAAiB,IAAPsB,EAAgB,MAAQA,EAClCE,EAAKhO,EAAGyM,QACRA,OAAiB,IAAPuB,EAAgB,EAAIA,EAClC,MAAO,GAAGM,OAAOhC,EAAS,KAAKgC,OAAO9B,EAAS,KAAK8B,OAAO7B,EAC7D,CA2J4BgC,CAAqBnB,GAEjD,CAEA,IAAIoB,GAAwB,WAC1B,MAAO,CACLvB,MAAO,CAAC,EACRrE,UAAW,CAAC,EACZuE,cAAe,GACfC,gBAAiB,CAAC,EAClBF,KAAM,CAAC,EAEX,EAEA,SAASuB,GAAkBC,EAAQC,EAAQlT,GACzC,IAAK,IAAIe,KAAOmS,EACTzG,GAAcyG,EAAOnS,KAAUyL,GAAoBzL,EAAKf,KAC3DiT,EAAOlS,GAAOmS,EAAOnS,GAG3B,CAeA,SAASoS,GAASnT,EAAOqI,EAAa1G,GACpC,IACI6P,EAAQ,CAAC,EAYb,OAPAwB,GAAkBxB,EANFxR,EAAMwR,OAAS,CAAC,EAMIxR,GACpC/B,OAAO0N,OAAO6F,EArBhB,SAAgCnN,EAAIgE,EAAa1G,GAC/C,IAAI4P,EAAoBlN,EAAGkN,kBAC3B,OAAOjT,EAAMuH,SAAQ,WACnB,IAAIuL,EApBC,CACLI,MAAO,CAAC,EACRrE,UAAW,CAAC,EACZuE,cAAe,GACfC,gBAAiB,CAAC,EAClBF,KAAM,CAAC,GAgBPN,GAAgBC,EAAO/I,EAAa,CAClC+J,4BAA6BzQ,GAC5B4P,GACH,IAAIE,EAAOL,EAAMK,KACbD,EAAQJ,EAAMI,MAClB,OAAOnT,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGuJ,GAAOD,EAClD,GAAG,CAACnJ,GACN,CAUuB+K,CAAuBpT,EAAOqI,EAAa1G,IAE5D3B,EAAMqT,kBACR7B,EAAQxR,EAAMqT,gBAAgB7B,IAGzBA,CACT,CAEA,SAAS8B,GAAatT,EAAOqI,EAAa1G,GAExC,IAAI4R,EAAY,CAAC,EACb/B,EAAQ2B,GAASnT,EAAOqI,EAAa1G,GAYzC,OAVI4D,QAAQvF,EAAMO,QAAgC,IAAvBP,EAAMwT,eAE/BD,EAAUE,WAAY,EAEtBjC,EAAMkC,WAAalC,EAAMmC,iBAAmBnC,EAAMoC,mBAAqB,OAEvEpC,EAAMqC,aAA6B,IAAf7T,EAAMO,KAAgB,OAAS,OAAOoS,OAAsB,MAAf3S,EAAMO,KAAe,IAAM,MAG9FgT,EAAU/B,MAAQA,EACX+B,CACT,CASA,IAAIO,GAAmB,IAAI1H,IAAI,CAAC,UAAW,UAAW,OAAQ,QAAS,WAAY,aAAc,oBAAqB,kBAAmB,SAAU,UAAW,SAAU,WAAY,mBAAoB,yBAA0B,4BAA6B,kBAAmB,wBAAyB,mBAAoB,sBAAuB,WAAY,cAAe,SAAU,YAAa,2BAA4B,kBAAmB,sBAAuB,OAAQ,eAAgB,eAAgB,kBAAmB,oBAAqB,mBAAoB,SAAU,SAAU,cAAe,eAAgB,kBAAmB,iBAAkB,YAAa,QAAS,aAAc,WAAY,oBAAqB,QAAS,aAAc,cAAe,eAAgB,aAAc,aAAc,WAAY,aAAc,cAAe,kBAAmB,kBAAmB,WAAY,iBAU53B,SAAS2H,GAAkBhT,GACzB,OAAO+S,GAAiB7I,IAAIlK,EAC9B,CAEA,IAAIiT,GAAgB,SAAuBjT,GACzC,OAAQgT,GAAkBhT,EAC5B,EAEA,SAASkT,GAAwBC,GAC1BA,IAELF,GAAgB,SAAuBjT,GACrC,OAAOA,EAAIiM,WAAW,OAAS+G,GAAkBhT,GAAOmT,EAAYnT,EACtE,EACF,CAgBA,IAMEkT,GAAwB,WAE1B,CADE,MAAO5P,IACT,CAEA,SAAS8P,GAAYnU,EAAOoU,EAAOC,GACjC,IAAIC,EAAgB,CAAC,EAErB,IAAK,IAAIvT,KAAOf,GACVgU,GAAcjT,KAA+B,IAAvBsT,GAA+BN,GAAkBhT,KAASqT,IAAUL,GAAkBhT,IAChHf,EAAiB,WAAKe,EAAIiM,WAAW,aACnCsH,EAAcvT,GAAOf,EAAMe,IAI/B,OAAOuT,CACT,CAEA,SAASC,GAAaC,EAAQC,EAAQhG,GACpC,MAAyB,iBAAX+F,EAAsBA,EAAShW,EAAgBkP,GAAGP,UAAUsH,EAAShG,EAAO+F,EAC5F,CAaA,IAAIE,GAAW,CACbD,OAAQ,oBACRE,MAAO,oBAELC,GAAY,CACdH,OAAQ,mBACRE,MAAO,mBAwCT,SAASE,GAAczD,EAAO/M,EAAIiN,EAASC,GACzC,IAAIuD,EAAQzQ,EAAGyQ,MACXC,EAAQ1Q,EAAG0Q,MACXpE,EAAUtM,EAAGsM,QACbE,EAAUxM,EAAGwM,QACbmE,EAAa3Q,EAAG2Q,WAChBlN,EAAKzD,EAAG4Q,YACRA,OAAqB,IAAPnN,EAAgB,EAAIA,EAClCqK,EAAK9N,EAAG6Q,WACRA,OAAoB,IAAP/C,EAAgB,EAAIA,EAIrChB,GAAgBC,EAFP/S,EAAM8W,OAAO9Q,EAAI,CAAC,QAAS,QAAS,UAAW,UAAW,aAAc,cAAe,eAEjEiN,EAASC,GACxCH,EAAMgE,MAAQhE,EAAMI,MACpBJ,EAAMI,MAAQ,CAAC,EACf,IAAI4D,EAAQhE,EAAMgE,MACd5D,EAAQJ,EAAMI,MACd6D,EAAajE,EAAMiE,WAMnBD,EAAMjI,YACJkI,IAAY7D,EAAMrE,UAAYiI,EAAMjI,kBACjCiI,EAAMjI,WAIXkI,SAA2B3P,IAAZiL,QAAqCjL,IAAZmL,GAAyBW,EAAMrE,aACzEqE,EAAMG,gBAnFV,SAAgC0D,EAAY1E,EAASE,GACnD,IAAIyE,EAAYf,GAAa5D,EAAS0E,EAAW1I,EAAG0I,EAAWhH,OAC3DkH,EAAYhB,GAAa1D,EAASwE,EAAWzI,EAAGyI,EAAW9G,QAC/D,MAAO,GAAGoE,OAAO2C,EAAW,KAAK3C,OAAO4C,EAC1C,CA+E4BC,CAAuBH,OAAwB3P,IAAZiL,EAAwBA,EAAU,QAAiBjL,IAAZmL,EAAwBA,EAAU,UAIxHnL,IAAVoP,IAAqBM,EAAMzI,EAAImI,QACrBpP,IAAVqP,IAAqBK,EAAMxI,EAAImI,QAEhBrP,IAAfsP,GApEN,SAAsBI,EAAO7T,EAAQkU,EAAShB,EAAQiB,QACpC,IAAZD,IACFA,EAAU,QAGG,IAAXhB,IACFA,EAAS,QAGS,IAAhBiB,IACFA,GAAc,GAIhBN,EAAMJ,WAAa,EAGnB,IAAI9V,EAAOwW,EAAchB,GAAWE,GAEpCQ,EAAMlW,EAAKuV,QAAUjW,EAAgBkP,GAAGP,WAAWsH,GAEnD,IAAIO,EAAaxW,EAAgBkP,GAAGP,UAAU5L,GAC1C0T,EAAczW,EAAgBkP,GAAGP,UAAUsI,GAC/CL,EAAMlW,EAAKyV,OAAS,GAAGhC,OAAOqC,EAAY,KAAKrC,OAAOsC,EACxD,CA6CIU,CAAaP,EAAOJ,EAAYC,EAAaC,GAAY,EAE7D,CAEA,IAAIU,GAAuB,WACzB,OAAOvX,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAhP/B,CACLsJ,MAAO,CAAC,EACRrE,UAAW,CAAC,EACZuE,cAAe,GACfC,gBAAiB,CAAC,EAClBF,KAAM,CAAC,IA2O0D,CACjE2D,MAAO,CAAC,GAEZ,EAEA,SAASS,GAAY7V,EAAOqI,GAC1B,IAAIyN,EAAcxX,EAAMuH,SAAQ,WAC9B,IAAIuL,EAAQwE,KAIZ,OAHAf,GAAczD,EAAO/I,EAAa,CAChC+J,4BAA4B,GAC3BpS,EAAMuR,mBACFlT,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGkJ,EAAMgE,OAAQ,CACrD5D,MAAOnT,EAAM6J,SAAS,CAAC,EAAGkJ,EAAMI,QAEpC,GAAG,CAACnJ,IAEJ,GAAIrI,EAAMwR,MAAO,CACf,IAAIuE,EAAY,CAAC,EACjB/C,GAAkB+C,EAAW/V,EAAMwR,MAAOxR,GAC1C8V,EAAYtE,MAAQnT,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAG6N,GAAYD,EAAYtE,MAChF,CAEA,OAAOsE,CACT,CAEA,SAASE,GAAgB3B,QACI,IAAvBA,IACFA,GAAqB,GAoBvB,OAjBgB,SAAmBpT,EAAWjB,EAAOoI,EAAc7E,EAAKc,EAAI1C,GAC1E,IAAI0P,EAAehN,EAAGgN,aAElByE,GADiB1K,EAAenK,GAAa4U,GAAcvC,IAC9BtT,EAAOqR,EAAc1P,GAClD2S,EAAgBH,GAAYnU,EAA4B,iBAAdiB,EAAwBoT,GAElE4B,EAAe5X,EAAM6J,SAAS7J,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGoM,GAAgBwB,GAAc,CAChGvS,IAAKA,IAOP,OAJI6E,IACF6N,EAAa,sBAAwB7N,GAGhC9J,EAAM4L,cAAcjJ,EAAWgV,EACxC,CAGF,CAEA,IAAIC,GAAqB,kBAMrBC,GAAc,SAAqBC,GACrC,OAAOA,EAAIC,QAAQH,GANE,SAMoCI,aAC3D,EAEA,SAASC,GAAWC,EAASnS,EAAIoS,EAAWjN,GAC1C,IAAIgI,EAAQnN,EAAGmN,MACXC,EAAOpN,EAAGoN,KAGd,IAAK,IAAI1Q,KAFT9C,OAAO0N,OAAO6K,EAAQhF,MAAOA,EAAOhI,GAAcA,EAAWkN,oBAAoBD,IAEjEhF,EACd+E,EAAQhF,MAAMmF,YAAY5V,EAAK0Q,EAAK1Q,GAExC,CAMA,IAAI6V,GAAsB,IAAIxK,IAAI,CAAC,gBAAiB,kBAAmB,eAAgB,mBAAoB,aAAc,WAAY,oBAAqB,eAAgB,cAAe,aAAc,UAAW,UAAW,eAAgB,mBAAoB,mBAAoB,eAAgB,cAAe,UAAW,oBAAqB,eAEpV,SAASyK,GAAUL,EAASM,EAAaC,EAAYvN,GAGnD,IAAK,IAAIzI,KAFTwV,GAAWC,EAASM,OAAapR,EAAW8D,GAE5BsN,EAAY1B,MAC1BoB,EAAQQ,aAAcJ,GAAoB3L,IAAIlK,GAA0BA,EAAnBoV,GAAYpV,GAAY+V,EAAY1B,MAAMrU,GAEnG,CAEA,SAASkW,GAA8BjX,GACrC,IAAIwR,EAAQxR,EAAMwR,MACd0F,EAAY,CAAC,EAEjB,IAAK,IAAInW,KAAOyQ,GACV/E,GAAc+E,EAAMzQ,KAASyL,GAAoBzL,EAAKf,MACxDkX,EAAUnW,GAAOyQ,EAAMzQ,IAI3B,OAAOmW,CACT,CAEA,SAASC,GAA4BnX,GACnC,IAAIkX,EAAYD,GAA8BjX,GAE9C,IAAK,IAAIe,KAAOf,EAAO,CACrB,GAAIyM,GAAczM,EAAMe,IAEtBmW,EADwB,MAARnW,GAAuB,MAARA,EAAc,OAASA,EAAIqW,cAAgBrW,GACnDf,EAAMe,EAEjC,CAEA,OAAOmW,CACT,CAEA,SAASG,GAAoBzT,GAC3B,MAAoB,iBAANA,GAAqC,mBAAZA,EAAEoB,KAC3C,CAEA,IAAIsS,GAAoB,SAA2B1T,GACjD,OAAOC,MAAMC,QAAQF,EACvB,EAMI2T,GAA+B,SAAsC3T,GAEvE,OAAO0T,GAAkB1T,GAAKA,EAAEA,EAAErC,OAAS,IAAM,EAAIqC,CACvD,EAQA,SAAS4T,GAAmBpZ,GAC1B,IAhByCwF,EAgBrC6T,EAAiBhL,GAAcrO,GAASA,EAAMmB,MAAQnB,EAC1D,OAjByCwF,EAiBpB6T,EAhBdlS,QAAQ3B,GAAkB,iBAANA,GAAkBA,EAAE8T,KAAO9T,EAAE+T,SAgBjBF,EAAeE,UAAYF,CACpE,CAEA,SAASG,GAAUvT,EAAIrE,EAAOyF,EAAS+C,GACrC,IAAI2O,EAA8B9S,EAAG8S,4BACjCU,EAAoBxT,EAAGwT,kBACvBC,EAAUzT,EAAGyT,QACb1G,EAAQ,CACVC,aAAc0G,GAAiB/X,EAAOyF,EAAS+C,EAAiB2O,GAChEL,YAAae,KASf,OANIC,IACF1G,EAAM7G,MAAQ,SAAUD,GACtB,OAAOwN,EAAQ9X,EAAOsK,EAAU8G,EAClC,GAGKA,CACT,CAEA,IAAI4G,GAAqB,SAA4B7P,GACnD,OAAO,SAAUnI,EAAO2B,GACtB,IAAI8D,EAAUnH,EAAMyD,WAAWF,GAC3B2G,EAAkBlK,EAAMyD,WAAWE,GACvC,OAAON,EAAWiW,GAAUzP,EAAQnI,EAAOyF,EAAS+C,GAAmBvC,GAAY,WACjF,OAAO2R,GAAUzP,EAAQnI,EAAOyF,EAAS+C,EAC3C,GACF,CACF,EAEA,SAASuP,GAAiB/X,EAAOyF,EAAS+C,EAAiByP,GACzD,IAAIC,EAAS,CAAC,EACVrP,GAAwH,KAA/FL,aAAyD,EAASA,EAAgBvD,SAC3GkT,EAAeF,EAAmBjY,GAEtC,IAAK,IAAIe,KAAOoX,EACdD,EAAOnX,GAAOyW,GAAmBW,EAAapX,IAGhD,IAAIkE,EAAUjF,EAAMiF,QAChBF,EAAU/E,EAAM+E,QAChBqT,EAAwBtT,EAA2B9E,GACnDqY,EAAgB/S,EAAmBtF,GAEnCyF,GAAW4S,IAAkBD,IAA2C,IAAlBpY,EAAM2F,UAC9DV,UAAmDA,EAAUQ,EAAQR,SACrEF,UAAmDA,EAAUU,EAAQV,UAGvE,IAAIuT,EAA4BzP,IAAqC,IAAZ5D,EACrDsT,EAAeD,EAA4BvT,EAAUE,EAErDsT,GAAwC,kBAAjBA,IAA+BlB,GAAoBkB,KACjE1U,MAAMC,QAAQyU,GAAgBA,EAAe,CAACA,IACpDpZ,SAAQ,SAAU8E,GACrB,IAAIuU,EAAWxU,EAAwBhE,EAAOiE,GAC9C,GAAKuU,EAAL,CACA,IAAIC,EAAgBD,EAASC,cAC7BD,EAASE,WAET,IAAIzF,EAAS5U,EAAM8W,OAAOqD,EAAU,CAAC,gBAAiB,eAEtD,IAAK,IAAIzX,KAAOkS,EAAQ,CACtB,IAAI0F,EAAc1F,EAAOlS,GAEzB,GAAI8C,MAAMC,QAAQ6U,GAMhBA,EAAcA,EADFL,EAA4BK,EAAYpX,OAAS,EAAI,GAI/C,OAAhBoX,IACFT,EAAOnX,GAAO4X,EAElB,CAEA,IAAK,IAAI5X,KAAO0X,EACdP,EAAOnX,GAAO0X,EAAc1X,EAxBT,CA0BvB,IAGF,OAAOmX,CACT,CAEA,IAiDWU,GAjDPC,GAAkB,CACpBnR,eAAgBsQ,GAAmB,CACjCb,4BAA6BA,GAC7BU,kBAAmBjC,GACnBkC,QAAS,SAAiB9X,EAAOsK,EAAUjG,GACzC,IAAIyS,EAAczS,EAAGyS,YACjBzF,EAAehN,EAAGgN,aAEtB,IACEyF,EAAYzB,WAAyC,mBAArB/K,EAASwO,QAAyBxO,EAASwO,UAAYxO,EAASyO,uBASlG,CARE,MAAOla,GAEPiY,EAAYzB,WAAa,CACvB1I,EAAG,EACHC,EAAG,EACHyB,MAAO,EACPE,OAAQ,EAEZ,CAEAsG,GAAciC,EAAazF,EAAc,CACvCe,4BAA4B,GAC3BpS,EAAMuR,mBACTsF,GAAUvM,EAAUwM,EACtB,KAGAkC,GAAmB,CACrBtR,eAAgBsQ,GAAmB,CACjCb,4BAA6BF,GAC7BY,kBAAmB9E,MAIvB,SAASkG,GAAsBhY,EAAWoD,EAAIkD,EAAmBC,EAAqBxG,GACpF,IAAI8G,EAAKzD,EAAGgQ,mBACRA,OAA4B,IAAPvM,GAAwBA,EAC7CoR,EAAa9N,EAAenK,GAAa4X,GAAkBG,GAC/D,OAAO3a,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGgR,GAAa,CACpD3R,kBAAmBA,EACnBE,UAAWuO,GAAgB3B,GAC3B7M,oBAAqBA,EACrBxG,0BAA2BA,EAC3BC,UAAWA,GAEf,CAcA,SAASkY,GAAYlG,EAAQmG,EAAWC,EAAS/H,GAQ/C,YAPgB,IAAZA,IACFA,EAAU,CACRgI,SAAS,IAIbrG,EAAOsG,iBAAiBH,EAAWC,EAAS/H,GACrC,WACL,OAAO2B,EAAOuG,oBAAoBJ,EAAWC,EAC/C,CACF,CAwBA,SAASI,GAAYlW,EAAK6V,EAAWC,EAAS/H,GAC5ChT,EAAMgE,WAAU,WACd,IAAIkU,EAAUjT,EAAIf,QAElB,GAAI6W,GAAW7C,EACb,OAAO2C,GAAY3C,EAAS4C,EAAWC,EAAS/H,EAEpD,GAAG,CAAC/N,EAAK6V,EAAWC,EAAS/H,GAC/B,CA6BA,SAASoI,GAAaC,GAEpB,MAA4B,oBAAjBC,cAAgCD,aAAiBC,eAC1B,UAAtBD,EAAME,aAGXF,aAAiBG,UAC1B,CAEA,SAASC,GAAaJ,GAEpB,QADmBA,EAAMK,OAE3B,CAhGA7b,EAAQya,mBAAgB,GAEbA,GAQRza,EAAQya,gBAAkBza,EAAQya,cAAgB,CAAC,IAP7B,QAAI,UAC3BA,GAAqB,MAAI,aACzBA,GAAmB,IAAI,WACvBA,GAAoB,KAAI,YACxBA,GAAqB,MAAI,aACzBA,GAAsB,OAAI,cAC1BA,GAAoB,KAAI,OAyG1B,IAAIqB,GAAmB,CACrBC,MAAO,EACPC,MAAO,GAGT,SAASC,GAAevb,EAAGwb,QACP,IAAdA,IACFA,EAAY,QAGd,IACIC,EADezb,EAAEmb,QAAQ,IAAMnb,EAAE0b,eAAe,IACxBN,GAC5B,MAAO,CACLtN,EAAG2N,EAAMD,EAAY,KACrBzN,EAAG0N,EAAMD,EAAY,KAEzB,CAEA,SAASG,GAAeF,EAAOD,GAK7B,YAJkB,IAAdA,IACFA,EAAY,QAGP,CACL1N,EAAG2N,EAAMD,EAAY,KACrBzN,EAAG0N,EAAMD,EAAY,KAEzB,CAEA,SAASI,GAAiBd,EAAOU,GAK/B,YAJkB,IAAdA,IACFA,EAAY,QAGP,CACLC,MAAOP,GAAaJ,GAASS,GAAeT,EAAOU,GAAaG,GAAeb,EAAOU,GAE1F,CAEA,IAAIK,GAAc,SAAqBrB,EAASsB,QACX,IAA/BA,IACFA,GAA6B,GAG/B,IAvD4BC,EAuDxBC,EAAW,SAAkBlB,GAC/B,OAAON,EAAQM,EAAOc,GAAiBd,GACzC,EAEA,OAAOgB,GA3DqBC,EA2D6BC,EA1DlD,SAAUlB,GACf,IAAID,EAAeC,aAAiBG,aACZJ,GAAgBA,GAAiC,IAAjBC,EAAMmB,SAG5DF,EAAajB,EAEjB,GAmDqEkB,CACvE,EAeIE,GAAkB,CACpBC,YAAa,YACbC,YAAa,YACbC,UAAW,UACXC,cAAe,cACfC,YAAa,YACbC,WAAY,WACZC,aAAc,aACdC,aAAc,cAEZC,GAAkB,CACpBR,YAAa,aACbC,YAAa,YACbC,UAAW,WACXC,cAAe,eAGjB,SAASM,GAAoBvb,GAC3B,OA7BOgC,GAAsC,OAAzBS,OAAO+Y,cA8BlBxb,EA1BFgC,GAAqC,OAAxBS,OAAOgZ,aA4BlBH,GAAgBtb,GAxBlBgC,GAAoC,OAAvBS,OAAOiZ,YA0BlBb,GAAgB7a,GAGlBA,CACT,CAEA,SAAS2b,GAAgB5I,EAAQmG,EAAWC,EAAS/H,GACnD,OAAO6H,GAAYlG,EAAQwI,GAAoBrC,GAAYsB,GAAYrB,EAAuB,gBAAdD,GAA8B9H,EAChH,CAEA,SAASwK,GAAgBvY,EAAK6V,EAAWC,EAAS/H,GAChD,OAAOmI,GAAYlW,EAAKkY,GAAoBrC,GAAYC,GAAWqB,GAAYrB,EAAuB,gBAAdD,GAA8B9H,EACxH,CAEA,SAASyK,GAAW7b,GAClB,IAAI8b,EAAO,KACX,OAAO,WAKL,OAAa,OAATA,IACFA,EAAO9b,EALM,WACb8b,EAAO,IACT,EAQF,CACF,CAEA,IAAIC,GAAuBF,GAAW,kBAClCG,GAAqBH,GAAW,gBAEpC,SAASI,GAAc5b,GACrB,IAAIyb,GAAO,EAEX,GAAa,MAATzb,EACFyb,EAAOE,UACF,GAAa,MAAT3b,EACTyb,EAAOC,SACF,CACL,IAAIG,EAAmBH,KACnBI,EAAiBH,KAEjBE,GAAoBC,EACtBL,EAAO,WACLI,IACAC,GACF,GAGID,GAAkBA,IAClBC,GAAgBA,IAExB,CAEA,OAAOL,CACT,CAEA,SAASM,KAGP,IAAIC,EAAkBJ,IAAc,GACpC,OAAKI,IACLA,KACO,EACT,CAEA,SAASC,GAAiBxa,EAAeya,EAAUC,GACjD,OAAO,SAAU/C,EAAOgD,GACtB,IAAItY,EAECqV,GAAaC,KAAU2C,OAKY,QAAvCjY,EAAKrC,EAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAGuY,UAAUze,EAAQya,cAAciE,MAAOJ,GACnHC,SAAoDA,EAAS/C,EAAOgD,GACtE,CACF,CAuBA,IAAIG,GAAgB,SAASA,EAAcvU,EAAQwU,GACjD,QAAKA,IAEMxU,IAAWwU,GAGbD,EAAcvU,EAAQwU,EAAMC,eAEvC,EAEA,SAASC,GAAiBP,GACxB,OAAOpe,EAAMgE,WAAU,WACrB,OAAO,WACL,OAAOoa,GACT,CACF,GAAG,GACL,CA0EA,IAAIQ,GAAS,IAAI9Q,IAEjB,SAAS+Q,GAASC,EAAWC,EAAS7G,GAChC4G,GAAaF,GAAOjS,IAAIoS,KAC5BC,QAAQC,KAAKF,GACT7G,GAAS8G,QAAQC,KAAK/G,GAC1B0G,GAAOM,IAAIH,GACb,CAQA,IAAII,GAAoB,IAAIC,QAOxBC,GAAY,IAAID,QAEhBE,GAAuB,SAA8BC,GACvD,IAAIxZ,EAE2C,QAA9CA,EAAKoZ,GAAkBle,IAAIse,EAAM5K,eAA4B,IAAP5O,GAAyBA,EAAGwZ,EACrF,EAEIC,GAA2B,SAAkCC,GAC/DA,EAAQ5e,QAAQye,GAClB,EA+BA,SAASI,GAAoBxH,EAASlF,EAASoL,GAC7C,IAAIuB,EA9BN,SAAkC5Z,GAChC,IAAI6Z,EAAO7Z,EAAG6Z,KACV5M,EAAUjT,EAAM8W,OAAO9Q,EAAI,CAAC,SAE5B8Z,EAAaD,GAAQ/b,SAKpBwb,GAAU1S,IAAIkT,IACjBR,GAAUzS,IAAIiT,EAAY,CAAC,GAG7B,IAAIC,EAAgBT,GAAUpe,IAAI4e,GAC9Bpd,EAAMsd,KAAKC,UAAUhN,GAYzB,OANK8M,EAAcrd,KACjBqd,EAAcrd,GAAO,IAAIwd,qBAAqBT,GAA0Bzf,EAAM6J,SAAS,CACrFgW,KAAMA,GACL5M,KAGE8M,EAAcrd,EACvB,CAGkCyd,CAAyBlN,GAGzD,OAFAmM,GAAkBvS,IAAIsL,EAASkG,GAC/BuB,EAA0BQ,QAAQjI,GAC3B,WACLiH,GAAkBiB,OAAOlI,GACzByH,EAA0BU,UAAUnI,EACtC,CACF,CAmBA,IAAIoI,GAAiB,CACnB3e,KAAM,EACN4e,IAAK,GAGP,SAASC,GAAwBC,EAAe3N,EAAOpP,EAAeqC,GACpE,IAAI6Z,EAAO7Z,EAAG6Z,KACVc,EAAa3a,EAAG8K,OAChBrH,EAAKzD,EAAG4a,OACRA,OAAgB,IAAPnX,EAAgB,OAASA,EAClCoX,EAAO7a,EAAG6a,KACd5gB,EAAMgE,WAAU,WACd,GAAKyc,EAAL,CACA,IAAIzN,EAAU,CACZ4M,KAAMA,aAAmC,EAASA,EAAK1b,QACvDwc,WAAYA,EACZG,UAA6B,iBAAXF,EAAsBA,EAASL,GAAeK,IAmClE,OAAOjB,GAAoBhc,EAAcod,cAAe9N,GAhC7B,SAA8BuM,GACvD,IAAIxZ,EAEAgb,EAAiBxB,EAAMwB,eAK3B,GAAIjO,EAAMkO,WAAaD,IACvBjO,EAAMkO,SAAWD,GAMbH,GAASG,IAAkBjO,EAAMmO,gBAArC,CAEWF,IACTjO,EAAMmO,gBAAiB,GAGe,QAAvClb,EAAKrC,EAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAGuY,UAAUze,EAAQya,cAAc4G,OAAQH,GAMpH,IAAIrf,EAAQgC,EAAcwC,WACtBkY,EAAW2C,EAAiBrf,EAAMyf,gBAAkBzf,EAAM0f,gBAC9DhD,SAAoDA,EAASmB,EAV7D,CAWF,GArC0B,CAwC5B,GAAG,CAACkB,EAAeb,EAAMc,EAAYC,GACvC,CAQA,SAASU,GAA+BZ,EAAe3N,EAAOpP,EAAeqC,GAC3E,IAAIyD,EAAKzD,EAAGub,SACRA,OAAkB,IAAP9X,GAAuBA,EACtCxJ,EAAMgE,WAAU,WACTyc,GAAkBa,GAevBC,uBAAsB,WACpB,IAAIxb,EAEJ+M,EAAMmO,gBAAiB,EACvB,IAAIE,EAAkBzd,EAAcwC,WAAWib,gBAC/CA,SAAkEA,EAAgB,MAC1C,QAAvCpb,EAAKrC,EAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAGuY,UAAUze,EAAQya,cAAc4G,QAAQ,EACtH,GACF,GAAG,CAACT,GACN,CAEA,IAAIe,GAA0B,SAAiCC,GAC7D,OAAO,SAAU/f,GAEf,OADA+f,EAAK/f,GACE,IACT,CACF,EAEIggB,GAAoB,CACtBpf,OAAQkf,IApHV,SAAqBzb,GACnB,IAAIrC,EAAgBqC,EAAGrC,cACnBie,EAAc5b,EAAG4b,YACjBR,EAAkBpb,EAAGob,gBACrBC,EAAkBrb,EAAGqb,gBACrB5X,EAAKzD,EAAG6b,SACRA,OAAkB,IAAPpY,EAAgB,CAAC,EAAIA,EAChCsJ,EAAQ9S,EAAM6H,OAAO,CACvBoZ,gBAAgB,EAChBD,UAAU,IAERP,EAAgBxZ,QAAQ0a,GAAeR,GAAmBC,GAC1DQ,EAAShB,MAAQ9N,EAAM5O,QAAQ+c,iBAAgBR,GAAgB,IACjB,oBAAzBR,qBAAuCoB,GAAiCb,IACrFC,EAAe3N,EAAM5O,QAASR,EAAeke,EAC3D,IAsGExf,IAAKof,IAjQP,SAAuBzb,GACrB,IAAI8b,EAAQ9b,EAAG8b,MACXC,EAAa/b,EAAG+b,WAChBC,EAAchc,EAAGgc,YACjBjb,EAAWf,EAAGe,SACdpD,EAAgBqC,EAAGrC,cACnBse,EAAoBH,GAASC,GAAcC,GAAejb,EAC1Dmb,EAAajiB,EAAM6H,QAAO,GAC1Bqa,EAA4BliB,EAAM6H,OAAO,MAKzCsa,EAAe,CACjBnH,UAAW8G,GAAcD,GAASE,GAAeK,IAGnD,SAASC,IACP,IAAItc,EAEyC,QAA5CA,EAAKmc,EAA0Bhe,eAA4B,IAAP6B,GAAyBA,EAAGX,KAAK8c,GACtFA,EAA0Bhe,QAAU,IACtC,CAEA,SAASoe,IACP,IAAIvc,EAKJ,OAHAsc,IACAJ,EAAW/d,SAAU,EACmB,QAAvC6B,EAAKrC,EAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAGuY,UAAUze,EAAQya,cAAciI,KAAK,IACzGvE,IACV,CAEA,SAASwE,EAAYnH,EAAOgD,GACrBiE,MAMJ9D,GAAc9a,EAAcod,cAAezF,EAAM1G,QAA+FkN,SAA8CA,EAAMxG,EAAOgD,GAAhJ0D,SAA0DA,EAAY1G,EAAOgD,GAC3I,CAEA,SAASoE,EAAgBpH,EAAOgD,GACzBiE,MACLP,SAA0DA,EAAY1G,EAAOgD,GAC/E,CAEA,SAAS+D,EAAc/G,EAAOgD,GAC5B,IAAItY,EAEJsc,IACIJ,EAAW/d,UACf+d,EAAW/d,SAAU,EACrBge,EAA0Bhe,QAAU/D,EAAUuiB,KAAKnF,GAAgBlZ,OAAQ,YAAame,EAAaL,GAAe5E,GAAgBlZ,OAAQ,gBAAiBoe,EAAiBN,IAKtI,QAAvCpc,EAAKrC,EAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAGuY,UAAUze,EAAQya,cAAciI,KAAK,GACjHT,SAAwDA,EAAWzG,EAAOgD,GAC5E,CAEAb,GAAgB9Z,EAAe,cAAese,EAAoBI,OAAgBhb,EAAW+a,GAC7FxD,GAAiB0D,EACnB,IAiMEngB,MAAOsf,IAzgBT,SAAyBzb,GACvB,IAAIgB,EAAahB,EAAGgB,WAChBrD,EAAgBqC,EAAGrC,cAcvByX,GAAYzX,EAAe,QAASqD,EAZtB,WACZ,IAAIhB,EAEoC,QAAvCA,EAAKrC,EAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAGuY,UAAUze,EAAQya,cAAcqI,OAAO,EACrH,OAQ2Dvb,GAC3D+T,GAAYzX,EAAe,OAAQqD,EAPtB,WACX,IAAIhB,EAEoC,QAAvCA,EAAKrC,EAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAGuY,UAAUze,EAAQya,cAAcqI,OAAO,EACrH,OAGyDvb,EAC3D,IAwfEjF,MAAOqf,IA/ST,SAAyBzb,GACvB,IAAI6c,EAAe7c,EAAG6c,aAClBC,EAAa9c,EAAG8c,WAChBjc,EAAab,EAAGa,WAChBlD,EAAgBqC,EAAGrC,cACvB8Z,GAAgB9Z,EAAe,eAAgBkf,GAAgBhc,EAAasX,GAAiBxa,GAAe,EAAMkf,QAAgBxb,EAAW,CAC3I4T,SAAU4H,IAEZpF,GAAgB9Z,EAAe,eAAgBmf,GAAcjc,EAAasX,GAAiBxa,GAAe,EAAOmf,QAAczb,EAAW,CACxI4T,SAAU6H,GAEd,KAsSIC,GAAU,EAEVC,GAAc,WAChB,OAAOD,IACT,EAEIE,GAAQ,WACV,OAAOrb,EAAYob,GACrB,EAmCA,SAASE,KACP,IAAI9b,EAAUnH,EAAMyD,WAAWE,GAC/B,GAAgB,OAAZwD,EAAkB,MAAO,EAAC,EAAM,MACpC,IAAI+b,EAAY/b,EAAQ+b,UACpBC,EAAiBhc,EAAQgc,eACzBC,EAAWjc,EAAQic,SAInB1Z,EAAKsZ,KACThjB,EAAMgE,WAAU,WACd,OAAOof,EAAS1Z,EAClB,GAAG,IAMH,OAAQwZ,GAAaC,EAAiB,EAAC,EAJpB,WACjB,OAAOA,aAAuD,EAASA,EAAezZ,EACxF,GAE8D,EAAC,EACjE,CA+BA,SAAS2Z,GAAeC,EAAMC,GAC5B,IAAKhe,MAAMC,QAAQ+d,GAAO,OAAO,EACjC,IAAIC,EAAaD,EAAKtgB,OACtB,GAAIugB,IAAeF,EAAKrgB,OAAQ,OAAO,EAEvC,IAAK,IAAIwI,EAAI,EAAGA,EAAI+X,EAAY/X,IAC9B,GAAI8X,EAAK9X,KAAO6X,EAAK7X,GAAI,OAAO,EAGlC,OAAO,CACT,CASA,IAAIgY,GAAwB,SAA+BC,GACzD,OAAiB,IAAVA,CACT,EAEIC,GAAe,CACjBC,OAAQzjB,EAAUyjB,OAClBC,OAAQ1jB,EAAU0jB,OAClBC,UAAW3jB,EAAU2jB,UACrBC,QAAS5jB,EAAU4jB,QACnBC,OAAQ7jB,EAAU6jB,OAClBC,UAAW9jB,EAAU8jB,UACrBC,QAAS/jB,EAAU+jB,QACnBC,OAAQhkB,EAAUgkB,OAClBC,UAAWjkB,EAAUikB,UACrBC,QAASlkB,EAAUkkB,QACnBC,WAAYnkB,EAAUmkB,WACtBC,SAAUpkB,EAAUokB,SACpBC,YAAarkB,EAAUqkB,YACvBC,UAAWtkB,EAAUskB,WAGnBC,GAA6B,SAAoC/e,GACnE,GAAIJ,MAAMC,QAAQG,GAAa,CAE7B1F,EAAU0kB,UAAgC,IAAtBhf,EAAW1C,OAAc,2DAE7C,IAAI8C,EAAKhG,EAAM6E,OAAOe,EAAY,GAC9Bif,EAAK7e,EAAG,GACR8e,EAAK9e,EAAG,GACR+e,EAAK/e,EAAG,GACRgf,EAAKhf,EAAG,GAEZ,OAAO5F,EAAU6kB,YAAYJ,EAAIC,EAAIC,EAAIC,EAC3C,CAAO,MAA0B,iBAAfpf,GAEhB1F,EAAU0kB,eAAuCvd,IAA7Buc,GAAahe,GAA2B,wBAAwB0O,OAAO1O,EAAY,MAChGge,GAAahe,IAGfA,CACT,EAgBIsf,GAAe,SAAsBxiB,EAAK3C,GAE5C,MAAY,WAAR2C,MAIiB,iBAAV3C,IAAsByF,MAAMC,QAAQ1F,OAE1B,iBAAVA,IACXI,EAAgBglB,QAAQjY,KAAKnN,IAC5BA,EAAM4O,WAAW,SAMpB,EAEIyW,GAAoB,WACtB,MAAO,CACLvW,KAAM,SACNwW,UAAW,IACXC,QAAS,GACTC,UAAW,GAEf,EAEIC,GAAyB,SAAgCC,GAC3D,MAAO,CACL5W,KAAM,SACNwW,UAAW,IACXC,QAAgB,IAAPG,EAAW,EAAIxW,KAAKyW,KAAK,KAAO,GACzCH,UAAW,GAEf,EAEII,GAAc,WAChB,MAAO,CACL9W,KAAM,YACN+W,KAAM,SACNC,SAAU,GAEd,EAEIC,GAAY,SAAmBjM,GACjC,MAAO,CACLhL,KAAM,YACNgX,SAAU,GACVhM,OAAQA,EAEZ,EAEIkM,GAAqB,CACvBzX,EAAG8W,GACH7W,EAAG6W,GACH5W,EAAG4W,GACHjU,OAAQiU,GACR/T,QAAS+T,GACT9T,QAAS8T,GACT7T,QAAS6T,GACT3T,OAAQ+T,GACR9T,OAAQ8T,GACRhU,MAAOgU,GACPpT,QAASuT,GACTK,gBAAiBL,GACjBM,MAAON,GACP/R,QAAS4R,IAqBPU,GAAoBlmB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGsF,IAAmB,CAE3E8W,MAAO9lB,EAAgB8lB,MACvBD,gBAAiB7lB,EAAgB8lB,MACjCE,aAAchmB,EAAgB8lB,MAC9BG,KAAMjmB,EAAgB8lB,MACtBI,OAAQlmB,EAAgB8lB,MAExBK,YAAanmB,EAAgB8lB,MAC7BM,eAAgBpmB,EAAgB8lB,MAChCO,iBAAkBrmB,EAAgB8lB,MAClCQ,kBAAmBtmB,EAAgB8lB,MACnCS,gBAAiBvmB,EAAgB8lB,MACjCU,OAAQxmB,EAAgBwmB,OACxBC,aAAczmB,EAAgBwmB,SAO5BE,GAAsB,SAA6BnkB,GACrD,OAAOwjB,GAAkBxjB,EAC3B,EAEA,SAASokB,GAAkBpkB,EAAK3C,GAC9B,IAAIiG,EAEA+gB,EAAmBF,GAAoBnkB,GAG3C,OAFIqkB,IAAqB5mB,EAAgBwmB,SAAQI,EAAmB5mB,EAAgBglB,SAE/B,QAA7Cnf,EAAK+gB,EAAiBD,yBAAsC,IAAP9gB,OAAgB,EAASA,EAAGX,KAAK0hB,EAAkBhnB,EAClH,CAEA,IAAIinB,GAAwB,CAC1B7iB,SAAS,GAwBX,IAAI8iB,IAAsB,EAK1B,SAASC,GAAoClhB,GAC3C,IAAI4f,EAAO5f,EAAG4f,KACVuB,EAAQnhB,EAAGmhB,MACXC,EAAOphB,EAAGohB,KACVC,EAAOrhB,EAAGqhB,KACVC,EAAOthB,EAAGshB,KACVjN,EAAara,EAAM8W,OAAO9Q,EAAI,CAAC,OAAQ,QAAS,OAAQ,OAAQ,SAEhEiN,EAAUjT,EAAM6J,SAAS,CAAC,EAAGwQ,GAgDjC,OA9CI8M,IAAOlU,EAAgB,OAAIkU,GAK3B9M,EAAWwL,WAAU5S,EAAkB,SAAIyQ,GAAsBrJ,EAAWwL,WAC5ExL,EAAWkN,cAAatU,EAAQsU,YAAc7D,GAAsBrJ,EAAWkN,cAK/E3B,IACF3S,EAAc,KA3LE,SAAuB2S,GACzC,OAAOpgB,MAAMC,QAAQmgB,IAA4B,iBAAZA,EAAK,EAC5C,CAyLsB4B,CAAc5B,GAAQA,EAAK6B,IAAI9C,IAA8BA,GAA2BiB,IAOpF,UAApBvL,EAAWxL,OAAkBoE,EAAQpE,KAAO,cAK5CuY,GAAQE,GAAQD,KAClBnnB,EAAUwnB,SAAST,GAAqB,mGACxCA,IAAsB,EAElBG,EACFnU,EAAQ0U,WAAa,UACZL,EACTrU,EAAQ0U,WAAa,OACZN,IACTpU,EAAQ0U,WAAa,UAGvB1U,EAAQ2U,OAASN,GAAQF,GAAQC,GAAQhN,EAAWuN,QAS9B,WAApBvN,EAAWxL,OAAmBoE,EAAQpE,KAAO,aAC1CoE,CACT,CAsBA,SAAS4U,GAA6BxN,EAAYpH,EAASvQ,GACzD,IAAIsD,EAlKmD8hB,EAAUrC,EAC7DsC,EAgLJ,OAbIviB,MAAMC,QAAQwN,EAAQwS,MACO,QAA9Bzf,EAAKqU,EAAWwL,gBAA6B,IAAP7f,IAAqBqU,EAAWwL,SAAW,KAbtF,SAA0B5S,GACpBzN,MAAMC,QAAQwN,EAAQwS,KAAyB,OAAlBxS,EAAQwS,GAAG,KAC1CxS,EAAQwS,GAAKzlB,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOoO,EAAQwS,KAAK,GAC/DxS,EAAQwS,GAAG,GAAKxS,EAAQgV,KAI5B,CASEC,CAAiBjV,GA3GnB,SAA6BjN,GAC3BA,EAAGmiB,KACHniB,EAAGoiB,MACHpiB,EAAGqiB,cACHriB,EAAGsiB,gBACHtiB,EAAGuiB,iBACHviB,EAAG4hB,OACH5hB,EAAG2hB,WACH3hB,EAAGuhB,YACHvhB,EAAGiiB,KAEH,IAAI5N,EAAara,EAAM8W,OAAO9Q,EAAI,CAAC,OAAQ,QAAS,gBAAiB,kBAAmB,mBAAoB,SAAU,aAAc,cAAe,SAEnJ,QAASpG,OAAOiB,KAAKwZ,GAAYnX,MACnC,CAkGOslB,CAAoBnO,KACvBA,EAAara,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGwQ,IA9KMyN,EA8K4BplB,EA9KlB+iB,EA8KuBxS,EAAQwS,GA1K9FsC,EADE9O,GAAkBwM,GACAK,GAEAC,GAAmB+B,IAAa/B,GAAmBnS,QAGlE5T,EAAM6J,SAAS,CACpB4b,GAAIA,GACHsC,EAAkBtC,OAsKdzlB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGoJ,GAAUiU,GAAoC7M,GACzF,CAsEA,SAASoO,GAAO1oB,GACd,OAAiB,IAAVA,GAAgC,iBAAVA,GAA4C,IAAtB2oB,WAAW3oB,KAAwC,IAAxBA,EAAMkN,QAAQ,IAC9F,CAEA,SAAS0b,GAAYC,GACnB,MAAoC,iBAAtBA,EAAiC,EAAI9B,GAAkB,GAAI8B,EAC3E,CAEA,SAASC,GAAmBxO,EAAY3X,GACtC,OAAO2X,EAAW3X,IAAQ2X,EAAoB,SAAKA,CACrD,CAOA,SAASyO,GAAepmB,EAAK3C,EAAO6U,EAAQyF,GAW1C,YAVmB,IAAfA,IACFA,EAAa,CAAC,GAGZ2M,GAAsB7iB,UACxBkW,EAAa,CACXxL,MAAM,IAIH9O,EAAM4G,OAAM,SAAUoiB,GAC3B,IAAIC,EACAC,EACAjnB,EA/FR,SAAsBU,EAAK3C,EAAO6U,EAAQyF,EAAY0O,GACpD,IAAI/iB,EAEAkjB,EAAkBL,GAAmBxO,EAAY3X,GACjDyT,EAAyC,QAA/BnQ,EAAKkjB,EAAgBjB,YAAyB,IAAPjiB,EAAgBA,EAAKjG,EAAMmB,MAC5EioB,EAAqBjE,GAAaxiB,EAAKkS,GAE5B,SAAXuB,GAAqBgT,GAAwC,iBAAXvU,EAKpDuB,EAAS2Q,GAAkBpkB,EAAKkS,GACvB6T,GAAOtS,IAA6B,iBAAXvB,EAClCuB,EAASwS,GAAY/T,IACXpP,MAAMC,QAAQmP,IAAW6T,GAAO7T,IAA6B,iBAAXuB,IAC5DvB,EAAS+T,GAAYxS,IAGvB,IAAIiT,EAAqBlE,GAAaxiB,EAAKyT,GA0C3C,OAzCAjW,EAAUwnB,QAAQ0B,IAAuBD,EAAoB,6BAA6B7U,OAAO5R,EAAK,WAAY4R,OAAO6B,EAAQ,UAAY7B,OAAOM,EAAQ,OAAQN,OAAO6B,EAAQ,+DAA+D7B,OAAO6B,EAAQ,8BAA8B7B,OAAOM,EAAQ,+BAyCtSwU,GAAuBD,IAA+C,IAAzBD,EAAgBra,KAvCrE,WACE,IAAIoE,EAAU,CACZgV,KAAM9R,EACNsP,GAAI7Q,EACJtO,SAAUvG,EAAMwG,cAChBwiB,WAAYA,EACZM,SAAU,SAAkB9jB,GAC1B,OAAOxF,EAAM8M,IAAItH,EACnB,GAEF,MAAgC,YAAzB2jB,EAAgBra,MAA+C,UAAzBqa,EAAgBra,KAAmBzO,EAAUkpB,QAAQtpB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGoJ,GAAUiW,IAAoB9oB,EAAUsG,QAAQ1G,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGge,GAA6BqB,EAAiBjW,EAASvQ,IAAO,CAClR2mB,SAAU,SAAkB9jB,GAC1B,IAAIS,EAEJiN,EAAQoW,SAAS9jB,GACmB,QAAnCS,EAAKkjB,EAAgBG,gBAA6B,IAAPrjB,GAAyBA,EAAGX,KAAK6jB,EAAiB3jB,EAChG,EACAwjB,WAAY,WACV,IAAI/iB,EAEJiN,EAAQ8V,aAC8B,QAArC/iB,EAAKkjB,EAAgBH,kBAA+B,IAAP/iB,GAAyBA,EAAGX,KAAK6jB,EACjF,IAEJ,EAEA,WACE,IAAIljB,EAAIyD,EAEJ8f,EAAcrQ,GAA6BtE,GAK/C,OAJA7U,EAAM8M,IAAI0c,GACVR,IACsG,QAArG/iB,EAAKkjB,aAAyD,EAASA,EAAgBG,gBAA6B,IAAPrjB,GAAyBA,EAAGX,KAAK6jB,EAAiBK,GACxD,QAAvG9f,EAAKyf,aAAyD,EAASA,EAAgBH,kBAA+B,IAAPtf,GAAyBA,EAAGpE,KAAK6jB,GAC1I,CACLM,KAAM,WAAiB,EAE3B,CAGF,CAiCoBC,CAAa/mB,EAAK3C,EAAO6U,EAAQyF,EAAY0O,GACzDX,EAvIR,SAAgC/N,EAAY3X,GAC1C,IAAIsD,EAAIyD,EAGR,OAAiG,QAAzFA,EAAsC,QAAhCzD,GADQ6iB,GAAmBxO,EAAY3X,IAAQ,CAAC,GAC3B0lB,aAA0B,IAAPpiB,EAAgBA,EAAKqU,EAAW+N,aAA0B,IAAP3e,EAAgBA,EAAK,CAChI,CAkIgBigB,CAAuBrP,EAAY3X,GAE3CiE,EAAQ,WACV,OAAOsiB,EAAWjnB,GACpB,EAQA,OANIomB,EACFY,EAAa1kB,OAAOqlB,WAAWhjB,EAAO+c,GAAsB0E,IAE5DzhB,IAGK,WACLijB,aAAaZ,GACbC,SAAoDA,EAASO,MAC/D,CACF,GACF,CAMA,IAQIK,GAAoB,SAA2BtkB,GACjD,MAAO,aAAa2H,KAAK3H,EAC3B,EAEA,SAASukB,GAAcC,EAAKC,IACH,IAAvBD,EAAI9c,QAAQ+c,IAAgBD,EAAIne,KAAKoe,EACvC,CAEA,SAASC,GAAWF,EAAKC,GACvB,IAAIE,EAAQH,EAAI9c,QAAQ+c,GACxBE,GAAS,GAAKH,EAAII,OAAOD,EAAO,EAClC,CAqBA,IAAIE,GAEJ,WACE,SAASA,IACP5hB,KAAK6hB,cAAgB,EACvB,CAwCA,OAtCAD,EAAoBjlB,UAAUga,IAAM,SAAUnE,GAC5C,IAAIsP,EAAQ9hB,KAGZ,OADAshB,GAActhB,KAAK6hB,cAAerP,GAC3B,WACL,OAAOiP,GAAWK,EAAMD,cAAerP,EACzC,CACF,EAEAoP,EAAoBjlB,UAAUolB,OAAS,SAAU7c,EAAGC,EAAG6c,GACrD,IAAIC,EAAmBjiB,KAAK6hB,cAAcnnB,OAC1C,GAAKunB,EAEL,GAAyB,IAArBA,EAIFjiB,KAAK6hB,cAAc,GAAG3c,EAAGC,EAAG6c,QAE5B,IAAK,IAAI9e,EAAI,EAAGA,EAAI+e,EAAkB/e,IAAK,CAKzC,IAAIsP,EAAUxS,KAAK6hB,cAAc3e,GACjCsP,GAAWA,EAAQtN,EAAGC,EAAG6c,EAC3B,CAEJ,EAEAJ,EAAoBjlB,UAAUulB,QAAU,WACtC,OAAOliB,KAAK6hB,cAAcnnB,MAC5B,EAEAknB,EAAoBjlB,UAAUwlB,MAAQ,WACpCniB,KAAK6hB,cAAcnnB,OAAS,CAC9B,EAEOknB,CACT,CA5CA,GAwDIQ,GAEJ,WASE,SAASA,EAAY/iB,GACnB,IAtB2B9H,EAsBvBuqB,EAAQ9hB,KAOZA,KAAKqiB,QAAU,QAOfriB,KAAKsiB,UAAY,EAOjBtiB,KAAKuiB,YAAc,EAOnBviB,KAAKwiB,kBAAoB,IAAIZ,GAO7B5hB,KAAKyiB,0BAA4B,IAAIb,GAOrC5hB,KAAK0iB,kBAAoB,IAAId,GAS7B5hB,KAAK2iB,kBAAmB,EAExB3iB,KAAK4iB,gBAAkB,SAAU7lB,EAAGwD,QACnB,IAAXA,IACFA,GAAS,GAGXuhB,EAAM9G,KAAO8G,EAAMnmB,QACnBmmB,EAAMnmB,QAAUoB,EAEhB,IAAIS,EAAK3F,EAAKgrB,eACVC,EAAQtlB,EAAGslB,MACXC,EAAYvlB,EAAGulB,UAEfjB,EAAMS,cAAgBQ,IACxBjB,EAAMQ,UAAYQ,EAClBhB,EAAMS,YAAcQ,EACpBhqB,EAAuB,QAAEiqB,WAAWlB,EAAMmB,wBAIxCnB,EAAM9G,OAAS8G,EAAMnmB,SACvBmmB,EAAMU,kBAAkBT,OAAOD,EAAMnmB,SAInCmmB,EAAMW,0BAA0BP,WAClCJ,EAAMW,0BAA0BV,OAAOD,EAAM/jB,eAI3CwC,GACFuhB,EAAMY,kBAAkBX,OAAOD,EAAMnmB,QAEzC,EAWAqE,KAAKijB,sBAAwB,WAC3B,OAAOlqB,EAAuB,QAAEiqB,WAAWlB,EAAMoB,cACnD,EAYAljB,KAAKkjB,cAAgB,SAAU1lB,GACbA,EAAGulB,YAEDjB,EAAMS,cACtBT,EAAM9G,KAAO8G,EAAMnmB,QAEnBmmB,EAAMW,0BAA0BV,OAAOD,EAAM/jB,eAEjD,EAEAiC,KAAKmjB,aAAc,EACnBnjB,KAAKgb,KAAOhb,KAAKrE,QAAU0D,EAC3BW,KAAK2iB,kBAhJsBprB,EAgJKyI,KAAKrE,SA/I/BynB,MAAMlD,WAAW3oB,IAgJzB,CAoNA,OAjKA6qB,EAAYzlB,UAAU0mB,SAAW,SAAUC,GACzC,OAAOtjB,KAAKwiB,kBAAkB7L,IAAI2M,EACpC,EAEAlB,EAAYzlB,UAAU4mB,eAAiB,WACrCvjB,KAAKwiB,kBAAkBL,OACzB,EAWAC,EAAYzlB,UAAU6mB,gBAAkB,SAAUF,GAGhD,OADAA,EAAatjB,KAAKtH,OACXsH,KAAK0iB,kBAAkB/L,IAAI2M,EACpC,EAQAlB,EAAYzlB,UAAU8mB,OAAS,SAAUC,GACvC1jB,KAAK0jB,cAAgBA,CACvB,EAkBAtB,EAAYzlB,UAAU0H,IAAM,SAAUtH,EAAGwD,QACxB,IAAXA,IACFA,GAAS,GAGNA,GAAWP,KAAK0jB,cAGnB1jB,KAAK0jB,cAAc3mB,EAAGiD,KAAK4iB,iBAF3B5iB,KAAK4iB,gBAAgB7lB,EAAGwD,EAI5B,EAUA6hB,EAAYzlB,UAAUjE,IAAM,WAC1B,OAAOsH,KAAKrE,OACd,EAMAymB,EAAYzlB,UAAUgnB,YAAc,WAClC,OAAO3jB,KAAKgb,IACd,EAUAoH,EAAYzlB,UAAUoB,YAAc,WAElC,OAAOiC,KAAK2iB,iBACZ/qB,EAAUgsB,kBAAkB1D,WAAWlgB,KAAKrE,SAAWukB,WAAWlgB,KAAKgb,MAAOhb,KAAKsiB,WAAa,CAClG,EAeAF,EAAYzlB,UAAUwB,MAAQ,SAAU3E,GACtC,IAAIsoB,EAAQ9hB,KAGZ,OADAA,KAAKghB,OACE,IAAI6C,SAAQ,SAAUC,GAC3BhC,EAAMqB,aAAc,EACpBrB,EAAMiC,cAAgBvqB,EAAUsqB,EAClC,IAAGE,MAAK,WACN,OAAOlC,EAAMmC,gBACf,GACF,EAQA7B,EAAYzlB,UAAUqkB,KAAO,WACvBhhB,KAAK+jB,eAAe/jB,KAAK+jB,gBAC7B/jB,KAAKikB,gBACP,EAQA7B,EAAYzlB,UAAUunB,YAAc,WAClC,QAASlkB,KAAK+jB,aAChB,EAEA3B,EAAYzlB,UAAUsnB,eAAiB,WACrCjkB,KAAK+jB,cAAgB,IACvB,EAYA3B,EAAYzlB,UAAUwnB,QAAU,WAC9BnkB,KAAKwiB,kBAAkBL,QACvBniB,KAAK0iB,kBAAkBP,QACvBniB,KAAKghB,MACP,EAEOoB,CACT,CA1VA,GA4VA,SAASgC,GAAY/kB,GACnB,OAAO,IAAI+iB,GAAY/iB,EACzB,CAMA,IAAIglB,GAAgB,SAAuBtnB,GACzC,OAAO,SAAUsJ,GACf,OAAOA,EAAK3B,KAAK3H,EACnB,CACF,EAkBIunB,GAAsB,CAAC3sB,EAAgB6O,OAAQ7O,EAAgBkP,GAAIlP,EAAgB4sB,QAAS5sB,EAAgBiR,QAASjR,EAAgB6sB,GAAI7sB,EAAgB8sB,GAZlJ,CACT/f,KAAM,SAAc3H,GAClB,MAAa,SAANA,CACT,EACA2nB,MAAO,SAAe3nB,GACpB,OAAOA,CACT,IAWE4nB,GAAyB,SAAgC5nB,GAC3D,OAAOunB,GAAoBM,KAAKP,GAActnB,GAChD,EAMI8nB,GAAartB,EAAMgoB,cAAchoB,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOioB,KAAsB,GAAQ,CAAC3sB,EAAgB8lB,MAAO9lB,EAAgBglB,UAAU,GAMtJmI,GAAgB,SAAuB/nB,GACzC,OAAO8nB,GAAWD,KAAKP,GAActnB,GACvC,EAOA,SAASgoB,GAAe5pB,EAAejB,EAAK3C,GACtC4D,EAAc6pB,SAAS9qB,GACzBiB,EAAc8pB,SAAS/qB,GAAKmK,IAAI9M,GAEhC4D,EAAc+pB,SAAShrB,EAAKkqB,GAAY7sB,GAE5C,CAEA,SAAS4tB,GAAUhqB,EAAeiC,GAChC,IAAIuU,EAAWjU,EAAevC,EAAeiC,GAEzCI,EAAKmU,EAAWxW,EAAciqB,qBAAqBzT,GAAU,GAAS,CAAC,EACvE1Q,EAAKzD,EAAGoU,cACRA,OAAuB,IAAP3Q,EAAgB,CAAC,EAAIA,EAEzCzD,EAAGqU,WAEH,IAAIzF,EAAS5U,EAAM8W,OAAO9Q,EAAI,CAAC,gBAAiB,eAIhD,IAAK,IAAItD,KAFTkS,EAAS5U,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAG+K,GAASwF,GAE5B,CAEtBmT,GAAe5pB,EAAejB,EADlBwW,GAA6BtE,EAAOlS,IAElD,CACF,CAEA,SAASmrB,GAAYlqB,EAAemqB,GACb9tB,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOipB,IAAgB,GAAOC,UAElEjtB,SAAQ,SAAU4B,GAC/B,IAAIsD,EAEAgoB,EAAUrqB,EAAcsqB,WAAWvrB,GACvCsrB,GAAWL,GAAUhqB,EAAeqqB,GACK,QAAxChoB,EAAKrC,EAAcuqB,uBAAoC,IAAPloB,GAAyBA,EAAGlF,SAAQ,SAAU4d,GAC7FmP,GAAYnP,EAAOoP,EACrB,GACF,GACF,CAYA,SAASK,GAAwBxqB,EAAeiR,EAAQuB,GACtD,IAAInQ,EAAIyD,EAAIqK,EAERE,EAEAoa,EAAexuB,OAAOiB,KAAK+T,GAAQ+R,QAAO,SAAUjkB,GACtD,OAAQiB,EAAc6pB,SAAS9qB,EACjC,IACI2rB,EAAeD,EAAalrB,OAChC,GAAKmrB,EAEL,IAAK,IAAI3iB,EAAI,EAAGA,EAAI2iB,EAAc3iB,IAAK,CACrC,IAAIhJ,EAAM0rB,EAAa1iB,GACnB4iB,EAAc1Z,EAAOlS,GACrB3C,EAAQ,KAMRyF,MAAMC,QAAQ6oB,KAChBvuB,EAAQuuB,EAAY,IASR,OAAVvuB,IACFA,EAAoG,QAA3F0J,EAA4B,QAAtBzD,EAAKmQ,EAAOzT,UAAyB,IAAPsD,EAAgBA,EAAKrC,EAAc4qB,UAAU7rB,UAAyB,IAAP+G,EAAgBA,EAAKmL,EAAOlS,IAQtI3C,UAEiB,iBAAVA,IArlBN,iBAAiBmN,KAqlB8BnN,IAAU8pB,GAAkB9pB,IAE9EA,EAAQ2oB,WAAW3oB,IACTutB,GAAcvtB,IAAUI,EAAgBglB,QAAQjY,KAAKohB,KAC/DvuB,EAAQ+mB,GAAkBpkB,EAAK4rB,IAGjC3qB,EAAc+pB,SAAShrB,EAAKkqB,GAAY7sB,IACV,QAA7B+T,GAAME,EAAKmC,GAAQzT,UAAyB,IAAPoR,IAAqBE,EAAGtR,GAAO3C,GACrE4D,EAAc6qB,cAAc9rB,EAAK3C,GACnC,CACF,CAEA,SAAS0uB,GAAwB/rB,EAAK2X,GACpC,GAAKA,EAEL,OADsBA,EAAW3X,IAAQ2X,EAAoB,SAAKA,GAC3C4N,IACzB,CAEA,SAASyG,GAAU9Z,EAAQyF,EAAY1W,GACrC,IAAIqC,EAAIyD,EAEJ0M,EAAS,CAAC,EAEd,IAAK,IAAIzT,KAAOkS,EACduB,EAAOzT,GAA2D,QAAnDsD,EAAKyoB,GAAwB/rB,EAAK2X,UAAgC,IAAPrU,EAAgBA,EAA4C,QAAtCyD,EAAK9F,EAAc8pB,SAAS/qB,UAAyB,IAAP+G,OAAgB,EAASA,EAAGvI,MAG5K,OAAOiV,CACT,CAEA,SAASwY,GAAqBhrB,EAAeiC,EAAYqN,GAMvD,IAAIjR,EAEJ,QAPgB,IAAZiR,IACFA,EAAU,CAAC,GAGbtP,EAAcirB,qBAAqBhpB,GAG/BJ,MAAMC,QAAQG,GAAa,CAC7B,IAAIipB,EAAajpB,EAAW6hB,KAAI,SAAUuG,GACxC,OAAOc,GAAenrB,EAAeqqB,EAAS/a,EAChD,IACAjR,EAAYqqB,QAAQ7L,IAAIqO,EAC1B,MAAO,GAA0B,iBAAfjpB,EAChB5D,EAAY8sB,GAAenrB,EAAeiC,EAAYqN,OACjD,CACL,IAAI8b,EAA2C,mBAAfnpB,EAA4BM,EAAevC,EAAeiC,EAAYqN,EAAQpN,QAAUD,EACxH5D,EAAYgtB,GAAcrrB,EAAeorB,EAAoB9b,EAC/D,CAEA,OAAOjR,EAAUwqB,MAAK,WACpB,OAAO7oB,EAAcsrB,wBAAwBrpB,EAC/C,GACF,CAEA,SAASkpB,GAAenrB,EAAeqqB,EAAS/a,GAC9C,IAAIjN,OAEY,IAAZiN,IACFA,EAAU,CAAC,GAGb,IAAIkH,EAAWjU,EAAevC,EAAeqqB,EAAS/a,EAAQpN,QAC1D4D,GAAM0Q,GAAY,CAAC,GAAGE,WACtBA,OAAoB,IAAP5Q,EAAgB9F,EAAcurB,wBAA0B,CAAC,EAAIzlB,EAE1EwJ,EAAQkc,qBACV9U,EAAapH,EAAQkc,oBAQvB,IAAI1F,EAAetP,EAAW,WAC5B,OAAO6U,GAAcrrB,EAAewW,EAAUlH,EAChD,EAAI,WACF,OAAOoZ,QAAQC,SACjB,EAMI8C,GAA+D,QAAxCppB,EAAKrC,EAAcuqB,uBAAoC,IAAPloB,OAAgB,EAASA,EAAGoK,MAAQ,SAAUif,QAClG,IAAjBA,IACFA,EAAe,GAGjB,IAAIrpB,EAAKqU,EAAWgO,cAChBA,OAAuB,IAAPriB,EAAgB,EAAIA,EACpCsiB,EAAkBjO,EAAWiO,gBAC7BC,EAAmBlO,EAAWkO,iBAClC,OA6EJ,SAAyB5kB,EAAeqqB,EAAS3F,EAAeC,EAAiBC,EAAkBtV,QAC3E,IAAlBoV,IACFA,EAAgB,QAGM,IAApBC,IACFA,EAAkB,QAGK,IAArBC,IACFA,EAAmB,GAGrB,IAAIsG,EAAa,GACbS,GAAsB3rB,EAAcuqB,gBAAgB9d,KAAO,GAAKkY,EAChEiH,EAA+C,IAArBhH,EAAyB,SAAU7c,GAK/D,YAJU,IAANA,IACFA,EAAI,GAGCA,EAAI4c,CACb,EAAI,SAAU5c,GAKZ,YAJU,IAANA,IACFA,EAAI,GAGC4jB,EAAqB5jB,EAAI4c,CAClC,EAQA,OAPA9iB,MAAMyiB,KAAKtkB,EAAcuqB,iBAAiB/Z,KAAKqb,IAAiB1uB,SAAQ,SAAU4d,EAAOhT,GACvFmjB,EAAWjjB,KAAKkjB,GAAepQ,EAAOsP,EAAShuB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGoJ,GAAU,CACzFmV,MAAOC,EAAgBkH,EAAwB7jB,MAC7C8gB,MAAK,WACP,OAAO9N,EAAMuQ,wBAAwBjB,EACvC,IACF,IACO3B,QAAQ7L,IAAIqO,EACrB,CAjHWY,CAAgB9rB,EAAeqqB,EAAS3F,EAAgBgH,EAAc/G,EAAiBC,EAAkBtV,EAClH,EAAI,WACF,OAAOoZ,QAAQC,SACjB,EAMInE,EAAO9N,EAAW8N,KAEtB,GAAIA,EAAM,CACR,IAAIrU,EAAK9T,EAAM6E,OAAgB,mBAATsjB,EAA4B,CAACsB,EAAc2F,GAAsB,CAACA,EAAoB3F,GAAe,GACvHiG,EAAQ5b,EAAG,GACX6b,EAAO7b,EAAG,GAEd,OAAO4b,IAAQlD,KAAKmD,EACtB,CACE,OAAOtD,QAAQ7L,IAAI,CAACiJ,IAAgB2F,EAAmBnc,EAAQmV,QAEnE,CAMA,SAAS4G,GAAcrrB,EAAeiC,EAAYI,GAChD,IAAIyD,EAEAqK,OAAY,IAAP9N,EAAgB,CAAC,EAAIA,EAC1BgO,EAAKF,EAAGsU,MACRA,OAAe,IAAPpU,EAAgB,EAAIA,EAC5Bmb,EAAqBrb,EAAGqb,mBACxBtgB,EAAOiF,EAAGjF,KAEV+gB,EAAKjsB,EAAciqB,qBAAqBhoB,GACxCiqB,EAAKD,EAAGvV,WACRA,OAAoB,IAAPwV,EAAgBlsB,EAAcurB,uBAAyBW,EACpEzV,EAAgBwV,EAAGxV,cACnBxF,EAAS5U,EAAM8W,OAAO8Y,EAAI,CAAC,aAAc,kBAEzCT,IAAoB9U,EAAa8U,GACrC,IAAIN,EAAa,GACbiB,EAAqBjhB,IAAiD,QAAvCpF,EAAK9F,EAAc+G,sBAAmC,IAAPjB,OAAgB,EAASA,EAAGsmB,WAAWlhB,IAEzH,IAAK,IAAInM,KAAOkS,EAAQ,CACtB,IAAI7U,EAAQ4D,EAAc8pB,SAAS/qB,GAC/B4X,EAAc1F,EAAOlS,GAEzB,MAAK3C,QAAyBsH,IAAhBiT,GAA6BwV,GAAsBE,GAAqBF,EAAoBptB,IAA1G,CAIA,IAAIwmB,EAAkBlpB,EAAM6J,SAAS,CACnCue,MAAOA,GACN/N,GAMC1W,EAAcyG,oBAAsB4D,GAAgBtL,KACtDwmB,EAAkBlpB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGqf,GAAkB,CACpEra,MAAM,EACNuZ,MAAO,KAIX,IAAIpmB,EAAY8mB,GAAepmB,EAAK3C,EAAOua,EAAa4O,GACxD2F,EAAWjjB,KAAK5J,EAlBhB,CAmBF,CAEA,OAAOqqB,QAAQ7L,IAAIqO,GAAYrC,MAAK,WAClCpS,GAAiBuT,GAAUhqB,EAAeyW,EAC5C,GACF,CA8CA,SAASoV,GAAgB9hB,EAAGC,GAC1B,OAAOD,EAAEuiB,iBAAiBtiB,EAC5B,CASA,SAASqiB,GAAqBhqB,EAAItD,GAChC,IAAIwtB,EAAgBlqB,EAAGkqB,cACnBC,EAAiBnqB,EAAGmqB,eACpBC,EAAcF,EAAc9qB,eAAe1C,KAAgC,IAAxBytB,EAAeztB,GAEtE,OADAytB,EAAeztB,IAAO,EACf0tB,CACT,CAEA,IAAIC,GAAuB,CAACvwB,EAAQya,cAAc+V,QAASxwB,EAAQya,cAAc4G,OAAQrhB,EAAQya,cAAcqI,MAAO9iB,EAAQya,cAAciE,MAAO1e,EAAQya,cAAciI,IAAK1iB,EAAQya,cAAcgW,KAAMzwB,EAAQya,cAAciW,MAE5NC,GAAuBzwB,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOwrB,KAAuB,GAAOtC,UAE1F2C,GAAoBL,GAAqBntB,OAY7C,SAASytB,GAAqBhtB,GAC5B,IA8VIqC,EA9VAU,EAXN,SAAqB/C,GACnB,OAAO,SAAUkrB,GACf,OAAOxC,QAAQ7L,IAAIqO,EAAWpH,KAAI,SAAUzhB,GAC1C,IAAIhE,EAAYgE,EAAGhE,UACfiR,EAAUjN,EAAGiN,QACjB,OAAO0b,GAAqBhrB,EAAe3B,EAAWiR,EACxD,IACF,CACF,CAGgB2d,CAAYjtB,GACtBoP,IA+VG/M,EAAK,CAAC,GAAMlG,EAAQya,cAAc+V,SAAWO,IAAgB,GAAO7qB,EAAGlG,EAAQya,cAAc4G,QAAU0P,KAAmB7qB,EAAGlG,EAAQya,cAAciE,OAASqS,KAAmB7qB,EAAGlG,EAAQya,cAAciI,KAAOqO,KAAmB7qB,EAAGlG,EAAQya,cAAcgW,MAAQM,KAAmB7qB,EAAGlG,EAAQya,cAAcqI,OAASiO,KAAmB7qB,EAAGlG,EAAQya,cAAciW,MAAQK,KAAmB7qB,GA9VlY8qB,EAAkB,CAAC,EACnBC,GAAkB,EAMlBC,EAA0B,SAAiCC,EAAKrrB,GAClE,IAAIuU,EAAWjU,EAAevC,EAAeiC,GAE7C,GAAIuU,EAAU,CACZA,EAASE,WAET,IAAID,EAAgBD,EAASC,cACzBxF,EAAS5U,EAAM8W,OAAOqD,EAAU,CAAC,aAAc,kBAEnD8W,EAAMjxB,EAAM6J,SAAS7J,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGonB,GAAMrc,GAASwF,EACxE,CAEA,OAAO6W,CACT,EA0BA,SAAStmB,EAAesI,EAASie,GA+M/B,IA9MA,IAAIlrB,EAEArE,EAAQgC,EAAcwC,WACtBiB,EAAUzD,EAAcwtB,mBAAkB,IAAS,CAAC,EAMpDtC,EAAa,GAMbuC,EAAc,IAAIrjB,IAOlBsjB,EAAkB,CAAC,EAMnBC,EAAsBC,IAEtBC,EAAU,SAAiB9lB,GAC7B,IAAImD,EAAO4hB,GAAqB/kB,GAC5B+lB,EAAY1e,EAAMlE,GAClBnH,EAA8B,QAAtB1B,EAAKrE,EAAMkN,UAA0B,IAAP7I,EAAgBA,EAAKoB,EAAQyH,GACnE6iB,EAAgBhsB,EAAegC,GAM/BiqB,EAAc9iB,IAASqiB,EAAoBO,EAAUrT,SAAW,MAChD,IAAhBuT,IAAuBL,EAAsB5lB,GAQjD,IAAIkmB,EAAclqB,IAASN,EAAQyH,IAASnH,IAAS/F,EAAMkN,IAAS6iB,EAgBpE,GAXIE,GAAeb,GAAmBptB,EAAckuB,yBAClDD,GAAc,GAQhBH,EAAUvB,cAAgBlwB,EAAM6J,SAAS,CAAC,EAAGwnB,IAG5CI,EAAUrT,UAA4B,OAAhBuT,IACtBjqB,IAAS+pB,EAAUK,UACpB9Y,GAAoBtR,IAAyB,kBAATA,EAClC,MAAO,WAST,IAAIqqB,EAuMV,SAAgCvO,EAAMD,GACpC,GAAoB,iBAATA,EACT,OAAOA,IAASC,EACX,GAAIle,EAAgBie,GACzB,OAAQD,GAAeC,EAAMC,GAG/B,OAAO,CACT,CA/M6BwO,CAAuBP,EAAUK,SAAUpqB,GAC9DuqB,EAAoBF,GACxBljB,IAASqiB,GAAqBO,EAAUrT,WAAawT,GAAeF,GACpEhmB,EAAI4lB,GAAuBI,EAMvBQ,EAAiB1sB,MAAMC,QAAQiC,GAAQA,EAAO,CAACA,GAM/CyqB,EAAiBD,EAAeE,OAAOpB,EAAyB,CAAC,IACjD,IAAhBW,IAAuBQ,EAAiB,CAAC,GAW7C,IAAI1oB,EAAKgoB,EAAUY,mBACfA,OAA4B,IAAP5oB,EAAgB,CAAC,EAAIA,EAE1C6oB,EAAUtyB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGwoB,GAAqBF,GAEjEI,EAAgB,SAAuB7vB,GACzCuvB,GAAoB,EACpBb,EAAY/Q,OAAO3d,GACnB+uB,EAAUtB,eAAeztB,IAAO,CAClC,EAEA,IAAK,IAAIA,KAAO4vB,EAAS,CACvB,IAAI/O,EAAO4O,EAAezvB,GACtB8gB,EAAO6O,EAAmB3vB,GAE1B2uB,EAAgBjsB,eAAe1C,KAK/B6gB,IAASC,EAKPvK,GAAkBsK,IAAStK,GAAkBuK,IAC1CF,GAAeC,EAAMC,IAASuO,EACjCQ,EAAc7vB,GAMd+uB,EAAUvB,cAAcxtB,IAAO,OAEf2E,IAATkc,EAETgP,EAAc7vB,GAGd0uB,EAAYjS,IAAIzc,QAEA2E,IAATkc,GAAsB6N,EAAYxkB,IAAIlK,GAK/C6vB,EAAc7vB,GAMd+uB,EAAUvB,cAAcxtB,IAAO,EAEnC,CAOA+uB,EAAUK,SAAWpqB,EACrB+pB,EAAUY,mBAAqBF,EAK3BV,EAAUrT,WACZiT,EAAkBrxB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGwnB,GAAkBc,IAGpEpB,GAAmBptB,EAAc6G,wBACnCynB,GAAoB,GASlBA,IAAsBL,GACxB/C,EAAWjjB,KAAKrD,MAAMsmB,EAAY7uB,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOqtB,EAAezK,KAAI,SAAUzlB,GAClG,MAAO,CACLA,UAAWA,EACXiR,QAASjT,EAAM6J,SAAS,CACtBgF,KAAMA,GACLoE,GAEP,MAAK,GAET,EASSvH,EAAI,EAAGA,EAAIglB,GAAmBhlB,IACrC8lB,EAAQ9lB,GAUV,GAPAolB,EAAkB9wB,EAAM6J,SAAS,CAAC,EAAGwnB,GAOjCD,EAAYhhB,KAAM,CACpB,IAAIoiB,EAAsB,CAAC,EAC3BpB,EAAYtwB,SAAQ,SAAU4B,GAC5B,IAAI+vB,EAAiB9uB,EAAc+uB,cAAchwB,QAE1B2E,IAAnBorB,IACFD,EAAoB9vB,GAAO+vB,EAE/B,IACA5D,EAAWjjB,KAAK,CACd5J,UAAWwwB,GAEf,CAEA,IAAIG,EAAgBzrB,QAAQ2nB,EAAW3rB,QAOvC,OALI6tB,IAAqC,IAAlBpvB,EAAMiF,UAAsBjD,EAAckuB,yBAC/Dc,GAAgB,GAGlB5B,GAAkB,EACX4B,EAAgBjsB,EAAQmoB,GAAcxC,QAAQC,SACvD,CA2BA,MAAO,CACLsG,WApSF,SAAoBlwB,GAClB,YAAgC2E,IAAzBypB,EAAgBpuB,EACzB,EAmSEiI,eAAgBA,EAChB4T,UAxBF,SAAmB1P,EAAMuP,EAAUnL,GACjC,IAAIjN,EAGJ,GAAI+M,EAAMlE,GAAMuP,WAAaA,EAAU,OAAOiO,QAAQC,UAEb,QAAxCtmB,EAAKrC,EAAcuqB,uBAAoC,IAAPloB,GAAyBA,EAAGlF,SAAQ,SAAU4d,GAC7F,IAAI1Y,EAEJ,OAAuC,QAA/BA,EAAK0Y,EAAMhU,sBAAmC,IAAP1E,OAAgB,EAASA,EAAGuY,UAAU1P,EAAMuP,EAC7F,IACArL,EAAMlE,GAAMuP,SAAWA,EACvB,IAAIyQ,EAAalkB,EAAesI,EAASpE,GAEzC,IAAK,IAAInM,KAAOqQ,EACdA,EAAMrQ,GAAKwtB,cAAgB,CAAC,EAG9B,OAAOrB,CACT,EAMEgE,mBA9RF,SAA4BC,GAC1BpsB,EAAUosB,EAAanvB,EACzB,EA6REosB,SAAU,WACR,OAAOhd,CACT,EAEJ,CAYA,SAAS8d,GAAgBzS,GAKvB,YAJiB,IAAbA,IACFA,GAAW,GAGN,CACLA,SAAUA,EACV8R,cAAe,CAAC,EAChBC,eAAgB,CAAC,EACjBkC,mBAAoB,CAAC,EAEzB,CAQA,IAAIxD,GAAa,CACf7sB,UAAWyf,IAAwB,SAAUzb,GAC3C,IAAIrC,EAAgBqC,EAAGrC,cACnB+C,EAAUV,EAAGU,QAOjB/C,EAAc+G,iBAAmB/G,EAAc+G,eAAiBimB,GAAqBhtB,IAKjFqV,GAAoBtS,IACtBzG,EAAMgE,WAAU,WACd,OAAOyC,EAAQqsB,UAAUpvB,EAC3B,GAAG,CAAC+C,GAER,IACAzE,KAAMwf,IAAwB,SAAU9f,GACtC,IAAIkE,EAASlE,EAAMkE,OACflC,EAAgBhC,EAAMgC,cAEtBqC,EAAKhG,EAAM6E,OAAOqe,KAAe,GACjCC,EAAYnd,EAAG,GACfgtB,EAAehtB,EAAG,GAElBmE,EAAkBlK,EAAMyD,WAAWE,GACvC3D,EAAMgE,WAAU,WACd,IAAI+B,EAAIyD,EAER9F,EAAcwf,UAAYA,EAC1B,IAAInhB,EAAoD,QAAvCgE,EAAKrC,EAAc+G,sBAAmC,IAAP1E,OAAgB,EAASA,EAAGuY,UAAUze,EAAQya,cAAciW,MAAOrN,EAAW,CAC5Itd,OAA4G,QAAnG4D,EAAKU,aAAyD,EAASA,EAAgBtE,cAA2B,IAAP4D,EAAgBA,EAAK5D,KAE1Isd,IAAcnhB,SAAsDA,EAAUwqB,KAAKwG,GACtF,GAAG,CAAC7P,GACN,KAME8P,GAEJ,WACE,SAASA,EAAW3X,EAAO4X,EAAUltB,GACnC,IACI5C,QADY,IAAP4C,EAAgB,CAAC,EAAIA,GACF5C,mBAExBknB,EAAQ9hB,KAoFZ,GA9EAA,KAAK2qB,WAAa,KAKlB3qB,KAAK4qB,cAAgB,KAKrB5qB,KAAK6qB,kBAAoB,KAKzB7qB,KAAK0qB,SAAW,CAAC,EAEjB1qB,KAAK8qB,YAAc,WACjB,GAAMhJ,EAAM8I,eAAiB9I,EAAM+I,kBAAnC,CACA,IAAI/U,EAAOiV,GAAWjJ,EAAM+I,kBAAmB/I,EAAMkJ,SACjDC,EAAoC,OAArBnJ,EAAM6I,WAIrBO,EAA0BtzB,EAAU2R,SAASuM,EAAKlI,OAAQ,CAC5D9H,EAAG,EACHC,EAAG,KACC,EACN,GAAKklB,GAAiBC,EAAtB,CACA,IAAIzX,EAAQqC,EAAKrC,MACbsP,EAAYlrB,EAAKgrB,eAAeE,UAEpCjB,EAAMkJ,QAAQ5nB,KAAK5L,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGoS,GAAQ,CAC3DsP,UAAWA,KAGb,IAAIvlB,EAAKskB,EAAM4I,SACXS,EAAU3tB,EAAG2tB,QACbC,EAAS5tB,EAAG4tB,OAEXH,IACHE,GAAWA,EAAQrJ,EAAM8I,cAAe9U,GACxCgM,EAAM6I,WAAa7I,EAAM8I,eAG3BQ,GAAUA,EAAOtJ,EAAM8I,cAAe9U,EAjBe,CAVQ,CA4B/D,EAEA9V,KAAKqrB,kBAAoB,SAAUvY,EAAOgD,GACxCgM,EAAM8I,cAAgB9X,EACtBgP,EAAM+I,kBAAoBS,GAAexV,EAAMgM,EAAMlnB,oBAEjDiY,GAAaC,IAA4B,IAAlBA,EAAMyY,QAC/BzJ,EAAM0J,gBAAgB1Y,EAAOgD,GAM/B/c,EAAuB,QAAE0yB,OAAO3J,EAAMgJ,aAAa,EACrD,EAEA9qB,KAAKwrB,gBAAkB,SAAU1Y,EAAOgD,GACtCgM,EAAM4J,MAEN,IAAIluB,EAAKskB,EAAM4I,SACXiB,EAAQnuB,EAAGmuB,MACXC,EAAepuB,EAAGouB,aAClBC,EAAUd,GAAWO,GAAexV,EAAMgM,EAAMlnB,oBAAqBknB,EAAMkJ,SAE3ElJ,EAAM6I,YAAcgB,GACtBA,EAAM7Y,EAAO+Y,GAGfD,GAAgBA,EAAa9Y,EAAO+Y,EACtC,IAGI3Y,GAAaJ,IAAUA,EAAMK,QAAQzY,OAAS,GAAlD,CACAsF,KAAK0qB,SAAWA,EAChB1qB,KAAKpF,mBAAqBA,EAC1B,IACIkxB,EAAcR,GADP1X,GAAiBd,GACW9S,KAAKpF,oBACxC6Y,EAAQqY,EAAYrY,MACpBsP,EAAYlrB,EAAKgrB,eAAeE,UACpC/iB,KAAKgrB,QAAU,CAACxzB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGoS,GAAQ,CACxDsP,UAAWA,KAEb,IAAIgJ,EAAiBrB,EAASqB,eAC9BA,GAAkBA,EAAejZ,EAAOiY,GAAWe,EAAa9rB,KAAKgrB,UACrEhrB,KAAKgsB,gBAAkBp0B,EAAUuiB,KAAKnF,GAAgBlZ,OAAQ,cAAekE,KAAKqrB,mBAAoBrW,GAAgBlZ,OAAQ,YAAakE,KAAKwrB,iBAAkBxW,GAAgBlZ,OAAQ,gBAAiBkE,KAAKwrB,iBAZrJ,CAa7D,CAWA,OATAf,EAAW9tB,UAAUsvB,eAAiB,SAAUvB,GAC9C1qB,KAAK0qB,SAAWA,CAClB,EAEAD,EAAW9tB,UAAU+uB,IAAM,WACzB1rB,KAAKgsB,iBAAmBhsB,KAAKgsB,kBAC7Bn0B,EAAKq0B,WAAWT,OAAOzrB,KAAK8qB,YAC9B,EAEOL,CACT,CAlHA,GAoHA,SAASa,GAAexV,EAAMlb,GAC5B,OAAOA,EAAqB,CAC1B6Y,MAAO7Y,EAAmBkb,EAAKrC,QAC7BqC,CACN,CAEA,SAASqW,GAAcjnB,EAAGC,GACxB,MAAO,CACLW,EAAGZ,EAAEY,EAAIX,EAAEW,EACXC,EAAGb,EAAEa,EAAIZ,EAAEY,EAEf,CAEA,SAASglB,GAAWvtB,EAAIwtB,GACtB,IAAIvX,EAAQjW,EAAGiW,MACf,MAAO,CACLA,MAAOA,EACPqP,MAAOqJ,GAAc1Y,EAAO2Y,GAAgBpB,IAC5Cpd,OAAQue,GAAc1Y,EAAO4Y,GAAiBrB,IAC9CltB,SAAUC,GAAYitB,EAAS,IAEnC,CAEA,SAASqB,GAAiBrB,GACxB,OAAOA,EAAQ,EACjB,CAEA,SAASoB,GAAgBpB,GACvB,OAAOA,EAAQA,EAAQtwB,OAAS,EAClC,CAEA,SAASqD,GAAYitB,EAAS1I,GAC5B,GAAI0I,EAAQtwB,OAAS,EACnB,MAAO,CACLoL,EAAG,EACHC,EAAG,GAQP,IAJA,IAAI7C,EAAI8nB,EAAQtwB,OAAS,EACrB4xB,EAAmB,KACnBC,EAAYH,GAAgBpB,GAEzB9nB,GAAK,IACVopB,EAAmBtB,EAAQ9nB,KAEvBqpB,EAAUxJ,UAAYuJ,EAAiBvJ,UAAY7H,GAAsBoH,MAI7Epf,IAGF,IAAKopB,EACH,MAAO,CACLxmB,EAAG,EACHC,EAAG,GAIP,IAAIymB,GAAQD,EAAUxJ,UAAYuJ,EAAiBvJ,WAAa,IAEhE,GAAa,IAATyJ,EACF,MAAO,CACL1mB,EAAG,EACHC,EAAG,GAIP,IAAIxI,EAAkB,CACpBuI,GAAIymB,EAAUzmB,EAAIwmB,EAAiBxmB,GAAK0mB,EACxCzmB,GAAIwmB,EAAUxmB,EAAIumB,EAAiBvmB,GAAKymB,GAW1C,OARIjvB,EAAgBuI,IAAMijB,MACxBxrB,EAAgBuI,EAAI,GAGlBvI,EAAgBwI,IAAMgjB,MACxBxrB,EAAgBwI,EAAI,GAGfxI,CACT,CAEA,SAASkvB,GAAWC,GAClB,OAAOA,EAAKC,IAAMD,EAAKE,GACzB,CAEA,SAASC,GAAOt1B,EAAO6U,EAAQ0gB,GAS7B,YARe,IAAX1gB,IACFA,EAAS,QAGS,IAAhB0gB,IACFA,EAAc,KAGTl1B,EAAU2R,SAAShS,EAAO6U,GAAU0gB,CAC7C,CAEA,SAASC,GAAcjK,EAAOzW,EAAQD,EAAQuB,QAC7B,IAAXA,IACFA,EAAS,IAGXmV,EAAMnV,OAASA,EACfmV,EAAMkK,YAAcp1B,EAAUiZ,IAAIxE,EAAOugB,IAAKvgB,EAAOsgB,IAAK7J,EAAMnV,QAChEmV,EAAM9Z,MAAQyjB,GAAWrgB,GAAUqgB,GAAWpgB,IAC1CwgB,GAAO/J,EAAM9Z,MAAO,EAAG,OAAWoa,MAAMN,EAAM9Z,UAAQ8Z,EAAM9Z,MAAQ,GACxE8Z,EAAMmK,UAAYr1B,EAAUiZ,IAAIzE,EAAOwgB,IAAKxgB,EAAOugB,IAAK7J,EAAMnV,QAAUmV,EAAMkK,aAC1EH,GAAO/J,EAAMmK,YAAc7J,MAAMN,EAAMmK,cAAYnK,EAAMmK,UAAY,EAC3E,CAEA,SAASC,GAAapK,EAAOzW,EAAQD,EAAQuB,GAC3Cof,GAAcjK,EAAMhd,EAAGuG,EAAOvG,EAAGsG,EAAOtG,EAAG6H,aAAuC,EAASA,EAAO7D,SAClGijB,GAAcjK,EAAM/c,EAAGsG,EAAOtG,EAAGqG,EAAOrG,EAAG4H,aAAuC,EAASA,EAAO3D,QACpG,CAEA,SAASmjB,GAAiB/gB,EAAQghB,EAAU1rB,GAC1C0K,EAAOwgB,IAAMlrB,EAAOkrB,IAAMQ,EAASR,IACnCxgB,EAAOugB,IAAMvgB,EAAOwgB,IAAMH,GAAWW,EACvC,CAOA,SAASC,GAAyBjhB,EAAQ7J,EAAQb,GAChD0K,EAAOwgB,IAAMrqB,EAAOqqB,IAAMlrB,EAAOkrB,IACjCxgB,EAAOugB,IAAMvgB,EAAOwgB,IAAMH,GAAWlqB,EACvC,CAEA,SAAS+qB,GAAqBlhB,EAAQ7J,EAAQb,GAC5C2rB,GAAyBjhB,EAAOtG,EAAGvD,EAAOuD,EAAGpE,EAAOoE,GACpDunB,GAAyBjhB,EAAOrG,EAAGxD,EAAOwD,EAAGrE,EAAOqE,EACtD,CA6BA,SAASwnB,GAA4Bb,EAAME,EAAKD,GAC9C,MAAO,CACLC,SAAa/tB,IAAR+tB,EAAoBF,EAAKE,IAAMA,OAAM/tB,EAC1C8tB,SAAa9tB,IAAR8tB,EAAoBD,EAAKC,IAAMA,GAAOD,EAAKC,IAAMD,EAAKE,UAAO/tB,EAEtE,CAsBA,SAAS2uB,GAA4BC,EAAYC,GAC/C,IAAIlwB,EAEAovB,EAAMc,EAAgBd,IAAMa,EAAWb,IACvCD,EAAMe,EAAgBf,IAAMc,EAAWd,IAO3C,OAJIe,EAAgBf,IAAMe,EAAgBd,IAAMa,EAAWd,IAAMc,EAAWb,MACxCA,GAAlCpvB,EAAKhG,EAAM6E,OAAO,CAACswB,EAAKC,GAAM,IAAa,GAAID,EAAMnvB,EAAG,IAGnD,CACLovB,IAAKA,EACLD,IAAKA,EAET,CAkDA,IAAIgB,GAAiB,IAsBrB,SAASC,GAAmBC,EAAaC,EAAUC,GACjD,MAAO,CACLnB,IAAKoB,GAAoBH,EAAaC,GACtCnB,IAAKqB,GAAoBH,EAAaE,GAE1C,CAEA,SAASC,GAAoBH,EAAaI,GACxC,IAAIzwB,EAEJ,MAA8B,iBAAhBqwB,EAA2BA,EAA4C,QAA7BrwB,EAAKqwB,EAAYI,UAA2B,IAAPzwB,EAAgBA,EAAK,CACpH,CAEA,IAuBI0wB,GAAY,WACd,MAAO,CACLpoB,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,GAST,EAEA,SAASwB,GAAStY,GAChB,MAAO,CAACA,EAAS,KAAMA,EAAS,KAClC,CAQA,SAASuY,GAAwB5wB,GAC/B,IAAIqK,EAAMrK,EAAGqK,IAIb,MAAO,CACL/B,EAAG,CACD8mB,IALOpvB,EAAGwK,KAMV2kB,IALQnvB,EAAGsK,OAOb/B,EAAG,CACD6mB,IAAK/kB,EACL8kB,IARSnvB,EAAGuK,QAWlB,CAqCA,SAASsmB,GAAgBrlB,GACvB,YAAiBnK,IAAVmK,GAAiC,IAAVA,CAChC,CAEA,SAASslB,GAAS9wB,GAChB,IAAIwL,EAAQxL,EAAGwL,MACXC,EAASzL,EAAGyL,OACZC,EAAS1L,EAAG0L,OAChB,OAAQmlB,GAAgBrlB,KAAWqlB,GAAgBplB,KAAYolB,GAAgBnlB,EACjF,CAEA,SAAS6B,GAAasG,GACpB,OAAOid,GAASjd,IAAWkd,GAAald,EAAOvL,IAAMyoB,GAAald,EAAOtL,IAAMsL,EAAOrL,GAAKqL,EAAO1I,QAAU0I,EAAOxI,SAAWwI,EAAOvI,OACvI,CAEA,SAASylB,GAAah3B,GACpB,OAAOA,GAAmB,OAAVA,CAClB,CAMA,SAASi3B,GAAW/a,EAAOzK,EAAOgkB,GAGhC,OAAOA,EADMhkB,GADYyK,EAAQuZ,EAGnC,CAMA,SAASyB,GAAgBhb,EAAOwZ,EAAWjkB,EAAOgkB,EAAa0B,GAK7D,YAJiB7vB,IAAb6vB,IACFjb,EAAQ+a,GAAW/a,EAAOib,EAAU1B,IAG/BwB,GAAW/a,EAAOzK,EAAOgkB,GAAeC,CACjD,CAMA,SAAS0B,GAAejC,EAAMO,EAAWjkB,EAAOgkB,EAAa0B,QACzC,IAAdzB,IACFA,EAAY,QAGA,IAAVjkB,IACFA,EAAQ,GAGV0jB,EAAKE,IAAM6B,GAAgB/B,EAAKE,IAAKK,EAAWjkB,EAAOgkB,EAAa0B,GACpEhC,EAAKC,IAAM8B,GAAgB/B,EAAKC,IAAKM,EAAWjkB,EAAOgkB,EAAa0B,EACtE,CAMA,SAASE,GAAcC,EAAKrxB,GAC1B,IAAIsI,EAAItI,EAAGsI,EACPC,EAAIvI,EAAGuI,EACX4oB,GAAeE,EAAI/oB,EAAGA,EAAEmnB,UAAWnnB,EAAEkD,MAAOlD,EAAEknB,aAC9C2B,GAAeE,EAAI9oB,EAAGA,EAAEknB,UAAWlnB,EAAEiD,MAAOjD,EAAEinB,YAChD,CAiDA,SAAS8B,GAAcpC,EAAMnjB,GAC3BmjB,EAAKE,IAAMF,EAAKE,IAAMrjB,EACtBmjB,EAAKC,IAAMD,EAAKC,IAAMpjB,CACxB,CAQA,SAASwlB,GAAcrC,EAAMsC,EAAYxxB,GACvC,IAAIyD,EAAKzJ,EAAM6E,OAAOmB,EAAI,GACtBtD,EAAM+G,EAAG,GACTguB,EAAWhuB,EAAG,GACdiuB,EAAYjuB,EAAG,GAEfkuB,OAAuCtwB,IAA1BmwB,EAAWE,GAA2BF,EAAWE,GAAa,GAC3ElC,EAAcp1B,EAAUiZ,IAAI6b,EAAKE,IAAKF,EAAKC,IAAKwC,GAEpDR,GAAejC,EAAMsC,EAAW90B,GAAM80B,EAAWC,GAAWjC,EAAagC,EAAWhmB,MACtF,CAMA,IAAIomB,GAAU,CAAC,IAAK,SAAU,WAC1BC,GAAU,CAAC,IAAK,SAAU,WAK9B,SAASC,GAAaT,EAAKvoB,GACzByoB,GAAcF,EAAI/oB,EAAGQ,EAAW8oB,IAChCL,GAAcF,EAAI9oB,EAAGO,EAAW+oB,GAClC,CAEA,SAASE,GAAqB9rB,EAAU6nB,GACtC,OAAO8C,GA7KT,SAA4B3a,EAAO6X,GACjC,IAAKA,EAAgB,OAAO7X,EAC5B,IAAI+b,EAAUlE,EAAe,CAC3BxlB,EAAG2N,EAAMzL,KACTjC,EAAG0N,EAAM5L,MAEP4nB,EAAcnE,EAAe,CAC/BxlB,EAAG2N,EAAM3L,MACT/B,EAAG0N,EAAM1L,SAEX,MAAO,CACLF,IAAK2nB,EAAQzpB,EACbiC,KAAMwnB,EAAQ1pB,EACdiC,OAAQ0nB,EAAY1pB,EACpB+B,MAAO2nB,EAAY3pB,EAEvB,CA6JiC4pB,CAAmBjsB,EAASyO,wBAAyBoZ,GACtF,CAeA,IAAIqE,GAAsB,IAAI9Y,QAM1B+Y,GAEJ,WACE,SAASA,EAA0Bz0B,GAIjC6E,KAAK6vB,eAAiB,KACtB7vB,KAAK8vB,YAAa,EAClB9vB,KAAK+vB,iBAAmB,KACxB/vB,KAAKgtB,YAAc,CACjBlnB,EAAG,EACHC,EAAG,GAML/F,KAAKgwB,aAAc,EACnBhwB,KAAKiwB,uBAAwB,EAK7BjwB,KAAKkwB,QA7QA,CACLpqB,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAmRL3sB,KAAK7E,cAAgBA,CACvB,CAygBA,OAvgBAy0B,EAA0BjzB,UAAUwB,MAAQ,SAAUgyB,EAAa3yB,GACjE,IAAIskB,EAAQ9hB,KAGRsL,QADY,IAAP9N,EAAgB,CAAC,EAAIA,GAClB4yB,aACRA,OAAsB,IAAP9kB,GAAwBA,EAM3C,IAAqC,IAAjCtL,KAAK7E,cAAcwf,UAAvB,CAkHA3a,KAAKqwB,WAAa,IAAI5F,GAAW0F,EAAa,CAC5CpE,eAjHmB,SAAwBjZ,GAG3CgP,EAAMiC,gBAEFqM,GACFtO,EAAMsO,aAAaxc,GAAiBd,EAAO,QAAQW,MAEvD,EA0GE0X,QAxGY,SAAiBrY,EAAOgD,GACpC,IAAItY,EAGAyD,EAAK6gB,EAAMnkB,WACXjE,EAAOuH,EAAGvH,KACV42B,EAAkBrvB,EAAGqvB,gBACrBC,EAActvB,EAAGsvB,cAEjB72B,GAAS42B,IACPxO,EAAM+N,gBAAgB/N,EAAM+N,iBAChC/N,EAAM+N,eAAiBva,GAAc5b,GAEhCooB,EAAM+N,mBAGb/N,EAAMgO,YAAa,EACnBhO,EAAMiO,iBAAmB,KAEzBjO,EAAM0O,qBAEF1O,EAAM3mB,cAAcwH,aACtBmf,EAAM3mB,cAAcwH,WAAW8tB,oBAAqB,EACpD3O,EAAM3mB,cAAcwH,WAAWyJ,YAASvN,GAO1CsvB,IAAS,SAAUzB,GACjB,IAAIlvB,EAAIyD,EAEJtF,EAAUmmB,EAAM4O,mBAAmBhE,GAAMh0B,OAAS,EAKtD,GAAIf,EAAgB4sB,QAAQ7f,KAAK/I,GAAU,CACzC,IAAIg1B,EAA+G,QAA/F1vB,EAA+C,QAAzCzD,EAAKskB,EAAM3mB,cAAcwH,kBAA+B,IAAPnF,OAAgB,EAASA,EAAG+E,cAA2B,IAAPtB,OAAgB,EAASA,EAAG2vB,OAAOlE,GAE9J,GAAIiE,EAEFh1B,EADe8wB,GAAWkE,IACJzQ,WAAWvkB,GAAW,IAEhD,CAEAmmB,EAAMkL,YAAYN,GAAQ/wB,CAC5B,IAEA40B,SAA0DA,EAAYzd,EAAOgD,GAC/B,QAA7CtY,EAAKskB,EAAM3mB,cAAc+G,sBAAmC,IAAP1E,GAAyBA,EAAGuY,UAAUze,EAAQya,cAAcgW,MAAM,GAC1H,EAqDEqD,OAnDW,SAAgBtY,EAAOgD,GAElC,IAAItY,EAAKskB,EAAMnkB,WACX2yB,EAAkB9yB,EAAG8yB,gBACrBO,EAAoBrzB,EAAGqzB,kBACvBC,EAAkBtzB,EAAGszB,gBACrBC,EAASvzB,EAAGuzB,OAGhB,GAAKT,GAAoBxO,EAAM+N,eAA/B,CACA,IAAIjiB,EAASkI,EAAKlI,OAElB,GAAIijB,GAAgD,OAA3B/O,EAAMiO,iBAO7B,OANAjO,EAAMiO,iBA4bd,SAA6BniB,EAAQojB,QACb,IAAlBA,IACFA,EAAgB,IAGlB,IAAIC,EAAY,KAEZxqB,KAAKyqB,IAAItjB,EAAO7H,GAAKirB,EACvBC,EAAY,IACHxqB,KAAKyqB,IAAItjB,EAAO9H,GAAKkrB,IAC9BC,EAAY,KAGd,OAAOA,CACT,CA1ciCE,CAAoBvjB,QAEd,OAA3BkU,EAAMiO,mBACRe,SAAkEA,EAAgBhP,EAAMiO,oBAO5FjO,EAAMsP,WAAW,IAAKtb,EAAKrC,MAAO7F,GAElCkU,EAAMsP,WAAW,IAAKtb,EAAKrC,MAAO7F,GASlCkU,EAAM3mB,cAAc8G,aAOpB8uB,SAAgDA,EAAOje,EAAOgD,EAhCT,CAiCvD,EAUE8V,aARiB,SAAsB9Y,EAAOgD,GAC9C,OAAOgM,EAAMd,KAAKlO,EAAOgD,EAC3B,GAOG,CACDlb,mBAAoBoF,KAAK7E,cAAck2B,yBAxHS,CA0HpD,EAEAzB,EAA0BjzB,UAAUqkB,KAAO,SAAUlO,EAAOgD,GAC1D,IAAIga,EAAa9vB,KAAK8vB,WAEtB,GADA9vB,KAAKsxB,SACAxB,EAAL,CACA,IAAIhyB,EAAWgY,EAAKhY,SACpBkC,KAAKsgB,eAAexiB,GACpB,IAAIyzB,EAAYvxB,KAAKrC,WAAW4zB,UAChCA,SAAsDA,EAAUze,EAAOgD,EAJhD,CAKzB,EAEA8Z,EAA0BjzB,UAAU20B,OAAS,WAC3C,IAAI9zB,EAAIyD,EAERjB,KAAK8vB,YAAa,EAEd9vB,KAAK7E,cAAcwH,aACrB3C,KAAK7E,cAAcwH,WAAW8tB,oBAAqB,GAG1B,QAA1BjzB,EAAKwC,KAAKqwB,kBAA+B,IAAP7yB,GAAyBA,EAAGkuB,MAC/D1rB,KAAKqwB,gBAAaxxB,GACImB,KAAKrC,WAAW2yB,iBAEdtwB,KAAK6vB,iBAC3B7vB,KAAK6vB,iBACL7vB,KAAK6vB,eAAiB,MAGqB,QAA5C5uB,EAAKjB,KAAK7E,cAAc+G,sBAAmC,IAAPjB,GAAyBA,EAAG8U,UAAUze,EAAQya,cAAcgW,MAAM,EACzH,EAEA6H,EAA0BjzB,UAAUy0B,WAAa,SAAU1E,EAAM8E,EAAQ5jB,GACvE,IAAIlU,EAAOsG,KAAKrC,WAAWjE,KAE3B,GAAKkU,GAAW6jB,GAAW/E,EAAMhzB,EAAMsG,KAAK+vB,kBAA5C,CACA,IAvmBsBtc,EAAOjW,EAAI0yB,EAC/BtD,EACAD,EAqmBE+E,EAAY1xB,KAAK0wB,mBAAmBhE,GACpC3R,EAAO/a,KAAKgtB,YAAYN,GAAQ9e,EAAO8e,GAEvC1sB,KAAKgwB,aAAehwB,KAAKgwB,YAAYtD,KA1mBnBjZ,EA2mBIsH,EA3mBGvd,EA2mBGwC,KAAKgwB,YAAYtD,GA3mBhBwD,EA2mBuBlwB,KAAKkwB,QAAQxD,GA1mBnEE,EAAMpvB,EAAGovB,IACTD,EAAMnvB,EAAGmvB,SAED9tB,IAAR+tB,GAAqBnZ,EAAQmZ,EAE/BnZ,EAAQyc,EAAUt4B,EAAUiZ,IAAI+b,EAAKnZ,EAAOyc,EAAQtD,KAAOnmB,KAAKkmB,IAAIlZ,EAAOmZ,QAC1D/tB,IAAR8tB,GAAqBlZ,EAAQkZ,IAEtClZ,EAAQyc,EAAUt4B,EAAUiZ,IAAI8b,EAAKlZ,EAAOyc,EAAQvD,KAAOlmB,KAAKmmB,IAAInZ,EAAOkZ,IAkmBzE5R,EA/lBGtH,GAkmBLie,EAAUrtB,IAAI0W,EARuD,CASvE,EAEA6U,EAA0BjzB,UAAU6zB,mBAAqB,WACvD,IAAI1O,EAAQ9hB,KAERxC,EAAKwC,KAAKrC,WACV6E,EAAkBhF,EAAGgF,gBACrBqrB,EAAcrwB,EAAGqwB,YAEjBtrB,GAAUvC,KAAK7E,cAAcwH,YAAc,CAAC,GAAGJ,OAC/CovB,EAAkB3xB,KAAKgwB,YAEvBxtB,GAAmB/F,EAAY+F,GAC5BxC,KAAKgwB,cACRhwB,KAAKgwB,YAAchwB,KAAK4xB,yBAIxB5xB,KAAKgwB,eADHxtB,IAAmBD,IA/lB7B,SAAiCsvB,EAAWr0B,GAC1C,IAAIqK,EAAMrK,EAAGqK,IACTG,EAAOxK,EAAGwK,KACVD,EAASvK,EAAGuK,OACZD,EAAQtK,EAAGsK,MACf,MAAO,CACLhC,EAAGynB,GAA4BsE,EAAU/rB,EAAGkC,EAAMF,GAClD/B,EAAGwnB,GAA4BsE,EAAU9rB,EAAG8B,EAAKE,GAErD,CAulB2B+pB,CAAwBvvB,EAAOquB,OAAQpuB,GAM9DxC,KAAKkwB,QAjhBT,SAA4BrC,GAW1B,YAVoB,IAAhBA,IACFA,EAAcF,KAGI,IAAhBE,EACFA,EAAc,GACW,IAAhBA,IACTA,EAAcF,IAGT,CACL7nB,EAAG8nB,GAAmBC,EAAa,OAAQ,SAC3C9nB,EAAG6nB,GAAmBC,EAAa,MAAO,UAE9C,CAkgBmBkE,CAAmBlE,GAM9B8D,IAAoB3xB,KAAKgwB,aAAeztB,GAAUvC,KAAKgwB,cAAgBhwB,KAAKiwB,uBAC9E9B,IAAS,SAAUzB,GACb5K,EAAM4O,mBAAmBhE,KAC3B5K,EAAMkO,YAAYtD,GA7iB5B,SAA+BnqB,EAAQytB,GACrC,IAAIgC,EAAsB,CAAC,EAU3B,YARwBnzB,IAApBmxB,EAAYpD,MACdoF,EAAoBpF,IAAMoD,EAAYpD,IAAMrqB,EAAOqqB,UAG7B/tB,IAApBmxB,EAAYrD,MACdqF,EAAoBrF,IAAMqD,EAAYrD,IAAMpqB,EAAOqqB,KAG9CoF,CACT,CAiiBoCC,CAAsB1vB,EAAOquB,OAAOlE,GAAO5K,EAAMkO,YAAYtD,IAE3F,GAEJ,EAEAkD,EAA0BjzB,UAAUi1B,sBAAwB,WAC1D,IAAIp0B,EAAKwC,KAAKrC,WACVqyB,EAAcxyB,EAAGgF,gBACjB0vB,EAA2B10B,EAAG00B,yBAElC,IAAKlC,IAAgBvzB,EAAYuzB,GAAc,OAAO,EACtD,IAAImC,EAAqBnC,EAAYr0B,QACrCjE,EAAU0kB,UAAiC,OAAvB+V,EAA6B,0GACjD,IAAIxvB,EAAa3C,KAAK7E,cAAcwH,WAEpC,IAAKA,IAAeA,EAAWJ,OAAQ,OAAO,EAC9C,IAAI6vB,EAnRR,SAAwBziB,EAAS0iB,EAAoBz3B,GACnD,IAAI03B,EAAc/C,GAAqB5f,EAAS/U,GAE5C23B,EAASF,EAAmBE,OAOhC,OALIA,IACFzD,GAAcwD,EAAYxsB,EAAGysB,EAAOzsB,GACpCgpB,GAAcwD,EAAYvsB,EAAGwsB,EAAOxsB,IAG/BusB,CACT,CAwQyBE,CAAeL,EAAoBxvB,EAAW0U,KAAMrX,KAAK7E,cAAck2B,yBACxFoB,EA7lBR,SAAiCZ,EAAWO,GAC1C,MAAO,CACLtsB,EAAG0nB,GAA4BqE,EAAU/rB,EAAGssB,EAAetsB,GAC3DC,EAAGynB,GAA4BqE,EAAU9rB,EAAGqsB,EAAersB,GAE/D,CAwlB8B2sB,CAAwB/vB,EAAWJ,OAAOquB,OAAQwB,GAM5E,GAAIF,EAA0B,CAC5B,IAAIS,EAAkBT,EA5d5B,SAAiC10B,GAC/B,IAAIsI,EAAItI,EAAGsI,EACPC,EAAIvI,EAAGuI,EACX,MAAO,CACL8B,IAAK9B,EAAE6mB,IACP9kB,MAAOhC,EAAE6mB,IACT5kB,OAAQhC,EAAE4mB,IACV3kB,KAAMlC,EAAE8mB,IAEZ,CAmdqDgG,CAAwBH,IACvEzyB,KAAKiwB,wBAA0B0C,EAE3BA,IACFF,EAAsBrE,GAAwBuE,GAElD,CAEA,OAAOF,CACT,EAEA7C,EAA0BjzB,UAAU2jB,eAAiB,SAAUxiB,GAC7D,IAAIgkB,EAAQ9hB,KAERxC,EAAKwC,KAAKrC,WACVjE,EAAO8D,EAAG9D,KACVm5B,EAAer1B,EAAGq1B,aAClBhF,EAAcrwB,EAAGqwB,YACjBiF,EAAiBt1B,EAAGs1B,eACpBC,EAAmBv1B,EAAGu1B,iBACtBC,EAAsBx1B,EAAGw1B,oBAEzBhD,EAAchwB,KAAKgwB,aAAe,CAAC,EACnCiD,EAAqB9E,IAAS,SAAUzB,GAC1C,IAAIlvB,EAEJ,GAAKi0B,GAAW/E,EAAMhzB,EAAMooB,EAAMiO,kBAAlC,CAIA,IAAIle,EAAoG,QAAtFrU,EAAKwyB,aAAiD,EAASA,EAAYtD,UAA0B,IAAPlvB,EAAgBA,EAAK,CAAC,EAClIu1B,IAAkBlhB,EAAa,CACjC+a,IAAK,EACLD,IAAK,IASP,IAAIuG,EAAkBrF,EAAc,IAAM,IACtCsF,EAAgBtF,EAAc,GAAK,IAEnC/M,EAAUtpB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAC1CgF,KAAM,UACNvI,SAAU+0B,EAAe/0B,EAAS4uB,GAAQ,EAC1CwG,gBAAiBA,EACjBC,cAAeA,EACfC,aAAc,IACdC,UAAW,EACXtW,UAAW,IACV+V,GAAiBjhB,GAKpB,OAAOiQ,EAAMwR,wBAAwB5G,EAAM5L,EA9B3C,CA+BF,IAEA,OAAO+C,QAAQ7L,IAAIib,GAAoBjP,KAAKgP,EAC9C,EAEApD,EAA0BjzB,UAAU22B,wBAA0B,SAAU5G,EAAM7a,GAE5E,OAAOyO,GAAeoM,EADN1sB,KAAK0wB,mBAAmBhE,GACD,EAAG7a,EAC5C,EAEA+d,EAA0BjzB,UAAUonB,cAAgB,WAClD,IAAIjC,EAAQ9hB,KAEZmuB,IAAS,SAAUzB,GACjB,OAAO5K,EAAM4O,mBAAmBhE,GAAM1L,MACxC,GACF,EASA4O,EAA0BjzB,UAAU+zB,mBAAqB,SAAUhE,GACjE,IAAIlvB,EAAIyD,EAEJsyB,EAAU,QAAU7G,EAAKnc,cACzBijB,EAAsBxzB,KAAK7E,cAAcwC,WAAW41B,GACxD,OAAOC,GAA4CxzB,KAAK7E,cAAc8pB,SAASyH,EAA4G,QAArGzrB,EAAsD,QAAhDzD,EAAKwC,KAAK7E,cAAcwC,WAAWS,eAA4B,IAAPZ,OAAgB,EAASA,EAAGkvB,UAA0B,IAAPzrB,EAAgBA,EAAK,EAC1N,EAEA2uB,EAA0BjzB,UAAUyzB,aAAe,SAAU3c,GAC3D,IAAIqO,EAAQ9hB,KAEZmuB,IAAS,SAAUzB,GAIjB,GAAK+E,GAAW/E,EAHL5K,EAAMnkB,WAAWjE,KAGAooB,EAAMiO,kBAAlC,CACA,IAAIptB,EAAamf,EAAM3mB,cAAcwH,WAEjC+uB,EAAY5P,EAAM4O,mBAAmBhE,GAEzC,GAAI/pB,GAAcA,EAAWJ,OAAQ,CACnC,IAAI/E,EAAKmF,EAAWJ,OAAOquB,OAAOlE,GAC9BE,EAAMpvB,EAAGovB,IACTD,EAAMnvB,EAAGmvB,IACb+E,EAAUrtB,IAAIoP,EAAMiZ,GAAQ90B,EAAUiZ,IAAI+b,EAAKD,EAAK,IACtD,CAV2D,CAW7D,GACF,EAQAiD,EAA0BjzB,UAAU82B,+BAAiC,WACnE,IAEIj2B,EAFAskB,EAAQ9hB,KAIRiB,EAAKjB,KAAKrC,WACVjE,EAAOuH,EAAGvH,KACV8I,EAAkBvB,EAAGuB,gBAErBG,EAAa3C,KAAK7E,cAAcwH,WACpC,GAAKlG,EAAY+F,IAAqBG,GAAe3C,KAAKgwB,YAA1D,CAMAhwB,KAAK+jB,gBAML,IAAI2P,EAAc,CAChB5tB,EAAG,EACHC,EAAG,GAELooB,IAAS,SAAUzB,GACjB,IA1uBcrgB,EAAQD,EACtBuB,EACAgmB,EACAC,EAuuBIlC,EAAY5P,EAAM4O,mBAAmBhE,GAEzC,GAAIgF,EAAW,CACb,IAAImC,EAASnC,EAAUh5B,MACvBg7B,EAAYhH,IA9uBArgB,EA8uBmB,CAC7BugB,IAAKiH,EACLlH,IAAKkH,GAhvBaznB,EAivBjB0V,EAAMkO,YAAYtD,GAhvBvB/e,EAAS,GACTgmB,EAAelH,GAAWpgB,IAC1BunB,EAAenH,GAAWrgB,IAEXunB,EACjBhmB,EAAS/V,EAAUk8B,SAAS1nB,EAAOwgB,IAAKxgB,EAAOugB,IAAMgH,EAActnB,EAAOugB,KACjE+G,EAAeC,IACxBjmB,EAAS/V,EAAUk8B,SAASznB,EAAOugB,IAAKvgB,EAAOsgB,IAAMiH,EAAcxnB,EAAOwgB,MAGrEh1B,EAAUm8B,MAAM,EAAG,EAAGpmB,GAuuBzB,CACF,IAKA,IAAIjD,EAAoB1K,KAAK7E,cAAcwC,WAAW+M,kBACtD1K,KAAK7E,cAAcod,cAAc5N,MAAMrE,UAAYoE,EAAoBA,EAAkB,CAAC,EAAG,IAAM,OACxE,QAA1BlN,EAAKmF,EAAW0U,YAAyB,IAAP7Z,GAAyBA,EAAGw2B,eAC/DrxB,EAAWsxB,eACXj0B,KAAKwwB,qBAMLrC,IAAS,SAAUzB,GACjB,GAAK+E,GAAW/E,EAAMhzB,EAAM,MAA5B,CAKA,IAAIg4B,EAAY5P,EAAM4O,mBAAmBhE,GAErClvB,EAAKskB,EAAMkO,YAAYtD,GACvBE,EAAMpvB,EAAGovB,IACTD,EAAMnvB,EAAGmvB,IACb+E,EAAUrtB,IAAIzM,EAAUiZ,IAAI+b,EAAKD,EAAK+G,EAAYhH,IAVT,CAW3C,GArD6E,CAsD/E,EAEAkD,EAA0BjzB,UAAUu3B,aAAe,WACjD,IAEI12B,EAFAskB,EAAQ9hB,KAIZ2vB,GAAoBtrB,IAAIrE,KAAK7E,cAAe6E,MAC5C,IAKIm0B,EAAsBnf,GALZhV,KAAK7E,cAAcod,cAKkB,eAAe,SAAUzF,GAC1E,IAAItV,EAAKskB,EAAMnkB,WACXjE,EAAO8D,EAAG9D,KACVuH,EAAKzD,EAAGmP,aAGZjT,SAF0B,IAAPuH,GAAuBA,IAElB6gB,EAAM3jB,MAAM2U,EACtC,IAEIshB,EAAyB,WAGvB33B,EAFkBqlB,EAAMnkB,WAAW6E,mBAGrCsf,EAAMkO,YAAclO,EAAM8P,wBAE9B,EAEIjvB,EAAa3C,KAAK7E,cAAcwH,WAChC0xB,EAA4B1xB,EAAW+P,iBAAiB,UAAW0hB,GAEnEzxB,IAAeA,EAAWJ,SACD,QAA1B/E,EAAKmF,EAAW0U,YAAyB,IAAP7Z,GAAyBA,EAAGw2B,eAC/DrxB,EAAWsxB,gBAGbG,IAMA,IAAIE,EAAqBhiB,GAAYxW,OAAQ,UAAU,WACrD,OAAOgmB,EAAM2R,gCACf,IAMIc,EAA2B5xB,EAAW+P,iBAAiB,aAAa,SAAUlV,GAChF,IAAIslB,EAAQtlB,EAAGslB,MACX0R,EAAmBh3B,EAAGg3B,iBAEtB1S,EAAMgO,YAAc0E,IACtBrG,IAAS,SAAUzB,GACjB,IAAItI,EAActC,EAAM4O,mBAAmBhE,GAEtCtI,IACLtC,EAAMkL,YAAYN,IAAS5J,EAAM4J,GAAMO,UACvC7I,EAAY/f,IAAI+f,EAAY1rB,MAAQoqB,EAAM4J,GAAMO,WAClD,IAEAnL,EAAM3mB,cAAc8G,aAExB,IACA,OAAO,WACLqyB,IACAH,IACAE,IACAE,SAAoFA,GACtF,CACF,EAEA3E,EAA0BjzB,UAAUgB,SAAW,WAC7C,IAAIxE,EAAQ6G,KAAK7E,cAAcwC,WAC3BH,EAAKrE,EAAMO,KACXA,OAAc,IAAP8D,GAAwBA,EAC/ByD,EAAK9H,EAAM03B,kBACXA,OAA2B,IAAP5vB,GAAwBA,EAC5CqK,EAAKnS,EAAMm3B,gBACXA,OAAyB,IAAPhlB,GAAwBA,EAC1CE,EAAKrS,EAAMqJ,gBACXA,OAAyB,IAAPgJ,GAAwBA,EAC1C4b,EAAKjuB,EAAM00B,YACXA,OAAqB,IAAPzG,EAAgBuG,GAAiBvG,EAC/CC,EAAKluB,EAAM05B,aACXA,OAAsB,IAAPxL,GAAuBA,EAC1C,OAAO7vB,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGlI,GAAQ,CAC/CO,KAAMA,EACNm3B,kBAAmBA,EACnBP,gBAAiBA,EACjB9tB,gBAAiBA,EACjBqrB,YAAaA,EACbgF,aAAcA,GAElB,EAEOjD,CACT,CAliBA,GAoiBA,SAAS6B,GAAWR,EAAWv3B,EAAMq2B,GACnC,SAAiB,IAATr2B,GAAiBA,IAASu3B,GAAoC,OAArBlB,GAA6BA,IAAqBkB,EACrG,CAkGA,IAAIv3B,GAAO,CACTI,IAAKmf,IArCP,SAAuBzb,GACrB,IAAIi3B,EAAQj3B,EAAGi3B,MACXC,EAAal3B,EAAGk3B,WAChBC,EAAWn3B,EAAGm3B,SACdC,EAAoBp3B,EAAGo3B,kBACvBz5B,EAAgBqC,EAAGrC,cACnB05B,EAAeJ,GAASC,GAAcC,GAAYC,EAClDvE,EAAa54B,EAAM6H,OAAO,MAC1B1E,EAAqBnD,EAAMyD,WAAWP,GAAqBC,mBAC3D8vB,EAAW,CACbqB,eAAgB6I,EAChBzJ,QAASuJ,EACTtJ,OAAQqJ,EACR9I,MAAO,SAAe7Y,EAAOgD,GAC3Bua,EAAW10B,QAAU,KACrBg5B,GAAYA,EAAS7hB,EAAOgD,EAC9B,GAEFre,EAAMgE,WAAU,WACa,OAAvB40B,EAAW10B,SACb00B,EAAW10B,QAAQswB,eAAevB,EAEtC,IAQAzV,GAAgB9Z,EAAe,cAAe05B,GAN9C,SAAuB/hB,GACrBud,EAAW10B,QAAU,IAAI8uB,GAAW3X,EAAO4X,EAAU,CACnD9vB,mBAAoBA,GAExB,GAGAwb,IAAiB,WACf,OAAOia,EAAW10B,SAAW00B,EAAW10B,QAAQ+vB,KAClD,GACF,IAIEhyB,KAAMuf,IApER,SAAiB9f,GACf,IAAI27B,EAAoB37B,EAAM47B,aAC1B55B,EAAgBhC,EAAMgC,cACtB45B,EAAe31B,GAAY,WAC7B,OAAO,IAAIwwB,GAA0Bz0B,EACvC,IAGA1D,EAAMgE,WAAU,WACd,OAAOq5B,GAAqBA,EAAkBvK,UAAUwK,EAC1D,GAAG,CAACA,EAAcD,IAElBr9B,EAAMgE,WAAU,WACd,OAAOs5B,EAAab,cACtB,GAAG,CAACa,GACN,KAuDIC,GAAQ,CAAC,gBAAiB,sBAAuB,eAAgB,oBAAqB,SAAU,SAAU,oBAAqB,0BAA2B,iBAAkB,uBAAwB,gBAAiB,WAiGzN,IAAI75B,GAAgB,SAAuBqC,GACzC,IAAIyD,EAAKzD,EAAGy3B,SACRA,OAAkB,IAAPh0B,EAAgB,GAAKA,EAChCi0B,EAAQ13B,EAAG03B,MACXC,EAAiB33B,EAAG0sB,cACpBkL,EAAwB53B,EAAG4nB,qBAC3BiQ,EAAsB73B,EAAG83B,mBACzBC,EAAiB/3B,EAAG+C,OACpBi1B,EAAwBh4B,EAAGg4B,sBAC3BC,EAA6Bj4B,EAAGi4B,2BAChCC,EAAoBl4B,EAAGiqB,iBACvBnX,EAA8B9S,EAAG8S,4BACrC,OAAO,SAAU9S,EAAIiN,GACnB,IAAI/I,EAASlE,EAAGkE,OACZvI,EAAQqE,EAAGrE,MACX4I,EAAavE,EAAGuE,WAChBC,EAAwBxE,EAAGwE,sBAC3BR,EAAchE,EAAGgE,YACjBI,EAAqBpE,EAAGoE,wBAEZ,IAAZ6I,IACFA,EAAU,CAAC,GAGb,IAUIhH,EAwCAkyB,EAlDAC,GAAY,EACZprB,EAAehJ,EAAYgJ,aAC3ByF,EAAczO,EAAYyO,YAc1B4lB,EAvIR,WACE,IAAIC,EAAWd,GAAM/V,KAAI,WACvB,OAAO,IAAI2C,EACb,IACImU,EAAoB,CAAC,EACrBF,EAAa,CACfG,kBAAmB,WACjB,OAAOF,EAASx9B,SAAQ,SAAU29B,GAChC,OAAOA,EAAQ9T,OACjB,GACF,EACA+T,oBAAqB,SAA6B/8B,GAChD67B,GAAM18B,SAAQ,SAAUe,GACtB,IAAImE,EAEA24B,EAAK,KAAO98B,EACZ+8B,EAAej9B,EAAMg9B,GAEU,QAAlC34B,EAAKu4B,EAAkB18B,UAA0B,IAAPmE,GAAyBA,EAAGX,KAAKk5B,GAExEK,IACFL,EAAkB18B,GAAQw8B,EAAWM,GAAIC,GAE7C,GACF,GAiBF,OAfAN,EAASx9B,SAAQ,SAAU29B,EAAS/yB,GAClC2yB,EAAW,KAAOb,GAAM9xB,IAAM,SAAUsP,GACtC,OAAOyjB,EAAQtf,IAAInE,EACrB,EAEAqjB,EAAW,SAAWb,GAAM9xB,IAAM,WAGhC,IAFA,IAAImzB,EAAO,GAEFC,EAAK,EAAGA,EAAKr2B,UAAUvF,OAAQ47B,IACtCD,EAAKC,GAAMr2B,UAAUq2B,GAGvB,OAAOL,EAAQlU,OAAOhiB,MAAMk2B,EAASz+B,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOg6B,IAAO,GACnF,CACF,IACOR,CACT,CA6FqBU,GAObllB,EAAS,IAAInN,IAMbsyB,EAAqB,IAAItyB,IAOzBuyB,EAAmB,CAAC,EAMpBC,EAAal/B,EAAM6J,SAAS,CAAC,EAAGmJ,GAcpC,SAASjK,IACFkD,GAAamyB,IAClBe,IACApB,EAAe9xB,EAAUwM,EAAa9W,EAAMwR,MAAOgF,EAAQhN,YAC7D,CAEA,SAASg0B,IACPzB,EAAMvlB,EAASM,EAAazF,EAAcC,EAAStR,EACrD,CAEA,SAASsyB,IACPoK,EAAWe,aAAapsB,EAC1B,CAMA,SAASqsB,EAAkB38B,EAAK3C,GAC9B,IAAIu/B,EAAiBv/B,EAAM8rB,UAAS,SAAU0T,GAC5CvsB,EAAatQ,GAAO68B,EACpB59B,EAAM0nB,UAAY9nB,EAAuB,QAAE0yB,OAAOA,GAAQ,GAAO,EACnE,IACIuL,EAAwBz/B,EAAMisB,gBAAgB7T,EAAQ5M,gBAC1DyzB,EAAmBnyB,IAAInK,GAAK,WAC1B48B,IACAE,GACF,GACF,CAaA,IAAIC,EAAsB3mB,EAA4BnX,GAEtD,IAAK,IAAIe,KAAO+8B,EAAqB,CACnC,IAAI1/B,EAAQ0/B,EAAoB/8B,QAEN2E,IAAtB2L,EAAatQ,IAAsB0L,GAAcrO,IACnDA,EAAM8M,IAAImG,EAAatQ,IAAM,EAEjC,CAMA,IAAIqX,EAAwBtT,EAA2B9E,GACnDqY,EAAgB/S,EAAmBtF,GAEnCwW,EAAUnY,EAAM6J,SAAS7J,EAAM6J,SAAS,CAC1C4zB,SAAUA,EAMVt5B,QAAS,KAKTu7B,MAAOx1B,EAASA,EAAOw1B,MAAQ,EAAI,EACnCx1B,OAAQA,EACRlB,SAAU,IAAI+E,IAKdxD,WAAYA,EACZH,mBAAoBA,EAOpB8jB,gBAAiBlU,EAAgB,IAAIjM,SAAQ1G,EAQ7Cs4B,eAAWt4B,EAUXwqB,uBAAwB3qB,QAAQgD,aAAuC,EAASA,EAAOk0B,aAMvF5zB,sBAAuBA,EAOvB4zB,UAAW,WACT,OAAOl3B,QAAQ+E,EACjB,EACAC,MAAO,SAAe0zB,GACpBxB,GAAY,EACZnyB,EAAWkM,EAAQhU,QAAUy7B,EAEzBznB,EAAQhN,YACVgN,EAAQhN,WAAWe,MAAM0zB,GAGvB5lB,GAAiB9P,IAAW6P,IAC9BokB,EAAwBj0B,aAAuC,EAASA,EAAO21B,gBAAgB1nB,IAGjG0B,EAAO/Y,SAAQ,SAAUf,EAAO2C,GAC9B,OAAO28B,EAAkB38B,EAAK3C,EAChC,IACAmK,SAAgDA,EAAOlB,SAASmW,IAAIhH,GACpEA,EAAQrP,SAASnH,EACnB,EAKAwK,QAAS,WACP,IAAInG,EAE0B,QAA7BA,EAAKmS,EAAQhN,kBAA+B,IAAPnF,GAAyBA,EAAGmG,UAClE9L,EAAKq0B,WAAWT,OAAOA,GACvB5zB,EAAKq0B,WAAW3rB,OAAOA,GACvBi2B,EAAmBl+B,SAAQ,SAAUg/B,GACnC,OAAOA,GACT,IACA3B,SAA8EA,IAC9Ej0B,SAAgDA,EAAOlB,SAASqX,OAAOlI,GACvEkmB,EAAWG,oBACXvyB,OAAW5E,EACX+2B,GAAY,CACd,EAKAyB,gBAAiB,SAAyBnhB,GACxC,IAAI1Y,EAEA+5B,EAAqB5nB,EAAQ6nB,wBAEjC,GAAID,EAEF,OAD8C,QAA7C/5B,EAAK+5B,EAAmB7R,uBAAoC,IAAPloB,GAAyBA,EAAGmZ,IAAIT,GAC/E,WACL,OAAOqhB,EAAmB7R,gBAAgB7N,OAAO3B,EACnD,CAEJ,EACAuR,iBAAkB,SAA0BgQ,GAI1C,OAAK/B,GAAqBT,IAAawC,EAAMxC,SACtCS,EAAkB/lB,EAAQ4I,cAAekf,EAAMlf,eADQ,CAEhE,EAMAif,sBAAuB,WACrB,OAAOhmB,EAAgB7B,EAAUjO,aAAuC,EAASA,EAAO81B,uBAC1F,EAKAE,YAAa,WACX,OAAOv+B,EAAM6H,QACf,EAKAuX,YAAa,WACX,OAAO9U,CACT,EAKAk0B,eAAgB,SAAwBz9B,GACtC,OAAOsQ,EAAatQ,EACtB,EACA09B,eAAgB,SAAwB19B,EAAK3C,GAC3C,OAAOiT,EAAatQ,GAAO3C,CAC7B,EAOAqL,gBAAiB,WACf,OAAO4H,CACT,EAMAqtB,cAAe,SAAuBC,GAChCnoB,EAAQwnB,YAAcW,IAC1BnoB,EAAQwnB,UAAYW,EACpBnoB,EAAQ5M,iBACV,EASAqiB,qBAAsB,SAA8BhZ,EAAQ2rB,GAK1D,YAJkB,IAAdA,IACFA,GAAY,GAGP3C,EAAsBzlB,EAASvD,EAAQjT,EAAO4+B,EACvD,EAOAzC,mBAAoB,WAClB,OAAOD,EAAoB5xB,EAAUtK,EACvC,EAMA+rB,SAAU,SAAkBhrB,EAAK3C,GAE3BoY,EAAQqV,SAAS9qB,IAAMyV,EAAQqoB,YAAY99B,GAC/CmX,EAAOhN,IAAInK,EAAK3C,GAChBiT,EAAatQ,GAAO3C,EAAMmB,MAC1Bm+B,EAAkB38B,EAAK3C,EACzB,EAKAygC,YAAa,SAAqB99B,GAChC,IAAIsD,EAEJ6T,EAAOwG,OAAO3d,GACyB,QAAtCsD,EAAKg5B,EAAmB99B,IAAIwB,UAAyB,IAAPsD,GAAyBA,IACxEg5B,EAAmB3e,OAAO3d,UACnBsQ,EAAatQ,GACpBu7B,EAA2Bv7B,EAAK+V,EAClC,EAKA+U,SAAU,SAAkB9qB,GAC1B,OAAOmX,EAAOjN,IAAIlK,EACpB,EAMA+qB,SAAU,SAAkB/qB,EAAK+9B,GAC/B,IAAI1gC,EAAQ8Z,EAAO3Y,IAAIwB,GAOvB,YALc2E,IAAVtH,QAAwCsH,IAAjBo5B,IACzB1gC,EAAQ6sB,GAAY6T,GACpBtoB,EAAQuV,SAAShrB,EAAK3C,IAGjBA,CACT,EAKAqG,aAAc,SAAsBiY,GAClC,OAAOxE,EAAO/Y,QAAQud,EACxB,EAOAkQ,UAAW,SAAmB7rB,GAC5B,IAAIsD,EAEJ,OAAoC,QAA5BA,EAAKgN,EAAatQ,UAAyB,IAAPsD,EAAgBA,EAAKg4B,EAAsB/xB,EAAUvJ,EAAKuQ,EACxG,EAMAub,cAAe,SAAuB9rB,EAAK3C,GACzCm/B,EAAWx8B,GAAO3C,CACpB,EAMA2yB,cAAe,SAAuBhwB,GACpC,GAAIi7B,EAAgB,CAClB,IAAI/oB,EAAS+oB,EAAeh8B,EAAOe,GAEnC,QAAe2E,IAAXuN,IAAyBxG,GAAcwG,GAAS,OAAOA,CAC7D,CAEA,OAAOsqB,EAAWx8B,EACpB,GACC27B,GAAa,CAIdX,MAAO,WAEL,OADAyB,IACO1mB,CACT,EAKAlN,eAAgB,WACdhK,EAAuB,QAAEwH,OAAOA,GAAQ,GAAO,EACjD,EAQA0B,WAAY1B,EAMZD,SAAU,SAAkB43B,IACtBA,EAASxtB,mBAAqBvR,EAAMuR,oBACtCiF,EAAQ5M,iBAGV5J,EAAQ++B,EACRrC,EAAWK,oBAAoBgC,GAC/BzB,EA3fR,SAAqC9mB,EAASoL,EAAMC,GAClD,IAAIxd,EAEJ,IAAK,IAAItD,KAAO6gB,EAAM,CACpB,IAAIod,EAAYpd,EAAK7gB,GACjBk+B,EAAYpd,EAAK9gB,GAErB,GAAI0L,GAAcuyB,GAKhBxoB,EAAQuV,SAAShrB,EAAKi+B,QASjB,GAAIvyB,GAAcwyB,GAKvBzoB,EAAQuV,SAAShrB,EAAKkqB,GAAY+T,SAC7B,GAAIC,IAAcD,EAMvB,GAAIxoB,EAAQqV,SAAS9qB,GAAM,CACzB,IAAIm+B,EAAgB1oB,EAAQsV,SAAS/qB,IAEpCm+B,EAAclV,aAAekV,EAAch0B,IAAI8zB,EAClD,MACExoB,EAAQuV,SAAShrB,EAAKkqB,GAAmD,QAAtC5mB,EAAKmS,EAAQgoB,eAAez9B,UAAyB,IAAPsD,EAAgBA,EAAK26B,GAG5G,CAGA,IAAK,IAAIj+B,KAAO8gB,OACInc,IAAdkc,EAAK7gB,IAAoByV,EAAQqoB,YAAY99B,GAGnD,OAAO6gB,CACT,CA0c2Bud,CAA4B3oB,EAASW,EAA4BnX,GAAQs9B,EAC9F,EACA94B,SAAU,WACR,OAAOxE,CACT,EAMAssB,WAAY,SAAoBpsB,GAC9B,IAAImE,EAEJ,OAAiC,QAAzBA,EAAKrE,EAAMsE,gBAA6B,IAAPD,OAAgB,EAASA,EAAGnE,EACvE,EAKAqtB,qBAAsB,WACpB,OAAOvtB,EAAM0Y,UACf,EACAwf,sBAAuB,WACrB,OAAOl4B,EAAMyB,kBACf,EAKA+tB,kBAAmB,SAA2B4P,GAK5C,QAJsB,IAAlBA,IACFA,GAAgB,GAGdA,EAAe,OAAO72B,aAAuC,EAASA,EAAOinB,oBAEjF,IAAKpX,EAAuB,CAC1B,IAAIinB,GAAa92B,aAAuC,EAASA,EAAOinB,sBAAwB,CAAC,EAMjG,YAJsB9pB,IAAlB1F,EAAMiF,UACRo6B,EAAUp6B,QAAUjF,EAAMiF,SAGrBo6B,CACT,CAIA,IAFA,IAAI55B,EAAU,CAAC,EAENsE,EAAI,EAAGA,EAAIu1B,GAAiBv1B,IAAK,CACxC,IAAIC,EAASu1B,GAAax1B,GACtBhE,EAAO/F,EAAMgK,IAEbjG,EAAegC,KAAkB,IAATA,KAC1BN,EAAQuE,GAAUjE,EAEtB,CAEA,OAAON,CACT,IAGF,OAAO+Q,CACT,CACF,EAEI+oB,GAAelhC,EAAMgoB,cAAc,CAAC,WAAYhoB,EAAM6E,OAAOwrB,KAAuB,GAEpF4Q,GAAkBC,GAAah+B,OAEnC,SAASi+B,GAAcphC,GACrB,MAAwB,iBAAVA,GAAsBA,EAAM4O,WAAW,SACvD,CAYA,IAAIyyB,GAAmB,uDAevB,SAASC,GAAiBl9B,EAASgU,EAASunB,QAC5B,IAAVA,IACFA,EAAQ,GAGVx/B,EAAU0kB,UAAU8a,GAPP,EAO0B,yDAA0DprB,OAAOnQ,EAAS,yDAEjH,IAAI6B,EAAKhG,EAAM6E,OApBjB,SAA0BV,GACxB,IAAIm9B,EAAQF,GAAiBG,KAAKp9B,GAClC,IAAKm9B,EAAO,MAAO,CAAC,GAEpB,IAAIt7B,EAAKhG,EAAM6E,OAAOy8B,EAAO,GAI7B,MAAO,CAHKt7B,EAAG,GACAA,EAAG,GAGpB,CAWwBw7B,CAAiBr9B,GAAU,GAC7Cs9B,EAAQz7B,EAAG,GACXub,EAAWvb,EAAG,GAGlB,GAAKy7B,EAAL,CAEA,IAAItnB,EAAW7V,OAAOo9B,iBAAiBvpB,GAASwpB,iBAAiBF,GAEjE,OAAItnB,EACKA,EAAS5F,OACP4sB,GAAc5f,GAEhB8f,GAAiB9f,EAAUpJ,EAASunB,EAAQ,GAE5Cne,CAVS,CAYpB,CAoDA,IAqBIqgB,GArBAC,GAAiB,IAAI9zB,IAAI,CAAC,QAAS,SAAU,MAAO,OAAQ,QAAS,SAAU,IAAK,MAEpF+zB,GAAkB,SAAyBp/B,GAC7C,OAAOm/B,GAAej1B,IAAIlK,EAC5B,EAMIq/B,GAAsB,SAA6BhiC,EAAO0lB,GAG5D1lB,EAAM8M,IAAI4Y,GAAI,GACd1lB,EAAM8M,IAAI4Y,EACZ,EAEIuc,GAAgB,SAAuBz8B,GACzC,OAAOA,IAAMpF,EAAgB6O,QAAUzJ,IAAMpF,EAAgBkP,EAC/D,GAIA,SAAWuyB,GACTA,EAA4B,MAAI,QAChCA,EAA6B,OAAI,SACjCA,EAA2B,KAAI,OAC/BA,EAA4B,MAAI,QAChCA,EAA0B,IAAI,MAC9BA,EAA6B,OAAI,QAClC,CAPD,CAOGA,KAAyBA,GAAuB,CAAC,IAEpD,IAAIK,GAAmB,SAA0BC,EAAQC,GACvD,OAAOzZ,WAAWwZ,EAAOE,MAAM,MAAMD,GACvC,EAEIE,GAAyB,SAAgCC,EAAMC,GACjE,OAAO,SAAUC,EAAOx8B,GACtB,IAAI8I,EAAY9I,EAAG8I,UACnB,GAAkB,SAAdA,IAAyBA,EAAW,OAAO,EAC/C,IAAI2zB,EAAW3zB,EAAUwyB,MAAM,sBAE/B,GAAImB,EACF,OAAOR,GAAiBQ,EAAS,GAAIF,GAErC,IAAIL,EAASpzB,EAAUwyB,MAAM,oBAE7B,OAAIY,EACKD,GAAiBC,EAAO,GAAII,GAE5B,CAGb,CACF,EAEIjvB,GAAgB,IAAItF,IAAI,CAAC,IAAK,IAAK,MACnC20B,GAAgCl1B,EAAemZ,QAAO,SAAUjkB,GAClE,OAAQ2Q,GAAczG,IAAIlK,EAC5B,IAiBA,IAAIigC,GAAmB,CAErB3yB,MAAO,SAAehK,EAAIyD,GACxB,IAAI6E,EAAItI,EAAGsI,EACPwF,EAAKrK,EAAGoH,YACRA,OAAqB,IAAPiD,EAAgB,IAAMA,EACpCE,EAAKvK,EAAGkH,aACRA,OAAsB,IAAPqD,EAAgB,IAAMA,EACzC,OAAO1F,EAAE6mB,IAAM7mB,EAAE8mB,IAAM1M,WAAW7X,GAAe6X,WAAW/X,EAC9D,EACAT,OAAQ,SAAgBlK,EAAIyD,GAC1B,IAAI8E,EAAIvI,EAAGuI,EACPuF,EAAKrK,EAAGiH,WACRA,OAAoB,IAAPoD,EAAgB,IAAMA,EACnCE,EAAKvK,EAAGmH,cACRA,OAAuB,IAAPoD,EAAgB,IAAMA,EAC1C,OAAOzF,EAAE4mB,IAAM5mB,EAAE6mB,IAAM1M,WAAWhY,GAAcgY,WAAW9X,EAC7D,EACAP,IAAK,SAAamyB,EAAOx8B,GACvB,IAAIqK,EAAMrK,EAAGqK,IACb,OAAOqY,WAAWrY,EACpB,EACAG,KAAM,SAAcgyB,EAAOx8B,GACzB,IAAIwK,EAAOxK,EAAGwK,KACd,OAAOkY,WAAWlY,EACpB,EACAD,OAAQ,SAAgBvK,EAAIyD,GAC1B,IAAI8E,EAAIvI,EAAGuI,EACP8B,EAAM5G,EAAG4G,IACb,OAAOqY,WAAWrY,IAAQ9B,EAAE4mB,IAAM5mB,EAAE6mB,IACtC,EACA9kB,MAAO,SAAetK,EAAIyD,GACxB,IAAI6E,EAAItI,EAAGsI,EACPkC,EAAO/G,EAAG+G,KACd,OAAOkY,WAAWlY,IAASlC,EAAE6mB,IAAM7mB,EAAE8mB,IACvC,EAEA9mB,EAAG+zB,GAAuB,EAAG,IAC7B9zB,EAAG8zB,GAAuB,EAAG,KAmC3BO,GAAmC,SAA0Cj/B,EAAeiR,EAAQuB,EAAQiE,QAC/F,IAAXjE,IACFA,EAAS,CAAC,QAGU,IAAlBiE,IACFA,EAAgB,CAAC,GAGnBxF,EAAS5U,EAAM6J,SAAS,CAAC,EAAG+K,GAC5BwF,EAAgBpa,EAAM6J,SAAS,CAAC,EAAGuQ,GACnC,IAAIyoB,EAAuBjjC,OAAOiB,KAAK+T,GAAQ+R,OAAOmb,IAGlDgB,EAAyB,GACzBC,GAAsC,EACtCC,EAAuB,GAoE3B,GAnEAH,EAAqB/hC,SAAQ,SAAU4B,GACrC,IAAI3C,EAAQ4D,EAAc8pB,SAAS/qB,GACnC,GAAKiB,EAAc6pB,SAAS9qB,GAA5B,CACA,IAGIugC,EAHAhb,EAAO9R,EAAOzT,GACdwgC,EAAW/V,GAAuBlF,GAClCxC,EAAK7Q,EAAOlS,GAMhB,GAAIuW,GAAkBwM,GAAK,CACzB,IAAI0d,EAAe1d,EAAGviB,OAClBkgC,EAAsB,OAAV3d,EAAG,GAAc,EAAI,EACrCwC,EAAOxC,EAAG2d,GACVF,EAAW/V,GAAuBlF,GAElC,IAAK,IAAIvc,EAAI03B,EAAW13B,EAAIy3B,EAAcz3B,IACnCu3B,EAIH/iC,EAAU0kB,UAAUuI,GAAuB1H,EAAG/Z,MAAQu3B,EAAQ,2CAH9DA,EAAS9V,GAAuB1H,EAAG/Z,IACnCxL,EAAU0kB,UAAUqe,IAAWC,GAAYlB,GAAckB,IAAalB,GAAciB,GAAS,gEAKnG,MACEA,EAAS9V,GAAuB1H,GAGlC,GAAIyd,IAAaD,EAGf,GAAIjB,GAAckB,IAAalB,GAAciB,GAAS,CACpD,IAAI9+B,EAAUpE,EAAMmB,MAEG,iBAAZiD,GACTpE,EAAM8M,IAAI6b,WAAWvkB,IAGL,iBAAPshB,EACT7Q,EAAOlS,GAAOgmB,WAAWjD,GAChBjgB,MAAMC,QAAQggB,IAAOwd,IAAW9iC,EAAgBkP,KACzDuF,EAAOlS,GAAO+iB,EAAGgC,IAAIiB,YAEzB,MAAYwa,aAA2C,EAASA,EAASp0B,aAAem0B,aAAuC,EAASA,EAAOn0B,aAAwB,IAATmZ,GAAqB,IAAPxC,GAG7J,IAATwC,EACFloB,EAAM8M,IAAIo2B,EAAOn0B,UAAUmZ,IAE3BrT,EAAOlS,GAAOwgC,EAASp0B,UAAU2W,IAK9Bsd,IACHD,EAjKV,SAAyCn/B,GACvC,IAAI0/B,EAAoB,GAWxB,OAVAX,GAA8B5hC,SAAQ,SAAU4B,GAC9C,IAAI3C,EAAQ4D,EAAc8pB,SAAS/qB,QAErB2E,IAAVtH,IACFsjC,EAAkBz3B,KAAK,CAAClJ,EAAK3C,EAAMmB,QACnCnB,EAAM8M,IAAInK,EAAIiM,WAAW,SAAW,EAAI,GAE5C,IAEI00B,EAAkBngC,QAAQS,EAAc8G,aACrC44B,CACT,CAoJmCC,CAAgC3/B,GACzDo/B,GAAsC,GAGxCC,EAAqBp3B,KAAKlJ,GAC1B0X,EAAc1X,QAA8B2E,IAAvB+S,EAAc1X,GAAqB0X,EAAc1X,GAAOkS,EAAOlS,GACpFq/B,GAAoBhiC,EAAO0lB,GA5DS,CA+D1C,IAEIud,EAAqB9/B,OAAQ,CAC/B,IAAIqgC,EAAYP,EAAqB/1B,QAAQ,WAAa,EAAI3I,OAAOk/B,YAAc,KAC/EC,EAtHuB,SAAkC7uB,EAAQjR,EAAe+/B,GACtF,IAAIC,EAAahgC,EAAcm6B,qBAC3B3lB,EAAUxU,EAAcod,cACxB6iB,EAAuBlC,iBAAiBvpB,GACxC0rB,EAAUD,EAAqBC,QAC/B1tB,EAAS,CAAC,EAGE,SAAZ0tB,GACFlgC,EAAcy8B,eAAe,UAAWxrB,EAAOivB,SAAW,SAO5DH,EAAY5iC,SAAQ,SAAU4B,GAC5ByT,EAAOzT,GAAOigC,GAAiBjgC,GAAKihC,EAAYC,EAClD,IAEAjgC,EAAc8G,aACd,IAAIq5B,EAAangC,EAAcm6B,qBAQ/B,OAPA4F,EAAY5iC,SAAQ,SAAU4B,GAG5B,IAAI3C,EAAQ4D,EAAc8pB,SAAS/qB,GACnCq/B,GAAoBhiC,EAAOoW,EAAOzT,IAClCkS,EAAOlS,GAAOigC,GAAiBjgC,GAAKohC,EAAYF,EAClD,IACOhvB,CACT,CAwF0BmvB,CAAyBnvB,EAAQjR,EAAeq/B,GAkBtE,OAhBIF,EAAuB5/B,QACzB4/B,EAAuBhiC,SAAQ,SAAUkF,GACvC,IAAIyD,EAAKzJ,EAAM6E,OAAOmB,EAAI,GACtBtD,EAAM+G,EAAG,GACT1J,EAAQ0J,EAAG,GAEf9F,EAAc8pB,SAAS/qB,GAAKmK,IAAI9M,EAClC,IAIF4D,EAAc8G,aAEI,OAAd84B,GAAoBj/B,OAAO0/B,SAAS,CACtC3zB,IAAKkzB,IAEA,CACL3uB,OAAQ6uB,EACRrpB,cAAeA,EAEnB,CACE,MAAO,CACLxF,OAAQA,EACRwF,cAAeA,EAGrB,EAUA,SAAS6pB,GAAetgC,EAAeiR,EAAQuB,EAAQiE,GACrD,OA5QqB,SAA0BxF,GAC/C,OAAOhV,OAAOiB,KAAK+T,GAAQhT,KAAKkgC,GAClC,CA0QSoC,CAAiBtvB,GAAUguB,GAAiCj/B,EAAeiR,EAAQuB,EAAQiE,GAAiB,CACjHxF,OAAQA,EACRwF,cAAeA,EAEnB,CAOA,IAAI+pB,GAAkB,SAAyBxgC,EAAeiR,EAAQuB,EAAQiE,GAC5E,IAAID,EA1UN,SAA6BxW,EAAeqC,EAAIoU,GAC9C,IAAI3Q,EAEAmL,EAAS5U,EAAM8W,OAAO9Q,EAAI,IAE1BmS,EAAUxU,EAAcod,cAC5B,KAAM5I,aAAmBisB,SAAU,MAAO,CACxCxvB,OAAQA,EACRwF,cAAeA,GAiBjB,IAAK,IAAI1X,KAbL0X,IACFA,EAAgBpa,EAAM6J,SAAS,CAAC,EAAGuQ,IAIrCzW,EAAcyC,cAAa,SAAUrG,GACnC,IAAIoE,EAAUpE,EAAMmB,MACpB,GAAKigC,GAAch9B,GAAnB,CACA,IAAIgW,EAAWknB,GAAiBl9B,EAASgU,GACrCgC,GAAUpa,EAAM8M,IAAIsN,EAFW,CAGrC,IAGgBvF,EAAQ,CACtB,IAAIzQ,EAAUyQ,EAAOlS,GACrB,GAAKy+B,GAAch9B,GAAnB,CACA,IAAIgW,EAAWknB,GAAiBl9B,EAASgU,GACpCgC,IAELvF,EAAOlS,GAAOyX,EAIVC,IAA6C,QAA7B3Q,EAAK2Q,EAAc1X,UAAyB,IAAP+G,IAAqB2Q,EAAc1X,GAAOyB,IAR9D,CASvC,CAEA,MAAO,CACLyQ,OAAQA,EACRwF,cAAeA,EAEnB,CAgSiBiqB,CAAoB1gC,EAAeiR,EAAQwF,GAG1D,OAAO6pB,GAAetgC,EAFtBiR,EAASuF,EAASvF,OAE2BuB,EAD7CiE,EAAgBD,EAASC,cAE3B,EAMA,IAAIkqB,GAAa,CACf7G,SAAU,MACVO,sBAAuB,SAA+BuG,EAAY7hC,GAChE,GAAIsL,GAAgBtL,GAAM,CACxB,IAAI8hC,EAAc3d,GAAoBnkB,GACtC,OAAO8hC,GAAcA,EAAY5wB,SAAe,CAClD,CACE,IAXsBuE,EAWlBssB,GAXkBtsB,EAWiBosB,EAVpCjgC,OAAOo9B,iBAAiBvpB,IAW3B,OAAQzJ,GAAgBhM,GAAO+hC,EAAc9C,iBAAiBj/B,GAAO+hC,EAAc/hC,KAAS,CAEhG,EACAutB,iBAAkB,SAA0BviB,EAAGC,GAM7C,OAAsC,EAA/BD,EAAEg3B,wBAAwB/2B,GAAS,GAAK,CACjD,EACA+kB,cAAe,SAAuB/wB,EAAOe,GAC3C,IAAIsD,EAEJ,OAA8B,QAAtBA,EAAKrE,EAAMwR,aAA0B,IAAPnN,OAAgB,EAASA,EAAGtD,EACpE,EACAo7B,mBAAoB,SAA4B3lB,EAASnS,GAEvD,OAAO+xB,GAAqB5f,EADHnS,EAAG5C,mBAE9B,EASAuhC,eAAgB,SAAwBxsB,EAASosB,EAAY5iC,GAC3D,IAAIuR,EAAoBvR,EAAMuR,kBAC9BqxB,EAAWpxB,MAAMrE,UAAYoE,EAAoBA,EAAkB,CAAC,EAAG,IAAM,OAE7EiF,EAAQ5M,gBACV,EACAq5B,iBAAkB,SAA0B34B,EAAU44B,GACpD54B,EAASkH,MAAMrE,UAAY+1B,EAAa1xB,MAAMrE,SAChD,EACAmvB,2BAA4B,SAAoCv7B,EAAKsD,GACnE,IAAIoN,EAAOpN,EAAGoN,KACVD,EAAQnN,EAAGmN,aACRC,EAAK1Q,UACLyQ,EAAMzQ,EACf,EAMAkrB,qBAAsB,SAA8BzV,EAASnS,EAAIyD,EAAI20B,GACnE,IAAI/jB,EAAarU,EAAGqU,WAChBD,EAAgBpU,EAAGoU,cACnBxF,EAAS5U,EAAM8W,OAAO9Q,EAAI,CAAC,aAAc,kBAEzCgP,EAAkBvL,EAAGuL,qBAEP,IAAdopB,IACFA,GAAY,GAGd,IAAIjoB,EAASuY,GAAU9Z,EAAQyF,GAAc,CAAC,EAAGlC,GAWjD,GANInD,IACEoF,IAAeA,EAAgBpF,EAAgBoF,IAC/CxF,IAAQA,EAASI,EAAgBJ,IACjCuB,IAAQA,EAASnB,EAAgBmB,KAGnCioB,EAAW,CACbjQ,GAAwBhW,EAASvD,EAAQuB,GACzC,IAAI2uB,EAASX,GAAgBhsB,EAASvD,EAAQuB,EAAQiE,GACtDA,EAAgB0qB,EAAO1qB,cACvBxF,EAASkwB,EAAOlwB,MAClB,CAEA,OAAO5U,EAAM6J,SAAS,CACpBwQ,WAAYA,EACZD,cAAeA,GACdxF,EACL,EACAkE,4BAA6BF,GAC7B8kB,MAAO,SAAevlB,EAASM,EAAazF,EAAcC,EAAStR,QACvC0F,IAAtB8Q,EAAQwnB,YACVlnB,EAAYtF,MAAMmtB,WAAanoB,EAAQwnB,UAAY,UAAY,UAGjE7sB,GAAgB2F,EAAazF,EAAcC,EAAStR,EAAMuR,kBAC5D,EACAnK,OAAQmP,IAEN6sB,GAAoBphC,GAAc2gC,IAClCU,GAAmBrhC,GAAc3D,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGy6B,IAAa,CAClF5R,cAAe,SAAuB/wB,EAAOe,GAC3C,OAAOf,EAAMe,EACf,EACAs7B,sBAAuB,SAA+BuG,EAAY7hC,GAChE,IAAIsD,EAEJ,OAAIgI,GAAgBtL,IAC0B,QAAnCsD,EAAK6gB,GAAoBnkB,UAAyB,IAAPsD,OAAgB,EAASA,EAAG4N,UAAY,GAG9FlR,EAAO6V,GAAoB3L,IAAIlK,GAA0BA,EAAnBoV,GAAYpV,GAC3C6hC,EAAWU,aAAaviC,GACjC,EACAoW,4BAA6BA,GAC7B4kB,MAAO,SAAewH,EAAUzsB,EAAazF,EAAcC,EAAStR,GAClE6U,GAAciC,EAAazF,EAAcC,EAAStR,EAAMuR,kBAC1D,EACAnK,OAAQyP,MAGN2sB,GAAyB,SAAgCviC,EAAWqQ,GACtE,OAAOlG,EAAenK,GAAaoiC,GAAiB/xB,EAAS,CAC3Dc,4BAA4B,IACzBgxB,GAAkB9xB,EAAS,CAC9Bc,4BAA4B,GAEhC,EAEA,SAASqxB,GAAgBC,EAAQnQ,GAC/B,OAAIA,EAAKC,MAAQD,EAAKE,IAAY,EAC3BiQ,GAAUnQ,EAAKC,IAAMD,EAAKE,KAAO,GAC1C,CAUA,IAAIkQ,GAAsB,CACxBC,QAAS,SAAiBlJ,EAAQmJ,GAChC,IAAKA,EAAK5wB,OAAQ,OAAOynB,EAMzB,GAAsB,iBAAXA,EAAqB,CAC9B,IAAIl8B,EAAgBkP,GAAGnC,KAAKmvB,GAG1B,OAAOA,EAFPA,EAAS3T,WAAW2T,EAIxB,CAOA,IAAI/tB,EAAI82B,GAAgB/I,EAAQmJ,EAAK5wB,OAAOtG,GACxCC,EAAI62B,GAAgB/I,EAAQmJ,EAAK5wB,OAAOrG,GAC5C,MAAO,GAAG+F,OAAOhG,EAAG,MAAMgG,OAAO/F,EAAG,IACtC,GAEEk3B,GAAW,QACXC,GAAmB,CACrBH,QAAS,SAAiBlJ,EAAQr2B,GAChC,IAAI2/B,EAAY3/B,EAAG2/B,UACfC,EAAkB5/B,EAAG4/B,gBACrBC,EAAWxJ,EAKXyJ,EAAuBzJ,EAAOrvB,SAAS,QACvC+4B,EAAe,GAEfD,IACFzJ,EAASA,EAAOrkB,QAAQopB,IAAkB,SAAUE,GAElD,OADAyE,EAAan6B,KAAK01B,GACXmE,EACT,KAGF,IAAIO,EAAS7lC,EAAgBglB,QAAQ+H,MAAMmP,GAE3C,GAAI2J,EAAO9iC,OAAS,EAAG,OAAO2iC,EAC9B,IAAII,EAAW9lC,EAAgBglB,QAAQ+gB,kBAAkB7J,GACrDjmB,EAA8B,iBAAd4vB,EAAO,GAAkB,EAAI,EAE7CG,EAASP,EAAgBt3B,EAAEkD,MAAQm0B,EAAUr3B,EAC7C83B,EAASR,EAAgBr3B,EAAEiD,MAAQm0B,EAAUp3B,EACjDy3B,EAAO,EAAI5vB,IAAW+vB,EACtBH,EAAO,EAAI5vB,IAAWgwB,EAQtB,IAAIC,EAAejmC,EAAUiZ,IAAI8sB,EAAQC,EAAQ,IAEf,iBAAvBJ,EAAO,EAAI5vB,KAAsB4vB,EAAO,EAAI5vB,IAAWiwB,GAEhC,iBAAvBL,EAAO,EAAI5vB,KAAsB4vB,EAAO,EAAI5vB,IAAWiwB,GAClE,IAAIC,EAASL,EAASD,GAEtB,GAAIF,EAAsB,CACxB,IAAIS,EAAM,EACVD,EAASA,EAAOtuB,QAAQytB,IAAU,WAChC,IAAIe,EAAcT,EAAaQ,GAE/B,OADAA,IACOC,CACT,GACF,CAEA,OAAOF,CACT,GAGEG,GAEJ,SAAUn+B,GAGR,SAASm+B,IACP,OAAkB,OAAXn+B,GAAmBA,EAAOC,MAAMC,KAAMC,YAAcD,IAC7D,CA2HA,OA/HAxI,EAAM0I,UAAU+9B,EAA0Bn+B,GAY1Cm+B,EAAyBthC,UAAUuhC,kBAAoB,WACrD,IAAIpc,EAAQ9hB,KAERxC,EAAKwC,KAAK7G,MACVgC,EAAgBqC,EAAGrC,cACnBgjC,EAAc3gC,EAAG2gC,YACjBC,EAAoB5gC,EAAG4gC,kBACvBp9B,EAAWxD,EAAGwD,SACd2B,EAAaxH,EAAcwH,WAC/BiC,EAAkBy5B,IAEd17B,KACEw7B,aAAiD,EAASA,EAAYG,QAAOH,EAAYG,MAAM3nB,IAAIhU,IAElGy7B,aAA6D,EAASA,EAAkBvjB,WAAa7Z,GACxGo9B,EAAkBvjB,SAASlY,GAG7BA,EAAW0U,KAAKknB,YAChB57B,EAAW+P,iBAAiB,qBAAqB,WAC/CoP,EAAM0I,cACR,IACA7nB,EAAWE,WAAWrL,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGsB,EAAW8H,SAAU,CAC3EmQ,eAAgB,WACd,OAAOkH,EAAM0I,cACf,MAIJjrB,EAAsBE,gBAAiB,CACzC,EAEAw+B,EAAyBthC,UAAUwD,wBAA0B,SAAUq+B,GACrE,IAAI1c,EAAQ9hB,KAERxC,EAAKwC,KAAK7G,MACVslC,EAAmBjhC,EAAGihC,iBACtBtjC,EAAgBqC,EAAGrC,cACnBzB,EAAO8D,EAAG9D,KACVihB,EAAYnd,EAAGmd,UACfhY,EAAaxH,EAAcwH,WAC/B,OAAKA,GASLA,EAAWgY,UAAYA,EAEnBjhB,GAAQ8kC,EAAUC,mBAAqBA,QAAyC5/B,IAArB4/B,EAC7D97B,EAAW+7B,aAEX1+B,KAAKwqB,eAGHgU,EAAU7jB,YAAcA,IACtBA,EACFhY,EAAWg8B,UACDh8B,EAAWi8B,YAMrB7lC,EAAuB,QAAEiqB,YAAW,WAClC,IAAIxlB,GAEmC,QAAhCA,EAAKmF,EAAWk8B,kBAA+B,IAAPrhC,OAAgB,EAASA,EAAGshC,QAAQpkC,SACjFonB,EAAM0I,cAEV,KAIG,MApCiB,IAqC1B,EAEAyT,EAAyBthC,UAAU0D,mBAAqB,WACtD,IAAIsC,EAAa3C,KAAK7G,MAAMgC,cAAcwH,WAEtCA,IACFA,EAAW0U,KAAKknB,aAEX57B,EAAWo8B,kBAAoBp8B,EAAWq8B,UAC7Ch/B,KAAKwqB,eAGX,EAEAyT,EAAyBthC,UAAUsiC,qBAAuB,WACxD,IAAIzhC,EAAKwC,KAAK7G,MACVgC,EAAgBqC,EAAGrC,cACnBgjC,EAAc3gC,EAAG2gC,YACjBe,EAAiB1hC,EAAG4gC,kBACpBz7B,EAAaxH,EAAcwH,WAE3BA,IACFA,EAAWw8B,6BACPhB,aAAiD,EAASA,EAAYG,QAAOH,EAAYG,MAAMhH,OAAO30B,IACtGu8B,aAAuD,EAASA,EAAeE,aAAYF,EAAeE,WAAWz8B,GAE7H,EAEAs7B,EAAyBthC,UAAU6tB,aAAe,WAChD,IAAIA,EAAexqB,KAAK7G,MAAMqxB,aAC9BA,SAA4DA,GAC9D,EAEAyT,EAAyBthC,UAAU4D,OAAS,WAC1C,OAAO,IACT,EAEO09B,CACT,CAjIA,CAiIEnlC,EAAwB,QAAEsB,WAgB5B,IAAIikC,GAAyB,CAC3Bn3B,aAAc1P,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGy7B,IAAsB,CACpEuC,QAAS,CAAC,sBAAuB,uBAAwB,yBAA0B,6BAErFj4B,oBAAqB01B,GACrBz1B,qBAAsBy1B,GACtBv1B,uBAAwBu1B,GACxBx1B,wBAAyBw1B,GACzBwC,UAAWpC,IAETqC,GAAiB,CACnBhmC,cAzBF,SAAuBJ,GACrB,IAAIqE,EAAKhG,EAAM6E,OAAOqe,KAAe,GACjCC,EAAYnd,EAAG,GACfgtB,EAAehtB,EAAG,GAElB2gC,EAAc1mC,EAAMyD,WAAWyE,GACnC,OAAO7G,EAAwB,QAAEuK,cAAc46B,GAA0BzmC,EAAM6J,SAAS,CAAC,EAAGlI,EAAO,CACjGglC,YAAaA,EACbC,kBAAmB3mC,EAAMyD,WAAW0E,GACpC+a,UAAWA,EACX6P,aAAcA,IAElB,GA2CA,SAAStsB,GAAQuhB,EAAMxC,EAAIpL,QACN,IAAfA,IACFA,EAAa,CAAC,GAGhB,IAAIta,EAAQqO,GAAc6Z,GAAQA,EAAO2E,GAAY3E,GAErD,OADAa,GAAe,GAAI/oB,EAAO0lB,EAAIpL,GACvB,CACLmP,KAAM,WACJ,OAAOzpB,EAAMypB,MACf,EACAkD,YAAa,WACX,OAAO3sB,EAAM2sB,aACf,EAEJ,CAEA,IAAIsb,GAAU,CAAC,UAAW,WAAY,aAAc,eAChDC,GAAaD,GAAQ9kC,OAErBglC,GAAW,SAAkBnoC,GAC/B,MAAwB,iBAAVA,EAAqB2oB,WAAW3oB,GAASA,CACzD,EAEIooC,GAAO,SAAcpoC,GACvB,MAAwB,iBAAVA,GAAsBI,EAAgBkP,GAAGnC,KAAKnN,EAC9D,EA+CA,SAASqoC,GAAUvuB,EAAQwuB,GACzB,IAAIriC,EAEJ,OAAqC,QAA7BA,EAAK6T,EAAOwuB,UAAgC,IAAPriC,EAAgBA,EAAK6T,EAAOnK,YAC3E,CAyBA,IAAI44B,GAAkBC,GAAS,EAAG,GAAKnoC,EAAU+jB,SAC7CqkB,GAAmBD,GAAS,GAAK,IAAMnoC,EAAUyjB,QAErD,SAAS0kB,GAASnT,EAAKD,EAAKsT,GAC1B,OAAO,SAAUplC,GAEf,OAAIA,EAAI+xB,EAAY,EAChB/xB,EAAI8xB,EAAY,EACbsT,EAAOroC,EAAUk8B,SAASlH,EAAKD,EAAK9xB,GAC7C,CACF,CAQA,SAASqlC,GAAaxT,EAAMyT,GAC1BzT,EAAKE,IAAMuT,EAAWvT,IACtBF,EAAKC,IAAMwT,EAAWxT,GACxB,CAQA,SAASyT,GAAYvR,EAAKwR,GACxBH,GAAarR,EAAI/oB,EAAGu6B,EAAUv6B,GAC9Bo6B,GAAarR,EAAI9oB,EAAGs6B,EAAUt6B,EAChC,CAMA,SAASu6B,GAAiB7sB,EAAOwZ,EAAWjkB,EAAOgkB,EAAa0B,GAQ9D,OANAjb,EAAQ+a,GADR/a,GAASwZ,EACiB,EAAIjkB,EAAOgkB,QAEpBnuB,IAAb6vB,IACFjb,EAAQ+a,GAAW/a,EAAO,EAAIib,EAAU1B,IAGnCvZ,CACT,CA6CA,SAAS8sB,GAAqB7T,EAAMsC,EAAYxxB,EAAImQ,EAAQ6yB,GAC1D,IAAIv/B,EAAKzJ,EAAM6E,OAAOmB,EAAI,GACtBtD,EAAM+G,EAAG,GACTguB,EAAWhuB,EAAG,GACdiuB,EAAYjuB,EAAG,IA3CrB,SAAyByrB,EAAMO,EAAWjkB,EAAO2E,EAAQ+gB,EAAUyR,EAAYK,GA2B7E,QA1BkB,IAAdvT,IACFA,EAAY,QAGA,IAAVjkB,IACFA,EAAQ,QAGK,IAAX2E,IACFA,EAAS,SAGQ,IAAfwyB,IACFA,EAAazT,QAGI,IAAf8T,IACFA,EAAa9T,GAGX/0B,EAAgB4sB,QAAQ7f,KAAKuoB,KAC/BA,EAAY/M,WAAW+M,GAEvBA,EADuBr1B,EAAUiZ,IAAI2vB,EAAW5T,IAAK4T,EAAW7T,IAAKM,EAAY,KAClDuT,EAAW5T,KAGnB,iBAAdK,EAAX,CACA,IAAID,EAAcp1B,EAAUiZ,IAAIsvB,EAAWvT,IAAKuT,EAAWxT,IAAKhf,GAC5D+e,IAASyT,IAAYnT,GAAeC,GACxCP,EAAKE,IAAM0T,GAAiB5T,EAAKE,IAAKK,EAAWjkB,EAAOgkB,EAAa0B,GACrEhC,EAAKC,IAAM2T,GAAiB5T,EAAKC,IAAKM,EAAWjkB,EAAOgkB,EAAa0B,EAJ5B,CAK3C,CAaE+R,CAAgB/T,EAAMsC,EAAW90B,GAAM80B,EAAWC,GAAWD,EAAWE,GAAYF,EAAWhmB,MAAO2E,EAAQ6yB,EAChH,CAMA,IAAIE,GAAQ,CAAC,IAAK,SAAU,WACxBC,GAAQ,CAAC,IAAK,SAAU,WAM5B,SAASC,GAAoB/R,EAAKG,EAAYqR,EAAWQ,GACvDN,GAAqB1R,EAAI/oB,EAAGkpB,EAAY0R,GAAOL,aAA6C,EAASA,EAAUv6B,EAAG+6B,aAA6C,EAASA,EAAU/6B,GAClLy6B,GAAqB1R,EAAI9oB,EAAGipB,EAAY2R,GAAON,aAA6C,EAASA,EAAUt6B,EAAG86B,aAA6C,EAASA,EAAU96B,EACpL,CAEA,SAAS+6B,GAAgBhe,GACvB,OAA2B,IAApBA,EAAMmK,WAAmC,IAAhBnK,EAAM9Z,KACxC,CAEA,SAAS+3B,GAAYje,GACnB,OAAOge,GAAgBhe,EAAMhd,IAAMg7B,GAAgBhe,EAAM/c,EAC3D,CAEA,SAASi7B,GAAU97B,EAAGC,GACpB,OAAOD,EAAEY,EAAE8mB,MAAQznB,EAAEW,EAAE8mB,KAAO1nB,EAAEY,EAAE6mB,MAAQxnB,EAAEW,EAAE6mB,KAAOznB,EAAEa,EAAE6mB,MAAQznB,EAAEY,EAAE6mB,KAAO1nB,EAAEa,EAAE4mB,MAAQxnB,EAAEY,EAAE4mB,GAC9F,CAEA,IAAIsU,GAEJ,WACE,SAASA,IACPjhC,KAAK8+B,QAAU,EACjB,CA8HA,OA5HAmC,EAAUtkC,UAAUga,IAAM,SAAUqmB,GAClC1b,GAActhB,KAAK8+B,QAAS9B,GAC5BA,EAAKj6B,gBACP,EAEAk+B,EAAUtkC,UAAU26B,OAAS,SAAU0F,GAOrC,GANAvb,GAAWzhB,KAAK8+B,QAAS9B,GAErBA,IAASh9B,KAAKkhC,WAChBlhC,KAAKkhC,cAAWriC,GAGdm+B,IAASh9B,KAAKmhC,KAAM,CACtB,IAAID,EAAWlhC,KAAK8+B,QAAQ9+B,KAAK8+B,QAAQpkC,OAAS,GAE9CwmC,GACFlhC,KAAK2+B,QAAQuC,EAEjB,CACF,EAEAD,EAAUtkC,UAAUiiC,SAAW,SAAU5B,GACvC,IAQIkE,EARAE,EAAcphC,KAAK8+B,QAAQuC,WAAU,SAAUC,GACjD,OAAOtE,IAASsE,CAClB,IACA,GAAoB,IAAhBF,EAAmB,OAAO,EAO9B,IAAK,IAAIl+B,EAAIk+B,EAAal+B,GAAK,EAAGA,IAAK,CACrC,IAAIo+B,EAASthC,KAAK8+B,QAAQ57B,GAE1B,IAAyB,IAArBo+B,EAAO3mB,UAAqB,CAC9BumB,EAAWI,EACX,KACF,CACF,CAEA,QAAIJ,IACFlhC,KAAK2+B,QAAQuC,IACN,EAIX,EAEAD,EAAUtkC,UAAUgiC,QAAU,SAAU3B,EAAMuE,GAC5C,IAAI/jC,EAEA0jC,EAAWlhC,KAAKmhC,KAChBnE,IAASkE,IACblhC,KAAKkhC,SAAWA,EAChBlhC,KAAKmhC,KAAOnE,EACZA,EAAKwE,OAEDN,IACFA,EAASz9B,UAAYy9B,EAASn+B,iBAC9Bi6B,EAAKj6B,iBACLi6B,EAAKyE,WAAaP,EAEdK,IACFvE,EAAKyE,WAAWC,iBAAkB,GAGhCR,EAASS,WACX3E,EAAK2E,SAAWT,EAASS,SACzB3E,EAAK2E,SAASn3B,aAAe02B,EAASU,iBAAmBV,EAAS12B,aAClEwyB,EAAK2E,SAASE,UAAW,IAGF,QAApBrkC,EAAKw/B,EAAK3lB,YAAyB,IAAP7Z,OAAgB,EAASA,EAAGskC,cAC3D9E,EAAK+E,eAAgB,IAKL,IAFF/E,EAAKvyB,QAAQu3B,WAG3Bd,EAASe,QAgBf,EAEAhB,EAAUtkC,UAAUulC,sBAAwB,WAC1CliC,KAAK8+B,QAAQxmC,SAAQ,SAAU0kC,GAC7B,IAAIx/B,EAAIyD,EAAIqK,EAAIE,EAAI4b,EAE0B,QAA7CnmB,GAAMzD,EAAKw/B,EAAKvyB,SAASmQ,sBAAmC,IAAP3Z,GAAyBA,EAAGpE,KAAKW,GACmB,QAAzG4pB,EAAkC,QAA5B9b,EAAK0xB,EAAKmF,oBAAiC,IAAP72B,OAAgB,GAAUE,EAAKF,EAAGb,SAASmQ,sBAAmC,IAAPwM,GAAyBA,EAAGvqB,KAAK2O,EACrJ,GACF,EAEAy1B,EAAUtkC,UAAUoG,eAAiB,WACnC/C,KAAK8+B,QAAQxmC,SAAQ,SAAU0kC,GAC7BA,EAAKv5B,UAAYu5B,EAAKj6B,gBAAe,EACvC,GACF,EAOAk+B,EAAUtkC,UAAUylC,mBAAqB,WACnCpiC,KAAKmhC,MAAQnhC,KAAKmhC,KAAKQ,WACzB3hC,KAAKmhC,KAAKQ,cAAW9iC,EAEzB,EAEOoiC,CACT,CAlIA,GAsIA,SAASoB,GAAyBvf,EAAOqa,EAAWmF,GAOlD,IAAIC,EAAazf,EAAMhd,EAAEmnB,UAAYkQ,EAAUr3B,EAC3C08B,EAAa1f,EAAM/c,EAAEknB,UAAYkQ,EAAUp3B,EAC3CO,EAAY,eAAewF,OAAOy2B,EAAY,QAAQz2B,OAAO02B,EAAY,WAQ7E,GAFAl8B,GAAa,SAASwF,OAAO,EAAIqxB,EAAUr3B,EAAG,MAAMgG,OAAO,EAAIqxB,EAAUp3B,EAAG,MAExEu8B,EAAiB,CACnB,IAAI35B,EAAS25B,EAAgB35B,OACzBE,EAAUy5B,EAAgBz5B,QAC1BC,EAAUw5B,EAAgBx5B,QAC1BH,IAAQrC,GAAa,UAAUwF,OAAOnD,EAAQ,UAC9CE,IAASvC,GAAa,WAAWwF,OAAOjD,EAAS,UACjDC,IAASxC,GAAa,WAAWwF,OAAOhD,EAAS,SACvD,CAOA,IAAI25B,EAAgB3f,EAAMhd,EAAEkD,MAAQm0B,EAAUr3B,EAC1C48B,EAAgB5f,EAAM/c,EAAEiD,MAAQm0B,EAAUp3B,EAE9C,MApCuB,sDAmCvBO,GAAa,SAASwF,OAAO22B,EAAe,MAAM32B,OAAO42B,EAAe,MAC9B,OAASp8B,CACrD,CAEA,IAAIq8B,GAAiB,SAAwBz9B,EAAGC,GAC9C,OAAOD,EAAEgyB,MAAQ/xB,EAAE+xB,KACrB,EAEI0L,GAEJ,WACE,SAASA,IACP5iC,KAAKQ,SAAW,GAChBR,KAAK6iC,SAAU,CACjB,CAkBA,OAhBAD,EAASjmC,UAAUga,IAAM,SAAUT,GACjCoL,GAActhB,KAAKQ,SAAU0V,GAC7BlW,KAAK6iC,SAAU,CACjB,EAEAD,EAASjmC,UAAU26B,OAAS,SAAUphB,GACpCuL,GAAWzhB,KAAKQ,SAAU0V,GAC1BlW,KAAK6iC,SAAU,CACjB,EAEAD,EAASjmC,UAAUrE,QAAU,SAAUud,GACrC7V,KAAK6iC,SAAW7iC,KAAKQ,SAASmL,KAAKg3B,IACnC3iC,KAAK6iC,SAAU,EACf7iC,KAAKQ,SAASlI,QAAQud,EACxB,EAEO+sB,CACT,CAvBA,GAgCA,SAASE,GAAqBtlC,GAC5B,IAAIulC,EAAuBvlC,EAAGulC,qBAC1BC,EAAgBxlC,EAAGwlC,cACnBC,EAAgBzlC,EAAGylC,cACnBC,EAAoB1lC,EAAG0lC,kBACvB/G,EAAiB3+B,EAAG2+B,eACxB,OAEE,WACE,SAASgH,EAAehiC,EAAIqJ,EAAc9I,QACnB,IAAjB8I,IACFA,EAAe,CAAC,QAGH,IAAX9I,IACFA,EAASshC,aAAqD,EAASA,KAGzE,IAAIlhB,EAAQ9hB,KASZA,KAAKQ,SAAW,IAAI+E,IAMpBvF,KAAKyK,QAAU,CAAC,EAOhBzK,KAAKojC,iBAAkB,EACvBpjC,KAAKywB,oBAAqB,EAQ1BzwB,KAAK+hC,eAAgB,EAKrB/hC,KAAKqjC,uBAAwB,EAC7BrjC,KAAKsjC,uBAAwB,EAM7BtjC,KAAK8hC,YAAa,EAKlB9hC,KAAKujC,OAAQ,EAMbvjC,KAAKwjC,YAAa,EAKlBxjC,KAAKyjC,sBAAuB,EAU5BzjC,KAAKm9B,UAAY,CACfr3B,EAAG,EACHC,EAAG,GAML/F,KAAK0jC,cAAgB,IAAIx/B,IAEzBlE,KAAK2jC,eAAiB,IAAIz/B,IAE1BlE,KAAK4jC,kBAAoB,WACnB9hB,EAAMggB,aACRhgB,EAAMggB,YAAa,EAEnBhgB,EAAM+hB,oBAEV,EAEA7jC,KAAK8jC,iBAAmB,WACtBhiB,EAAMiiB,MAAMzrC,QAAQ0rC,IAEpBliB,EAAMiiB,MAAMzrC,QAAQ2rC,GACtB,EAEAjkC,KAAKkkC,cAAe,EACpBlkC,KAAKm3B,WAAY,EACjBn3B,KAAKmkC,kBAAoB,EAMzBnkC,KAAKokC,YAAc,IAAIlgC,IACvBlE,KAAKmB,GAAKA,EACVnB,KAAKwK,aAAeA,EACpBxK,KAAKqX,KAAO3V,EAASA,EAAO2V,MAAQ3V,EAAS1B,KAC7CA,KAAKqkC,KAAO3iC,EAASlK,EAAMgoB,cAAchoB,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOqF,EAAO2iC,OAAO,GAAQ,CAAC3iC,IAAS,GAAS,GACvH1B,KAAK0B,OAASA,EACd1B,KAAKk3B,MAAQx1B,EAASA,EAAOw1B,MAAQ,EAAI,EACzC/1B,GAAMnB,KAAKqX,KAAKitB,sBAAsBnjC,EAAInB,MAE1C,IAAK,IAAIkD,EAAI,EAAGA,EAAIlD,KAAKqkC,KAAK3pC,OAAQwI,IACpClD,KAAKqkC,KAAKnhC,GAAGugC,sBAAuB,EAGlCzjC,KAAKqX,OAASrX,OAAMA,KAAK+jC,MAAQ,IAAInB,GAC3C,CA0kCA,OAxkCAO,EAAexmC,UAAU+V,iBAAmB,SAAUrZ,EAAMmZ,GAK1D,OAJKxS,KAAK0jC,cAAct/B,IAAI/K,IAC1B2G,KAAK0jC,cAAcr/B,IAAIhL,EAAM,IAAIuoB,IAG5B5hB,KAAK0jC,cAAchrC,IAAIW,GAAMsd,IAAInE,EAC1C,EAEA2wB,EAAexmC,UAAU4nC,gBAAkB,SAAUlrC,GAGnD,IAFA,IAAIg9B,EAAO,GAEFC,EAAK,EAAGA,EAAKr2B,UAAUvF,OAAQ47B,IACtCD,EAAKC,EAAK,GAAKr2B,UAAUq2B,GAG3B,IAAIkO,EAAsBxkC,KAAK0jC,cAAchrC,IAAIW,GACjDmrC,SAA0EA,EAAoBziB,OAAOhiB,MAAMykC,EAAqBhtC,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOg6B,IAAO,GAC9K,EAEA8M,EAAexmC,UAAU8nC,aAAe,SAAUprC,GAChD,OAAO2G,KAAK0jC,cAAct/B,IAAI/K,EAChC,EAEA8pC,EAAexmC,UAAU2nC,sBAAwB,SAAUnjC,EAAI67B,GAC7Dh9B,KAAK2jC,eAAet/B,IAAIlD,EAAI67B,EAC9B,EAMAmG,EAAexmC,UAAU+G,MAAQ,SAAUD,EAAUs+B,GACnD,IAEIvkC,EAFAskB,EAAQ9hB,KAQZ,QAJsB,IAAlB+hC,IACFA,GAAgB,IAGd/hC,KAAKyD,SAAT,CACAzD,KAAKujC,MAAQ9/B,aAAoBihC,YAAmC,QAArBjhC,EAASkhC,QACxD3kC,KAAKyD,SAAWA,EAChB,IAAIxC,EAAKjB,KAAKyK,QACVzJ,EAAWC,EAAGD,SACduB,EAAStB,EAAGsB,OACZpH,EAAgB8F,EAAG9F,cAcvB,GAZIA,IAAkBA,EAAcod,eAClCpd,EAAcuI,MAAMD,GAGtBzD,KAAKqX,KAAK0sB,MAAMptB,IAAI3W,MACG,QAAtBxC,EAAKwC,KAAK0B,cAA2B,IAAPlE,GAAyBA,EAAGgD,SAASmW,IAAI3W,MACxEA,KAAKmB,IAAMnB,KAAKqX,KAAKssB,eAAe9rB,OAAO7X,KAAKmB,IAE5C4gC,IAAkBx/B,GAAUvB,KAC9BhB,KAAK+hC,eAAgB,GAGnBgB,EAAsB,CACxB,IAAI6B,EAEAC,EAAwB,WAC1B,OAAO/iB,EAAMzK,KAAKisB,uBAAwB,CAC5C,EAEAP,EAAqBt/B,GAAU,WAC7Bqe,EAAMzK,KAAKisB,uBAAwB,EACnCliB,aAAawjB,GACbA,EAAmB9oC,OAAOqlB,WAAW0jB,EAAuB,KAExDtlC,EAAsBC,yBACxBD,EAAsBC,wBAAyB,EAE/CsiB,EAAMiiB,MAAMzrC,QAAQwsC,IAExB,GACF,CAEI9jC,GACFhB,KAAKqX,KAAK0tB,mBAAmB/jC,EAAUhB,OAIZ,IAAzBA,KAAKyK,QAAQvM,SAAqB/C,IAAkB6F,GAAYuB,IAClEvC,KAAK0S,iBAAiB,aAAa,SAAUlV,GAC3C,IAAIyD,EAAIqK,EAAIE,EAAI4b,EAAIC,EAEhBvE,EAAQtlB,EAAGslB,MACX0R,EAAmBh3B,EAAGg3B,iBACtBwQ,EAA2BxnC,EAAGwnC,yBAC9BC,EAAYznC,EAAG+E,OAEnB,GAAIuf,EAAMojB,yBAGR,OAFApjB,EAAM1V,YAASvN,OACfijB,EAAMqjB,oBAAiBtmC,GAKzB,IAAIumC,EAAoI,QAAhH95B,EAAyC,QAAnCrK,EAAK6gB,EAAMrX,QAAQoH,kBAA+B,IAAP5Q,EAAgBA,EAAK9F,EAAcurB,8BAA2C,IAAPpb,EAAgBA,EAAK+5B,GAEjKC,EAAKnqC,EAAcwC,WACnB4nC,EAAyBD,EAAGC,uBAC5BC,EAA4BF,EAAGE,0BAO/BC,GAAiB3jB,EAAM4jB,eAAiB1E,GAAUlf,EAAM4jB,aAAcT,IAAcD,EAOpFW,GAAgCnR,GAAoBwQ,EAExD,IAAiC,QAA3Bx5B,EAAKsW,EAAM2f,kBAA+B,IAAPj2B,OAAgB,EAASA,EAAG/H,WAAakiC,GAAgCnR,IAAqBiR,IAAkB3jB,EAAMid,kBAAmB,CAC5Kjd,EAAM2f,aACR3f,EAAMqgB,aAAergB,EAAM2f,WAC3B3f,EAAMqgB,aAAaA,kBAAetjC,GAGpCijB,EAAM8jB,mBAAmB9iB,EAAO6iB,GAEhC,IAAIE,EAAmBruC,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGgf,GAAmB+kB,EAAkB,WAAY,CACxGU,OAAQP,EACRhlB,WAAYilB,IAGVrqC,EAAcyG,qBAChBikC,EAAiBjmB,MAAQ,EACzBimB,EAAiBx/B,MAAO,GAG1Byb,EAAMxB,eAAeulB,EACvB,MAMOrR,GAAgD,IAA5B1S,EAAMqiB,mBAC7BriB,EAAMgjB,kBAGRhjB,EAAMkd,WAA4D,QAA9C3X,GAAMD,EAAKtF,EAAMrX,SAASmQ,sBAAmC,IAAPyM,GAAyBA,EAAGxqB,KAAKuqB,IAG7GtF,EAAM4jB,aAAeT,CACvB,GAlHuB,CAoH3B,EAEA9B,EAAexmC,UAAUgH,QAAU,WACjC,IAAInG,EAAIyD,EAERjB,KAAKyK,QAAQzJ,UAAYhB,KAAK0+B,aAC9B1+B,KAAKqX,KAAK0sB,MAAMzM,OAAOt3B,MACI,QAA1BxC,EAAKwC,KAAK6+B,kBAA+B,IAAPrhC,GAAyBA,EAAG85B,OAAOt3B,MAC/C,QAAtBiB,EAAKjB,KAAK0B,cAA2B,IAAPT,GAAyBA,EAAGT,SAASqX,OAAO7X,MAC3EA,KAAKyD,cAAW5E,EAChBhH,EAAKq0B,WAAW6Z,UAAU/lC,KAAK8jC,iBACjC,EAGAX,EAAexmC,UAAUqpC,YAAc,WACrChmC,KAAKqjC,uBAAwB,CAC/B,EAEAF,EAAexmC,UAAUspC,cAAgB,WACvCjmC,KAAKqjC,uBAAwB,CAC/B,EAEAF,EAAexmC,UAAUupC,gBAAkB,WACzC,OAAOlmC,KAAKqjC,uBAAyBrjC,KAAKsjC,qBAC5C,EAEAH,EAAexmC,UAAUuoC,uBAAyB,WAChD,IAAI1nC,EAEJ,OAAOwC,KAAKywB,qBAA8C,QAAtBjzB,EAAKwC,KAAK0B,cAA2B,IAAPlE,OAAgB,EAASA,EAAG0nC,4BAA6B,CAC7H,EAGA/B,EAAexmC,UAAUwpC,YAAc,WACrC,IAAI3oC,EAEAwC,KAAKkmC,oBACTlmC,KAAK8hC,YAAa,EACI,QAArBtkC,EAAKwC,KAAK+jC,aAA0B,IAAPvmC,GAAyBA,EAAGlF,QAAQ8tC,IACpE,EAEAjD,EAAexmC,UAAU+hC,WAAa,SAAU2H,GAC9C,IAAI7oC,EAAIyD,EAAIqK,EAMZ,QAJ8B,IAA1B+6B,IACFA,GAAwB,GAGtBrmC,KAAKqX,KAAK6uB,kBACkC,QAA7CjlC,GAAMzD,EAAKwC,KAAKyK,SAASmQ,sBAAmC,IAAP3Z,GAAyBA,EAAGpE,KAAKW,QAKzF,IADCwC,KAAKqX,KAAKyqB,YAAc9hC,KAAKqX,KAAK8uB,eAC/BnmC,KAAK+hC,cAAT,CACA/hC,KAAK+hC,eAAgB,EAErB,IAAK,IAAI7+B,EAAI,EAAGA,EAAIlD,KAAKqkC,KAAK3pC,OAAQwI,IAAK,CACzC,IAAI85B,EAAOh9B,KAAKqkC,KAAKnhC,GACrB85B,EAAKyG,sBAAuB,EAM5BzG,EAAKhJ,cACP,CAEA,IAAIxoB,EAAKxL,KAAKyK,QACVzJ,EAAWwK,EAAGxK,SACduB,EAASiJ,EAAGjJ,OAChB,QAAiB1D,IAAbmC,GAA2BuB,EAA/B,CACA,IAAImI,EAA0D,QAArCY,EAAKtL,KAAKyK,QAAQtP,qBAAkC,IAAPmQ,OAAgB,EAASA,EAAG3N,WAAW+M,kBAC7G1K,KAAKsmC,2BAA6B57B,aAA6D,EAASA,EAAkB1K,KAAKwK,aAAc,IAC7IxK,KAAKumC,iBACLF,GAAyBrmC,KAAKukC,gBAAgB,aAJD,CAjBf,CAsBhC,EAGApB,EAAexmC,UAAU4hC,UAAY,WAKnC,GAJuBv+B,KAAKkmC,kBAQ1B,OAHAlmC,KAAKimC,gBACLjmC,KAAK6jC,yBACL7jC,KAAK+jC,MAAMzrC,QAAQkuC,IAIhBxmC,KAAK8hC,aACV9hC,KAAK8hC,YAAa,EAQd9hC,KAAK2jC,eAAe/7B,OACtB5H,KAAK2jC,eAAerrC,QAAQmuC,IAC5BzmC,KAAK2jC,eAAexhB,SAOtBniB,KAAK+jC,MAAMzrC,QAAQouC,IAMnB1mC,KAAK+jC,MAAMzrC,QAAQ27B,IAMnBj0B,KAAK+jC,MAAMzrC,QAAQquC,IACnB3mC,KAAK6jC,oBAELhsC,EAAK+uC,UAAUnb,SACf5zB,EAAK+uC,UAAUb,YACfluC,EAAK+uC,UAAUrmC,SACjB,EAEA4iC,EAAexmC,UAAUknC,kBAAoB,WAC3C7jC,KAAK+jC,MAAMzrC,QAAQuuC,IACnB7mC,KAAKokC,YAAY9rC,QAAQwuC,GAC3B,EAEA3D,EAAexmC,UAAUoqC,yBAA2B,WAClDhuC,EAAuB,QAAEgtC,UAAU/lC,KAAK8jC,kBAAkB,GAAO,EACnE,EAEAX,EAAexmC,UAAUwiC,0BAA4B,WACnD,IAAIrd,EAAQ9hB,KAQZjH,EAAuB,QAAEiqB,YAAW,WAC9BlB,EAAMigB,cACRjgB,EAAMzK,KAAKknB,YAEXzc,EAAMzK,KAAKusB,mBAEf,GACF,EAMAT,EAAexmC,UAAU4pC,eAAiB,WACxC,IAAIvmC,KAAK2hC,UAAa3hC,KAAKyD,SAA3B,CACA,IAAIujC,EAAWhnC,KAAKinC,UAChB1kC,EAASvC,KAAKknC,gBAAgBlnC,KAAKmnC,oBAAoBH,IAC3DI,GAAS7kC,GACTvC,KAAK2hC,SAAW,CACdqF,SAAUA,EACVzkC,OAAQA,EACRiI,aAAc,CAAC,EAP0B,CAS7C,EAEA24B,EAAexmC,UAAUs3B,aAAe,WACtC,IAAIz2B,EAEJ,GAAKwC,KAAKyD,WAEVzD,KAAKg0B,eAECh0B,KAAKyK,QAAQ3H,qBAAuB9C,KAAKg/B,UAAch/B,KAAK+hC,eAAlE,CAYA,GAAI/hC,KAAKyhC,aAAezhC,KAAKyhC,WAAWh+B,SACtC,IAAK,IAAIP,EAAI,EAAGA,EAAIlD,KAAKqkC,KAAK3pC,OAAQwI,IAAK,CAC9BlD,KAAKqkC,KAAKnhC,GAChB8wB,cACP,CAGF,IAAIgT,EAAWhnC,KAAKinC,UACpBG,GAASJ,GACT,IAAIK,EAAarnC,KAAKuC,OACtBvC,KAAKuC,OAAS,CACZykC,SAAUA,EACVpW,OAAQ5wB,KAAKmnC,oBAAoBH,IAEnChnC,KAAKsnC,gBA5sGJ,CACLxhC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAktGD3sB,KAAK+hC,eAAgB,EACrB/hC,KAAKo9B,qBAAkBv+B,EACvBmB,KAAKukC,gBAAgB,UAAWvkC,KAAKuC,OAAOquB,QACN,QAArCpzB,EAAKwC,KAAKyK,QAAQtP,qBAAkC,IAAPqC,GAAyBA,EAAG+pC,oBAAoBvnC,KAAKuC,OAAOquB,OAAQyW,aAA+C,EAASA,EAAWzW,OA5BrL,CA6BF,EAEAuS,EAAexmC,UAAUq3B,aAAe,WAClCh0B,KAAKyK,QAAQhI,cAAgBzC,KAAKyD,WACpCzD,KAAKwnC,aAAetE,EAAkBljC,KAAKyD,UAC3CzD,KAAKuyB,OAAS0Q,EAAcjjC,KAAKyD,UAErC,EAEA0/B,EAAexmC,UAAUw/B,eAAiB,WACxC,IAAI3+B,EAEJ,GAAK2+B,EAAL,CACA,IAAIsL,EAAmBznC,KAAK+hC,eAAiB/hC,KAAKyjC,qBAC9CiE,EAAgB1nC,KAAKo9B,kBAAoB2D,GAAY/gC,KAAKo9B,iBAC1D1yB,EAA0D,QAArClN,EAAKwC,KAAKyK,QAAQtP,qBAAkC,IAAPqC,OAAgB,EAASA,EAAGG,WAAW+M,kBACzGi9B,EAAyBj9B,aAA6D,EAASA,EAAkB1K,KAAKwK,aAAc,IACpIo9B,EAA8BD,IAA2B3nC,KAAKsmC,2BAE9DmB,IAAqBC,GAAiB38B,GAAa/K,KAAKwK,eAAiBo9B,KAC3EzL,EAAen8B,KAAKyD,SAAUkkC,GAC9B3nC,KAAKyjC,sBAAuB,EAC5BzjC,KAAK+C,iBAVoB,CAY7B,EAEAogC,EAAexmC,UAAUsqC,QAAU,WACjC,IAAI9rC,EAAgB6E,KAAKyK,QAAQtP,cACjC,IAAKA,EAAe,MA7uGnB,CACL2K,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAmvGD,IAAIkC,EAAM1zB,EAAcm6B,qBAEpB/C,EAASvyB,KAAKqX,KAAKkb,OAOvB,OALIA,IACFzD,GAAcD,EAAI/oB,EAAGysB,EAAOzsB,GAC5BgpB,GAAcD,EAAI9oB,EAAGwsB,EAAOxsB,IAGvB8oB,CACT,EAEAsU,EAAexmC,UAAUwqC,oBAAsB,SAAUtY,GACvD,IAAIgZ,EA3vGH,CACL/hC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAiwGDyT,GAAYyH,EAAkBhZ,GAM9B,IAAK,IAAI3rB,EAAI,EAAGA,EAAIlD,KAAKqkC,KAAK3pC,OAAQwI,IAAK,CACzC,IAAI85B,EAAOh9B,KAAKqkC,KAAKnhC,GACjB4kC,EAAW9K,EAAKzK,OAChB9nB,EAAUuyB,EAAKvyB,QACf+8B,EAAexK,EAAKwK,aAExB,GAAIxK,IAASh9B,KAAKqX,MAAQywB,GAAYr9B,EAAQhI,aAAc,CAK1D,GAAI+kC,EAAc,CAChBpH,GAAYyH,EAAkBhZ,GAC9B,IAAIkZ,EAAa/nC,KAAKqX,KAAKkb,OAMvBwV,IACFjZ,GAAc+Y,EAAiB/hC,GAAIiiC,EAAWjiC,GAC9CgpB,GAAc+Y,EAAiB9hC,GAAIgiC,EAAWhiC,GAElD,CAEA+oB,GAAc+Y,EAAiB/hC,EAAGgiC,EAAShiC,GAC3CgpB,GAAc+Y,EAAiB9hC,EAAG+hC,EAAS/hC,EAC7C,CACF,CAEA,OAAO8hC,CACT,EAEA1E,EAAexmC,UAAUqrC,eAAiB,SAAUnZ,EAAKoZ,QACjC,IAAlBA,IACFA,GAAgB,GAGlB,IAAIC,EAxyGH,CACLpiC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IA8yGDyT,GAAY8H,EAAgBrZ,GAE5B,IAAK,IAAI3rB,EAAI,EAAGA,EAAIlD,KAAKqkC,KAAK3pC,OAAQwI,IAAK,CACzC,IAAI85B,EAAOh9B,KAAKqkC,KAAKnhC,IAEhB+kC,GAAiBjL,EAAKvyB,QAAQhI,cAAgBu6B,EAAKzK,QAAUyK,IAASA,EAAK3lB,MAC9EiY,GAAa4Y,EAAgB,CAC3BpiC,GAAIk3B,EAAKzK,OAAOzsB,EAChBC,GAAIi3B,EAAKzK,OAAOxsB,IAIfgF,GAAaiyB,EAAKxyB,eACvB8kB,GAAa4Y,EAAgBlL,EAAKxyB,aACpC,CAMA,OAJIO,GAAa/K,KAAKwK,eACpB8kB,GAAa4Y,EAAgBloC,KAAKwK,cAG7B09B,CACT,EAEA/E,EAAexmC,UAAUuqC,gBAAkB,SAAUrY,GACnD,IAAIrxB,EAEA2qC,EAn0GH,CACLriC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAy0GDyT,GAAY+H,EAAqBtZ,GAEjC,IAAK,IAAI3rB,EAAI,EAAGA,EAAIlD,KAAKqkC,KAAK3pC,OAAQwI,IAAK,CACzC,IAAI85B,EAAOh9B,KAAKqkC,KAAKnhC,GACrB,GAAK85B,EAAKv5B,UACLsH,GAAaiyB,EAAKxyB,cAAvB,CACA8jB,GAAS0O,EAAKxyB,eAAiBwyB,EAAKuJ,iBACpC,IAAI1F,EA30GL,CACL/6B,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAk1GCyT,GAAYS,EADE7D,EAAKiK,WAEnBrG,GAAoBuH,EAAqBnL,EAAKxyB,aAAuC,QAAxBhN,EAAKw/B,EAAK2E,gBAA6B,IAAPnkC,OAAgB,EAASA,EAAG+E,OAAQs+B,EALnF,CAMhD,CAMA,OAJI91B,GAAa/K,KAAKwK,eACpBo2B,GAAoBuH,EAAqBnoC,KAAKwK,cAGzC29B,CACT,EAMAhF,EAAexmC,UAAUyrC,eAAiB,SAAUtlB,GAClD9iB,KAAKqoC,YAAcvlB,EACnB9iB,KAAKqX,KAAK0vB,0BACZ,EAEA5D,EAAexmC,UAAUkG,WAAa,SAAU4H,GAC9C,IAAIjN,EAEJwC,KAAKyK,QAAUjT,EAAM6J,SAAS7J,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGrB,KAAKyK,SAAUA,GAAU,CACvFu3B,UAAwC,QAA5BxkC,EAAKiN,EAAQu3B,iBAA8B,IAAPxkC,GAAgBA,GAEpE,EAEA2lC,EAAexmC,UAAU6pC,kBAAoB,WAC3CxmC,KAAKuyB,YAAS1zB,EACdmB,KAAKuC,YAAS1D,EACdmB,KAAK2hC,cAAW9iC,EAChBmB,KAAKsmC,gCAA6BznC,EAClCmB,KAAKqoC,iBAAcxpC,EACnBmB,KAAKoM,YAASvN,EACdmB,KAAK+hC,eAAgB,CACvB,EAMAoB,EAAexmC,UAAUqnC,mBAAqB,WAC5C,IAAIxmC,EAzjHa4O,EAAQghB,EAAU1rB,EA2jH/BT,EAAKjB,KAAKyK,QACVlI,EAAStB,EAAGsB,OACZvB,EAAWC,EAAGD,SAKbhB,KAAKuC,SAAYA,GAAUvB,KAQ3BhB,KAAKqoC,aAAgBroC,KAAKmlC,iBAE7BnlC,KAAKsoC,eAAiBtoC,KAAKuoC,6BAEvBvoC,KAAKsoC,gBAAkBtoC,KAAKsoC,eAAe/lC,SAC7CvC,KAAKmlC,eA94GR,CACLr/B,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAo5GG3sB,KAAKwoC,qBA/4GR,CACL1iC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAq5GGW,GAAqBttB,KAAKwoC,qBAAsBxoC,KAAKuC,OAAOquB,OAAQ5wB,KAAKsoC,eAAe/lC,OAAOquB,QAC/FwP,GAAYpgC,KAAKmlC,eAAgBnlC,KAAKwoC,yBASrCxoC,KAAKmlC,gBAAmBnlC,KAAKqoC,eAK7BroC,KAAKoM,SACRpM,KAAKoM,OAh6GN,CACLtG,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAs6GC3sB,KAAKyoC,qBAj6GN,CACL3iC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,KA66GG3sB,KAAKmlC,gBAAkBnlC,KAAKwoC,uBAAwD,QAA9BhrC,EAAKwC,KAAKsoC,sBAAmC,IAAP9qC,OAAgB,EAASA,EAAG4O,SAzmH3GA,EA0mHCpM,KAAKoM,OA1mHEghB,EA0mHMptB,KAAKmlC,eA1mHDzjC,EA0mHiB1B,KAAKsoC,eAAel8B,OAzmH9E+gB,GAAiB/gB,EAAOtG,EAAGsnB,EAAStnB,EAAGpE,EAAOoE,GAC9CqnB,GAAiB/gB,EAAOrG,EAAGqnB,EAASrnB,EAAGrE,EAAOqE,IA4mH7B/F,KAAKqoC,aACV3pC,QAAQsB,KAAKmiC,cAEfniC,KAAKoM,OAASpM,KAAKgoC,eAAehoC,KAAKuC,OAAOquB,QAE9CwP,GAAYpgC,KAAKoM,OAAQpM,KAAKuC,OAAOquB,QAGvChC,GAAc5uB,KAAKoM,OAAQpM,KAAKqoC,cAKhCjI,GAAYpgC,KAAKoM,OAAQpM,KAAKuC,OAAOquB,QAOnC5wB,KAAK0oC,iCACP1oC,KAAK0oC,gCAAiC,EACtC1oC,KAAKsoC,eAAiBtoC,KAAKuoC,6BAEvBvoC,KAAKsoC,gBAAkB5pC,QAAQsB,KAAKsoC,eAAenG,gBAAkBzjC,QAAQsB,KAAKmiC,gBAAkBniC,KAAKsoC,eAAe79B,QAAQhI,cAAgBzC,KAAKsoC,eAAel8B,SACtKpM,KAAKmlC,eAt8GR,CACLr/B,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IA48GG3sB,KAAKwoC,qBAv8GR,CACL1iC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IA68GGW,GAAqBttB,KAAKwoC,qBAAsBxoC,KAAKoM,OAAQpM,KAAKsoC,eAAel8B,QACjFg0B,GAAYpgC,KAAKmlC,eAAgBnlC,KAAKwoC,yBAG5C,EAEArF,EAAexmC,UAAU4rC,2BAA6B,WACpD,GAAKvoC,KAAK0B,SAAUqJ,GAAa/K,KAAK0B,OAAO8I,cAE7C,OAAKxK,KAAK0B,OAAOyjC,gBAAkBnlC,KAAK0B,OAAO2mC,cAAgBroC,KAAK0B,OAAOa,OAClEvC,KAAK0B,OAEL1B,KAAK0B,OAAO6mC,4BAEvB,EAEApF,EAAexmC,UAAUsnC,eAAiB,WACxC,IAAIzmC,EAEAyD,EAAKjB,KAAKyK,QACVlI,EAAStB,EAAGsB,OACZvB,EAAWC,EAAGD,SAYlB,GANAhB,KAAKojC,gBAAkB1kC,SAAgC,QAAtBlB,EAAKwC,KAAK0B,cAA2B,IAAPlE,OAAgB,EAASA,EAAG4lC,kBAAoBpjC,KAAK++B,kBAAoB/+B,KAAK2oC,kBAExI3oC,KAAKojC,kBACRpjC,KAAKqoC,YAAcroC,KAAKmlC,oBAAiBtmC,GAGtCmB,KAAKuC,SAAYA,GAAUvB,GAAhC,CACA,IAAImgC,EAAOnhC,KAAK4oC,UAMhBxI,GAAYpgC,KAAKsnC,gBAAiBtnC,KAAKuC,OAAOquB,QAh2GtD,SAAyB/B,EAAKsO,EAAW0L,EAAUC,GACjD,IAAItrC,EAAIyD,OAEmB,IAAvB6nC,IACFA,GAAqB,GAGvB,IAAIC,EAAaF,EAASnuC,OAC1B,GAAKquC,EAAL,CAGA,IAAI/L,EACAla,EAFJqa,EAAUr3B,EAAIq3B,EAAUp3B,EAAI,EAI5B,IAAK,IAAI7C,EAAI,EAAGA,EAAI6lC,EAAY7lC,IAE9B4f,GADAka,EAAO6L,EAAS3lC,IACHk6B,gBACuH,cAAjD,QAA7En8B,EAA8B,QAAxBzD,EAAKw/B,EAAKv5B,gBAA6B,IAAPjG,OAAgB,EAASA,EAAGmN,aAA0B,IAAP1J,OAAgB,EAASA,EAAGo6B,WAEnHyN,GAAsB9L,EAAKvyB,QAAQhI,cAAgBu6B,EAAKzK,QAAUyK,IAASA,EAAK3lB,MAClFiY,GAAaT,EAAK,CAChB/oB,GAAIk3B,EAAKzK,OAAOzsB,EAChBC,GAAIi3B,EAAKzK,OAAOxsB,IAIhB+c,IAEFqa,EAAUr3B,GAAKgd,EAAMhd,EAAEkD,MACvBm0B,EAAUp3B,GAAK+c,EAAM/c,EAAEiD,MAEvB4lB,GAAcC,EAAK/L,IAGjBgmB,GAAsB/9B,GAAaiyB,EAAKxyB,eAC1C8kB,GAAaT,EAAKmO,EAAKxyB,cA3BJ,CA8BzB,CAg0GQw+B,CAAgBhpC,KAAKsnC,gBAAiBtnC,KAAKm9B,UAAWn9B,KAAKqkC,KAAM3lC,QAAQsB,KAAKmiC,eAAiBniC,OAASmhC,GACxG,IAAI/0B,EAAS+0B,EAAK/0B,OAClB,GAAKA,EAAL,CAEKpM,KAAKo9B,kBACRp9B,KAAKo9B,gBAzgHN,CACLt3B,EAVK,CACLmnB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,GAObjnB,EAXK,CACLknB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,IA+gHPhtB,KAAKipC,6BA1gHN,CACLnjC,EAVK,CACLmnB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,GAObjnB,EAXK,CACLknB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,KAkhHT,IAAIkc,EAAiBlpC,KAAKm9B,UAAUr3B,EAChCqjC,EAAiBnpC,KAAKm9B,UAAUp3B,EAChCqjC,EAA0BppC,KAAKqpC,oBAWnCnc,GAAaltB,KAAKo9B,gBAAiBp9B,KAAKsnC,gBAAiBl7B,EAAQpM,KAAKwK,cACtExK,KAAKqpC,oBAAsBhH,GAAyBriC,KAAKo9B,gBAAiBp9B,KAAKm9B,WAE3En9B,KAAKqpC,sBAAwBD,GAA2BppC,KAAKm9B,UAAUr3B,IAAMojC,GAAkBlpC,KAAKm9B,UAAUp3B,IAAMojC,IACtHnpC,KAAKkkC,cAAe,EACpBlkC,KAAK+C,iBACL/C,KAAKukC,gBAAgB,mBAAoBn4B,GA1BxB,CAf8B,CA2CnD,EAEA+2B,EAAexmC,UAAUslC,KAAO,WAC9BjiC,KAAKm3B,WAAY,CACnB,EAEAgM,EAAexmC,UAAU6kC,KAAO,WAC9BxhC,KAAKm3B,WAAY,CACnB,EAEAgM,EAAexmC,UAAUoG,eAAiB,SAAUumC,GAClD,IAAI9rC,EAAIyD,EAAIqK,OAEM,IAAdg+B,IACFA,GAAY,GAGgC,QAA7CroC,GAAMzD,EAAKwC,KAAKyK,SAAS1H,sBAAmC,IAAP9B,GAAyBA,EAAGpE,KAAKW,GACvF8rC,IAAyC,QAA1Bh+B,EAAKtL,KAAK6+B,kBAA+B,IAAPvzB,GAAyBA,EAAGvI,kBAEzE/C,KAAKmiC,eAAiBniC,KAAKmiC,aAAa1+B,WAC1CzD,KAAKmiC,kBAAetjC,EAExB,EAEAskC,EAAexmC,UAAUipC,mBAAqB,SAAU9iB,EAAO6iB,GAC7D,IAEInoC,EAFAskB,EAAQ9hB,UAIyB,IAAjC2lC,IACFA,GAA+B,GAGjC,IAAIhE,EAAW3hC,KAAK2hC,SAChB4H,GAAwB5H,aAA2C,EAASA,EAASn3B,eAAiB,CAAC,EAEvGg/B,EAAchyC,EAAM6J,SAAS,CAAC,EAAGrB,KAAKwK,cAEtC69B,EAzkHH,CACLviC,EAVK,CACLmnB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,GAObjnB,EAXK,CACLknB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,IA+kHThtB,KAAKmlC,eAAiBnlC,KAAKwoC,0BAAuB3pC,EAClDmB,KAAK0oC,gCAAkC/C,EACvC,IAAI8D,EA9jHH,CACL3jC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAokHG+c,EAA0B/H,aAA2C,EAASA,EAASE,SACvF8H,IAA4C,QAA1BnsC,EAAKwC,KAAK6+B,kBAA+B,IAAPrhC,OAAgB,EAASA,EAAGshC,QAAQpkC,SAAW,IAAM,EACzGkvC,EAAyBlrC,QAAQgrC,IAA4BC,IAA2C,IAA3B3pC,KAAKyK,QAAQu3B,YAAuBhiC,KAAKqkC,KAAKjrC,KAAKywC,KACpI7pC,KAAKmkC,kBAAoB,EAEzBnkC,KAAK8pC,eAAiB,SAAUjW,GAC9B,IAAIr2B,EAufEsgC,EAAQre,EAAMxC,EAAIpiB,EArfpBi5B,EAAWD,EAAS,IACxBkW,GAAa1B,EAAYviC,EAAGgd,EAAMhd,EAAGguB,GACrCiW,GAAa1B,EAAYtiC,EAAG+c,EAAM/c,EAAG+tB,GAErChS,EAAMsmB,eAAeC,GAEjBvmB,EAAMqjB,gBAAkBrjB,EAAM0mB,sBAAwB1mB,EAAMvf,SAA2C,QAA/B/E,EAAKskB,EAAMwmB,sBAAmC,IAAP9qC,OAAgB,EAASA,EAAG+E,UAC7I+qB,GAAqBmc,EAAgB3nB,EAAMvf,OAAOquB,OAAQ9O,EAAMwmB,eAAe/lC,OAAOquB,QA8elFkN,EA7eGhc,EAAMqjB,eA6eD1lB,EA7eiBqC,EAAM0mB,qBA6ejBvrB,EA7euCwsB,EA6enC5uC,EA7emDi5B,EA8enFkW,GAAQlM,EAAOh4B,EAAG2Z,EAAK3Z,EAAGmX,EAAGnX,EAAGjL,GAChCmvC,GAAQlM,EAAO/3B,EAAG0Z,EAAK1Z,EAAGkX,EAAGlX,EAAGlL,IA5epB6uC,IACF5nB,EAAM8f,gBAAkB4H,EAvxCpC,SAAmBp9B,EAAQ69B,EAAQ9I,EAAMrN,EAAU8V,EAAwBD,GACzE,IAAInsC,EAAIyD,EAAIqK,EAAIE,EAEZo+B,GACFx9B,EAAOxC,QAAUhS,EAAUiZ,IAAI,EAEP,QAAvBrT,EAAK2jC,EAAKv3B,eAA4B,IAAPpM,EAAgBA,EAAK,EAAGsiC,GAAgBhM,IACxE1nB,EAAO89B,YAActyC,EAAUiZ,IAA8B,QAAzB5P,EAAKgpC,EAAOrgC,eAA4B,IAAP3I,EAAgBA,EAAK,EAAG,EAAG++B,GAAiBlM,KACxG6V,IACTv9B,EAAOxC,QAAUhS,EAAUiZ,IAA8B,QAAzBvF,EAAK2+B,EAAOrgC,eAA4B,IAAP0B,EAAgBA,EAAK,EAA2B,QAAvBE,EAAK21B,EAAKv3B,eAA4B,IAAP4B,EAAgBA,EAAK,EAAGsoB,IAOnJ,IAAK,IAAI5wB,EAAI,EAAGA,EAAIu8B,GAAYv8B,IAAK,CACnC,IAAIinC,EAAc,SAASr+B,OAAO0zB,GAAQt8B,GAAI,UAC1CknC,EAAexK,GAAUqK,EAAQE,GACjCE,EAAazK,GAAUuB,EAAMgJ,QACZtrC,IAAjBurC,QAA6CvrC,IAAfwrC,IAClCD,IAAiBA,EAAe,GAChCC,IAAeA,EAAa,GACE,IAAjBD,GAAqC,IAAfC,GAAoB1K,GAAKyK,KAAkBzK,GAAK0K,IAGjFj+B,EAAO+9B,GAAe1jC,KAAKkmB,IAAI/0B,EAAUiZ,IAAI6uB,GAAS0K,GAAe1K,GAAS2K,GAAavW,GAAW,IAElGn8B,EAAgB4sB,QAAQ7f,KAAK2lC,IAAe1yC,EAAgB4sB,QAAQ7f,KAAK0lC,MAC3Eh+B,EAAO+9B,IAAgB,MAGzB/9B,EAAO+9B,GAAeE,EAE1B,EAMIJ,EAAOthC,QAAUw4B,EAAKx4B,UACxByD,EAAOzD,OAAS/Q,EAAUiZ,IAAIo5B,EAAOthC,QAAU,EAAGw4B,EAAKx4B,QAAU,EAAGmrB,GAExE,CA6uCYwW,CAAUd,EAAaD,EAAsBznB,EAAMtX,aAAcspB,EAAU8V,EAAwBD,IAGrG7nB,EAAMzK,KAAK0vB,2BAEXjlB,EAAM/e,iBAEN+e,EAAMqiB,kBAAoBrQ,CAC5B,EAEA9zB,KAAK8pC,eAAe,EACtB,EAEA3G,EAAexmC,UAAU2jB,eAAiB,SAAU7V,GAClD,IAEIjN,EAAIyD,EAFJ6gB,EAAQ9hB,KAIZA,KAAKukC,gBAAgB,kBACY,QAAhC/mC,EAAKwC,KAAK++B,wBAAqC,IAAPvhC,GAAyBA,EAAGwjB,OAEjEhhB,KAAKmiC,eACuC,QAA7ClhC,EAAKjB,KAAKmiC,aAAapD,wBAAqC,IAAP99B,GAAyBA,EAAG+f,QAGhFhhB,KAAK2oC,mBACP9wC,EAAKq0B,WAAWT,OAAOzrB,KAAK2oC,kBAC5B3oC,KAAK2oC,sBAAmB9pC,GAS1BmB,KAAK2oC,iBAAmB5vC,EAAuB,QAAE0yB,QAAO,WACtDlsB,EAAsBC,wBAAyB,EAC/CsiB,EAAMid,iBAAmB7gC,GAAQ,EAl6BrB,IAk6ByC1G,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGoJ,GAAU,CAC/FoW,SAAU,SAAkBgT,GAC1B,IAAIr2B,EAEJskB,EAAMgoB,eAAejW,GAEO,QAA3Br2B,EAAKiN,EAAQoW,gBAA6B,IAAPrjB,GAAyBA,EAAGX,KAAK4N,EAASopB,EAChF,EACAtT,WAAY,WACV,IAAI/iB,EAE0B,QAA7BA,EAAKiN,EAAQ8V,kBAA+B,IAAP/iB,GAAyBA,EAAGX,KAAK4N,GAEvEqX,EAAMyoB,mBACR,KAGEzoB,EAAMqgB,eACRrgB,EAAMqgB,aAAapD,iBAAmBjd,EAAMid,kBAG9Cjd,EAAM6mB,sBAAmB9pC,CAC3B,GACF,EAEAskC,EAAexmC,UAAU4tC,kBAAoB,WAC3C,IAAI/sC,EAEAwC,KAAKmiC,eACPniC,KAAKmiC,aAAapD,sBAAmBlgC,EACrCmB,KAAKmiC,aAAaT,qBAAkB7iC,GAGX,QAA1BrB,EAAKwC,KAAK6+B,kBAA+B,IAAPrhC,GAAyBA,EAAG0kC,wBAC/DliC,KAAKmiC,aAAeniC,KAAK++B,iBAAmB/+B,KAAK4hC,qBAAkB/iC,EACnEmB,KAAKukC,gBAAgB,oBACvB,EAEApB,EAAexmC,UAAUmoC,gBAAkB,WACzC,IAAItnC,EAEAwC,KAAK++B,mBACwB,QAA9BvhC,EAAKwC,KAAK8pC,sBAAmC,IAAPtsC,GAAyBA,EAAGX,KAAKmD,KA58B5D,KA68BZA,KAAK++B,iBAAiB/d,QAGxBhhB,KAAKuqC,mBACP,EAEApH,EAAexmC,UAAU6tC,wBAA0B,WACjD,IAAIhtC,EAAKwC,KAAK4oC,UACVH,EAAuBjrC,EAAGirC,qBAC1Br8B,EAAS5O,EAAG4O,OACZ7J,EAAS/E,EAAG+E,OACZiI,EAAehN,EAAGgN,aAEjBi+B,GAAyBr8B,GAAW7J,IACzC69B,GAAYqI,EAAsBr8B,GAOlCkjB,GAAamZ,EAAsBj+B,GAQnC0iB,GAAaltB,KAAKipC,6BAA8BjpC,KAAKsnC,gBAAiBmB,EAAsBj+B,GAC9F,EAEA24B,EAAexmC,UAAUooC,mBAAqB,SAAU/jC,EAAUg8B,GAChE,IAAIx/B,EAAIyD,EAAIqK,EAEPtL,KAAKokC,YAAYhgC,IAAIpD,IACxBhB,KAAKokC,YAAY//B,IAAIrD,EAAU,IAAIigC,IAGzBjhC,KAAKokC,YAAY1rC,IAAIsI,GAC3B2V,IAAIqmB,GACVA,EAAK2B,QAAQ,CACX9sB,WAA2D,QAA9CrU,EAAKw/B,EAAKvyB,QAAQ/H,8BAA2C,IAAPlF,OAAgB,EAASA,EAAGqU,WAC/F0vB,sBAAiJ,QAAzHj2B,EAAoD,QAA9CrK,EAAK+7B,EAAKvyB,QAAQ/H,8BAA2C,IAAPzB,OAAgB,EAASA,EAAGwpC,mCAAgD,IAAPn/B,OAAgB,EAASA,EAAGzO,KAAKoE,EAAI+7B,IAElM,EAEAmG,EAAexmC,UAAUqiC,OAAS,WAChC,IAAI0L,EAAQ1qC,KAAK6+B,WACjB,OAAO6L,GAAQA,EAAMvJ,OAASnhC,IAChC,EAEAmjC,EAAexmC,UAAUisC,QAAU,WACjC,IAAIprC,EAGJ,OADewC,KAAKyK,QAAQzJ,WACkB,QAA1BxD,EAAKwC,KAAK6+B,kBAA+B,IAAPrhC,OAAgB,EAASA,EAAG2jC,OAAgBnhC,IACpG,EAEAmjC,EAAexmC,UAAUguC,YAAc,WACrC,IAAIntC,EAGJ,OADewC,KAAKyK,QAAQzJ,SACiB,QAA1BxD,EAAKwC,KAAK6+B,kBAA+B,IAAPrhC,OAAgB,EAASA,EAAG0jC,cAAWriC,CAC9F,EAEAskC,EAAexmC,UAAUkiC,SAAW,WAClC,IAAI79B,EAAWhB,KAAKyK,QAAQzJ,SAC5B,GAAIA,EAAU,OAAOhB,KAAKqX,KAAK+sB,YAAY1rC,IAAIsI,EACjD,EAEAmiC,EAAexmC,UAAUgiC,QAAU,SAAUnhC,GAC3C,IAAIyD,OAAY,IAAPzD,EAAgB,CAAC,EAAIA,EAC1BgmC,EAAaviC,EAAGuiC,WAChB3xB,EAAa5Q,EAAG4Q,WAChB0vB,EAAwBtgC,EAAGsgC,sBAE3BmJ,EAAQ1qC,KAAK6+B,WACb6L,GAAOA,EAAM/L,QAAQ3+B,KAAMuhC,GAE3BiC,IACFxjC,KAAKo9B,qBAAkBv+B,EACvBmB,KAAKwjC,YAAa,GAGhB3xB,GAAY7R,KAAK6C,WAAW,CAC9BgP,WAAYA,GAEhB,EAEAsxB,EAAexmC,UAAUiiC,SAAW,WAClC,IAAI8L,EAAQ1qC,KAAK6+B,WAEjB,QAAI6L,GACKA,EAAM9L,SAAS5+B,KAI1B,EAEAmjC,EAAexmC,UAAUypC,cAAgB,WACvC,IAAIjrC,EAAgB6E,KAAKyK,QAAQtP,cACjC,GAAKA,EAAL,CAMA,IAJA,IAAIyvC,GAAY,EAEZC,EAAc,CAAC,EAEV3nC,EAAI,EAAGA,EAAI6B,EAAcrK,OAAQwI,IAAK,CAC7C,IACIhJ,EAAM,SADC6K,EAAc7B,GAIpB/H,EAAcw8B,eAAez9B,KAIlC0wC,GAAY,EAEZC,EAAY3wC,GAAOiB,EAAcw8B,eAAez9B,GAChDiB,EAAcy8B,eAAe19B,EAAK,GACpC,CAGA,GAAK0wC,EAAL,CAKA,IAAK,IAAI1wC,KAFTiB,SAA8DA,EAAc8G,aAE5D4oC,EACd1vC,EAAcy8B,eAAe19B,EAAK2wC,EAAY3wC,IAKhDiB,EAAc4H,gBAXQ,CAtBI,CAkC5B,EAEAogC,EAAexmC,UAAUkT,oBAAsB,SAAUD,GACvD,IAAIpS,EAAIyD,EAAIqK,EAAIE,EAAI4b,EAAIC,OAEN,IAAdzX,IACFA,EAAY,CAAC,GAIf,IAAIk7B,EAAS,CAAC,EACd,IAAK9qC,KAAKyD,UAAYzD,KAAKujC,MAAO,OAAOuH,EAEzC,IAAK9qC,KAAKm3B,UACR,MAAO,CACLW,WAAY,UAGdgT,EAAOhT,WAAa,GAGtB,IAAIptB,EAA0D,QAArClN,EAAKwC,KAAKyK,QAAQtP,qBAAkC,IAAPqC,OAAgB,EAASA,EAAGG,WAAW+M,kBAE7G,GAAI1K,KAAKwjC,WAKP,OAJAxjC,KAAKwjC,YAAa,EAClBsH,EAAOlhC,QAAU,GACjBkhC,EAAOC,cAAgBp6B,GAAmBf,EAAUm7B,gBAAkB,GACtED,EAAOxkC,UAAYoE,EAAoBA,EAAkB1K,KAAKwK,aAAc,IAAM,OAC3EsgC,EAGT,IAAI3J,EAAOnhC,KAAK4oC,UAEhB,IAAK5oC,KAAKo9B,kBAAoBp9B,KAAKuC,SAAW4+B,EAAK/0B,OAAQ,CACzD,IAAI4+B,EAAc,CAAC,EAYnB,OAVIhrC,KAAKyK,QAAQzJ,WACfgqC,EAAYphC,QAA+C,QAApC3I,EAAKjB,KAAKwK,aAAaZ,eAA4B,IAAP3I,EAAgBA,EAAK,EACxF+pC,EAAYD,cAAgBp6B,GAAmBf,EAAUm7B,gBAAkB,IAGzE/qC,KAAKkkC,eAAiBn5B,GAAa/K,KAAKwK,gBAC1CwgC,EAAY1kC,UAAYoE,EAAoBA,EAAkB,CAAC,EAAG,IAAM,OACxE1K,KAAKkkC,cAAe,GAGf8G,CACT,CAEA,IAAIC,EAAiB9J,EAAKS,iBAAmBT,EAAK32B,aAClDxK,KAAKwqC,0BACLM,EAAOxkC,UAAY+7B,GAAyBriC,KAAKipC,6BAA8BjpC,KAAKm9B,UAAW8N,GAE3FvgC,IACFogC,EAAOxkC,UAAYoE,EAAkBugC,EAAgBH,EAAOxkC,YAG9D,IAAIg/B,EAAKtlC,KAAKo9B,gBACVt3B,EAAIw/B,EAAGx/B,EACPC,EAAIu/B,EAAGv/B,EAqBX,IAAK,IAAI7L,KApBT4wC,EAAOhgC,gBAAkB,GAAGgB,OAAkB,IAAXhG,EAAE6H,OAAc,MAAM7B,OAAkB,IAAX/F,EAAE4H,OAAc,OAE5EwzB,EAAKS,gBAKPkJ,EAAOlhC,QAAUu3B,IAASnhC,KAA2G,QAAnGwL,EAAuC,QAAjCF,EAAK2/B,EAAerhC,eAA4B,IAAP0B,EAAgBA,EAAKtL,KAAKwK,aAAaZ,eAA4B,IAAP4B,EAAgBA,EAAK,EAAIxL,KAAK0hC,gBAAkB1hC,KAAKwK,aAAaZ,QAAUqhC,EAAef,YAMxOY,EAAOlhC,QAAUu3B,IAASnhC,KAAyC,QAAjConB,EAAK6jB,EAAerhC,eAA4B,IAAPwd,EAAgBA,EAAK,GAA2C,QAArCC,EAAK4jB,EAAef,mBAAgC,IAAP7iB,EAAgBA,EAAK,EAO1J1iB,EACd,QAA4B9F,IAAxBosC,EAAe/wC,GAAnB,CACA,IAAIgxC,EAAKvmC,EAAgBzK,GACrB6iC,EAAUmO,EAAGnO,QACbsC,EAAU6L,EAAG7L,QACb8L,EAAYpO,EAAQkO,EAAe/wC,GAAMinC,GAE7C,GAAI9B,EAGF,IAFA,IAAI+L,EAAM/L,EAAQ3kC,OAETwI,EAAI,EAAGA,EAAIkoC,EAAKloC,IACvB4nC,EAAOzL,EAAQn8B,IAAMioC,OAGvBL,EAAO5wC,GAAOixC,CAb+B,CA2BjD,OAJInrC,KAAKyK,QAAQzJ,WACf8pC,EAAOC,cAAgB5J,IAASnhC,KAAO2Q,GAAmBf,EAAUm7B,gBAAkB,GAAK,QAGtFD,CACT,EAEA3H,EAAexmC,UAAUkqC,cAAgB,WACvC7mC,KAAKyhC,WAAazhC,KAAK2hC,cAAW9iC,CACpC,EAGAskC,EAAexmC,UAAU0uC,UAAY,WACnCrrC,KAAKqX,KAAK0sB,MAAMzrC,SAAQ,SAAU0kC,GAChC,IAAIx/B,EAEJ,OAAwC,QAAhCA,EAAKw/B,EAAK+B,wBAAqC,IAAPvhC,OAAgB,EAASA,EAAGwjB,MAC9E,IACAhhB,KAAKqX,KAAK0sB,MAAMzrC,QAAQkuC,IACxBxmC,KAAKqX,KAAK+sB,YAAYjiB,OACxB,EAEOghB,CACT,CA5sCK,EA8sCT,CAEA,SAASlP,GAAa+I,GACpBA,EAAK/I,cACP,CAEA,SAAS0S,GAAmB3J,GAC1B,IAAIx/B,EAAIyD,EAAIqK,EAAIE,EAEZm2B,EAA8F,QAAlF1gC,EAAgC,QAA1BzD,EAAKw/B,EAAKyE,kBAA+B,IAAPjkC,OAAgB,EAASA,EAAGmkC,gBAA6B,IAAP1gC,EAAgBA,EAAK+7B,EAAK2E,SAEpI,GAAI3E,EAAKgC,UAAYhC,EAAKz6B,QAAUo/B,GAAY3E,EAAKyH,aAAa,aAAc,CAC9E,IAAIrd,EAAK4V,EAAKz6B,OACV+oC,EAAWlkB,EAAGwJ,OACd2a,EAAiBnkB,EAAG4f,SAGW,SAA/BhK,EAAKvyB,QAAQzH,cACfmrB,IAAS,SAAUzB,GACjB,IAAI8e,EAAe7J,EAASE,SAAWF,EAASqF,SAASta,GAAQiV,EAASp/B,OAAOmqB,GAC7EhyB,EAAS+xB,GAAW+e,GACxBA,EAAa5e,IAAM0e,EAAS5e,GAAME,IAClC4e,EAAa7e,IAAM6e,EAAa5e,IAAMlyB,CACxC,IACwC,aAA/BsiC,EAAKvyB,QAAQzH,eACtBmrB,IAAS,SAAUzB,GACjB,IAAI8e,EAAe7J,EAASE,SAAWF,EAASqF,SAASta,GAAQiV,EAASp/B,OAAOmqB,GAC7EhyB,EAAS+xB,GAAW6e,EAAS5e,IACjC8e,EAAa7e,IAAM6e,EAAa5e,IAAMlyB,CACxC,IAGF,IAAI+wC,EA59HC,CACL3lC,EAVK,CACLmnB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,GAObjnB,EAXK,CACLknB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,IAk+HbE,GAAaue,EAAaH,EAAU3J,EAASp/B,QAC7C,IAAImpC,EA99HC,CACL5lC,EAVK,CACLmnB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,GAObjnB,EAXK,CACLknB,UAAW,EACXjkB,MAAO,EACP2E,OAAQ,EACRqf,YAAa,IAq+HT2U,EAASE,SACX3U,GAAawe,EAAa1O,EAAKgL,eAAeuD,GAAgB,GAAO5J,EAASqF,UAE9E9Z,GAAawe,EAAaJ,EAAU3J,EAASp/B,QAG/C,IAAIiyB,GAAoBuM,GAAY0K,GAChCzG,GAA2B,EAE/B,IAAKhI,EAAKyE,aACRzE,EAAKsL,eAAiBtL,EAAKuL,6BAMvBvL,EAAKsL,iBAAmBtL,EAAKsL,eAAe7G,YAAY,CAC1D,IAAIpa,EAAK2V,EAAKsL,eACVqD,EAAiBtkB,EAAGsa,SACpBiK,EAAevkB,EAAG9kB,OAEtB,GAAIopC,GAAkBC,EAAc,CAClC,IAAIC,EAx+HL,CACL/lC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IA8+HCW,GAAqBue,EAAkBlK,EAASp/B,OAAQopC,EAAeppC,QACvE,IAAIknC,EA1+HL,CACL3jC,EARK,CACL8mB,IAAK,EACLD,IAAK,GAOL5mB,EATK,CACL6mB,IAAK,EACLD,IAAK,IAg/HCW,GAAqBmc,EAAgB6B,EAAUM,EAAahb,QAEvDoQ,GAAU6K,EAAkBpC,KAC/BzE,GAA2B,EAE/B,CACF,CAGFhI,EAAKuH,gBAAgB,YAAa,CAChChiC,OAAQ+oC,EACR3J,SAAUA,EACV7e,MAAO4oB,EACPD,YAAaA,EACbjX,iBAAkBA,EAClBwQ,yBAA0BA,GAE9B,MAAWhI,EAAKgC,WACgC,QAA7CxzB,GAAMF,EAAK0xB,EAAKvyB,SAASmQ,sBAAmC,IAAPpP,GAAyBA,EAAG3O,KAAKyO,IASzF0xB,EAAKvyB,QAAQoH,gBAAahT,CAC5B,CAEA,SAASgoC,GAAc7J,GACrBA,EAAK6J,eACP,CAEA,SAASL,GAAkBxJ,GACzBA,EAAKwJ,mBACP,CAEA,SAASE,GAAoB1J,GAC3B,IAAI7hC,EAAgB6hC,EAAKvyB,QAAQtP,eAE7BA,aAAqD,EAASA,EAAcwC,WAAWmuC,wBACzF3wC,EAAc4wC,4BAGhB/O,EAAKb,gBACP,CAEA,SAAS2I,GAAgB9H,GACvBA,EAAK8H,kBACL9H,EAAKqL,YAAcrL,EAAKmI,eAAiBnI,EAAK5wB,YAASvN,CACzD,CAEA,SAASmlC,GAAmBhH,GAC1BA,EAAKgH,oBACP,CAEA,SAASC,GAAejH,GACtBA,EAAKiH,gBACP,CAEA,SAASmC,GAAcpJ,GACrBA,EAAKoJ,eACP,CAEA,SAASU,GAAoB4D,GAC3BA,EAAMtI,oBACR,CAEA,SAAS2H,GAAajM,EAAQhb,EAAOjoB,GACnCijC,EAAO7Q,UAAYr1B,EAAUiZ,IAAIiS,EAAMmK,UAAW,EAAGpyB,GACrDijC,EAAO90B,MAAQpR,EAAUiZ,IAAIiS,EAAM9Z,MAAO,EAAGnO,GAC7CijC,EAAOnwB,OAASmV,EAAMnV,OACtBmwB,EAAO9Q,YAAclK,EAAMkK,WAC7B,CAEA,SAASgd,GAAQlM,EAAQre,EAAMxC,EAAIpiB,GACjCijC,EAAOlR,IAAMh1B,EAAUiZ,IAAI4O,EAAKmN,IAAK3P,EAAG2P,IAAK/xB,GAC7CijC,EAAOnR,IAAM/0B,EAAUiZ,IAAI4O,EAAKkN,IAAK1P,EAAG0P,IAAK9xB,EAC/C,CAOA,SAASgvC,GAAoB7M,GAC3B,OAAOA,EAAK4E,sBAAwD/iC,IAArCm+B,EAAK4E,gBAAgBsI,WACtD,CAEA,IAAI7E,GAA0B,CAC5BhoB,SAAU,IACVD,KAAM,CAAC,GAAK,EAAG,GAAK,IAGtB,SAASqpB,GAAezJ,EAAM77B,GAO5B,IAFA,IAAI6qC,EAAahP,EAAK3lB,KAEbnU,EAAI85B,EAAKqH,KAAK3pC,OAAS,EAAGwI,GAAK,EAAGA,IACzC,GAAIxE,QAAQs+B,EAAKqH,KAAKnhC,GAAGO,UAAW,CAClCuoC,EAAahP,EAAKqH,KAAKnhC,GACvB,KACF,CAGF,IACIyM,GADgBq8B,GAAcA,IAAehP,EAAK3lB,KAAO20B,EAAWvoC,SAAWnI,UACvD2wC,cAAc,wBAAyBngC,OAAO3K,EAAI,OAC1EwO,GAASqtB,EAAKt5B,MAAMiM,GAAS,EACnC,CAEA,SAASu8B,GAAUxf,GACjBA,EAAKE,IAAMnmB,KAAKC,MAAMgmB,EAAKE,KAC3BF,EAAKC,IAAMlmB,KAAKC,MAAMgmB,EAAKC,IAC7B,CAEA,SAASya,GAASvY,GAChBqd,GAAUrd,EAAI/oB,GACdomC,GAAUrd,EAAI9oB,EAChB,CAEA,IAAIomC,GAAyBrJ,GAAqB,CAChDC,qBAAsB,SAA8BrmC,EAAKqlB,GACvD,OAAOzP,GAAY5V,EAAK,SAAUqlB,EACpC,EACAkhB,cAAe,WACb,MAAO,CACLn9B,EAAGxK,SAAS8wC,gBAAgBC,YAAc/wC,SAASgxC,KAAKD,WACxDtmC,EAAGzK,SAAS8wC,gBAAgBG,WAAajxC,SAASgxC,KAAKC,UAE3D,EACArJ,kBAAmB,WACjB,OAAO,CACT,IAEE7Q,GAAqB,CACvB12B,aAASkD,GAEP2tC,GAAqB1J,GAAqB,CAC5CG,cAAe,SAAuBx/B,GACpC,MAAO,CACLqC,EAAGrC,EAAS4oC,WACZtmC,EAAGtC,EAAS8oC,UAEhB,EACAvJ,cAAe,WACb,IAAK3Q,GAAmB12B,QAAS,CAC/B,IAAI8wC,EAAe,IAAIN,GAAuB,EAAG,CAAC,GAClDM,EAAa/oC,MAAM5H,QACnB2wC,EAAa5pC,WAAW,CACtBJ,cAAc,IAEhB4vB,GAAmB12B,QAAU8wC,CAC/B,CAEA,OAAOpa,GAAmB12B,OAC5B,EACAwgC,eAAgB,SAAwB14B,EAAUlM,GAChDkM,EAASkH,MAAMrE,UAAY/O,QAAqCA,EAAQ,MAC1E,EACA2rC,kBAAmB,SAA2Bz/B,GAC5C,OAAO/E,QAAuD,UAA/C5C,OAAOo9B,iBAAiBz1B,GAAUipC,SACnD,IAGEC,GAAgBn1C,EAAM6J,SAAS7J,EAAM6J,SAAS7J,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGglB,IAAalN,IAAoBzf,IAAO6lC,IASxHqN,GAAsB/oC,GAAkB,SAAUzJ,EAAWkH,GAC/D,OAAO8Q,GAAsBhY,EAAWkH,EAAQqrC,GAAehQ,GAAwB6P,GACzF,IA2BA,IAAIK,GAAIhpC,EAAkBuO,IAE1B,SAAS06B,KACP,IAAIlX,EAAYn+B,EAAM6H,QAAO,GAO7B,OANA/D,GAA0B,WAExB,OADAq6B,EAAUj6B,SAAU,EACb,WACLi6B,EAAUj6B,SAAU,CACtB,CACF,GAAG,IACIi6B,CACT,CAEA,SAASmX,KACP,IAAInX,EAAYkX,KAEZtvC,EAAKhG,EAAM6E,OAAO5E,EAAM6E,SAAS,GAAI,GACrC0wC,EAAoBxvC,EAAG,GACvByvC,EAAuBzvC,EAAG,GAE1B0vC,EAAcz1C,EAAM+L,aAAY,WAClCoyB,EAAUj6B,SAAWsxC,EAAqBD,EAAoB,EAChE,GAAG,CAACA,IASJ,MAAO,CAHmBv1C,EAAM+L,aAAY,WAC1C,OAAOzK,EAAuB,QAAEiqB,WAAWkqB,EAC7C,GAAG,CAACA,IACyBF,EAC/B,CAEA,IAAIG,GAAgB,SAAuB3vC,GACzC,IAAIgD,EAAWhD,EAAGgD,SACdpC,EAAUZ,EAAGY,QACbuc,EAAYnd,EAAGmd,UACfyyB,EAAkB5vC,EAAGod,eACrBvd,EAASG,EAAGH,OACZgwC,EAAwB7vC,EAAG6vC,sBAC3BC,EAAmBluC,EAAYmuC,IAC/BpsC,EAAKsZ,KACL7b,EAAUnH,EAAMuH,SAAQ,WAC1B,MAAO,CACLmC,GAAIA,EACJ/C,QAASA,EACTuc,UAAWA,EACXtd,OAAQA,EACRud,eAAgB,SAAwB4yB,GACtC,IAAIC,EAAKjwC,EAET8vC,EAAiBjpC,IAAImpC,GAAS,GAE9B,IACE,IAAK,IAAIvsC,EAAKzJ,EAAMk2C,SAASJ,EAAiBj8B,UAAW/F,EAAKrK,EAAG8Z,QAASzP,EAAGqiC,KAAMriC,EAAKrK,EAAG8Z,OAAQ,CAEjG,IADiBzP,EAAG/T,MACH,MACnB,CAWF,CAVE,MAAOq2C,GACPH,EAAM,CACJI,MAAOD,EAEX,CAAE,QACA,IACMtiC,IAAOA,EAAGqiC,OAASnwC,EAAKyD,EAAG6sC,SAAStwC,EAAGX,KAAKoE,EAGlD,CAFE,QACA,GAAIwsC,EAAK,MAAMA,EAAII,KACrB,CACF,CAEAT,SAAkEA,GACpE,EACAvyB,SAAU,SAAkB2yB,GAE1B,OADAF,EAAiBjpC,IAAImpC,GAAS,GACvB,WACL,OAAOF,EAAiBz1B,OAAO21B,EACjC,CACF,EAEJ,GAMAH,OAAwBxuC,EAAY,CAAC8b,IAcrC,OAbAljB,EAAMuH,SAAQ,WACZsuC,EAAiBh1C,SAAQ,SAAUy1C,EAAG7zC,GACpC,OAAOozC,EAAiBjpC,IAAInK,GAAK,EACnC,GACF,GAAG,CAACygB,IAMJ9hB,EAAiB4C,WAAU,YACxBkf,IAAc2yB,EAAiB1lC,OAASwlC,SAAkEA,IAC7G,GAAG,CAACzyB,IACG9hB,EAAiBwK,cAAcjI,EAAgBmI,SAAU,CAC9DhM,MAAOqH,GACN4B,EACL,EAEA,SAAS+sC,KACP,OAAO,IAAIrpC,GACb,CAEA,IAAI8pC,GAAc,SAAqB93B,GACrC,OAAOA,EAAMhc,KAAO,EACtB,EAoDA,IAoII+zC,GAA+Bx2C,EAAM6C,cAAc,MAEnDynB,GAAS,SAAgBib,GAC3B,OAAQA,EAAK+E,eAAiB/E,EAAK0B,YAAW,EAChD,EAEA,SAASwP,KACP,IAAInK,EAAQ,IAAIx+B,IACZsc,EAAgB,IAAIhL,QAEpBs3B,EAAW,WACb,OAAOpK,EAAMzrC,QAAQypB,GACvB,EAEA,MAAO,CACLpL,IAAK,SAAaqmB,GAChB+G,EAAMptB,IAAIqmB,GACVnb,EAAcxd,IAAI24B,EAAMA,EAAKtqB,iBAAiB,aAAcy7B,GAC9D,EACA7W,OAAQ,SAAgB0F,GACtB,IAAIx/B,EAEJumC,EAAMlsB,OAAOmlB,GACsB,QAAlCx/B,EAAKqkB,EAAcnpB,IAAIskC,UAA0B,IAAPx/B,GAAyBA,IACpEqkB,EAAchK,OAAOmlB,GACrBmR,GACF,EACAC,MAAOD,EAEX,CAEA,IAAIE,GAAqB,SAA4BvvC,GACnD,OAAmB,IAAZA,CACT,EAMIwvC,GAAc,SAAqB9wC,GACrC,IAAIyD,EAAIqK,EAEJ9K,EAAWhD,EAAGgD,SACdW,EAAK3D,EAAG2D,GACRotC,EAAY/wC,EAAG+wC,UACf/iC,EAAKhO,EAAGsB,QACRA,OAAiB,IAAP0M,GAAuBA,OAEnB3M,IAAd0vC,IAAyBzvC,EAAUyvC,GACvC,IAAIC,EAAqB/2C,EAAMyD,WAAWyE,GACtC8uC,EAA+Bh3C,EAAMyD,WAAW+yC,IAEhD7mB,EAAK5vB,EAAM6E,OAAO0wC,KAAkB,GACpCG,EAAc9lB,EAAG,GACjBltB,EAAMktB,EAAG,GAETxoB,EAAUnH,EAAM6H,OAAO,MACvBovC,EAA8C,QAAhCztC,EAAKutC,EAAmBrtC,UAAuB,IAAPF,EAAgBA,EAAKwtC,EAEvD,OAApB7vC,EAAQjD,UAxBQ,SAAyBmD,GAC7C,OAAOuvC,IAA+B,IAAZvvC,IAAiC,OAAZA,CACjD,CAuBQ6vC,CAAgB7vC,IAAY4vC,IAC9BvtC,EAAKA,EAAKutC,EAAa,IAAMvtC,EAAKutC,GAGpC9vC,EAAQjD,QAAU,CAChBwF,GAAIA,EACJm9B,MAAO+P,GAAmBvvC,IAAuH,QAA3GwM,EAAKkjC,aAA+D,EAASA,EAAmBlQ,aAA0B,IAAPhzB,EAAgBA,EAAmB4iC,OAIhM,IAAIU,EAAkBn3C,EAAMuH,SAAQ,WAClC,OAAOxH,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGzC,EAAQjD,SAAU,CACzDuxC,YAAaA,GAEjB,GAAG,CAAChzC,IACJ,OAAOrB,EAAiBwK,cAAc1D,EAAmB4D,SAAU,CACjEhM,MAAOq3C,GACNpuC,EACL,EAEIW,GAAK,EA8IT,SAAS0tC,GAAa50C,GACpB,MAA2B,mBAAbA,CAChB,CAEA,IAAI60C,GAAiBr3C,EAAM6C,cAAc,MAEzC,SAASy0C,GAAaC,EAAOz3C,EAAOqW,EAAQ9P,GAC1C,IAAKA,EAAU,OAAOkxC,EACtB,IAAIttB,EAAQstB,EAAM3N,WAAU,SAAU7f,GACpC,OAAOA,EAAKjqB,QAAUA,CACxB,IACA,IAAe,IAAXmqB,EAAc,OAAOstB,EACzB,IAAIC,EAAanxC,EAAW,EAAI,GAAK,EACjCoxC,EAAWF,EAAMttB,EAAQutB,GAC7B,IAAKC,EAAU,OAAOF,EACtB,IAAIxtB,EAAOwtB,EAAMttB,GACbytB,EAAaD,EAAS3sC,OACtB6sC,EAAiBx3C,EAAUiZ,IAAIs+B,EAAWviB,IAAKuiB,EAAWxiB,IAAK,IAEnE,OAAmB,IAAfsiB,GAAoBztB,EAAKjf,OAAOoqB,IAAM/e,EAASwhC,IAAkC,IAAhBH,GAAqBztB,EAAKjf,OAAOqqB,IAAMhf,EAASwhC,EAh1MvH,SAAkB5xC,EAAIo9B,EAAWyU,GAC/B,IACI9tB,EADK/pB,EAAM6E,OAAOmB,GACT8xC,MAAM,GAEfC,EAAa3U,EAAY,EAAIrZ,EAAI7mB,OAASkgC,EAAYA,EAE1D,GAAI2U,GAAc,GAAKA,EAAahuB,EAAI7mB,OAAQ,CAC9C,IAAI80C,EAAWH,EAAU,EAAI9tB,EAAI7mB,OAAS20C,EAAUA,EAGhD7tB,EADKhqB,EAAM6E,OAAOklB,EAAII,OAAOiZ,EAAW,GAAI,GAClC,GAEdrZ,EAAII,OAAO6tB,EAAU,EAAGhuB,EAC1B,CAEA,OAAOD,CACT,CAi0MWkuB,CAAST,EAAOttB,EAAOA,EAAQutB,GAGjCD,CACT,CAwDA,IAAIU,GAAQj4C,EAAMqJ,YAtDlB,SAAsBtD,EAAIuD,GACxB,IAAIP,EAAWhD,EAAGgD,SACdS,EAAKzD,EAAGmyC,GACRA,OAAY,IAAP1uC,EAAgB,KAAOA,EAC5BqK,EAAK9N,EAAGkvB,KACRA,OAAc,IAAPphB,EAAgB,IAAMA,EAC7BskC,EAAYpyC,EAAGoyC,UACfv+B,EAAS7T,EAAG6T,OACZlY,EAAQ3B,EAAM8W,OAAO9Q,EAAI,CAAC,WAAY,KAAM,OAAQ,YAAa,WAEjEpD,EAAYgF,GAAY,WAC1B,OAAOwtC,GAAO+C,EAChB,IACIX,EAAQ,GACRa,EAAep4C,EAAM6H,QAAO,GAChC5H,EAAU0kB,UAAU1d,QAAQ2S,GAAS,gDACrC,IAAIzS,EAAU,CACZ8tB,KAAMA,EACNojB,aAAc,SAAsBv4C,EAAOgL,GAIrCA,IAEI,IAFMysC,EAAM3N,WAAU,SAAUrqB,GACtC,OAAOzf,IAAUyf,EAAMzf,KACzB,MACEy3C,EAAM5rC,KAAK,CACT7L,MAAOA,EACPgL,OAAQA,EAAOmqB,KAEjBsiB,EAAMrjC,KAAKokC,IAEf,EACAC,YAAa,SAAqB7uC,EAAIyM,EAAQ9P,GAC5C,IAAI+xC,EAAal0C,QAAjB,CACA,IAAIs0C,EAAWlB,GAAaC,EAAO7tC,EAAIyM,EAAQ9P,GAE3CkxC,IAAUiB,IACZJ,EAAal0C,SAAU,EACvBi0C,EAAUK,EAAShxB,IAAIgG,IAAU9G,QAAO,SAAU5mB,GAChD,OAAkC,IAA3B8Z,EAAO5M,QAAQlN,EACxB,KAP8B,CASlC,GAKF,OAHAE,EAAMgE,WAAU,WACdo0C,EAAal0C,SAAU,CACzB,IACO9C,EAAiBwK,cAAcjJ,EAAW5C,EAAM6J,SAAS,CAAC,EAAGlI,EAAO,CACzEuD,IAAKqE,IACHlI,EAAiBwK,cAAcyrC,GAAevrC,SAAU,CAC1DhM,MAAOqH,GACN4B,GACL,IAIA,SAASykB,GAASzD,GAChB,OAAOA,EAAKjqB,KACd,CAEA,SAASw4C,GAAW7qC,EAAGC,GACrB,OAAOD,EAAE3C,OAAOqqB,IAAMznB,EAAE5C,OAAOqqB,GACjC,CAoBA,SAASsjB,GAAe9xC,GACtB,IAAI7G,EAAQ6H,GAAY,WACtB,OAAOglB,GAAYhmB,EACrB,IASA,GAFe3G,EAAMyD,WAAWP,GAAqBG,SAEvC,CACZ,IACIq1C,EADK34C,EAAM6E,OAAO5E,EAAM6E,SAAS8B,GAAU,GAC1B,GAErB3G,EAAMgE,WAAU,WACd,OAAOlE,EAAM8rB,SAAS8sB,EACxB,GAAG,GACL,CAEA,OAAO54C,CACT,CAEA,IAII64C,GAAW,SAAkBrzC,GAC/B,OALsB,SAA2BA,GACjD,MAAoB,iBAANA,GAAkBA,EAAE8T,GACpC,CAGSw/B,CAAkBtzC,GAAKA,EAAE8T,SAAMhS,CACxC,EAEA,SAASyH,KAGP,IAFA,IAAI+vB,EAAO,GAEFC,EAAK,EAAGA,EAAKr2B,UAAUvF,OAAQ47B,IACtCD,EAAKC,GAAMr2B,UAAUq2B,GAGvB,IAAIga,GAAgBtzC,MAAMC,QAAQo5B,EAAK,IACnCka,EAAYD,EAAe,GAAK,EAChCE,EAAana,EAAK,EAAIka,GACtBE,EAAapa,EAAK,EAAIka,GACtBG,EAAcra,EAAK,EAAIka,GACvB9lC,EAAU4rB,EAAK,EAAIka,GACnBI,EAAe/4C,EAAUg5C,YAAYH,EAAYC,EAAal5C,EAAM6J,SAAS,CAC/EwvC,MAAOT,GAASM,EAAY,KAC3BjmC,IACH,OAAO6lC,EAAeK,EAAaH,GAAcG,CACnD,CAqBA,SAASG,GAAuBz/B,EAAQ0/B,GAItC,IAAIx5C,EAAQ24C,GAAea,KAQvBC,EAAc,WAChB,OAAOz5C,EAAM8M,IAAI0sC,IACnB,EAgBA,OATAC,IAlCF,SAA0B3/B,EAAQmB,GAChCjX,GAA0B,WACxB,IAAIsmB,EAAgBxQ,EAAO4N,KAAI,SAAU1nB,GACvC,OAAOA,EAAM8rB,SAAS7Q,EACxB,IACA,OAAO,WACL,OAAOqP,EAAcvpB,SAAQ,SAAU24C,GACrC,OAAOA,GACT,GACF,CACF,GACF,CA6BEC,CAAiB7/B,GAAQ,WACvB,OAAOtY,EAAuB,QAAE0yB,OAAOulB,GAAa,GAAO,EAC7D,IACOz5C,CACT,CAEA,SAAS45C,GAAaC,EAAOC,EAAyBX,EAAajmC,GACjE,IAAI6mC,EAAiD,mBAA5BD,EAAyCA,EAA0B/qC,GAAU+qC,EAAyBX,EAAajmC,GAC5I,OAAOzN,MAAMC,QAAQm0C,GAASG,GAAiBH,EAAOE,GAAeC,GAAiB,CAACH,IAAQ,SAAU5zC,GACvG,IACIq2B,EADKr8B,EAAM6E,OAAOmB,EAAI,GACV,GAEhB,OAAO8zC,EAAYzd,EACrB,GACF,CAEA,SAAS0d,GAAiBlgC,EAAQigC,GAChC,IAAIzd,EAASz0B,GAAY,WACvB,MAAO,EACT,IACA,OAAO0xC,GAAuBz/B,GAAQ,WACpCwiB,EAAOn5B,OAAS,EAGhB,IAFA,IAAI82C,EAAYngC,EAAO3W,OAEdwI,EAAI,EAAGA,EAAIsuC,EAAWtuC,IAC7B2wB,EAAO3wB,GAAKmO,EAAOnO,GAAGxK,MAGxB,OAAO44C,EAAYzd,EACrB,GACF,CAEA,SAAS4d,GAAsBl6C,EAAO0gC,GAKpC,YAJqB,IAAjBA,IACFA,EAAe,GAGVryB,GAAcrO,GAASA,EAAQ24C,GAAejY,EACvD,CA2DA,IACIyZ,GAAU,CACZhC,MAAOA,GACPiC,KAHSl6C,EAAMqJ,YAzDjB,SAAqBtD,EAAIuD,GACvB,IAAIP,EAAWhD,EAAGgD,SACdmK,EAAQnN,EAAGmN,MACXpT,EAAQiG,EAAGjG,MACX0J,EAAKzD,EAAGmyC,GACRA,OAAY,IAAP1uC,EAAgB,KAAOA,EAC5B2wC,EAAUp0C,EAAGuzB,OACbzlB,EAAK9N,EAAG+E,OACRA,OAAgB,IAAP+I,GAAuBA,EAChCnS,EAAQ3B,EAAM8W,OAAO9Q,EAAI,CAAC,WAAY,QAAS,QAAS,KAAM,SAAU,WAExEpD,EAAYgF,GAAY,WAC1B,OAAOwtC,GAAO+C,EAChB,IACI/wC,EAAUnH,EAAMyD,WAAW4zC,IAC3Br7B,EAAQ,CACV3N,EAAG2rC,GAAsB9mC,aAAqC,EAASA,EAAM7E,GAC7EC,EAAG0rC,GAAsB9mC,aAAqC,EAASA,EAAM5E,IAE3EmE,EAASinC,GAAa,CAAC19B,EAAM3N,EAAG2N,EAAM1N,IAAI,SAAUvI,GACtD,IAAIyD,EAAKzJ,EAAM6E,OAAOmB,EAAI,GACtBq0C,EAAU5wC,EAAG,GACb6wC,EAAU7wC,EAAG,GAEjB,OAAO4wC,GAAWC,EAAU,EAAI,OAClC,IACIvG,EAAiB9zC,EAAM6H,OAAO,MAClC5H,EAAU0kB,UAAU1d,QAAQE,GAAU,iDACtC,IAAI4M,EAAK5M,EACL8tB,EAAOlhB,EAAGkhB,KACVojB,EAAetkC,EAAGskC,aAClBE,EAAcxkC,EAAGwkC,YAIrB,OAHAv4C,EAAMgE,WAAU,WACdq0C,EAAav4C,EAAOg0C,EAAe5vC,QACrC,GAAG,CAACiD,IACG/F,EAAiBwK,cAAcjJ,EAAW5C,EAAM6J,SAAS,CAC9D3H,KAAMgzB,GACLvzB,EAAO,CACR45B,kBAAkB,EAClBpoB,MAAOnT,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGsJ,GAAQ,CAC/C7E,EAAG2N,EAAM3N,EACTC,EAAG0N,EAAM1N,EACTmE,OAAQA,IAEV3H,OAAQA,EACRwuB,OAAQ,SAAgBje,EAAOi/B,GAC7B,IAAIj0C,EAAWi0C,EAAaj0C,SAC5BA,EAAS4uB,IAASsjB,EAAYz4C,EAAOkc,EAAMiZ,GAAMh0B,MAAOoF,EAAS4uB,IACjEklB,SAAkDA,EAAQ9+B,EAAOi/B,EACnE,EACAC,gBAAiB,SAAyBhL,GACxCuE,EAAe5vC,QAAUqrC,CAC3B,EACAtqC,IAAKqE,IACHP,EACN,KAWIyxC,GAAez6C,EAAM6J,SAAS7J,EAAM6J,SAAS,CAC/CS,SAAU66B,IACTtW,IAAalN,IAMZ+4B,GAAS16C,EAAM6J,SAAS7J,EAAM6J,SAAS7J,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAG4wC,IAAev4C,IAAO6lC,IAAiB,CAClHplC,0BAA2BqyC,KAoI7B,IAAI2F,GAA2B,WAC7B,MAAO,CACLC,QAAShuB,GAAY,GACrBiuB,QAASjuB,GAAY,GACrBkuB,gBAAiBluB,GAAY,GAC7BmuB,gBAAiBnuB,GAAY,GAEjC,EAEA,SAASouB,GAAUh1C,QACN,IAAPA,IACFA,EAAK,CAAC,GAGR,IAAIi1C,EAAYj1C,EAAGi1C,UACfrmC,EAAS5O,EAAG4O,OACZ3B,EAAUjT,EAAM8W,OAAO9Q,EAAI,CAAC,YAAa,WAEzC6T,EAASjS,EAAY+yC,IAczB,OAbA52C,GAA0B,WACxB,OAAOzD,EAAIy6B,QAAO,SAAU/0B,GAC1B,IAAIsI,EAAItI,EAAGsI,EACPC,EAAIvI,EAAGuI,EACXsL,EAAO+gC,QAAQ/tC,IAAIyB,EAAEnK,SACrB0V,EAAOihC,gBAAgBjuC,IAAIyB,EAAEguB,UAC7BziB,EAAOghC,QAAQhuC,IAAI0B,EAAEpK,SACrB0V,EAAOkhC,gBAAgBluC,IAAI0B,EAAE+tB,SAC/B,GAAGt8B,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAGoJ,GAAU,CAC7CgoC,WAAYA,aAA6C,EAASA,EAAU92C,eAAYkD,EACxFuN,QAASA,aAAuC,EAASA,EAAOzQ,eAAYkD,IAEhF,GAAG,IACIwS,CACT,CAsBA,SAASqhC,GAAkB78B,GACzB,IAAI88B,EAAmBl7C,EAAM6H,OAAO,GAChCxE,EAAWrD,EAAMyD,WAAWP,GAAqBG,SACrDrD,EAAMgE,WAAU,WACd,IAAIX,EAAJ,CAEA,IAAI83C,EAAwB,SAA+Bp1C,GACzD,IAAIulB,EAAYvlB,EAAGulB,UACd4vB,EAAiBh3C,UAASg3C,EAAiBh3C,QAAUonB,GAC1DlN,EAASkN,EAAY4vB,EAAiBh3C,QACxC,EAGA,OADA5C,EAAuB,QAAE0yB,OAAOmnB,GAAuB,GAChD,WACL,OAAO/6C,EAAKq0B,WAAWT,OAAOmnB,EAChC,CAXoB,CAYtB,GAAG,CAAC/8B,GACN,CAcA,SAASg9B,KAIP,IAAIC,GAAa,EAMbC,EAAoB,GAKpBC,EAAc,IAAIztC,IAClBkb,EAAW,CACb8J,UAAW,SAAmBpvB,GAE5B,OADA63C,EAAYr8B,IAAIxb,GACT,WACO63C,EAAYn7B,OAAO1c,EACjC,CACF,EACAgD,MAAO,SAAef,EAAYupB,GAOhC,GAAImsB,EAAY,CACd,IAAIG,EAAe,GAMnB,OALAD,EAAY16C,SAAQ,SAAU6C,GAC5B83C,EAAa7vC,KAAK+iB,GAAqBhrB,EAAeiC,EAAY,CAChEupB,mBAAoBA,IAExB,IACO9C,QAAQ7L,IAAIi7B,EACrB,CACE,OAAO,IAAIpvB,SAAQ,SAAUC,GAC3BivB,EAAkB3vC,KAAK,CACrB5J,UAAW,CAAC4D,EAAYupB,GACxB7C,QAASA,GAEb,GAEJ,EACAzf,IAAK,SAAajH,GAEhB,OADA1F,EAAU0kB,UAAU02B,EAAY,iHACzBE,EAAY16C,SAAQ,SAAU6C,IA33M3C,SAAmBA,EAAeiC,GAC5BJ,MAAMC,QAAQG,GACTioB,GAAYlqB,EAAeiC,GACH,iBAAfA,EACTioB,GAAYlqB,EAAe,CAACiC,IAEnC+nB,GAAUhqB,EAAeiC,EAE7B,CAo3MQ81C,CAAU/3C,EAAeiC,EAC3B,GACF,EACA4jB,KAAM,WACJgyB,EAAY16C,SAAQ,SAAU6C,IA3nMpC,SAAuBA,GACrBA,EAAcyC,cAAa,SAAUrG,GACnC,OAAOA,EAAMypB,MACf,GACF,CAwnMQ+C,CAAc5oB,EAChB,GACF,EACAuI,MAAO,WAOL,OANAovC,GAAa,EACbC,EAAkBz6C,SAAQ,SAAUkF,GAClC,IAAIhE,EAAYgE,EAAGhE,UACfsqB,EAAUtmB,EAAGsmB,QACjBrD,EAAStiB,MAAM4B,MAAM0gB,EAAUjpB,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAO7C,IAAY,IAAQwqB,KAAKF,EAC/F,IACO,WACLgvB,GAAa,EACbryB,EAASO,MACX,CACF,GAEF,OAAOP,CACT,CAgCA,SAAS0yB,KACP,IAAI1yB,EAAWrhB,EAAYyzC,IAE3B,OADAp7C,EAAMgE,UAAUglB,EAAS/c,MAAO,IACzB+c,CACT,CAEA,IAAI2yB,GAAeD,GAuGnB,IAAIE,GAEJ,WACE,SAASA,IACPrzC,KAAKszC,kBAAoB,IAAI/tC,GAC/B,CAuCA,OA/BA8tC,EAAa12C,UAAU4tB,UAAY,SAAU9J,GAC3C,IAAIqB,EAAQ9hB,KAGZ,OADAA,KAAKszC,kBAAkB38B,IAAI8J,GACpB,WACL,OAAOqB,EAAMwxB,kBAAkBz7B,OAAO4I,EACxC,CACF,EAkBA4yB,EAAa12C,UAAUwB,MAAQ,SAAU2U,EAAOrI,GAC9CzK,KAAKszC,kBAAkBh7C,SAAQ,SAAUmoB,GACvCA,EAAStiB,MAAM2U,EAAMygC,aAAezgC,EAAOrI,EAC7C,GACF,EAEO4oC,CACT,CA3CA,GA6CIG,GAAqB,WACvB,OAAO,IAAIH,EACb,EAiCA,SAASI,KACP,OAAOC,EACT,CAEA,SAASA,GAAgBC,GAClBthB,GAAmB12B,UACxB02B,GAAmB12B,QAAQmmC,YAAa,EACxCzP,GAAmB12B,QAAQqqC,cAC3B2N,SAAwCA,IAC1C,CAoCA,IAAIC,GAAe,WACjB,MAAO,CAAC,CACV,EAEIC,GAAqB14C,GAAc,CACrC+5B,MAAO,WAAkB,EACzBI,mBAAoBpH,GACpBiO,eAAgB,WAA2B,EAC3CC,iBAAkB,WAA6B,EAC/C3G,2BAA4B,WAAuC,EACnEl1B,OAAQ,WAAmB,EAC3B+P,4BAA6BsjC,GAC7Bpe,sBAAuB,SAA+Bse,EAAQ55C,EAAKuQ,GACjE,OAAOA,EAAQspC,aAAa75C,IAAQ,CACtC,EACAkrB,qBAAsB,SAA8BzV,EAASnS,GAC3D,IAAIqU,EAAarU,EAAGqU,WAChBD,EAAgBpU,EAAGoU,cACnBxF,EAAS5U,EAAM8W,OAAO9Q,EAAI,CAAC,aAAc,kBAI7C,OADAmoB,GAAwBhW,EAASvD,EADpB8Z,GAAU9Z,EAAQyF,GAAc,CAAC,EAAGlC,IAE1CnY,EAAM6J,SAAS,CACpBwQ,WAAYA,EACZD,cAAeA,GACdxF,EACL,IAEEvL,GAAiBsQ,GAAmB,CACtCb,4BAA6BsjC,GAC7B5iC,kBAAmB4iC,KA2CrB,IAEII,GAAc,SAAqBhrC,GACrC,OAAOA,EAAQ,KAAQ,EAAIA,EAHd,GAIf,EAEIirC,IAAY,EA6ChB38C,EAAQ48C,gBA50Cc,SAAyB12C,GAC7C,IAAIgD,EAAWhD,EAAGgD,SACdnD,EAASG,EAAGH,OACZ4D,EAAKzD,EAAGY,QACRA,OAAiB,IAAP6C,GAAuBA,EACjC2Z,EAAiBpd,EAAGod,eACpBu5B,EAAkB32C,EAAG22C,gBACrB7oC,EAAK9N,EAAG6vC,sBACRA,OAA+B,IAAP/hC,GAAuBA,EAI/C4hC,EADK11C,EAAM6E,OAAO0wC,KAAkB,GACnB,GAEjBqH,EAAyB38C,EAAMyD,WAAWyE,GAAoButC,YAC9DkH,IAAwBlH,EAAckH,GAC1C,IAAIxe,EAAYkX,KAEZuH,EA7DN,SAAsB7zC,GACpB,IAAI8zC,EAAW,GAKf,OAHA78C,EAAM88C,SAASj8C,QAAQkI,GAAU,SAAU0V,GACrCze,EAAM+8C,eAAet+B,IAAQo+B,EAASlxC,KAAK8S,EACjD,IACOo+B,CACT,CAsDyBG,CAAaj0C,GAChCk0C,EAAmBL,EACnBM,EAAU,IAAIpvC,IAGdqvC,EAAkBn9C,EAAM6H,OAAOo1C,GAE/BG,EAAcp9C,EAAM6H,OAAO,IAAI4E,KAAOvI,QAGtC4sB,EAAkB9wB,EAAM6H,QAAO,GAYnC,GAXA/D,GAA0B,WACxBgtB,EAAgB5sB,SAAU,EAhF9B,SAA2B6E,EAAUq0C,GACnCr0C,EAASlI,SAAQ,SAAU4d,GACzB,IAAIhc,EAAM8zC,GAAY93B,GACtB2+B,EAAYxwC,IAAInK,EAAKgc,EACvB,GACF,CA4EI4+B,CAAkBT,EAAkBQ,GACpCD,EAAgBj5C,QAAU+4C,CAC5B,IACAt+B,IAAiB,WACfmS,EAAgB5sB,SAAU,EAC1Bk5C,EAAY1yB,QACZwyB,EAAQxyB,OACV,IAEIoG,EAAgB5sB,QAClB,OAAO9C,EAAiBwK,cAAcxK,EAAiBk8C,SAAU,KAAML,EAAiBz1B,KAAI,SAAU/I,GACpG,OAAOrd,EAAiBwK,cAAc8pC,GAAe,CACnDjzC,IAAK8zC,GAAY93B,GACjByE,WAAW,EACXvc,UAASA,QAAUS,EACnBwuC,sBAAuBA,GACtBn3B,EACL,KAIFw+B,EAAmBl9C,EAAMgoB,cAAc,GAAIhoB,EAAM6E,OAAOq4C,IAAmB,GAQ3E,IALA,IAAIM,EAAcJ,EAAgBj5C,QAAQsjB,IAAI+uB,IAC1CiH,EAAaZ,EAAiBp1B,IAAI+uB,IAElCkH,EAAaF,EAAYt6C,OAEpBwI,EAAI,EAAGA,EAAIgyC,EAAYhyC,IAAK,CACnC,IAAIhJ,EAAM86C,EAAY9xC,IAEW,IAA7B+xC,EAAWxwC,QAAQvK,IACrBy6C,EAAQh+B,IAAIzc,EAEhB,CAyDA,OArDIi6C,GAAmBQ,EAAQ/sC,OAC7B8sC,EAAmB,IAKrBC,EAAQr8C,SAAQ,SAAU4B,GAExB,IAAiC,IAA7B+6C,EAAWxwC,QAAQvK,GAAvB,CACA,IAAIgc,EAAQ2+B,EAAYn8C,IAAIwB,GAC5B,GAAKgc,EAAL,CACA,IAAIi/B,EAAiBH,EAAYvwC,QAAQvK,GAmBzCw6C,EAAiB/yB,OAAOwzB,EAAgB,EAAGt8C,EAAiBwK,cAAc8pC,GAAe,CACvFjzC,IAAK8zC,GAAY93B,GACjByE,WAAW,EACXC,eApBW,WACXi6B,EAAYh9B,OAAO3d,GACnBy6C,EAAQ98B,OAAO3d,GAEf,IAAIk7C,EAAcR,EAAgBj5C,QAAQ0lC,WAAU,SAAUgU,GAC5D,OAAOA,EAAan7C,MAAQA,CAC9B,IAGA,GAFA06C,EAAgBj5C,QAAQgmB,OAAOyzB,EAAa,IAEvCT,EAAQ/sC,KAAM,CAEjB,GADAgtC,EAAgBj5C,QAAU04C,GACA,IAAtBze,EAAUj6B,QAAmB,OACjCuxC,IACAtyB,GAAkBA,GACpB,CACF,EAMEvd,OAAQA,EACRgwC,sBAAuBA,GACtBn3B,GA1Be,CAFwB,CA6B5C,IAGAw+B,EAAmBA,EAAiBz1B,KAAI,SAAU/I,GAChD,IAAIhc,EAAMgc,EAAMhc,IAChB,OAAOy6C,EAAQvwC,IAAIlK,GAAOgc,EAAQrd,EAAiBwK,cAAc8pC,GAAe,CAC9EjzC,IAAK8zC,GAAY93B,GACjByE,WAAW,EACX0yB,sBAAuBA,GACtBn3B,EACL,IAMOrd,EAAiBwK,cAAcxK,EAAiBk8C,SAAU,KAAMJ,EAAQ/sC,KAAO8sC,EAAmBA,EAAiBz1B,KAAI,SAAU/I,GACtI,OAAOze,EAAM69C,aAAap/B,EAC5B,IACF,EA+sCA5e,EAAQi+C,oBAvnCkB,SAA6B/3C,GACrD,IAAIgD,EAAWhD,EAAGgD,SAIlB,OAHA3H,EAAiB4C,WAAU,WACzB/D,EAAUwnB,SAAQ,EAAO,0GAC3B,GAAG,IACIrmB,EAAiBwK,cAAcirC,GAAa,CACjDntC,GAAI/B,GAAY,WACd,MAAO,OAAO0M,OAAO3K,KACvB,KACCX,EACL,EA8mCAlJ,EAAQ22C,6BAA+BA,GACvC32C,EAAQ+7C,aAAeA,GACvB/7C,EAAQsrC,SAAWA,GACnBtrC,EAAQg3C,YAAcA,GACtBh3C,EAAQqI,mBAAqBA,EAC7BrI,EAAQk+C,WA3hCR,SAAoBh4C,GAClB,IAAIgD,EAAWhD,EAAGgD,SACdvG,EAAWuD,EAAGvD,SACdgH,EAAKzD,EAAGjD,OACRA,OAAgB,IAAP0G,GAAwBA,EAGjCw0C,EADKj+C,EAAM6E,OAAO5E,EAAM6E,UAAUuyC,GAAa50C,IAAY,GAC1C,GAEjBy7C,EAAiBj+C,EAAM6H,YAAOT,GAKlC,IAAKgwC,GAAa50C,GAAW,CAC3B,IAAI6H,EAAW7H,EAAS6H,SACpB6zC,EAAiBn+C,EAAM8W,OAAOrU,EAAU,CAAC,aAE7Cy7C,EAAe/5C,QAAUmG,EACzB9H,EAAa27C,EACf,CAcA,OAZAl+C,EAAMgE,WAAU,WACVozC,GAAa50C,IACfA,IAAW+pB,MAAK,SAAUxmB,GACxB,IAAIsE,EAAWtE,EAAGsE,SAGlB9H,EAFqBxC,EAAM8W,OAAO9Q,EAAI,CAAC,cAGvCk4C,EAAe/5C,QAAUmG,EACzB2zC,GAAY,EACd,GAEJ,GAAG,IACI58C,EAAiBwK,cAAchJ,EAAYkJ,SAAU,CAC1DhM,MAAO,CACLuK,SAAU4zC,EAAe/5C,QACzBpB,OAAQA,IAETiG,EACL,EAo/BAlJ,EAAQs+C,aAhmCR,SAAsBp4C,GACpB,IAAIgD,EAAWhD,EAAGgD,SACd6M,EAAc7P,EAAG6P,YACjB/L,EAAS9J,EAAM8W,OAAO9Q,EAAI,CAAC,WAAY,gBAE3C6P,GAAeD,GAAwBC,IAKvC/L,EAAS9J,EAAM6J,SAAS7J,EAAM6J,SAAS,CAAC,EAAG5J,EAAMyD,WAAWP,IAAuB2G,IAM5ExG,SAAWsE,GAAY,WAC5B,OAAOkC,EAAOxG,QAChB,IAMA,IAAI8D,EAAUnH,EAAMuH,SAAQ,WAC1B,OAAOsC,CACT,GAAG,CAACkW,KAAKC,UAAUnW,EAAOuQ,YAAavQ,EAAO1G,mBAAoB0G,EAAOvG,gBACzE,OAAOlC,EAAiBwK,cAAc1I,EAAoB4I,SAAU,CAClEhM,MAAOqH,GACN4B,EACL,EAmkCAlJ,EAAQqD,oBAAsBA,EAC9BrD,EAAQ0D,cAAgBA,EACxB1D,EAAQ8qB,YAAcA,GACtB9qB,EAAQ8D,gBAAkBA,EAC1B9D,EAAQo6C,QAAUA,GAClBp6C,EAAQsI,yBAA2BA,EACnCtI,EAAQ0d,gBAAkBA,GAC1B1d,EAAQsN,kBAAoBA,EAC5BtN,EAAQ4G,QAAUA,GAClB5G,EAAQ6uB,qBAAuBA,GAC/B7uB,EAAQu7C,kBAAoBA,GAC5Bv7C,EAAQ+uB,WAAaA,GACrB/uB,EAAQm1B,WAAaA,GACrBn1B,EAAQquB,wBAA0BA,GAClCruB,EAAQ42B,UAAYA,GACpB52B,EAAQu+C,yBAjhDR,SAAkC37C,GAChC,OAAOuG,EAAsB2R,GAAsBlY,EAAK,CACtDsT,oBAAoB,GACnBm/B,GAAehQ,GAAwB6P,IAC5C,EA8gDAl1C,EAAQmJ,sBAAwBA,EAChCnJ,EAAQ26C,aAAeA,GACvB36C,EAAQ46C,OAASA,GACjB56C,EAAQgW,YAAcA,GACtBhW,EAAQ+D,UAAYA,EACpB/D,EAAQme,aAAeA,GACvBne,EAAQsO,cAAgBA,GACxBtO,EAAQ4V,kBAAoBA,GAC5B5V,EAAQu1C,EAAIA,GACZv1C,EAAQ6Z,mBAAqBA,GAC7B7Z,EAAQs1C,OAASA,GACjBt1C,EAAQ8sB,YAAcA,GACtB9sB,EAAQqZ,mBAAqBA,GAC7BrZ,EAAQgP,UAAYA,GACpBhP,EAAQ87C,aAAeA,GACvB97C,EAAQ67C,qBAAuBA,GAC/B77C,EAAQo7C,kBAAoBA,GAC5Bp7C,EAAQw+C,SAhXR,WAGE,IAFA,IAAIC,EAAQ,GAEHzf,EAAK,EAAGA,EAAKr2B,UAAUvF,OAAQ47B,IACtCyf,EAAMzf,GAAMr2B,UAAUq2B,GAGxB,IAAI5U,EAAQjqB,EAAM6H,OAAO,GAErB9B,EAAKhG,EAAM6E,OAAO5E,EAAM6E,SAASy5C,EAAMr0B,EAAM/lB,UAAW,GACxD6lB,EAAOhkB,EAAG,GACVw4C,EAAUx4C,EAAG,GAEby4C,EAAWx+C,EAAM+L,aAAY,SAAUuX,GACzC2G,EAAM/lB,QAA0B,iBAATof,EAAoBnjB,EAAUs+C,KAAK,EAAGH,EAAMr7C,OAAQgnB,EAAM/lB,QAAU,GAAKof,EAChGi7B,EAAQD,EAAMr0B,EAAM/lB,SACtB,GAAGnE,EAAMgoB,cAAc,CAACu2B,EAAMr7C,QAASlD,EAAM6E,OAAO05C,IAAQ,IAC5D,MAAO,CAACv0B,EAAMy0B,EAChB,EA+VA3+C,EAAQ6+C,2BAlIR,SAA0BpC,GACxB,IAAIv2C,EAAKhG,EAAM6E,OAAO5E,EAAM6E,SAASy3C,GAAe,GAChD7xC,EAAiB1E,EAAG,GACpB44C,EAAoB54C,EAAG,GAEvBgE,EAAcX,GAAe,CAAC,GAAG,GACjC8O,EAAUvQ,GAAY,WACxB,OAAOy0C,GAAmB,CACxB16C,MAAO,CAAC,EACRqI,YAAaA,GACZ,CACDuyC,aAAcA,GAElB,IAiBA,OAhBAt8C,EAAMgE,WAAU,WAEd,OADAkU,EAAQjM,MAAM,CAAC,GACRiM,EAAQhM,OACjB,GAAG,CAACgM,IACJlY,EAAMgE,WAAU,WACdkU,EAAQrP,SAAS,CACfugB,SAAU,SAAkB9jB,GAC1Bq5C,EAAkB5+C,EAAM6J,SAAS,CAAC,EAAGtE,GACvC,GAEJ,GAAG,CAACq5C,EAAmBzmC,IAMhB,CAACzN,EALa9C,GAAY,WAC/B,OAAO,SAAUi3C,GACf,OAAOlwB,GAAqBxW,EAAS0mC,EACvC,CACF,IAEF,EAoGA/+C,EAAQg/C,2BApER,SAA0BttC,GACxB,IAAIutC,EAAerG,GAAe,GAC9BsG,EAAetG,GAAe,GAC9B/0C,EAAgBF,IAepB,OAdAvD,EAAU0kB,aAAapT,IAAS7N,GAAgB,8GAChDzD,EAAUwnB,QAAQ+0B,GAAW,2FAC7BA,IAAY,EAERjrC,GACFutC,EAAevtC,EAAMC,QAAUstC,EAC/BC,EAAextC,EAAME,QAAUstC,GACtBr7C,IACTo7C,EAAep7C,EAAc8pB,SAAS,SAAU,GAChDuxB,EAAer7C,EAAc8pB,SAAS,SAAU,IAK3C,CACLhc,OAHWkoC,GAAaoF,EAAcvC,IAItC9qC,OAHWioC,GAAaqF,EAAcxC,IAK1C,EA+CA18C,EAAQsb,YAAcA,GACtBtb,EAAQm/C,gBA3NR,WACE,OAAOr3C,EAAYo0C,GACrB,EA0NAl8C,EAAQo/C,iBA9iBR,SAA0Bh6C,GAExB,OADA4Z,IAAS,EAAO,6EACTk8B,GAAU,CACfC,UAAW/1C,GAEf,EA0iBApF,EAAQy1C,eAAiBA,GACzBz1C,EAAQq/C,UAnWR,SAAmBj6C,EAAKc,GACtB,IAAIyD,OAAY,IAAPzD,EAAgB,CAAC,EAAIA,EAC1B6Z,EAAOpW,EAAGoW,KACV/O,EAASrH,EAAGqH,OACZ8P,EAASnX,EAAGmX,OACZ9M,EAAKrK,EAAGoX,KACRA,OAAc,IAAP/M,GAAwBA,EAE/BE,EAAKhU,EAAM6E,OAAO5E,EAAM6E,UAAS,GAAQ,GACzCmc,EAAWjN,EAAG,GACdorC,EAAYprC,EAAG,GAqBnB,OAnBA/T,EAAMgE,WAAU,WACd,IAAI+B,EAEJ,MAAKd,EAAIf,SAAW0c,GAAQI,GAA5B,CAEA,IAOIhO,EAAU,CACZ4M,KAA0E,QAAnE7Z,EAAK6Z,aAAmC,EAASA,EAAK1b,eAA4B,IAAP6B,EAAgBA,OAAKqB,EACvGyJ,OAAQA,EACR8P,OAAmB,SAAXA,EAAoB,MAAQA,GAEtC,OAAOtgB,EAAIiC,OAAO2C,EAAIf,SAZR,WAEZ,OADAi7C,GAAU,GACHv+B,OAAOxZ,EAAY,WACxB,OAAO+3C,GAAU,EACnB,CACF,GAOwCnsC,EAdI,CAe9C,GAAG,CAAC4M,EAAM3a,EAAK4L,EAAQ+P,IAChBI,CACT,EAoUAnhB,EAAQm8C,2BAA6BA,GACrCn8C,EAAQu/C,qBAjNR,WACE,IAAIr5C,EAAKhG,EAAM6E,OAAO0wC,KAAkB,GACpC+J,EAAct5C,EAAG,GACjBwvC,EAAoBxvC,EAAG,GAEvBu5C,EAA+BtD,KAWnC,OAVAh8C,EAAMgE,WAAU,WAId1C,EAAuB,QAAEiqB,YAAW,WAClC,OAAOjqB,EAAuB,QAAEiqB,YAAW,WACzC,OAAOxE,GAAsB7iB,SAAU,CACzC,GACF,GACF,GAAG,CAACqxC,IACG,SAAUn3B,GACfkhC,GAA6B,WAC3Bv4B,GAAsB7iB,SAAU,EAChCm7C,IACAjhC,GACF,GACF,CACF,EA2LAve,EAAQ0/C,aAxzPR,WACE,OAImB,QADFp4C,EAHAnH,EAAMyD,WAAWE,KAIDwD,EAAQ+b,UAD3C,IAAmB/b,CAFnB,EAuzPAtH,EAAQiE,0BAA4BA,EACpCjE,EAAQ2/C,kBAtsBR,SAA2BC,GAGzB,IAFA,IAAI7lC,EAAS,GAEJilB,EAAK,EAAGA,EAAKr2B,UAAUvF,OAAQ47B,IACtCjlB,EAAOilB,EAAK,GAAKr2B,UAAUq2B,GAO7B,IAAI6gB,EAAeD,EAAUx8C,OAE7B,SAAS08C,IAGP,IAFA,IAAItZ,EAAS,GAEJ56B,EAAI,EAAGA,EAAIi0C,EAAcj0C,IAAK,CACrC46B,GAAUoZ,EAAUh0C,GACRmO,EAAOnO,KACR46B,GAAUzsB,EAAOnO,GAAGxK,MACjC,CAEA,OAAOolC,CACT,CAEA,OAAOgT,GAAuBz/B,EAAQ+lC,EACxC,EA6qBA9/C,EAAQ44C,eAAiBA,GACzB54C,EAAQojB,YAAcA,GACtBpjB,EAAQuE,iBAAmBA,EAC3BvE,EAAQiF,uBAAyBA,EACjCjF,EAAQ+/C,mBAhMR,WAME,OALYx+C,EAAiB2K,aAAY,WACvC,IAAI6T,EAAOgb,GAAmB12B,QACzB0b,GACLA,EAAKg0B,WACP,GAAG,GAEL,EA0LA/zC,EAAQk7C,UAAYA,GACpBl7C,EAAQggD,UA7pBR,SAAmBjrC,EAAQ/K,QACV,IAAXA,IACFA,EAAS,CAAC,GAGZ,IAAIxG,EAAWrD,EAAMyD,WAAWP,GAAqBG,SACjDy8C,EAAwB9/C,EAAM6H,OAAO,MACrC/H,EAAQ24C,GAAetqC,GAAcyG,GAAUA,EAAO3T,MAAQ2T,GA0BlE,OAzBA5U,EAAMuH,SAAQ,WACZ,OAAOzH,EAAMksB,QAAO,SAAU1mB,EAAGsH,GAK/B,OAAIvJ,EAAiBuJ,EAAItH,IAErBw6C,EAAsB57C,SACxB47C,EAAsB57C,QAAQqlB,OAGhCu2B,EAAsB57C,QAAU/D,EAAUsG,QAAQ1G,EAAM6J,SAAS7J,EAAM6J,SAAS,CAC9Eoe,KAAMloB,EAAMmB,MACZukB,GAAIlgB,EACJe,SAAUvG,EAAMwG,eACfuD,GAAS,CACVuf,SAAUxc,KAEL9M,EAAMmB,MACf,GACF,GAAG,CAAC8e,KAAKC,UAAUnW,KAxQrB,SAAqB/J,EAAOse,GAC1Bta,GAA0B,WACxB,GAAIqK,GAAcrO,GAAQ,OAAOA,EAAM8rB,SAASxN,EAClD,GAAG,CAACA,GACN,CAqQE2hC,CAAYnrC,GAAQ,SAAUtP,GAC5B,OAAOxF,EAAM8M,IAAI6b,WAAWnjB,GAC9B,IACOxF,CACT,EA4nBAD,EAAQmgD,QA1hBR,WACE,IAAIjrB,EAAO0jB,GAAe,GAI1B,OAHAwC,IAAkB,SAAUgF,GAC1B,OAAOlrB,EAAKnoB,IAAIqzC,EAClB,IACOlrB,CACT,EAqhBAl1B,EAAQ65C,aAAeA,GACvB75C,EAAQ8e,iBAAmBA,GAC3B9e,EAAQqgD,YAjnBR,SAAqBpgD,GACnB,IAAIuG,EAAWoyC,GAAe34C,EAAMwG,eAMpC,OALAtG,EAAMgE,WAAU,WACd,OAAOlE,EAAMkrB,0BAA0B9L,KAAI,SAAUihC,GACnD95C,EAASuG,IAAIuzC,EACf,GACF,GAAG,CAACrgD,IACGuG,CACT,EA0mBAxG,EAAQugD,kBAtjBR,WAEE,OADAvhC,IAAS,EAAO,4DACTk8B,IACT,EAojBAl7C,EAAQ2D,wBAA0BA,EAClC3D,EAAQ6D,cAAgBA,GACxB7D,EAAQuc,YAAcA,E","sources":["webpack://learnstorybook.com/./node_modules/framer-motion/dist/cjs/index.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar tslib = require('tslib');\n\nvar React = require('react');\n\nvar heyListen = require('hey-listen');\n\nvar styleValueTypes = require('style-value-types');\n\nvar popmotion = require('popmotion');\n\nvar sync = require('framesync');\n\nvar dom = require('@motionone/dom');\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\n\nfunction _interopNamespace(e) {\n  if (e && e.__esModule) return e;\n  var n = Object.create(null);\n\n  if (e) {\n    Object.keys(e).forEach(function (k) {\n      if (k !== 'default') {\n        var d = Object.getOwnPropertyDescriptor(e, k);\n        Object.defineProperty(n, k, d.get ? d : {\n          enumerable: true,\n          get: function get() {\n            return e[k];\n          }\n        });\n      }\n    });\n  }\n\n  n[\"default\"] = e;\n  return Object.freeze(n);\n}\n\nvar React__namespace = /*#__PURE__*/_interopNamespace(React);\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar sync__default = /*#__PURE__*/_interopDefaultLegacy(sync);\n/**\n * Browser-safe usage of process\n */\n\n\nvar defaultEnvironment = \"production\";\nvar env = typeof process === \"undefined\" || process.env === undefined ? defaultEnvironment : process.env.NODE_ENV || defaultEnvironment;\n\nvar createDefinition = function createDefinition(propNames) {\n  return {\n    isEnabled: function isEnabled(props) {\n      return propNames.some(function (name) {\n        return !!props[name];\n      });\n    }\n  };\n};\n\nvar featureDefinitions = {\n  measureLayout: createDefinition([\"layout\", \"layoutId\", \"drag\"]),\n  animation: createDefinition([\"animate\", \"exit\", \"variants\", \"whileHover\", \"whileTap\", \"whileFocus\", \"whileDrag\", \"whileInView\"]),\n  exit: createDefinition([\"exit\"]),\n  drag: createDefinition([\"drag\", \"dragControls\"]),\n  focus: createDefinition([\"whileFocus\"]),\n  hover: createDefinition([\"whileHover\", \"onHoverStart\", \"onHoverEnd\"]),\n  tap: createDefinition([\"whileTap\", \"onTap\", \"onTapStart\", \"onTapCancel\"]),\n  pan: createDefinition([\"onPan\", \"onPanStart\", \"onPanSessionStart\", \"onPanEnd\"]),\n  inView: createDefinition([\"whileInView\", \"onViewportEnter\", \"onViewportLeave\"])\n};\n\nfunction loadFeatures(features) {\n  for (var key in features) {\n    if (features[key] === null) continue;\n\n    if (key === \"projectionNodeConstructor\") {\n      featureDefinitions.projectionNodeConstructor = features[key];\n    } else {\n      featureDefinitions[key].Component = features[key];\n    }\n  }\n}\n\nvar LazyContext = React.createContext({\n  strict: false\n});\nvar featureNames = Object.keys(featureDefinitions);\nvar numFeatures = featureNames.length;\n/**\n * Load features via renderless components based on the provided MotionProps.\n */\n\nfunction useFeatures(props, visualElement, preloadedFeatures) {\n  var features = [];\n  var lazyContext = React.useContext(LazyContext);\n  if (!visualElement) return null;\n  /**\n   * If we're in development mode, check to make sure we're not rendering a motion component\n   * as a child of LazyMotion, as this will break the file-size benefits of using it.\n   */\n\n  if (env !== \"production\" && preloadedFeatures && lazyContext.strict) {\n    heyListen.invariant(false, \"You have rendered a `motion` component within a `LazyMotion` component. This will break tree shaking. Import and render a `m` component instead.\");\n  }\n\n  for (var i = 0; i < numFeatures; i++) {\n    var name_1 = featureNames[i];\n    var _a = featureDefinitions[name_1],\n        isEnabled = _a.isEnabled,\n        Component = _a.Component;\n    /**\n     * It might be possible in the future to use this moment to\n     * dynamically request functionality. In initial tests this\n     * was producing a lot of duplication amongst bundles.\n     */\n\n    if (isEnabled(props) && Component) {\n      features.push(React__namespace.createElement(Component, tslib.__assign({\n        key: name_1\n      }, props, {\n        visualElement: visualElement\n      })));\n    }\n  }\n\n  return features;\n}\n/**\n * @public\n */\n\n\nvar MotionConfigContext = React.createContext({\n  transformPagePoint: function transformPagePoint(p) {\n    return p;\n  },\n  isStatic: false,\n  reducedMotion: \"never\"\n});\nvar MotionContext = React.createContext({});\n\nfunction useVisualElementContext() {\n  return React.useContext(MotionContext).visualElement;\n}\n/**\n * @public\n */\n\n\nvar PresenceContext = React.createContext(null);\nvar isBrowser = typeof document !== \"undefined\";\nvar useIsomorphicLayoutEffect = isBrowser ? React.useLayoutEffect : React.useEffect; // Does this device prefer reduced motion? Returns `null` server-side.\n\nvar prefersReducedMotion = {\n  current: null\n};\nvar hasDetected = false;\n\nfunction initPrefersReducedMotion() {\n  hasDetected = true;\n  if (!isBrowser) return;\n\n  if (window.matchMedia) {\n    var motionMediaQuery_1 = window.matchMedia(\"(prefers-reduced-motion)\");\n\n    var setReducedMotionPreferences = function setReducedMotionPreferences() {\n      return prefersReducedMotion.current = motionMediaQuery_1.matches;\n    };\n\n    motionMediaQuery_1.addListener(setReducedMotionPreferences);\n    setReducedMotionPreferences();\n  } else {\n    prefersReducedMotion.current = false;\n  }\n}\n/**\n * A hook that returns `true` if we should be using reduced motion based on the current device's Reduced Motion setting.\n *\n * This can be used to implement changes to your UI based on Reduced Motion. For instance, replacing motion-sickness inducing\n * `x`/`y` animations with `opacity`, disabling the autoplay of background videos, or turning off parallax motion.\n *\n * It will actively respond to changes and re-render your components with the latest setting.\n *\n * ```jsx\n * export function Sidebar({ isOpen }) {\n *   const shouldReduceMotion = useReducedMotion()\n *   const closedX = shouldReduceMotion ? 0 : \"-100%\"\n *\n *   return (\n *     <motion.div animate={{\n *       opacity: isOpen ? 1 : 0,\n *       x: isOpen ? 0 : closedX\n *     }} />\n *   )\n * }\n * ```\n *\n * @return boolean\n *\n * @public\n */\n\n\nfunction useReducedMotion() {\n  /**\n   * Lazy initialisation of prefersReducedMotion\n   */\n  !hasDetected && initPrefersReducedMotion();\n\n  var _a = tslib.__read(React.useState(prefersReducedMotion.current), 1),\n      shouldReduceMotion = _a[0];\n  /**\n   * TODO See if people miss automatically updating shouldReduceMotion setting\n   */\n\n\n  return shouldReduceMotion;\n}\n\nfunction useReducedMotionConfig() {\n  var reducedMotionPreference = useReducedMotion();\n  var reducedMotion = React.useContext(MotionConfigContext).reducedMotion;\n\n  if (reducedMotion === \"never\") {\n    return false;\n  } else if (reducedMotion === \"always\") {\n    return true;\n  } else {\n    return reducedMotionPreference;\n  }\n}\n\nfunction useVisualElement(Component, visualState, props, createVisualElement) {\n  var lazyContext = React.useContext(LazyContext);\n  var parent = useVisualElementContext();\n  var presenceContext = React.useContext(PresenceContext);\n  var shouldReduceMotion = useReducedMotionConfig();\n  var visualElementRef = React.useRef(undefined);\n  /**\n   * If we haven't preloaded a renderer, check to see if we have one lazy-loaded\n   */\n\n  if (!createVisualElement) createVisualElement = lazyContext.renderer;\n\n  if (!visualElementRef.current && createVisualElement) {\n    visualElementRef.current = createVisualElement(Component, {\n      visualState: visualState,\n      parent: parent,\n      props: props,\n      presenceId: presenceContext === null || presenceContext === void 0 ? void 0 : presenceContext.id,\n      blockInitialAnimation: (presenceContext === null || presenceContext === void 0 ? void 0 : presenceContext.initial) === false,\n      shouldReduceMotion: shouldReduceMotion\n    });\n  }\n\n  var visualElement = visualElementRef.current;\n  useIsomorphicLayoutEffect(function () {\n    visualElement === null || visualElement === void 0 ? void 0 : visualElement.syncRender();\n  });\n  React.useEffect(function () {\n    var _a;\n\n    (_a = visualElement === null || visualElement === void 0 ? void 0 : visualElement.animationState) === null || _a === void 0 ? void 0 : _a.animateChanges();\n  });\n  useIsomorphicLayoutEffect(function () {\n    return function () {\n      return visualElement === null || visualElement === void 0 ? void 0 : visualElement.notifyUnmount();\n    };\n  }, []);\n  return visualElement;\n}\n\nfunction isRefObject(ref) {\n  return typeof ref === \"object\" && Object.prototype.hasOwnProperty.call(ref, \"current\");\n}\n/**\n * Creates a ref function that, when called, hydrates the provided\n * external ref and VisualElement.\n */\n\n\nfunction useMotionRef(visualState, visualElement, externalRef) {\n  return React.useCallback(function (instance) {\n    var _a;\n\n    instance && ((_a = visualState.mount) === null || _a === void 0 ? void 0 : _a.call(visualState, instance));\n\n    if (visualElement) {\n      instance ? visualElement.mount(instance) : visualElement.unmount();\n    }\n\n    if (externalRef) {\n      if (typeof externalRef === \"function\") {\n        externalRef(instance);\n      } else if (isRefObject(externalRef)) {\n        externalRef.current = instance;\n      }\n    }\n  },\n  /**\n   * Only pass a new ref callback to React if we've received a visual element\n   * factory. Otherwise we'll be mounting/remounting every time externalRef\n   * or other dependencies change.\n   */\n  [visualElement]);\n}\n/**\n * Decides if the supplied variable is an array of variant labels\n */\n\n\nfunction isVariantLabels(v) {\n  return Array.isArray(v);\n}\n/**\n * Decides if the supplied variable is variant label\n */\n\n\nfunction isVariantLabel(v) {\n  return typeof v === \"string\" || isVariantLabels(v);\n}\n/**\n * Creates an object containing the latest state of every MotionValue on a VisualElement\n */\n\n\nfunction getCurrent(visualElement) {\n  var current = {};\n  visualElement.forEachValue(function (value, key) {\n    return current[key] = value.get();\n  });\n  return current;\n}\n/**\n * Creates an object containing the latest velocity of every MotionValue on a VisualElement\n */\n\n\nfunction getVelocity$1(visualElement) {\n  var velocity = {};\n  visualElement.forEachValue(function (value, key) {\n    return velocity[key] = value.getVelocity();\n  });\n  return velocity;\n}\n\nfunction resolveVariantFromProps(props, definition, custom, currentValues, currentVelocity) {\n  var _a;\n\n  if (currentValues === void 0) {\n    currentValues = {};\n  }\n\n  if (currentVelocity === void 0) {\n    currentVelocity = {};\n  }\n  /**\n   * If the variant definition is a function, resolve.\n   */\n\n\n  if (typeof definition === \"function\") {\n    definition = definition(custom !== null && custom !== void 0 ? custom : props.custom, currentValues, currentVelocity);\n  }\n  /**\n   * If the variant definition is a variant label, or\n   * the function returned a variant label, resolve.\n   */\n\n\n  if (typeof definition === \"string\") {\n    definition = (_a = props.variants) === null || _a === void 0 ? void 0 : _a[definition];\n  }\n  /**\n   * At this point we've resolved both functions and variant labels,\n   * but the resolved variant label might itself have been a function.\n   * If so, resolve. This can only have returned a valid target object.\n   */\n\n\n  if (typeof definition === \"function\") {\n    definition = definition(custom !== null && custom !== void 0 ? custom : props.custom, currentValues, currentVelocity);\n  }\n\n  return definition;\n}\n\nfunction resolveVariant(visualElement, definition, custom) {\n  var props = visualElement.getProps();\n  return resolveVariantFromProps(props, definition, custom !== null && custom !== void 0 ? custom : props.custom, getCurrent(visualElement), getVelocity$1(visualElement));\n}\n\nfunction checkIfControllingVariants(props) {\n  var _a;\n\n  return typeof ((_a = props.animate) === null || _a === void 0 ? void 0 : _a.start) === \"function\" || isVariantLabel(props.initial) || isVariantLabel(props.animate) || isVariantLabel(props.whileHover) || isVariantLabel(props.whileDrag) || isVariantLabel(props.whileTap) || isVariantLabel(props.whileFocus) || isVariantLabel(props.exit);\n}\n\nfunction checkIfVariantNode(props) {\n  return Boolean(checkIfControllingVariants(props) || props.variants);\n}\n\nfunction getCurrentTreeVariants(props, context) {\n  if (checkIfControllingVariants(props)) {\n    var initial = props.initial,\n        animate = props.animate;\n    return {\n      initial: initial === false || isVariantLabel(initial) ? initial : undefined,\n      animate: isVariantLabel(animate) ? animate : undefined\n    };\n  }\n\n  return props.inherit !== false ? context : {};\n}\n\nfunction useCreateMotionContext(props) {\n  var _a = getCurrentTreeVariants(props, React.useContext(MotionContext)),\n      initial = _a.initial,\n      animate = _a.animate;\n\n  return React.useMemo(function () {\n    return {\n      initial: initial,\n      animate: animate\n    };\n  }, [variantLabelsAsDependency(initial), variantLabelsAsDependency(animate)]);\n}\n\nfunction variantLabelsAsDependency(prop) {\n  return Array.isArray(prop) ? prop.join(\" \") : prop;\n}\n/**\n * Creates a constant value over the lifecycle of a component.\n *\n * Even if `useMemo` is provided an empty array as its final argument, it doesn't offer\n * a guarantee that it won't re-run for performance reasons later on. By using `useConstant`\n * you can ensure that initialisers don't execute twice or more.\n */\n\n\nfunction useConstant(init) {\n  var ref = React.useRef(null);\n\n  if (ref.current === null) {\n    ref.current = init();\n  }\n\n  return ref.current;\n}\n/**\n * This should only ever be modified on the client otherwise it'll\n * persist through server requests. If we need instanced states we\n * could lazy-init via root.\n */\n\n\nvar globalProjectionState = {\n  /**\n   * Global flag as to whether the tree has animated since the last time\n   * we resized the window\n   */\n  hasAnimatedSinceResize: true,\n\n  /**\n   * We set this to true once, on the first update. Any nodes added to the tree beyond that\n   * update will be given a `data-projection-id` attribute.\n   */\n  hasEverUpdated: false\n};\nvar id$1 = 1;\n\nfunction useProjectionId() {\n  return useConstant(function () {\n    if (globalProjectionState.hasEverUpdated) {\n      return id$1++;\n    }\n  });\n}\n\nvar LayoutGroupContext = React.createContext({});\n/**\n * Internal, exported only for usage in Framer\n */\n\nvar SwitchLayoutGroupContext = React.createContext({});\n\nfunction useProjection(projectionId, _a, visualElement, ProjectionNodeConstructor) {\n  var _b;\n\n  var layoutId = _a.layoutId,\n      layout = _a.layout,\n      drag = _a.drag,\n      dragConstraints = _a.dragConstraints,\n      layoutScroll = _a.layoutScroll;\n  var initialPromotionConfig = React.useContext(SwitchLayoutGroupContext);\n\n  if (!ProjectionNodeConstructor || !visualElement || (visualElement === null || visualElement === void 0 ? void 0 : visualElement.projection)) {\n    return;\n  }\n\n  visualElement.projection = new ProjectionNodeConstructor(projectionId, visualElement.getLatestValues(), (_b = visualElement.parent) === null || _b === void 0 ? void 0 : _b.projection);\n  visualElement.projection.setOptions({\n    layoutId: layoutId,\n    layout: layout,\n    alwaysMeasureLayout: Boolean(drag) || dragConstraints && isRefObject(dragConstraints),\n    visualElement: visualElement,\n    scheduleRender: function scheduleRender() {\n      return visualElement.scheduleRender();\n    },\n\n    /**\n     * TODO: Update options in an effect. This could be tricky as it'll be too late\n     * to update by the time layout animations run.\n     * We also need to fix this safeToRemove by linking it up to the one returned by usePresence,\n     * ensuring it gets called if there's no potential layout animations.\n     *\n     */\n    animationType: typeof layout === \"string\" ? layout : \"both\",\n    initialPromotionConfig: initialPromotionConfig,\n    layoutScroll: layoutScroll\n  });\n}\n\nvar VisualElementHandler =\n/** @class */\nfunction (_super) {\n  tslib.__extends(VisualElementHandler, _super);\n\n  function VisualElementHandler() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * Update visual element props as soon as we know this update is going to be commited.\n   */\n\n\n  VisualElementHandler.prototype.getSnapshotBeforeUpdate = function () {\n    this.updateProps();\n    return null;\n  };\n\n  VisualElementHandler.prototype.componentDidUpdate = function () {};\n\n  VisualElementHandler.prototype.updateProps = function () {\n    var _a = this.props,\n        visualElement = _a.visualElement,\n        props = _a.props;\n    if (visualElement) visualElement.setProps(props);\n  };\n\n  VisualElementHandler.prototype.render = function () {\n    return this.props.children;\n  };\n\n  return VisualElementHandler;\n}(React__default[\"default\"].Component);\n/**\n * Create a `motion` component.\n *\n * This function accepts a Component argument, which can be either a string (ie \"div\"\n * for `motion.div`), or an actual React component.\n *\n * Alongside this is a config option which provides a way of rendering the provided\n * component \"offline\", or outside the React render cycle.\n */\n\n\nfunction createMotionComponent(_a) {\n  var preloadedFeatures = _a.preloadedFeatures,\n      createVisualElement = _a.createVisualElement,\n      projectionNodeConstructor = _a.projectionNodeConstructor,\n      useRender = _a.useRender,\n      useVisualState = _a.useVisualState,\n      Component = _a.Component;\n  preloadedFeatures && loadFeatures(preloadedFeatures);\n\n  function MotionComponent(props, externalRef) {\n    var layoutId = useLayoutId(props);\n    props = tslib.__assign(tslib.__assign({}, props), {\n      layoutId: layoutId\n    });\n    /**\n     * If we're rendering in a static environment, we only visually update the component\n     * as a result of a React-rerender rather than interactions or animations. This\n     * means we don't need to load additional memory structures like VisualElement,\n     * or any gesture/animation features.\n     */\n\n    var config = React.useContext(MotionConfigContext);\n    var features = null;\n    var context = useCreateMotionContext(props);\n    /**\n     * Create a unique projection ID for this component. If a new component is added\n     * during a layout animation we'll use this to query the DOM and hydrate its ref early, allowing\n     * us to measure it as soon as any layout effect flushes pending layout animations.\n     *\n     * Performance note: It'd be better not to have to search the DOM for these elements.\n     * For newly-entering components it could be enough to only correct treeScale, in which\n     * case we could mount in a scale-correction mode. This wouldn't be enough for\n     * shared element transitions however. Perhaps for those we could revert to a root node\n     * that gets forceRendered and layout animations are triggered on its layout effect.\n     */\n\n    var projectionId = config.isStatic ? undefined : useProjectionId();\n    /**\n     *\n     */\n\n    var visualState = useVisualState(props, config.isStatic);\n\n    if (!config.isStatic && isBrowser) {\n      /**\n       * Create a VisualElement for this component. A VisualElement provides a common\n       * interface to renderer-specific APIs (ie DOM/Three.js etc) as well as\n       * providing a way of rendering to these APIs outside of the React render loop\n       * for more performant animations and interactions\n       */\n      context.visualElement = useVisualElement(Component, visualState, tslib.__assign(tslib.__assign({}, config), props), createVisualElement);\n      useProjection(projectionId, props, context.visualElement, projectionNodeConstructor || featureDefinitions.projectionNodeConstructor);\n      /**\n       * Load Motion gesture and animation features. These are rendered as renderless\n       * components so each feature can optionally make use of React lifecycle methods.\n       */\n\n      features = useFeatures(props, context.visualElement, preloadedFeatures);\n    }\n    /**\n     * The mount order and hierarchy is specific to ensure our element ref\n     * is hydrated by the time features fire their effects.\n     */\n\n\n    return React__namespace.createElement(VisualElementHandler, {\n      visualElement: context.visualElement,\n      props: tslib.__assign(tslib.__assign({}, config), props)\n    }, features, React__namespace.createElement(MotionContext.Provider, {\n      value: context\n    }, useRender(Component, props, projectionId, useMotionRef(visualState, context.visualElement, externalRef), visualState, config.isStatic, context.visualElement)));\n  }\n\n  return React.forwardRef(MotionComponent);\n}\n\nfunction useLayoutId(_a) {\n  var _b;\n\n  var layoutId = _a.layoutId;\n  var layoutGroupId = (_b = React.useContext(LayoutGroupContext)) === null || _b === void 0 ? void 0 : _b.id;\n  return layoutGroupId && layoutId !== undefined ? layoutGroupId + \"-\" + layoutId : layoutId;\n}\n/**\n * Convert any React component into a `motion` component. The provided component\n * **must** use `React.forwardRef` to the underlying DOM component you want to animate.\n *\n * ```jsx\n * const Component = React.forwardRef((props, ref) => {\n *   return <div ref={ref} />\n * })\n *\n * const MotionComponent = motion(Component)\n * ```\n *\n * @public\n */\n\n\nfunction createMotionProxy(createConfig) {\n  function custom(Component, customMotionComponentConfig) {\n    if (customMotionComponentConfig === void 0) {\n      customMotionComponentConfig = {};\n    }\n\n    return createMotionComponent(createConfig(Component, customMotionComponentConfig));\n  }\n\n  if (typeof Proxy === \"undefined\") {\n    return custom;\n  }\n  /**\n   * A cache of generated `motion` components, e.g `motion.div`, `motion.input` etc.\n   * Rather than generating them anew every render.\n   */\n\n\n  var componentCache = new Map();\n  return new Proxy(custom, {\n    /**\n     * Called when `motion` is referenced with a prop: `motion.div`, `motion.input` etc.\n     * The prop name is passed through as `key` and we can use that to generate a `motion`\n     * DOM component with that name.\n     */\n    get: function get(_target, key) {\n      /**\n       * If this element doesn't exist in the component cache, create it and cache.\n       */\n      if (!componentCache.has(key)) {\n        componentCache.set(key, custom(key));\n      }\n\n      return componentCache.get(key);\n    }\n  });\n}\n/**\n * We keep these listed seperately as we use the lowercase tag names as part\n * of the runtime bundle to detect SVG components\n */\n\n\nvar lowercaseSVGElements = [\"animate\", \"circle\", \"defs\", \"desc\", \"ellipse\", \"g\", \"image\", \"line\", \"filter\", \"marker\", \"mask\", \"metadata\", \"path\", \"pattern\", \"polygon\", \"polyline\", \"rect\", \"stop\", \"svg\", \"switch\", \"symbol\", \"text\", \"tspan\", \"use\", \"view\"];\n\nfunction isSVGComponent(Component) {\n  if (\n  /**\n   * If it's not a string, it's a custom React component. Currently we only support\n   * HTML custom React components.\n   */\n  typeof Component !== \"string\" ||\n  /**\n   * If it contains a dash, the element is a custom HTML webcomponent.\n   */\n  Component.includes(\"-\")) {\n    return false;\n  } else if (\n  /**\n   * If it's in our list of lowercase SVG tags, it's an SVG component\n   */\n  lowercaseSVGElements.indexOf(Component) > -1 ||\n  /**\n   * If it contains a capital letter, it's an SVG component\n   */\n  /[A-Z]/.test(Component)) {\n    return true;\n  }\n\n  return false;\n}\n\nvar scaleCorrectors = {};\n\nfunction addScaleCorrector(correctors) {\n  Object.assign(scaleCorrectors, correctors);\n}\n/**\n * A list of all transformable axes. We'll use this list to generated a version\n * of each axes for each transform.\n */\n\n\nvar transformAxes = [\"\", \"X\", \"Y\", \"Z\"];\n/**\n * An ordered array of each transformable value. By default, transform values\n * will be sorted to this order.\n */\n\nvar order = [\"translate\", \"scale\", \"rotate\", \"skew\"];\n/**\n * Generate a list of every possible transform key.\n */\n\nvar transformProps = [\"transformPerspective\", \"x\", \"y\", \"z\"];\norder.forEach(function (operationKey) {\n  return transformAxes.forEach(function (axesKey) {\n    return transformProps.push(operationKey + axesKey);\n  });\n});\n/**\n * A function to use with Array.sort to sort transform keys by their default order.\n */\n\nfunction sortTransformProps(a, b) {\n  return transformProps.indexOf(a) - transformProps.indexOf(b);\n}\n/**\n * A quick lookup for transform props.\n */\n\n\nvar transformPropSet = new Set(transformProps);\n\nfunction isTransformProp(key) {\n  return transformPropSet.has(key);\n}\n/**\n * A quick lookup for transform origin props\n */\n\n\nvar transformOriginProps = new Set([\"originX\", \"originY\", \"originZ\"]);\n\nfunction isTransformOriginProp(key) {\n  return transformOriginProps.has(key);\n}\n\nfunction isForcedMotionValue(key, _a) {\n  var layout = _a.layout,\n      layoutId = _a.layoutId;\n  return isTransformProp(key) || isTransformOriginProp(key) || (layout || layoutId !== undefined) && (!!scaleCorrectors[key] || key === \"opacity\");\n}\n\nvar isMotionValue = function isMotionValue(value) {\n  return Boolean(value !== null && typeof value === \"object\" && value.getVelocity);\n};\n\nvar translateAlias = {\n  x: \"translateX\",\n  y: \"translateY\",\n  z: \"translateZ\",\n  transformPerspective: \"perspective\"\n};\n/**\n * Build a CSS transform style from individual x/y/scale etc properties.\n *\n * This outputs with a default order of transforms/scales/rotations, this can be customised by\n * providing a transformTemplate function.\n */\n\nfunction buildTransform(_a, _b, transformIsDefault, transformTemplate) {\n  var transform = _a.transform,\n      transformKeys = _a.transformKeys;\n  var _c = _b.enableHardwareAcceleration,\n      enableHardwareAcceleration = _c === void 0 ? true : _c,\n      _d = _b.allowTransformNone,\n      allowTransformNone = _d === void 0 ? true : _d; // The transform string we're going to build into.\n\n  var transformString = \"\"; // Transform keys into their default order - this will determine the output order.\n\n  transformKeys.sort(sortTransformProps); // Track whether the defined transform has a defined z so we don't add a\n  // second to enable hardware acceleration\n\n  var transformHasZ = false; // Loop over each transform and build them into transformString\n\n  var numTransformKeys = transformKeys.length;\n\n  for (var i = 0; i < numTransformKeys; i++) {\n    var key = transformKeys[i];\n    transformString += \"\".concat(translateAlias[key] || key, \"(\").concat(transform[key], \") \");\n    if (key === \"z\") transformHasZ = true;\n  }\n\n  if (!transformHasZ && enableHardwareAcceleration) {\n    transformString += \"translateZ(0)\";\n  } else {\n    transformString = transformString.trim();\n  } // If we have a custom `transform` template, pass our transform values and\n  // generated transformString to that before returning\n\n\n  if (transformTemplate) {\n    transformString = transformTemplate(transform, transformIsDefault ? \"\" : transformString);\n  } else if (allowTransformNone && transformIsDefault) {\n    transformString = \"none\";\n  }\n\n  return transformString;\n}\n/**\n * Build a transformOrigin style. Uses the same defaults as the browser for\n * undefined origins.\n */\n\n\nfunction buildTransformOrigin(_a) {\n  var _b = _a.originX,\n      originX = _b === void 0 ? \"50%\" : _b,\n      _c = _a.originY,\n      originY = _c === void 0 ? \"50%\" : _c,\n      _d = _a.originZ,\n      originZ = _d === void 0 ? 0 : _d;\n  return \"\".concat(originX, \" \").concat(originY, \" \").concat(originZ);\n}\n/**\n * Returns true if the provided key is a CSS variable\n */\n\n\nfunction isCSSVariable$1(key) {\n  return key.startsWith(\"--\");\n}\n/**\n * Provided a value and a ValueType, returns the value as that value type.\n */\n\n\nvar getValueAsType = function getValueAsType(value, type) {\n  return type && typeof value === \"number\" ? type.transform(value) : value;\n};\n\nvar int = tslib.__assign(tslib.__assign({}, styleValueTypes.number), {\n  transform: Math.round\n});\n\nvar numberValueTypes = {\n  // Border props\n  borderWidth: styleValueTypes.px,\n  borderTopWidth: styleValueTypes.px,\n  borderRightWidth: styleValueTypes.px,\n  borderBottomWidth: styleValueTypes.px,\n  borderLeftWidth: styleValueTypes.px,\n  borderRadius: styleValueTypes.px,\n  radius: styleValueTypes.px,\n  borderTopLeftRadius: styleValueTypes.px,\n  borderTopRightRadius: styleValueTypes.px,\n  borderBottomRightRadius: styleValueTypes.px,\n  borderBottomLeftRadius: styleValueTypes.px,\n  // Positioning props\n  width: styleValueTypes.px,\n  maxWidth: styleValueTypes.px,\n  height: styleValueTypes.px,\n  maxHeight: styleValueTypes.px,\n  size: styleValueTypes.px,\n  top: styleValueTypes.px,\n  right: styleValueTypes.px,\n  bottom: styleValueTypes.px,\n  left: styleValueTypes.px,\n  // Spacing props\n  padding: styleValueTypes.px,\n  paddingTop: styleValueTypes.px,\n  paddingRight: styleValueTypes.px,\n  paddingBottom: styleValueTypes.px,\n  paddingLeft: styleValueTypes.px,\n  margin: styleValueTypes.px,\n  marginTop: styleValueTypes.px,\n  marginRight: styleValueTypes.px,\n  marginBottom: styleValueTypes.px,\n  marginLeft: styleValueTypes.px,\n  // Transform props\n  rotate: styleValueTypes.degrees,\n  rotateX: styleValueTypes.degrees,\n  rotateY: styleValueTypes.degrees,\n  rotateZ: styleValueTypes.degrees,\n  scale: styleValueTypes.scale,\n  scaleX: styleValueTypes.scale,\n  scaleY: styleValueTypes.scale,\n  scaleZ: styleValueTypes.scale,\n  skew: styleValueTypes.degrees,\n  skewX: styleValueTypes.degrees,\n  skewY: styleValueTypes.degrees,\n  distance: styleValueTypes.px,\n  translateX: styleValueTypes.px,\n  translateY: styleValueTypes.px,\n  translateZ: styleValueTypes.px,\n  x: styleValueTypes.px,\n  y: styleValueTypes.px,\n  z: styleValueTypes.px,\n  perspective: styleValueTypes.px,\n  transformPerspective: styleValueTypes.px,\n  opacity: styleValueTypes.alpha,\n  originX: styleValueTypes.progressPercentage,\n  originY: styleValueTypes.progressPercentage,\n  originZ: styleValueTypes.px,\n  // Misc\n  zIndex: int,\n  // SVG\n  fillOpacity: styleValueTypes.alpha,\n  strokeOpacity: styleValueTypes.alpha,\n  numOctaves: int\n};\n\nfunction buildHTMLStyles(state, latestValues, options, transformTemplate) {\n  var _a;\n\n  var style = state.style,\n      vars = state.vars,\n      transform = state.transform,\n      transformKeys = state.transformKeys,\n      transformOrigin = state.transformOrigin; // Empty the transformKeys array. As we're throwing out refs to its items\n  // this might not be as cheap as suspected. Maybe using the array as a buffer\n  // with a manual incrementation would be better.\n\n  transformKeys.length = 0; // Track whether we encounter any transform or transformOrigin values.\n\n  var hasTransform = false;\n  var hasTransformOrigin = false; // Does the calculated transform essentially equal \"none\"?\n\n  var transformIsNone = true;\n  /**\n   * Loop over all our latest animated values and decide whether to handle them\n   * as a style or CSS variable.\n   *\n   * Transforms and transform origins are kept seperately for further processing.\n   */\n\n  for (var key in latestValues) {\n    var value = latestValues[key];\n    /**\n     * If this is a CSS variable we don't do any further processing.\n     */\n\n    if (isCSSVariable$1(key)) {\n      vars[key] = value;\n      continue;\n    } // Convert the value to its default value type, ie 0 -> \"0px\"\n\n\n    var valueType = numberValueTypes[key];\n    var valueAsType = getValueAsType(value, valueType);\n\n    if (isTransformProp(key)) {\n      // If this is a transform, flag to enable further transform processing\n      hasTransform = true;\n      transform[key] = valueAsType;\n      transformKeys.push(key); // If we already know we have a non-default transform, early return\n\n      if (!transformIsNone) continue; // Otherwise check to see if this is a default transform\n\n      if (value !== ((_a = valueType.default) !== null && _a !== void 0 ? _a : 0)) transformIsNone = false;\n    } else if (isTransformOriginProp(key)) {\n      transformOrigin[key] = valueAsType; // If this is a transform origin, flag and enable further transform-origin processing\n\n      hasTransformOrigin = true;\n    } else {\n      style[key] = valueAsType;\n    }\n  }\n\n  if (hasTransform) {\n    style.transform = buildTransform(state, options, transformIsNone, transformTemplate);\n  } else if (transformTemplate) {\n    style.transform = transformTemplate({}, \"\");\n  } else if (!latestValues.transform && style.transform) {\n    style.transform = \"none\";\n  }\n\n  if (hasTransformOrigin) {\n    style.transformOrigin = buildTransformOrigin(transformOrigin);\n  }\n}\n\nvar createHtmlRenderState = function createHtmlRenderState() {\n  return {\n    style: {},\n    transform: {},\n    transformKeys: [],\n    transformOrigin: {},\n    vars: {}\n  };\n};\n\nfunction copyRawValuesOnly(target, source, props) {\n  for (var key in source) {\n    if (!isMotionValue(source[key]) && !isForcedMotionValue(key, props)) {\n      target[key] = source[key];\n    }\n  }\n}\n\nfunction useInitialMotionValues(_a, visualState, isStatic) {\n  var transformTemplate = _a.transformTemplate;\n  return React.useMemo(function () {\n    var state = createHtmlRenderState();\n    buildHTMLStyles(state, visualState, {\n      enableHardwareAcceleration: !isStatic\n    }, transformTemplate);\n    var vars = state.vars,\n        style = state.style;\n    return tslib.__assign(tslib.__assign({}, vars), style);\n  }, [visualState]);\n}\n\nfunction useStyle(props, visualState, isStatic) {\n  var styleProp = props.style || {};\n  var style = {};\n  /**\n   * Copy non-Motion Values straight into style\n   */\n\n  copyRawValuesOnly(style, styleProp, props);\n  Object.assign(style, useInitialMotionValues(props, visualState, isStatic));\n\n  if (props.transformValues) {\n    style = props.transformValues(style);\n  }\n\n  return style;\n}\n\nfunction useHTMLProps(props, visualState, isStatic) {\n  // The `any` isn't ideal but it is the type of createElement props argument\n  var htmlProps = {};\n  var style = useStyle(props, visualState, isStatic);\n\n  if (Boolean(props.drag) && props.dragListener !== false) {\n    // Disable the ghost element when a user drags\n    htmlProps.draggable = false; // Disable text selection\n\n    style.userSelect = style.WebkitUserSelect = style.WebkitTouchCallout = \"none\"; // Disable scrolling on the draggable direction\n\n    style.touchAction = props.drag === true ? \"none\" : \"pan-\".concat(props.drag === \"x\" ? \"y\" : \"x\");\n  }\n\n  htmlProps.style = style;\n  return htmlProps;\n}\n/**\n * A list of all valid MotionProps.\n *\n * @privateRemarks\n * This doesn't throw if a `MotionProp` name is missing - it should.\n */\n\n\nvar validMotionProps = new Set([\"initial\", \"animate\", \"exit\", \"style\", \"variants\", \"transition\", \"transformTemplate\", \"transformValues\", \"custom\", \"inherit\", \"layout\", \"layoutId\", \"layoutDependency\", \"onLayoutAnimationStart\", \"onLayoutAnimationComplete\", \"onLayoutMeasure\", \"onBeforeLayoutMeasure\", \"onAnimationStart\", \"onAnimationComplete\", \"onUpdate\", \"onDragStart\", \"onDrag\", \"onDragEnd\", \"onMeasureDragConstraints\", \"onDirectionLock\", \"onDragTransitionEnd\", \"drag\", \"dragControls\", \"dragListener\", \"dragConstraints\", \"dragDirectionLock\", \"dragSnapToOrigin\", \"_dragX\", \"_dragY\", \"dragElastic\", \"dragMomentum\", \"dragPropagation\", \"dragTransition\", \"whileDrag\", \"onPan\", \"onPanStart\", \"onPanEnd\", \"onPanSessionStart\", \"onTap\", \"onTapStart\", \"onTapCancel\", \"onHoverStart\", \"onHoverEnd\", \"whileFocus\", \"whileTap\", \"whileHover\", \"whileInView\", \"onViewportEnter\", \"onViewportLeave\", \"viewport\", \"layoutScroll\"]);\n/**\n * Check whether a prop name is a valid `MotionProp` key.\n *\n * @param key - Name of the property to check\n * @returns `true` is key is a valid `MotionProp`.\n *\n * @public\n */\n\nfunction isValidMotionProp(key) {\n  return validMotionProps.has(key);\n}\n\nvar shouldForward = function shouldForward(key) {\n  return !isValidMotionProp(key);\n};\n\nfunction loadExternalIsValidProp(isValidProp) {\n  if (!isValidProp) return; // Explicitly filter our events\n\n  shouldForward = function shouldForward(key) {\n    return key.startsWith(\"on\") ? !isValidMotionProp(key) : isValidProp(key);\n  };\n}\n/**\n * Emotion and Styled Components both allow users to pass through arbitrary props to their components\n * to dynamically generate CSS. They both use the `@emotion/is-prop-valid` package to determine which\n * of these should be passed to the underlying DOM node.\n *\n * However, when styling a Motion component `styled(motion.div)`, both packages pass through *all* props\n * as it's seen as an arbitrary component rather than a DOM node. Motion only allows arbitrary props\n * passed through the `custom` prop so it doesn't *need* the payload or computational overhead of\n * `@emotion/is-prop-valid`, however to fix this problem we need to use it.\n *\n * By making it an optionalDependency we can offer this functionality only in the situations where it's\n * actually required.\n */\n\n\ntry {\n  /**\n   * We attempt to import this package but require won't be defined in esm environments, in that case\n   * isPropValid will have to be provided via `MotionContext`. In a 6.0.0 this should probably be removed\n   * in favour of explicit injection.\n   */\n  loadExternalIsValidProp(require(\"@emotion/is-prop-valid\").default);\n} catch (_a) {// We don't need to actually do anything here - the fallback is the existing `isPropValid`.\n}\n\nfunction filterProps(props, isDom, forwardMotionProps) {\n  var filteredProps = {};\n\n  for (var key in props) {\n    if (shouldForward(key) || forwardMotionProps === true && isValidMotionProp(key) || !isDom && !isValidMotionProp(key) || // If trying to use native HTML drag events, forward drag listeners\n    props[\"draggable\"] && key.startsWith(\"onDrag\")) {\n      filteredProps[key] = props[key];\n    }\n  }\n\n  return filteredProps;\n}\n\nfunction calcOrigin$1(origin, offset, size) {\n  return typeof origin === \"string\" ? origin : styleValueTypes.px.transform(offset + size * origin);\n}\n/**\n * The SVG transform origin defaults are different to CSS and is less intuitive,\n * so we use the measured dimensions of the SVG to reconcile these.\n */\n\n\nfunction calcSVGTransformOrigin(dimensions, originX, originY) {\n  var pxOriginX = calcOrigin$1(originX, dimensions.x, dimensions.width);\n  var pxOriginY = calcOrigin$1(originY, dimensions.y, dimensions.height);\n  return \"\".concat(pxOriginX, \" \").concat(pxOriginY);\n}\n\nvar dashKeys = {\n  offset: \"stroke-dashoffset\",\n  array: \"stroke-dasharray\"\n};\nvar camelKeys = {\n  offset: \"strokeDashoffset\",\n  array: \"strokeDasharray\"\n};\n/**\n * Build SVG path properties. Uses the path's measured length to convert\n * our custom pathLength, pathSpacing and pathOffset into stroke-dashoffset\n * and stroke-dasharray attributes.\n *\n * This function is mutative to reduce per-frame GC.\n */\n\nfunction buildSVGPath(attrs, length, spacing, offset, useDashCase) {\n  if (spacing === void 0) {\n    spacing = 1;\n  }\n\n  if (offset === void 0) {\n    offset = 0;\n  }\n\n  if (useDashCase === void 0) {\n    useDashCase = true;\n  } // Normalise path length by setting SVG attribute pathLength to 1\n\n\n  attrs.pathLength = 1; // We use dash case when setting attributes directly to the DOM node and camel case\n  // when defining props on a React component.\n\n  var keys = useDashCase ? dashKeys : camelKeys; // Build the dash offset\n\n  attrs[keys.offset] = styleValueTypes.px.transform(-offset); // Build the dash array\n\n  var pathLength = styleValueTypes.px.transform(length);\n  var pathSpacing = styleValueTypes.px.transform(spacing);\n  attrs[keys.array] = \"\".concat(pathLength, \" \").concat(pathSpacing);\n}\n/**\n * Build SVG visual attrbutes, like cx and style.transform\n */\n\n\nfunction buildSVGAttrs(state, _a, options, transformTemplate) {\n  var attrX = _a.attrX,\n      attrY = _a.attrY,\n      originX = _a.originX,\n      originY = _a.originY,\n      pathLength = _a.pathLength,\n      _b = _a.pathSpacing,\n      pathSpacing = _b === void 0 ? 1 : _b,\n      _c = _a.pathOffset,\n      pathOffset = _c === void 0 ? 0 : _c,\n      // This is object creation, which we try to avoid per-frame.\n  latest = tslib.__rest(_a, [\"attrX\", \"attrY\", \"originX\", \"originY\", \"pathLength\", \"pathSpacing\", \"pathOffset\"]);\n\n  buildHTMLStyles(state, latest, options, transformTemplate);\n  state.attrs = state.style;\n  state.style = {};\n  var attrs = state.attrs,\n      style = state.style,\n      dimensions = state.dimensions;\n  /**\n   * However, we apply transforms as CSS transforms. So if we detect a transform we take it from attrs\n   * and copy it into style.\n   */\n\n  if (attrs.transform) {\n    if (dimensions) style.transform = attrs.transform;\n    delete attrs.transform;\n  } // Parse transformOrigin\n\n\n  if (dimensions && (originX !== undefined || originY !== undefined || style.transform)) {\n    style.transformOrigin = calcSVGTransformOrigin(dimensions, originX !== undefined ? originX : 0.5, originY !== undefined ? originY : 0.5);\n  } // Treat x/y not as shortcuts but as actual attributes\n\n\n  if (attrX !== undefined) attrs.x = attrX;\n  if (attrY !== undefined) attrs.y = attrY; // Build SVG path if one has been defined\n\n  if (pathLength !== undefined) {\n    buildSVGPath(attrs, pathLength, pathSpacing, pathOffset, false);\n  }\n}\n\nvar createSvgRenderState = function createSvgRenderState() {\n  return tslib.__assign(tslib.__assign({}, createHtmlRenderState()), {\n    attrs: {}\n  });\n};\n\nfunction useSVGProps(props, visualState) {\n  var visualProps = React.useMemo(function () {\n    var state = createSvgRenderState();\n    buildSVGAttrs(state, visualState, {\n      enableHardwareAcceleration: false\n    }, props.transformTemplate);\n    return tslib.__assign(tslib.__assign({}, state.attrs), {\n      style: tslib.__assign({}, state.style)\n    });\n  }, [visualState]);\n\n  if (props.style) {\n    var rawStyles = {};\n    copyRawValuesOnly(rawStyles, props.style, props);\n    visualProps.style = tslib.__assign(tslib.__assign({}, rawStyles), visualProps.style);\n  }\n\n  return visualProps;\n}\n\nfunction createUseRender(forwardMotionProps) {\n  if (forwardMotionProps === void 0) {\n    forwardMotionProps = false;\n  }\n\n  var useRender = function useRender(Component, props, projectionId, ref, _a, isStatic) {\n    var latestValues = _a.latestValues;\n    var useVisualProps = isSVGComponent(Component) ? useSVGProps : useHTMLProps;\n    var visualProps = useVisualProps(props, latestValues, isStatic);\n    var filteredProps = filterProps(props, typeof Component === \"string\", forwardMotionProps);\n\n    var elementProps = tslib.__assign(tslib.__assign(tslib.__assign({}, filteredProps), visualProps), {\n      ref: ref\n    });\n\n    if (projectionId) {\n      elementProps[\"data-projection-id\"] = projectionId;\n    }\n\n    return React.createElement(Component, elementProps);\n  };\n\n  return useRender;\n}\n\nvar CAMEL_CASE_PATTERN = /([a-z])([A-Z])/g;\nvar REPLACE_TEMPLATE = \"$1-$2\";\n/**\n * Convert camelCase to dash-case properties.\n */\n\nvar camelToDash = function camelToDash(str) {\n  return str.replace(CAMEL_CASE_PATTERN, REPLACE_TEMPLATE).toLowerCase();\n};\n\nfunction renderHTML(element, _a, styleProp, projection) {\n  var style = _a.style,\n      vars = _a.vars;\n  Object.assign(element.style, style, projection && projection.getProjectionStyles(styleProp)); // Loop over any CSS variables and assign those.\n\n  for (var key in vars) {\n    element.style.setProperty(key, vars[key]);\n  }\n}\n/**\n * A set of attribute names that are always read/written as camel case.\n */\n\n\nvar camelCaseAttributes = new Set([\"baseFrequency\", \"diffuseConstant\", \"kernelMatrix\", \"kernelUnitLength\", \"keySplines\", \"keyTimes\", \"limitingConeAngle\", \"markerHeight\", \"markerWidth\", \"numOctaves\", \"targetX\", \"targetY\", \"surfaceScale\", \"specularConstant\", \"specularExponent\", \"stdDeviation\", \"tableValues\", \"viewBox\", \"gradientTransform\", \"pathLength\"]);\n\nfunction renderSVG(element, renderState, _styleProp, projection) {\n  renderHTML(element, renderState, undefined, projection);\n\n  for (var key in renderState.attrs) {\n    element.setAttribute(!camelCaseAttributes.has(key) ? camelToDash(key) : key, renderState.attrs[key]);\n  }\n}\n\nfunction scrapeMotionValuesFromProps$1(props) {\n  var style = props.style;\n  var newValues = {};\n\n  for (var key in style) {\n    if (isMotionValue(style[key]) || isForcedMotionValue(key, props)) {\n      newValues[key] = style[key];\n    }\n  }\n\n  return newValues;\n}\n\nfunction scrapeMotionValuesFromProps(props) {\n  var newValues = scrapeMotionValuesFromProps$1(props);\n\n  for (var key in props) {\n    if (isMotionValue(props[key])) {\n      var targetKey = key === \"x\" || key === \"y\" ? \"attr\" + key.toUpperCase() : key;\n      newValues[targetKey] = props[key];\n    }\n  }\n\n  return newValues;\n}\n\nfunction isAnimationControls(v) {\n  return typeof v === \"object\" && typeof v.start === \"function\";\n}\n\nvar isKeyframesTarget = function isKeyframesTarget(v) {\n  return Array.isArray(v);\n};\n\nvar isCustomValue = function isCustomValue(v) {\n  return Boolean(v && typeof v === \"object\" && v.mix && v.toValue);\n};\n\nvar resolveFinalValueInKeyframes = function resolveFinalValueInKeyframes(v) {\n  // TODO maybe throw if v.length - 1 is placeholder token?\n  return isKeyframesTarget(v) ? v[v.length - 1] || 0 : v;\n};\n/**\n * If the provided value is a MotionValue, this returns the actual value, otherwise just the value itself\n *\n * TODO: Remove and move to library\n */\n\n\nfunction resolveMotionValue(value) {\n  var unwrappedValue = isMotionValue(value) ? value.get() : value;\n  return isCustomValue(unwrappedValue) ? unwrappedValue.toValue() : unwrappedValue;\n}\n\nfunction makeState(_a, props, context, presenceContext) {\n  var scrapeMotionValuesFromProps = _a.scrapeMotionValuesFromProps,\n      createRenderState = _a.createRenderState,\n      onMount = _a.onMount;\n  var state = {\n    latestValues: makeLatestValues(props, context, presenceContext, scrapeMotionValuesFromProps),\n    renderState: createRenderState()\n  };\n\n  if (onMount) {\n    state.mount = function (instance) {\n      return onMount(props, instance, state);\n    };\n  }\n\n  return state;\n}\n\nvar makeUseVisualState = function makeUseVisualState(config) {\n  return function (props, isStatic) {\n    var context = React.useContext(MotionContext);\n    var presenceContext = React.useContext(PresenceContext);\n    return isStatic ? makeState(config, props, context, presenceContext) : useConstant(function () {\n      return makeState(config, props, context, presenceContext);\n    });\n  };\n};\n\nfunction makeLatestValues(props, context, presenceContext, scrapeMotionValues) {\n  var values = {};\n  var blockInitialAnimation = (presenceContext === null || presenceContext === void 0 ? void 0 : presenceContext.initial) === false;\n  var motionValues = scrapeMotionValues(props);\n\n  for (var key in motionValues) {\n    values[key] = resolveMotionValue(motionValues[key]);\n  }\n\n  var initial = props.initial,\n      animate = props.animate;\n  var isControllingVariants = checkIfControllingVariants(props);\n  var isVariantNode = checkIfVariantNode(props);\n\n  if (context && isVariantNode && !isControllingVariants && props.inherit !== false) {\n    initial !== null && initial !== void 0 ? initial : initial = context.initial;\n    animate !== null && animate !== void 0 ? animate : animate = context.animate;\n  }\n\n  var initialAnimationIsBlocked = blockInitialAnimation || initial === false;\n  var variantToSet = initialAnimationIsBlocked ? animate : initial;\n\n  if (variantToSet && typeof variantToSet !== \"boolean\" && !isAnimationControls(variantToSet)) {\n    var list = Array.isArray(variantToSet) ? variantToSet : [variantToSet];\n    list.forEach(function (definition) {\n      var resolved = resolveVariantFromProps(props, definition);\n      if (!resolved) return;\n      var transitionEnd = resolved.transitionEnd;\n      resolved.transition;\n\n      var target = tslib.__rest(resolved, [\"transitionEnd\", \"transition\"]);\n\n      for (var key in target) {\n        var valueTarget = target[key];\n\n        if (Array.isArray(valueTarget)) {\n          /**\n           * Take final keyframe if the initial animation is blocked because\n           * we want to initialise at the end of that blocked animation.\n           */\n          var index = initialAnimationIsBlocked ? valueTarget.length - 1 : 0;\n          valueTarget = valueTarget[index];\n        }\n\n        if (valueTarget !== null) {\n          values[key] = valueTarget;\n        }\n      }\n\n      for (var key in transitionEnd) {\n        values[key] = transitionEnd[key];\n      }\n    });\n  }\n\n  return values;\n}\n\nvar svgMotionConfig = {\n  useVisualState: makeUseVisualState({\n    scrapeMotionValuesFromProps: scrapeMotionValuesFromProps,\n    createRenderState: createSvgRenderState,\n    onMount: function onMount(props, instance, _a) {\n      var renderState = _a.renderState,\n          latestValues = _a.latestValues;\n\n      try {\n        renderState.dimensions = typeof instance.getBBox === \"function\" ? instance.getBBox() : instance.getBoundingClientRect();\n      } catch (e) {\n        // Most likely trying to measure an unrendered element under Firefox\n        renderState.dimensions = {\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0\n        };\n      }\n\n      buildSVGAttrs(renderState, latestValues, {\n        enableHardwareAcceleration: false\n      }, props.transformTemplate);\n      renderSVG(instance, renderState);\n    }\n  })\n};\nvar htmlMotionConfig = {\n  useVisualState: makeUseVisualState({\n    scrapeMotionValuesFromProps: scrapeMotionValuesFromProps$1,\n    createRenderState: createHtmlRenderState\n  })\n};\n\nfunction createDomMotionConfig(Component, _a, preloadedFeatures, createVisualElement, projectionNodeConstructor) {\n  var _b = _a.forwardMotionProps,\n      forwardMotionProps = _b === void 0 ? false : _b;\n  var baseConfig = isSVGComponent(Component) ? svgMotionConfig : htmlMotionConfig;\n  return tslib.__assign(tslib.__assign({}, baseConfig), {\n    preloadedFeatures: preloadedFeatures,\n    useRender: createUseRender(forwardMotionProps),\n    createVisualElement: createVisualElement,\n    projectionNodeConstructor: projectionNodeConstructor,\n    Component: Component\n  });\n}\n\nexports.AnimationType = void 0;\n\n(function (AnimationType) {\n  AnimationType[\"Animate\"] = \"animate\";\n  AnimationType[\"Hover\"] = \"whileHover\";\n  AnimationType[\"Tap\"] = \"whileTap\";\n  AnimationType[\"Drag\"] = \"whileDrag\";\n  AnimationType[\"Focus\"] = \"whileFocus\";\n  AnimationType[\"InView\"] = \"whileInView\";\n  AnimationType[\"Exit\"] = \"exit\";\n})(exports.AnimationType || (exports.AnimationType = {}));\n\nfunction addDomEvent(target, eventName, handler, options) {\n  if (options === void 0) {\n    options = {\n      passive: true\n    };\n  }\n\n  target.addEventListener(eventName, handler, options);\n  return function () {\n    return target.removeEventListener(eventName, handler);\n  };\n}\n/**\n * Attaches an event listener directly to the provided DOM element.\n *\n * Bypassing React's event system can be desirable, for instance when attaching non-passive\n * event handlers.\n *\n * ```jsx\n * const ref = useRef(null)\n *\n * useDomEvent(ref, 'wheel', onWheel, { passive: false })\n *\n * return <div ref={ref} />\n * ```\n *\n * @param ref - React.RefObject that's been provided to the element you want to bind the listener to.\n * @param eventName - Name of the event you want listen for.\n * @param handler - Function to fire when receiving the event.\n * @param options - Options to pass to `Event.addEventListener`.\n *\n * @public\n */\n\n\nfunction useDomEvent(ref, eventName, handler, options) {\n  React.useEffect(function () {\n    var element = ref.current;\n\n    if (handler && element) {\n      return addDomEvent(element, eventName, handler, options);\n    }\n  }, [ref, eventName, handler, options]);\n}\n/**\n *\n * @param props\n * @param ref\n * @internal\n */\n\n\nfunction useFocusGesture(_a) {\n  var whileFocus = _a.whileFocus,\n      visualElement = _a.visualElement;\n\n  var onFocus = function onFocus() {\n    var _a;\n\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.Focus, true);\n  };\n\n  var onBlur = function onBlur() {\n    var _a;\n\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.Focus, false);\n  };\n\n  useDomEvent(visualElement, \"focus\", whileFocus ? onFocus : undefined);\n  useDomEvent(visualElement, \"blur\", whileFocus ? onBlur : undefined);\n}\n\nfunction isMouseEvent(event) {\n  // PointerEvent inherits from MouseEvent so we can't use a straight instanceof check.\n  if (typeof PointerEvent !== \"undefined\" && event instanceof PointerEvent) {\n    return !!(event.pointerType === \"mouse\");\n  }\n\n  return event instanceof MouseEvent;\n}\n\nfunction isTouchEvent(event) {\n  var hasTouches = !!event.touches;\n  return hasTouches;\n}\n/**\n * Filters out events not attached to the primary pointer (currently left mouse button)\n * @param eventHandler\n */\n\n\nfunction filterPrimaryPointer(eventHandler) {\n  return function (event) {\n    var isMouseEvent = event instanceof MouseEvent;\n    var isPrimaryPointer = !isMouseEvent || isMouseEvent && event.button === 0;\n\n    if (isPrimaryPointer) {\n      eventHandler(event);\n    }\n  };\n}\n\nvar defaultPagePoint = {\n  pageX: 0,\n  pageY: 0\n};\n\nfunction pointFromTouch(e, pointType) {\n  if (pointType === void 0) {\n    pointType = \"page\";\n  }\n\n  var primaryTouch = e.touches[0] || e.changedTouches[0];\n  var point = primaryTouch || defaultPagePoint;\n  return {\n    x: point[pointType + \"X\"],\n    y: point[pointType + \"Y\"]\n  };\n}\n\nfunction pointFromMouse(point, pointType) {\n  if (pointType === void 0) {\n    pointType = \"page\";\n  }\n\n  return {\n    x: point[pointType + \"X\"],\n    y: point[pointType + \"Y\"]\n  };\n}\n\nfunction extractEventInfo(event, pointType) {\n  if (pointType === void 0) {\n    pointType = \"page\";\n  }\n\n  return {\n    point: isTouchEvent(event) ? pointFromTouch(event, pointType) : pointFromMouse(event, pointType)\n  };\n}\n\nvar wrapHandler = function wrapHandler(handler, shouldFilterPrimaryPointer) {\n  if (shouldFilterPrimaryPointer === void 0) {\n    shouldFilterPrimaryPointer = false;\n  }\n\n  var listener = function listener(event) {\n    return handler(event, extractEventInfo(event));\n  };\n\n  return shouldFilterPrimaryPointer ? filterPrimaryPointer(listener) : listener;\n}; // We check for event support via functions in case they've been mocked by a testing suite.\n\n\nvar supportsPointerEvents = function supportsPointerEvents() {\n  return isBrowser && window.onpointerdown === null;\n};\n\nvar supportsTouchEvents = function supportsTouchEvents() {\n  return isBrowser && window.ontouchstart === null;\n};\n\nvar supportsMouseEvents = function supportsMouseEvents() {\n  return isBrowser && window.onmousedown === null;\n};\n\nvar mouseEventNames = {\n  pointerdown: \"mousedown\",\n  pointermove: \"mousemove\",\n  pointerup: \"mouseup\",\n  pointercancel: \"mousecancel\",\n  pointerover: \"mouseover\",\n  pointerout: \"mouseout\",\n  pointerenter: \"mouseenter\",\n  pointerleave: \"mouseleave\"\n};\nvar touchEventNames = {\n  pointerdown: \"touchstart\",\n  pointermove: \"touchmove\",\n  pointerup: \"touchend\",\n  pointercancel: \"touchcancel\"\n};\n\nfunction getPointerEventName(name) {\n  if (supportsPointerEvents()) {\n    return name;\n  } else if (supportsTouchEvents()) {\n    return touchEventNames[name];\n  } else if (supportsMouseEvents()) {\n    return mouseEventNames[name];\n  }\n\n  return name;\n}\n\nfunction addPointerEvent(target, eventName, handler, options) {\n  return addDomEvent(target, getPointerEventName(eventName), wrapHandler(handler, eventName === \"pointerdown\"), options);\n}\n\nfunction usePointerEvent(ref, eventName, handler, options) {\n  return useDomEvent(ref, getPointerEventName(eventName), handler && wrapHandler(handler, eventName === \"pointerdown\"), options);\n}\n\nfunction createLock(name) {\n  var lock = null;\n  return function () {\n    var openLock = function openLock() {\n      lock = null;\n    };\n\n    if (lock === null) {\n      lock = name;\n      return openLock;\n    }\n\n    return false;\n  };\n}\n\nvar globalHorizontalLock = createLock(\"dragHorizontal\");\nvar globalVerticalLock = createLock(\"dragVertical\");\n\nfunction getGlobalLock(drag) {\n  var lock = false;\n\n  if (drag === \"y\") {\n    lock = globalVerticalLock();\n  } else if (drag === \"x\") {\n    lock = globalHorizontalLock();\n  } else {\n    var openHorizontal_1 = globalHorizontalLock();\n    var openVertical_1 = globalVerticalLock();\n\n    if (openHorizontal_1 && openVertical_1) {\n      lock = function lock() {\n        openHorizontal_1();\n        openVertical_1();\n      };\n    } else {\n      // Release the locks because we don't use them\n      if (openHorizontal_1) openHorizontal_1();\n      if (openVertical_1) openVertical_1();\n    }\n  }\n\n  return lock;\n}\n\nfunction isDragActive() {\n  // Check the gesture lock - if we get it, it means no drag gesture is active\n  // and we can safely fire the tap gesture.\n  var openGestureLock = getGlobalLock(true);\n  if (!openGestureLock) return true;\n  openGestureLock();\n  return false;\n}\n\nfunction createHoverEvent(visualElement, isActive, callback) {\n  return function (event, info) {\n    var _a;\n\n    if (!isMouseEvent(event) || isDragActive()) return;\n    /**\n     * Ensure we trigger animations before firing event callback\n     */\n\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.Hover, isActive);\n    callback === null || callback === void 0 ? void 0 : callback(event, info);\n  };\n}\n\nfunction useHoverGesture(_a) {\n  var onHoverStart = _a.onHoverStart,\n      onHoverEnd = _a.onHoverEnd,\n      whileHover = _a.whileHover,\n      visualElement = _a.visualElement;\n  usePointerEvent(visualElement, \"pointerenter\", onHoverStart || whileHover ? createHoverEvent(visualElement, true, onHoverStart) : undefined, {\n    passive: !onHoverStart\n  });\n  usePointerEvent(visualElement, \"pointerleave\", onHoverEnd || whileHover ? createHoverEvent(visualElement, false, onHoverEnd) : undefined, {\n    passive: !onHoverEnd\n  });\n}\n/**\n * Recursively traverse up the tree to check whether the provided child node\n * is the parent or a descendant of it.\n *\n * @param parent - Element to find\n * @param child - Element to test against parent\n */\n\n\nvar isNodeOrChild = function isNodeOrChild(parent, child) {\n  if (!child) {\n    return false;\n  } else if (parent === child) {\n    return true;\n  } else {\n    return isNodeOrChild(parent, child.parentElement);\n  }\n};\n\nfunction useUnmountEffect(callback) {\n  return React.useEffect(function () {\n    return function () {\n      return callback();\n    };\n  }, []);\n}\n/**\n * @param handlers -\n * @internal\n */\n\n\nfunction useTapGesture(_a) {\n  var onTap = _a.onTap,\n      onTapStart = _a.onTapStart,\n      onTapCancel = _a.onTapCancel,\n      whileTap = _a.whileTap,\n      visualElement = _a.visualElement;\n  var hasPressListeners = onTap || onTapStart || onTapCancel || whileTap;\n  var isPressing = React.useRef(false);\n  var cancelPointerEndListeners = React.useRef(null);\n  /**\n   * Only set listener to passive if there are no external listeners.\n   */\n\n  var eventOptions = {\n    passive: !(onTapStart || onTap || onTapCancel || onPointerDown)\n  };\n\n  function removePointerEndListener() {\n    var _a;\n\n    (_a = cancelPointerEndListeners.current) === null || _a === void 0 ? void 0 : _a.call(cancelPointerEndListeners);\n    cancelPointerEndListeners.current = null;\n  }\n\n  function checkPointerEnd() {\n    var _a;\n\n    removePointerEndListener();\n    isPressing.current = false;\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.Tap, false);\n    return !isDragActive();\n  }\n\n  function onPointerUp(event, info) {\n    if (!checkPointerEnd()) return;\n    /**\n     * We only count this as a tap gesture if the event.target is the same\n     * as, or a child of, this component's element\n     */\n\n    !isNodeOrChild(visualElement.getInstance(), event.target) ? onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info) : onTap === null || onTap === void 0 ? void 0 : onTap(event, info);\n  }\n\n  function onPointerCancel(event, info) {\n    if (!checkPointerEnd()) return;\n    onTapCancel === null || onTapCancel === void 0 ? void 0 : onTapCancel(event, info);\n  }\n\n  function onPointerDown(event, info) {\n    var _a;\n\n    removePointerEndListener();\n    if (isPressing.current) return;\n    isPressing.current = true;\n    cancelPointerEndListeners.current = popmotion.pipe(addPointerEvent(window, \"pointerup\", onPointerUp, eventOptions), addPointerEvent(window, \"pointercancel\", onPointerCancel, eventOptions));\n    /**\n     * Ensure we trigger animations before firing event callback\n     */\n\n    (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.Tap, true);\n    onTapStart === null || onTapStart === void 0 ? void 0 : onTapStart(event, info);\n  }\n\n  usePointerEvent(visualElement, \"pointerdown\", hasPressListeners ? onPointerDown : undefined, eventOptions);\n  useUnmountEffect(removePointerEndListener);\n}\n\nvar warned = new Set();\n\nfunction warnOnce(condition, message, element) {\n  if (condition || warned.has(message)) return;\n  console.warn(message);\n  if (element) console.warn(element);\n  warned.add(message);\n}\n/**\n * Map an IntersectionHandler callback to an element. We only ever make one handler for one\n * element, so even though these handlers might all be triggered by different\n * observers, we can keep them in the same map.\n */\n\n\nvar observerCallbacks = new WeakMap();\n/**\n * Multiple observers can be created for multiple element/document roots. Each with\n * different settings. So here we store dictionaries of observers to each root,\n * using serialised settings (threshold/margin) as lookup keys.\n */\n\nvar observers = new WeakMap();\n\nvar fireObserverCallback = function fireObserverCallback(entry) {\n  var _a;\n\n  (_a = observerCallbacks.get(entry.target)) === null || _a === void 0 ? void 0 : _a(entry);\n};\n\nvar fireAllObserverCallbacks = function fireAllObserverCallbacks(entries) {\n  entries.forEach(fireObserverCallback);\n};\n\nfunction initIntersectionObserver(_a) {\n  var root = _a.root,\n      options = tslib.__rest(_a, [\"root\"]);\n\n  var lookupRoot = root || document;\n  /**\n   * If we don't have an observer lookup map for this root, create one.\n   */\n\n  if (!observers.has(lookupRoot)) {\n    observers.set(lookupRoot, {});\n  }\n\n  var rootObservers = observers.get(lookupRoot);\n  var key = JSON.stringify(options);\n  /**\n   * If we don't have an observer for this combination of root and settings,\n   * create one.\n   */\n\n  if (!rootObservers[key]) {\n    rootObservers[key] = new IntersectionObserver(fireAllObserverCallbacks, tslib.__assign({\n      root: root\n    }, options));\n  }\n\n  return rootObservers[key];\n}\n\nfunction observeIntersection(element, options, callback) {\n  var rootInteresectionObserver = initIntersectionObserver(options);\n  observerCallbacks.set(element, callback);\n  rootInteresectionObserver.observe(element);\n  return function () {\n    observerCallbacks.delete(element);\n    rootInteresectionObserver.unobserve(element);\n  };\n}\n\nfunction useViewport(_a) {\n  var visualElement = _a.visualElement,\n      whileInView = _a.whileInView,\n      onViewportEnter = _a.onViewportEnter,\n      onViewportLeave = _a.onViewportLeave,\n      _b = _a.viewport,\n      viewport = _b === void 0 ? {} : _b;\n  var state = React.useRef({\n    hasEnteredView: false,\n    isInView: false\n  });\n  var shouldObserve = Boolean(whileInView || onViewportEnter || onViewportLeave);\n  if (viewport.once && state.current.hasEnteredView) shouldObserve = false;\n  var useObserver = typeof IntersectionObserver === \"undefined\" ? useMissingIntersectionObserver : useIntersectionObserver;\n  useObserver(shouldObserve, state.current, visualElement, viewport);\n}\n\nvar thresholdNames = {\n  some: 0,\n  all: 1\n};\n\nfunction useIntersectionObserver(shouldObserve, state, visualElement, _a) {\n  var root = _a.root,\n      rootMargin = _a.margin,\n      _b = _a.amount,\n      amount = _b === void 0 ? \"some\" : _b,\n      once = _a.once;\n  React.useEffect(function () {\n    if (!shouldObserve) return;\n    var options = {\n      root: root === null || root === void 0 ? void 0 : root.current,\n      rootMargin: rootMargin,\n      threshold: typeof amount === \"number\" ? amount : thresholdNames[amount]\n    };\n\n    var intersectionCallback = function intersectionCallback(entry) {\n      var _a;\n\n      var isIntersecting = entry.isIntersecting;\n      /**\n       * If there's been no change in the viewport state, early return.\n       */\n\n      if (state.isInView === isIntersecting) return;\n      state.isInView = isIntersecting;\n      /**\n       * Handle hasEnteredView. If this is only meant to run once, and\n       * element isn't visible, early return. Otherwise set hasEnteredView to true.\n       */\n\n      if (once && !isIntersecting && state.hasEnteredView) {\n        return;\n      } else if (isIntersecting) {\n        state.hasEnteredView = true;\n      }\n\n      (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.InView, isIntersecting);\n      /**\n       * Use the latest committed props rather than the ones in scope\n       * when this observer is created\n       */\n\n      var props = visualElement.getProps();\n      var callback = isIntersecting ? props.onViewportEnter : props.onViewportLeave;\n      callback === null || callback === void 0 ? void 0 : callback(entry);\n    };\n\n    return observeIntersection(visualElement.getInstance(), options, intersectionCallback);\n  }, [shouldObserve, root, rootMargin, amount]);\n}\n/**\n * If IntersectionObserver is missing, we activate inView and fire onViewportEnter\n * on mount. This way, the page will be in the state the author expects users\n * to see it in for everyone.\n */\n\n\nfunction useMissingIntersectionObserver(shouldObserve, state, visualElement, _a) {\n  var _b = _a.fallback,\n      fallback = _b === void 0 ? true : _b;\n  React.useEffect(function () {\n    if (!shouldObserve || !fallback) return;\n\n    if (env !== \"production\") {\n      warnOnce(false, \"IntersectionObserver not available on this device. whileInView animations will trigger on mount.\");\n    }\n    /**\n     * Fire this in an rAF because, at this point, the animation state\n     * won't have flushed for the first time and there's certain logic in\n     * there that behaves differently on the initial animation.\n     *\n     * This hook should be quite rarely called so setting this in an rAF\n     * is preferred to changing the behaviour of the animation state.\n     */\n\n\n    requestAnimationFrame(function () {\n      var _a;\n\n      state.hasEnteredView = true;\n      var onViewportEnter = visualElement.getProps().onViewportEnter;\n      onViewportEnter === null || onViewportEnter === void 0 ? void 0 : onViewportEnter(null);\n      (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.InView, true);\n    });\n  }, [shouldObserve]);\n}\n\nvar makeRenderlessComponent = function makeRenderlessComponent(hook) {\n  return function (props) {\n    hook(props);\n    return null;\n  };\n};\n\nvar gestureAnimations = {\n  inView: makeRenderlessComponent(useViewport),\n  tap: makeRenderlessComponent(useTapGesture),\n  focus: makeRenderlessComponent(useFocusGesture),\n  hover: makeRenderlessComponent(useHoverGesture)\n};\nvar counter = 0;\n\nvar incrementId = function incrementId() {\n  return counter++;\n};\n\nvar useId = function useId() {\n  return useConstant(incrementId);\n};\n/**\n * Ideally we'd use the following code to support React 18 optionally.\n * But this fairly fails in Webpack (otherwise treeshaking wouldn't work at all).\n * Need to come up with a different way of figuring this out.\n */\n// export const useId = (React as any).useId\n//     ? (React as any).useId\n//     : () => useConstant(incrementId)\n\n/**\n * When a component is the child of `AnimatePresence`, it can use `usePresence`\n * to access information about whether it's still present in the React tree.\n *\n * ```jsx\n * import { usePresence } from \"framer-motion\"\n *\n * export const Component = () => {\n *   const [isPresent, safeToRemove] = usePresence()\n *\n *   useEffect(() => {\n *     !isPresent && setTimeout(safeToRemove, 1000)\n *   }, [isPresent])\n *\n *   return <div />\n * }\n * ```\n *\n * If `isPresent` is `false`, it means that a component has been removed the tree, but\n * `AnimatePresence` won't really remove it until `safeToRemove` has been called.\n *\n * @public\n */\n\n\nfunction usePresence() {\n  var context = React.useContext(PresenceContext);\n  if (context === null) return [true, null];\n  var isPresent = context.isPresent,\n      onExitComplete = context.onExitComplete,\n      register = context.register; // It's safe to call the following hooks conditionally (after an early return) because the context will always\n  // either be null or non-null for the lifespan of the component.\n  // Replace with useId when released in React\n\n  var id = useId();\n  React.useEffect(function () {\n    return register(id);\n  }, []);\n\n  var safeToRemove = function safeToRemove() {\n    return onExitComplete === null || onExitComplete === void 0 ? void 0 : onExitComplete(id);\n  };\n\n  return !isPresent && onExitComplete ? [false, safeToRemove] : [true];\n}\n/**\n * Similar to `usePresence`, except `useIsPresent` simply returns whether or not the component is present.\n * There is no `safeToRemove` function.\n *\n * ```jsx\n * import { useIsPresent } from \"framer-motion\"\n *\n * export const Component = () => {\n *   const isPresent = useIsPresent()\n *\n *   useEffect(() => {\n *     !isPresent && console.log(\"I've been removed!\")\n *   }, [isPresent])\n *\n *   return <div />\n * }\n * ```\n *\n * @public\n */\n\n\nfunction useIsPresent() {\n  return isPresent(React.useContext(PresenceContext));\n}\n\nfunction isPresent(context) {\n  return context === null ? true : context.isPresent;\n}\n\nfunction shallowCompare(next, prev) {\n  if (!Array.isArray(prev)) return false;\n  var prevLength = prev.length;\n  if (prevLength !== next.length) return false;\n\n  for (var i = 0; i < prevLength; i++) {\n    if (prev[i] !== next[i]) return false;\n  }\n\n  return true;\n}\n/**\n * Converts seconds to milliseconds\n *\n * @param seconds - Time in seconds.\n * @return milliseconds - Converted time in milliseconds.\n */\n\n\nvar secondsToMilliseconds = function secondsToMilliseconds(seconds) {\n  return seconds * 1000;\n};\n\nvar easingLookup = {\n  linear: popmotion.linear,\n  easeIn: popmotion.easeIn,\n  easeInOut: popmotion.easeInOut,\n  easeOut: popmotion.easeOut,\n  circIn: popmotion.circIn,\n  circInOut: popmotion.circInOut,\n  circOut: popmotion.circOut,\n  backIn: popmotion.backIn,\n  backInOut: popmotion.backInOut,\n  backOut: popmotion.backOut,\n  anticipate: popmotion.anticipate,\n  bounceIn: popmotion.bounceIn,\n  bounceInOut: popmotion.bounceInOut,\n  bounceOut: popmotion.bounceOut\n};\n\nvar easingDefinitionToFunction = function easingDefinitionToFunction(definition) {\n  if (Array.isArray(definition)) {\n    // If cubic bezier definition, create bezier curve\n    heyListen.invariant(definition.length === 4, \"Cubic bezier arrays must contain four numerical values.\");\n\n    var _a = tslib.__read(definition, 4),\n        x1 = _a[0],\n        y1 = _a[1],\n        x2 = _a[2],\n        y2 = _a[3];\n\n    return popmotion.cubicBezier(x1, y1, x2, y2);\n  } else if (typeof definition === \"string\") {\n    // Else lookup from table\n    heyListen.invariant(easingLookup[definition] !== undefined, \"Invalid easing type '\".concat(definition, \"'\"));\n    return easingLookup[definition];\n  }\n\n  return definition;\n};\n\nvar isEasingArray = function isEasingArray(ease) {\n  return Array.isArray(ease) && typeof ease[0] !== \"number\";\n};\n/**\n * Check if a value is animatable. Examples:\n *\n * ✅: 100, \"100px\", \"#fff\"\n * ❌: \"block\", \"url(2.jpg)\"\n * @param value\n *\n * @internal\n */\n\n\nvar isAnimatable = function isAnimatable(key, value) {\n  // If the list of keys tat might be non-animatable grows, replace with Set\n  if (key === \"zIndex\") return false; // If it's a number or a keyframes array, we can animate it. We might at some point\n  // need to do a deep isAnimatable check of keyframes, or let Popmotion handle this,\n  // but for now lets leave it like this for performance reasons\n\n  if (typeof value === \"number\" || Array.isArray(value)) return true;\n\n  if (typeof value === \"string\" && // It's animatable if we have a string\n  styleValueTypes.complex.test(value) && // And it contains numbers and/or colors\n  !value.startsWith(\"url(\") // Unless it starts with \"url(\"\n  ) {\n    return true;\n  }\n\n  return false;\n};\n\nvar underDampedSpring = function underDampedSpring() {\n  return {\n    type: \"spring\",\n    stiffness: 500,\n    damping: 25,\n    restSpeed: 10\n  };\n};\n\nvar criticallyDampedSpring = function criticallyDampedSpring(to) {\n  return {\n    type: \"spring\",\n    stiffness: 550,\n    damping: to === 0 ? 2 * Math.sqrt(550) : 30,\n    restSpeed: 10\n  };\n};\n\nvar linearTween = function linearTween() {\n  return {\n    type: \"keyframes\",\n    ease: \"linear\",\n    duration: 0.3\n  };\n};\n\nvar keyframes = function keyframes(values) {\n  return {\n    type: \"keyframes\",\n    duration: 0.8,\n    values: values\n  };\n};\n\nvar defaultTransitions = {\n  x: underDampedSpring,\n  y: underDampedSpring,\n  z: underDampedSpring,\n  rotate: underDampedSpring,\n  rotateX: underDampedSpring,\n  rotateY: underDampedSpring,\n  rotateZ: underDampedSpring,\n  scaleX: criticallyDampedSpring,\n  scaleY: criticallyDampedSpring,\n  scale: criticallyDampedSpring,\n  opacity: linearTween,\n  backgroundColor: linearTween,\n  color: linearTween,\n  default: criticallyDampedSpring\n};\n\nvar getDefaultTransition = function getDefaultTransition(valueKey, to) {\n  var transitionFactory;\n\n  if (isKeyframesTarget(to)) {\n    transitionFactory = keyframes;\n  } else {\n    transitionFactory = defaultTransitions[valueKey] || defaultTransitions.default;\n  }\n\n  return tslib.__assign({\n    to: to\n  }, transitionFactory(to));\n};\n/**\n * A map of default value types for common values\n */\n\n\nvar defaultValueTypes = tslib.__assign(tslib.__assign({}, numberValueTypes), {\n  // Color props\n  color: styleValueTypes.color,\n  backgroundColor: styleValueTypes.color,\n  outlineColor: styleValueTypes.color,\n  fill: styleValueTypes.color,\n  stroke: styleValueTypes.color,\n  // Border props\n  borderColor: styleValueTypes.color,\n  borderTopColor: styleValueTypes.color,\n  borderRightColor: styleValueTypes.color,\n  borderBottomColor: styleValueTypes.color,\n  borderLeftColor: styleValueTypes.color,\n  filter: styleValueTypes.filter,\n  WebkitFilter: styleValueTypes.filter\n});\n/**\n * Gets the default ValueType for the provided value key\n */\n\n\nvar getDefaultValueType = function getDefaultValueType(key) {\n  return defaultValueTypes[key];\n};\n\nfunction getAnimatableNone(key, value) {\n  var _a;\n\n  var defaultValueType = getDefaultValueType(key);\n  if (defaultValueType !== styleValueTypes.filter) defaultValueType = styleValueTypes.complex; // If value is not recognised as animatable, ie \"none\", create an animatable version origin based on the target\n\n  return (_a = defaultValueType.getAnimatableNone) === null || _a === void 0 ? void 0 : _a.call(defaultValueType, value);\n}\n\nvar instantAnimationState = {\n  current: false\n};\n/**\n * Decide whether a transition is defined on a given Transition.\n * This filters out orchestration options and returns true\n * if any options are left.\n */\n\nfunction isTransitionDefined(_a) {\n  _a.when;\n  _a.delay;\n  _a.delayChildren;\n  _a.staggerChildren;\n  _a.staggerDirection;\n  _a.repeat;\n  _a.repeatType;\n  _a.repeatDelay;\n  _a.from;\n\n  var transition = tslib.__rest(_a, [\"when\", \"delay\", \"delayChildren\", \"staggerChildren\", \"staggerDirection\", \"repeat\", \"repeatType\", \"repeatDelay\", \"from\"]);\n\n  return !!Object.keys(transition).length;\n}\n\nvar legacyRepeatWarning = false;\n/**\n * Convert Framer Motion's Transition type into Popmotion-compatible options.\n */\n\nfunction convertTransitionToAnimationOptions(_a) {\n  var ease = _a.ease,\n      times = _a.times,\n      yoyo = _a.yoyo,\n      flip = _a.flip,\n      loop = _a.loop,\n      transition = tslib.__rest(_a, [\"ease\", \"times\", \"yoyo\", \"flip\", \"loop\"]);\n\n  var options = tslib.__assign({}, transition);\n\n  if (times) options[\"offset\"] = times;\n  /**\n   * Convert any existing durations from seconds to milliseconds\n   */\n\n  if (transition.duration) options[\"duration\"] = secondsToMilliseconds(transition.duration);\n  if (transition.repeatDelay) options.repeatDelay = secondsToMilliseconds(transition.repeatDelay);\n  /**\n   * Map easing names to Popmotion's easing functions\n   */\n\n  if (ease) {\n    options[\"ease\"] = isEasingArray(ease) ? ease.map(easingDefinitionToFunction) : easingDefinitionToFunction(ease);\n  }\n  /**\n   * Support legacy transition API\n   */\n\n\n  if (transition.type === \"tween\") options.type = \"keyframes\";\n  /**\n   * TODO: These options are officially removed from the API.\n   */\n\n  if (yoyo || loop || flip) {\n    heyListen.warning(!legacyRepeatWarning, \"yoyo, loop and flip have been removed from the API. Replace with repeat and repeatType options.\");\n    legacyRepeatWarning = true;\n\n    if (yoyo) {\n      options.repeatType = \"reverse\";\n    } else if (loop) {\n      options.repeatType = \"loop\";\n    } else if (flip) {\n      options.repeatType = \"mirror\";\n    }\n\n    options.repeat = loop || yoyo || flip || transition.repeat;\n  }\n  /**\n   * TODO: Popmotion 9 has the ability to automatically detect whether to use\n   * a keyframes or spring animation, but does so by detecting velocity and other spring options.\n   * It'd be good to introduce a similar thing here.\n   */\n\n\n  if (transition.type !== \"spring\") options.type = \"keyframes\";\n  return options;\n}\n/**\n * Get the delay for a value by checking Transition with decreasing specificity.\n */\n\n\nfunction getDelayFromTransition(transition, key) {\n  var _a, _b;\n\n  var valueTransition = getValueTransition(transition, key) || {};\n  return (_b = (_a = valueTransition.delay) !== null && _a !== void 0 ? _a : transition.delay) !== null && _b !== void 0 ? _b : 0;\n}\n\nfunction hydrateKeyframes(options) {\n  if (Array.isArray(options.to) && options.to[0] === null) {\n    options.to = tslib.__spreadArray([], tslib.__read(options.to), false);\n    options.to[0] = options.from;\n  }\n\n  return options;\n}\n\nfunction getPopmotionAnimationOptions(transition, options, key) {\n  var _a;\n\n  if (Array.isArray(options.to)) {\n    (_a = transition.duration) !== null && _a !== void 0 ? _a : transition.duration = 0.8;\n  }\n\n  hydrateKeyframes(options);\n  /**\n   * Get a default transition if none is determined to be defined.\n   */\n\n  if (!isTransitionDefined(transition)) {\n    transition = tslib.__assign(tslib.__assign({}, transition), getDefaultTransition(key, options.to));\n  }\n\n  return tslib.__assign(tslib.__assign({}, options), convertTransitionToAnimationOptions(transition));\n}\n/**\n *\n */\n\n\nfunction getAnimation(key, value, target, transition, onComplete) {\n  var _a;\n\n  var valueTransition = getValueTransition(transition, key);\n  var origin = (_a = valueTransition.from) !== null && _a !== void 0 ? _a : value.get();\n  var isTargetAnimatable = isAnimatable(key, target);\n\n  if (origin === \"none\" && isTargetAnimatable && typeof target === \"string\") {\n    /**\n     * If we're trying to animate from \"none\", try and get an animatable version\n     * of the target. This could be improved to work both ways.\n     */\n    origin = getAnimatableNone(key, target);\n  } else if (isZero(origin) && typeof target === \"string\") {\n    origin = getZeroUnit(target);\n  } else if (!Array.isArray(target) && isZero(target) && typeof origin === \"string\") {\n    target = getZeroUnit(origin);\n  }\n\n  var isOriginAnimatable = isAnimatable(key, origin);\n  heyListen.warning(isOriginAnimatable === isTargetAnimatable, \"You are trying to animate \".concat(key, \" from \\\"\").concat(origin, \"\\\" to \\\"\").concat(target, \"\\\". \").concat(origin, \" is not an animatable value - to enable this animation set \").concat(origin, \" to a value animatable to \").concat(target, \" via the `style` property.\"));\n\n  function start() {\n    var options = {\n      from: origin,\n      to: target,\n      velocity: value.getVelocity(),\n      onComplete: onComplete,\n      onUpdate: function onUpdate(v) {\n        return value.set(v);\n      }\n    };\n    return valueTransition.type === \"inertia\" || valueTransition.type === \"decay\" ? popmotion.inertia(tslib.__assign(tslib.__assign({}, options), valueTransition)) : popmotion.animate(tslib.__assign(tslib.__assign({}, getPopmotionAnimationOptions(valueTransition, options, key)), {\n      onUpdate: function onUpdate(v) {\n        var _a;\n\n        options.onUpdate(v);\n        (_a = valueTransition.onUpdate) === null || _a === void 0 ? void 0 : _a.call(valueTransition, v);\n      },\n      onComplete: function onComplete() {\n        var _a;\n\n        options.onComplete();\n        (_a = valueTransition.onComplete) === null || _a === void 0 ? void 0 : _a.call(valueTransition);\n      }\n    }));\n  }\n\n  function set() {\n    var _a, _b;\n\n    var finalTarget = resolveFinalValueInKeyframes(target);\n    value.set(finalTarget);\n    onComplete();\n    (_a = valueTransition === null || valueTransition === void 0 ? void 0 : valueTransition.onUpdate) === null || _a === void 0 ? void 0 : _a.call(valueTransition, finalTarget);\n    (_b = valueTransition === null || valueTransition === void 0 ? void 0 : valueTransition.onComplete) === null || _b === void 0 ? void 0 : _b.call(valueTransition);\n    return {\n      stop: function stop() {}\n    };\n  }\n\n  return !isOriginAnimatable || !isTargetAnimatable || valueTransition.type === false ? set : start;\n}\n\nfunction isZero(value) {\n  return value === 0 || typeof value === \"string\" && parseFloat(value) === 0 && value.indexOf(\" \") === -1;\n}\n\nfunction getZeroUnit(potentialUnitType) {\n  return typeof potentialUnitType === \"number\" ? 0 : getAnimatableNone(\"\", potentialUnitType);\n}\n\nfunction getValueTransition(transition, key) {\n  return transition[key] || transition[\"default\"] || transition;\n}\n/**\n * Start animation on a MotionValue. This function is an interface between\n * Framer Motion and Popmotion\n */\n\n\nfunction startAnimation(key, value, target, transition) {\n  if (transition === void 0) {\n    transition = {};\n  }\n\n  if (instantAnimationState.current) {\n    transition = {\n      type: false\n    };\n  }\n\n  return value.start(function (onComplete) {\n    var delayTimer;\n    var controls;\n    var animation = getAnimation(key, value, target, transition, onComplete);\n    var delay = getDelayFromTransition(transition, key);\n\n    var start = function start() {\n      return controls = animation();\n    };\n\n    if (delay) {\n      delayTimer = window.setTimeout(start, secondsToMilliseconds(delay));\n    } else {\n      start();\n    }\n\n    return function () {\n      clearTimeout(delayTimer);\n      controls === null || controls === void 0 ? void 0 : controls.stop();\n    };\n  });\n}\n/**\n * Check if value is a numerical string, ie a string that is purely a number eg \"100\" or \"-100.1\"\n */\n\n\nvar isNumericalString = function isNumericalString(v) {\n  return /^\\-?\\d*\\.?\\d+$/.test(v);\n};\n/**\n * Check if the value is a zero value string like \"0px\" or \"0%\"\n */\n\n\nvar isZeroValueString = function isZeroValueString(v) {\n  return /^0[^.\\s]+$/.test(v);\n};\n\nfunction addUniqueItem(arr, item) {\n  arr.indexOf(item) === -1 && arr.push(item);\n}\n\nfunction removeItem(arr, item) {\n  var index = arr.indexOf(item);\n  index > -1 && arr.splice(index, 1);\n} // Adapted from array-move\n\n\nfunction moveItem(_a, fromIndex, toIndex) {\n  var _b = tslib.__read(_a),\n      arr = _b.slice(0);\n\n  var startIndex = fromIndex < 0 ? arr.length + fromIndex : fromIndex;\n\n  if (startIndex >= 0 && startIndex < arr.length) {\n    var endIndex = toIndex < 0 ? arr.length + toIndex : toIndex;\n\n    var _c = tslib.__read(arr.splice(fromIndex, 1), 1),\n        item = _c[0];\n\n    arr.splice(endIndex, 0, item);\n  }\n\n  return arr;\n}\n\nvar SubscriptionManager =\n/** @class */\nfunction () {\n  function SubscriptionManager() {\n    this.subscriptions = [];\n  }\n\n  SubscriptionManager.prototype.add = function (handler) {\n    var _this = this;\n\n    addUniqueItem(this.subscriptions, handler);\n    return function () {\n      return removeItem(_this.subscriptions, handler);\n    };\n  };\n\n  SubscriptionManager.prototype.notify = function (a, b, c) {\n    var numSubscriptions = this.subscriptions.length;\n    if (!numSubscriptions) return;\n\n    if (numSubscriptions === 1) {\n      /**\n       * If there's only a single handler we can just call it without invoking a loop.\n       */\n      this.subscriptions[0](a, b, c);\n    } else {\n      for (var i = 0; i < numSubscriptions; i++) {\n        /**\n         * Check whether the handler exists before firing as it's possible\n         * the subscriptions were modified during this loop running.\n         */\n        var handler = this.subscriptions[i];\n        handler && handler(a, b, c);\n      }\n    }\n  };\n\n  SubscriptionManager.prototype.getSize = function () {\n    return this.subscriptions.length;\n  };\n\n  SubscriptionManager.prototype.clear = function () {\n    this.subscriptions.length = 0;\n  };\n\n  return SubscriptionManager;\n}();\n\nvar isFloat = function isFloat(value) {\n  return !isNaN(parseFloat(value));\n};\n/**\n * `MotionValue` is used to track the state and velocity of motion values.\n *\n * @public\n */\n\n\nvar MotionValue =\n/** @class */\nfunction () {\n  /**\n   * @param init - The initiating value\n   * @param config - Optional configuration options\n   *\n   * -  `transformer`: A function to transform incoming values with.\n   *\n   * @internal\n   */\n  function MotionValue(init) {\n    var _this = this;\n    /**\n     * This will be replaced by the build step with the latest version number.\n     * When MotionValues are provided to motion components, warn if versions are mixed.\n     */\n\n\n    this.version = \"7.0.0\";\n    /**\n     * Duration, in milliseconds, since last updating frame.\n     *\n     * @internal\n     */\n\n    this.timeDelta = 0;\n    /**\n     * Timestamp of the last time this `MotionValue` was updated.\n     *\n     * @internal\n     */\n\n    this.lastUpdated = 0;\n    /**\n     * Functions to notify when the `MotionValue` updates.\n     *\n     * @internal\n     */\n\n    this.updateSubscribers = new SubscriptionManager();\n    /**\n     * Functions to notify when the velocity updates.\n     *\n     * @internal\n     */\n\n    this.velocityUpdateSubscribers = new SubscriptionManager();\n    /**\n     * Functions to notify when the `MotionValue` updates and `render` is set to `true`.\n     *\n     * @internal\n     */\n\n    this.renderSubscribers = new SubscriptionManager();\n    /**\n     * Tracks whether this value can output a velocity. Currently this is only true\n     * if the value is numerical, but we might be able to widen the scope here and support\n     * other value types.\n     *\n     * @internal\n     */\n\n    this.canTrackVelocity = false;\n\n    this.updateAndNotify = function (v, render) {\n      if (render === void 0) {\n        render = true;\n      }\n\n      _this.prev = _this.current;\n      _this.current = v; // Update timestamp\n\n      var _a = sync.getFrameData(),\n          delta = _a.delta,\n          timestamp = _a.timestamp;\n\n      if (_this.lastUpdated !== timestamp) {\n        _this.timeDelta = delta;\n        _this.lastUpdated = timestamp;\n        sync__default[\"default\"].postRender(_this.scheduleVelocityCheck);\n      } // Update update subscribers\n\n\n      if (_this.prev !== _this.current) {\n        _this.updateSubscribers.notify(_this.current);\n      } // Update velocity subscribers\n\n\n      if (_this.velocityUpdateSubscribers.getSize()) {\n        _this.velocityUpdateSubscribers.notify(_this.getVelocity());\n      } // Update render subscribers\n\n\n      if (render) {\n        _this.renderSubscribers.notify(_this.current);\n      }\n    };\n    /**\n     * Schedule a velocity check for the next frame.\n     *\n     * This is an instanced and bound function to prevent generating a new\n     * function once per frame.\n     *\n     * @internal\n     */\n\n\n    this.scheduleVelocityCheck = function () {\n      return sync__default[\"default\"].postRender(_this.velocityCheck);\n    };\n    /**\n     * Updates `prev` with `current` if the value hasn't been updated this frame.\n     * This ensures velocity calculations return `0`.\n     *\n     * This is an instanced and bound function to prevent generating a new\n     * function once per frame.\n     *\n     * @internal\n     */\n\n\n    this.velocityCheck = function (_a) {\n      var timestamp = _a.timestamp;\n\n      if (timestamp !== _this.lastUpdated) {\n        _this.prev = _this.current;\n\n        _this.velocityUpdateSubscribers.notify(_this.getVelocity());\n      }\n    };\n\n    this.hasAnimated = false;\n    this.prev = this.current = init;\n    this.canTrackVelocity = isFloat(this.current);\n  }\n  /**\n   * Adds a function that will be notified when the `MotionValue` is updated.\n   *\n   * It returns a function that, when called, will cancel the subscription.\n   *\n   * When calling `onChange` inside a React component, it should be wrapped with the\n   * `useEffect` hook. As it returns an unsubscribe function, this should be returned\n   * from the `useEffect` function to ensure you don't add duplicate subscribers..\n   *\n   * ```jsx\n   * export const MyComponent = () => {\n   *   const x = useMotionValue(0)\n   *   const y = useMotionValue(0)\n   *   const opacity = useMotionValue(1)\n   *\n   *   useEffect(() => {\n   *     function updateOpacity() {\n   *       const maxXY = Math.max(x.get(), y.get())\n   *       const newOpacity = transform(maxXY, [0, 100], [1, 0])\n   *       opacity.set(newOpacity)\n   *     }\n   *\n   *     const unsubscribeX = x.onChange(updateOpacity)\n   *     const unsubscribeY = y.onChange(updateOpacity)\n   *\n   *     return () => {\n   *       unsubscribeX()\n   *       unsubscribeY()\n   *     }\n   *   }, [])\n   *\n   *   return <motion.div style={{ x }} />\n   * }\n   * ```\n   *\n   * @privateRemarks\n   *\n   * We could look into a `useOnChange` hook if the above lifecycle management proves confusing.\n   *\n   * ```jsx\n   * useOnChange(x, () => {})\n   * ```\n   *\n   * @param subscriber - A function that receives the latest value.\n   * @returns A function that, when called, will cancel this subscription.\n   *\n   * @public\n   */\n\n\n  MotionValue.prototype.onChange = function (subscription) {\n    return this.updateSubscribers.add(subscription);\n  };\n\n  MotionValue.prototype.clearListeners = function () {\n    this.updateSubscribers.clear();\n  };\n  /**\n   * Adds a function that will be notified when the `MotionValue` requests a render.\n   *\n   * @param subscriber - A function that's provided the latest value.\n   * @returns A function that, when called, will cancel this subscription.\n   *\n   * @internal\n   */\n\n\n  MotionValue.prototype.onRenderRequest = function (subscription) {\n    // Render immediately\n    subscription(this.get());\n    return this.renderSubscribers.add(subscription);\n  };\n  /**\n   * Attaches a passive effect to the `MotionValue`.\n   *\n   * @internal\n   */\n\n\n  MotionValue.prototype.attach = function (passiveEffect) {\n    this.passiveEffect = passiveEffect;\n  };\n  /**\n   * Sets the state of the `MotionValue`.\n   *\n   * @remarks\n   *\n   * ```jsx\n   * const x = useMotionValue(0)\n   * x.set(10)\n   * ```\n   *\n   * @param latest - Latest value to set.\n   * @param render - Whether to notify render subscribers. Defaults to `true`\n   *\n   * @public\n   */\n\n\n  MotionValue.prototype.set = function (v, render) {\n    if (render === void 0) {\n      render = true;\n    }\n\n    if (!render || !this.passiveEffect) {\n      this.updateAndNotify(v, render);\n    } else {\n      this.passiveEffect(v, this.updateAndNotify);\n    }\n  };\n  /**\n   * Returns the latest state of `MotionValue`\n   *\n   * @returns - The latest state of `MotionValue`\n   *\n   * @public\n   */\n\n\n  MotionValue.prototype.get = function () {\n    return this.current;\n  };\n  /**\n   * @public\n   */\n\n\n  MotionValue.prototype.getPrevious = function () {\n    return this.prev;\n  };\n  /**\n   * Returns the latest velocity of `MotionValue`\n   *\n   * @returns - The latest velocity of `MotionValue`. Returns `0` if the state is non-numerical.\n   *\n   * @public\n   */\n\n\n  MotionValue.prototype.getVelocity = function () {\n    // This could be isFloat(this.prev) && isFloat(this.current), but that would be wasteful\n    return this.canTrackVelocity ? // These casts could be avoided if parseFloat would be typed better\n    popmotion.velocityPerSecond(parseFloat(this.current) - parseFloat(this.prev), this.timeDelta) : 0;\n  };\n  /**\n   * Registers a new animation to control this `MotionValue`. Only one\n   * animation can drive a `MotionValue` at one time.\n   *\n   * ```jsx\n   * value.start()\n   * ```\n   *\n   * @param animation - A function that starts the provided animation\n   *\n   * @internal\n   */\n\n\n  MotionValue.prototype.start = function (animation) {\n    var _this = this;\n\n    this.stop();\n    return new Promise(function (resolve) {\n      _this.hasAnimated = true;\n      _this.stopAnimation = animation(resolve);\n    }).then(function () {\n      return _this.clearAnimation();\n    });\n  };\n  /**\n   * Stop the currently active animation.\n   *\n   * @public\n   */\n\n\n  MotionValue.prototype.stop = function () {\n    if (this.stopAnimation) this.stopAnimation();\n    this.clearAnimation();\n  };\n  /**\n   * Returns `true` if this value is currently animating.\n   *\n   * @public\n   */\n\n\n  MotionValue.prototype.isAnimating = function () {\n    return !!this.stopAnimation;\n  };\n\n  MotionValue.prototype.clearAnimation = function () {\n    this.stopAnimation = null;\n  };\n  /**\n   * Destroy and clean up subscribers to this `MotionValue`.\n   *\n   * The `MotionValue` hooks like `useMotionValue` and `useTransform` automatically\n   * handle the lifecycle of the returned `MotionValue`, so this method is only necessary if you've manually\n   * created a `MotionValue` via the `motionValue` function.\n   *\n   * @public\n   */\n\n\n  MotionValue.prototype.destroy = function () {\n    this.updateSubscribers.clear();\n    this.renderSubscribers.clear();\n    this.stop();\n  };\n\n  return MotionValue;\n}();\n\nfunction motionValue(init) {\n  return new MotionValue(init);\n}\n/**\n * Tests a provided value against a ValueType\n */\n\n\nvar testValueType = function testValueType(v) {\n  return function (type) {\n    return type.test(v);\n  };\n};\n/**\n * ValueType for \"auto\"\n */\n\n\nvar auto = {\n  test: function test(v) {\n    return v === \"auto\";\n  },\n  parse: function parse(v) {\n    return v;\n  }\n};\n/**\n * A list of value types commonly used for dimensions\n */\n\nvar dimensionValueTypes = [styleValueTypes.number, styleValueTypes.px, styleValueTypes.percent, styleValueTypes.degrees, styleValueTypes.vw, styleValueTypes.vh, auto];\n/**\n * Tests a dimensional value against the list of dimension ValueTypes\n */\n\nvar findDimensionValueType = function findDimensionValueType(v) {\n  return dimensionValueTypes.find(testValueType(v));\n};\n/**\n * A list of all ValueTypes\n */\n\n\nvar valueTypes = tslib.__spreadArray(tslib.__spreadArray([], tslib.__read(dimensionValueTypes), false), [styleValueTypes.color, styleValueTypes.complex], false);\n/**\n * Tests a value against the list of ValueTypes\n */\n\n\nvar findValueType = function findValueType(v) {\n  return valueTypes.find(testValueType(v));\n};\n/**\n * Set VisualElement's MotionValue, creating a new MotionValue for it if\n * it doesn't exist.\n */\n\n\nfunction setMotionValue(visualElement, key, value) {\n  if (visualElement.hasValue(key)) {\n    visualElement.getValue(key).set(value);\n  } else {\n    visualElement.addValue(key, motionValue(value));\n  }\n}\n\nfunction setTarget(visualElement, definition) {\n  var resolved = resolveVariant(visualElement, definition);\n\n  var _a = resolved ? visualElement.makeTargetAnimatable(resolved, false) : {},\n      _b = _a.transitionEnd,\n      transitionEnd = _b === void 0 ? {} : _b;\n\n  _a.transition;\n\n  var target = tslib.__rest(_a, [\"transitionEnd\", \"transition\"]);\n\n  target = tslib.__assign(tslib.__assign({}, target), transitionEnd);\n\n  for (var key in target) {\n    var value = resolveFinalValueInKeyframes(target[key]);\n    setMotionValue(visualElement, key, value);\n  }\n}\n\nfunction setVariants(visualElement, variantLabels) {\n  var reversedLabels = tslib.__spreadArray([], tslib.__read(variantLabels), false).reverse();\n\n  reversedLabels.forEach(function (key) {\n    var _a;\n\n    var variant = visualElement.getVariant(key);\n    variant && setTarget(visualElement, variant);\n    (_a = visualElement.variantChildren) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n      setVariants(child, variantLabels);\n    });\n  });\n}\n\nfunction setValues(visualElement, definition) {\n  if (Array.isArray(definition)) {\n    return setVariants(visualElement, definition);\n  } else if (typeof definition === \"string\") {\n    return setVariants(visualElement, [definition]);\n  } else {\n    setTarget(visualElement, definition);\n  }\n}\n\nfunction checkTargetForNewValues(visualElement, target, origin) {\n  var _a, _b, _c;\n\n  var _d;\n\n  var newValueKeys = Object.keys(target).filter(function (key) {\n    return !visualElement.hasValue(key);\n  });\n  var numNewValues = newValueKeys.length;\n  if (!numNewValues) return;\n\n  for (var i = 0; i < numNewValues; i++) {\n    var key = newValueKeys[i];\n    var targetValue = target[key];\n    var value = null;\n    /**\n     * If the target is a series of keyframes, we can use the first value\n     * in the array. If this first value is null, we'll still need to read from the DOM.\n     */\n\n    if (Array.isArray(targetValue)) {\n      value = targetValue[0];\n    }\n    /**\n     * If the target isn't keyframes, or the first keyframe was null, we need to\n     * first check if an origin value was explicitly defined in the transition as \"from\",\n     * if not read the value from the DOM. As an absolute fallback, take the defined target value.\n     */\n\n\n    if (value === null) {\n      value = (_b = (_a = origin[key]) !== null && _a !== void 0 ? _a : visualElement.readValue(key)) !== null && _b !== void 0 ? _b : target[key];\n    }\n    /**\n     * If value is still undefined or null, ignore it. Preferably this would throw,\n     * but this was causing issues in Framer.\n     */\n\n\n    if (value === undefined || value === null) continue;\n\n    if (typeof value === \"string\" && (isNumericalString(value) || isZeroValueString(value))) {\n      // If this is a number read as a string, ie \"0\" or \"200\", convert it to a number\n      value = parseFloat(value);\n    } else if (!findValueType(value) && styleValueTypes.complex.test(targetValue)) {\n      value = getAnimatableNone(key, targetValue);\n    }\n\n    visualElement.addValue(key, motionValue(value));\n    (_c = (_d = origin)[key]) !== null && _c !== void 0 ? _c : _d[key] = value;\n    visualElement.setBaseTarget(key, value);\n  }\n}\n\nfunction getOriginFromTransition(key, transition) {\n  if (!transition) return;\n  var valueTransition = transition[key] || transition[\"default\"] || transition;\n  return valueTransition.from;\n}\n\nfunction getOrigin(target, transition, visualElement) {\n  var _a, _b;\n\n  var origin = {};\n\n  for (var key in target) {\n    origin[key] = (_a = getOriginFromTransition(key, transition)) !== null && _a !== void 0 ? _a : (_b = visualElement.getValue(key)) === null || _b === void 0 ? void 0 : _b.get();\n  }\n\n  return origin;\n}\n\nfunction animateVisualElement(visualElement, definition, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  visualElement.notifyAnimationStart(definition);\n  var animation;\n\n  if (Array.isArray(definition)) {\n    var animations = definition.map(function (variant) {\n      return animateVariant(visualElement, variant, options);\n    });\n    animation = Promise.all(animations);\n  } else if (typeof definition === \"string\") {\n    animation = animateVariant(visualElement, definition, options);\n  } else {\n    var resolvedDefinition = typeof definition === \"function\" ? resolveVariant(visualElement, definition, options.custom) : definition;\n    animation = animateTarget(visualElement, resolvedDefinition, options);\n  }\n\n  return animation.then(function () {\n    return visualElement.notifyAnimationComplete(definition);\n  });\n}\n\nfunction animateVariant(visualElement, variant, options) {\n  var _a;\n\n  if (options === void 0) {\n    options = {};\n  }\n\n  var resolved = resolveVariant(visualElement, variant, options.custom);\n  var _b = (resolved || {}).transition,\n      transition = _b === void 0 ? visualElement.getDefaultTransition() || {} : _b;\n\n  if (options.transitionOverride) {\n    transition = options.transitionOverride;\n  }\n  /**\n   * If we have a variant, create a callback that runs it as an animation.\n   * Otherwise, we resolve a Promise immediately for a composable no-op.\n   */\n\n\n  var getAnimation = resolved ? function () {\n    return animateTarget(visualElement, resolved, options);\n  } : function () {\n    return Promise.resolve();\n  };\n  /**\n   * If we have children, create a callback that runs all their animations.\n   * Otherwise, we resolve a Promise immediately for a composable no-op.\n   */\n\n  var getChildAnimations = ((_a = visualElement.variantChildren) === null || _a === void 0 ? void 0 : _a.size) ? function (forwardDelay) {\n    if (forwardDelay === void 0) {\n      forwardDelay = 0;\n    }\n\n    var _a = transition.delayChildren,\n        delayChildren = _a === void 0 ? 0 : _a,\n        staggerChildren = transition.staggerChildren,\n        staggerDirection = transition.staggerDirection;\n    return animateChildren(visualElement, variant, delayChildren + forwardDelay, staggerChildren, staggerDirection, options);\n  } : function () {\n    return Promise.resolve();\n  };\n  /**\n   * If the transition explicitly defines a \"when\" option, we need to resolve either\n   * this animation or all children animations before playing the other.\n   */\n\n  var when = transition.when;\n\n  if (when) {\n    var _c = tslib.__read(when === \"beforeChildren\" ? [getAnimation, getChildAnimations] : [getChildAnimations, getAnimation], 2),\n        first = _c[0],\n        last = _c[1];\n\n    return first().then(last);\n  } else {\n    return Promise.all([getAnimation(), getChildAnimations(options.delay)]);\n  }\n}\n/**\n * @internal\n */\n\n\nfunction animateTarget(visualElement, definition, _a) {\n  var _b;\n\n  var _c = _a === void 0 ? {} : _a,\n      _d = _c.delay,\n      delay = _d === void 0 ? 0 : _d,\n      transitionOverride = _c.transitionOverride,\n      type = _c.type;\n\n  var _e = visualElement.makeTargetAnimatable(definition),\n      _f = _e.transition,\n      transition = _f === void 0 ? visualElement.getDefaultTransition() : _f,\n      transitionEnd = _e.transitionEnd,\n      target = tslib.__rest(_e, [\"transition\", \"transitionEnd\"]);\n\n  if (transitionOverride) transition = transitionOverride;\n  var animations = [];\n  var animationTypeState = type && ((_b = visualElement.animationState) === null || _b === void 0 ? void 0 : _b.getState()[type]);\n\n  for (var key in target) {\n    var value = visualElement.getValue(key);\n    var valueTarget = target[key];\n\n    if (!value || valueTarget === undefined || animationTypeState && shouldBlockAnimation(animationTypeState, key)) {\n      continue;\n    }\n\n    var valueTransition = tslib.__assign({\n      delay: delay\n    }, transition);\n    /**\n     * Make animation instant if this is a transform prop and we should reduce motion.\n     */\n\n\n    if (visualElement.shouldReduceMotion && isTransformProp(key)) {\n      valueTransition = tslib.__assign(tslib.__assign({}, valueTransition), {\n        type: false,\n        delay: 0\n      });\n    }\n\n    var animation = startAnimation(key, value, valueTarget, valueTransition);\n    animations.push(animation);\n  }\n\n  return Promise.all(animations).then(function () {\n    transitionEnd && setTarget(visualElement, transitionEnd);\n  });\n}\n\nfunction animateChildren(visualElement, variant, delayChildren, staggerChildren, staggerDirection, options) {\n  if (delayChildren === void 0) {\n    delayChildren = 0;\n  }\n\n  if (staggerChildren === void 0) {\n    staggerChildren = 0;\n  }\n\n  if (staggerDirection === void 0) {\n    staggerDirection = 1;\n  }\n\n  var animations = [];\n  var maxStaggerDuration = (visualElement.variantChildren.size - 1) * staggerChildren;\n  var generateStaggerDuration = staggerDirection === 1 ? function (i) {\n    if (i === void 0) {\n      i = 0;\n    }\n\n    return i * staggerChildren;\n  } : function (i) {\n    if (i === void 0) {\n      i = 0;\n    }\n\n    return maxStaggerDuration - i * staggerChildren;\n  };\n  Array.from(visualElement.variantChildren).sort(sortByTreeOrder).forEach(function (child, i) {\n    animations.push(animateVariant(child, variant, tslib.__assign(tslib.__assign({}, options), {\n      delay: delayChildren + generateStaggerDuration(i)\n    })).then(function () {\n      return child.notifyAnimationComplete(variant);\n    }));\n  });\n  return Promise.all(animations);\n}\n\nfunction stopAnimation(visualElement) {\n  visualElement.forEachValue(function (value) {\n    return value.stop();\n  });\n}\n\nfunction sortByTreeOrder(a, b) {\n  return a.sortNodePosition(b);\n}\n/**\n * Decide whether we should block this animation. Previously, we achieved this\n * just by checking whether the key was listed in protectedKeys, but this\n * posed problems if an animation was triggered by afterChildren and protectedKeys\n * had been set to true in the meantime.\n */\n\n\nfunction shouldBlockAnimation(_a, key) {\n  var protectedKeys = _a.protectedKeys,\n      needsAnimating = _a.needsAnimating;\n  var shouldBlock = protectedKeys.hasOwnProperty(key) && needsAnimating[key] !== true;\n  needsAnimating[key] = false;\n  return shouldBlock;\n}\n\nvar variantPriorityOrder = [exports.AnimationType.Animate, exports.AnimationType.InView, exports.AnimationType.Focus, exports.AnimationType.Hover, exports.AnimationType.Tap, exports.AnimationType.Drag, exports.AnimationType.Exit];\n\nvar reversePriorityOrder = tslib.__spreadArray([], tslib.__read(variantPriorityOrder), false).reverse();\n\nvar numAnimationTypes = variantPriorityOrder.length;\n\nfunction animateList(visualElement) {\n  return function (animations) {\n    return Promise.all(animations.map(function (_a) {\n      var animation = _a.animation,\n          options = _a.options;\n      return animateVisualElement(visualElement, animation, options);\n    }));\n  };\n}\n\nfunction createAnimationState(visualElement) {\n  var animate = animateList(visualElement);\n  var state = createState();\n  var allAnimatedKeys = {};\n  var isInitialRender = true;\n  /**\n   * This function will be used to reduce the animation definitions for\n   * each active animation type into an object of resolved values for it.\n   */\n\n  var buildResolvedTypeValues = function buildResolvedTypeValues(acc, definition) {\n    var resolved = resolveVariant(visualElement, definition);\n\n    if (resolved) {\n      resolved.transition;\n\n      var transitionEnd = resolved.transitionEnd,\n          target = tslib.__rest(resolved, [\"transition\", \"transitionEnd\"]);\n\n      acc = tslib.__assign(tslib.__assign(tslib.__assign({}, acc), target), transitionEnd);\n    }\n\n    return acc;\n  };\n\n  function isAnimated(key) {\n    return allAnimatedKeys[key] !== undefined;\n  }\n  /**\n   * This just allows us to inject mocked animation functions\n   * @internal\n   */\n\n\n  function setAnimateFunction(makeAnimator) {\n    animate = makeAnimator(visualElement);\n  }\n  /**\n   * When we receive new props, we need to:\n   * 1. Create a list of protected keys for each type. This is a directory of\n   *    value keys that are currently being \"handled\" by types of a higher priority\n   *    so that whenever an animation is played of a given type, these values are\n   *    protected from being animated.\n   * 2. Determine if an animation type needs animating.\n   * 3. Determine if any values have been removed from a type and figure out\n   *    what to animate those to.\n   */\n\n\n  function animateChanges(options, changedActiveType) {\n    var _a;\n\n    var props = visualElement.getProps();\n    var context = visualElement.getVariantContext(true) || {};\n    /**\n     * A list of animations that we'll build into as we iterate through the animation\n     * types. This will get executed at the end of the function.\n     */\n\n    var animations = [];\n    /**\n     * Keep track of which values have been removed. Then, as we hit lower priority\n     * animation types, we can check if they contain removed values and animate to that.\n     */\n\n    var removedKeys = new Set();\n    /**\n     * A dictionary of all encountered keys. This is an object to let us build into and\n     * copy it without iteration. Each time we hit an animation type we set its protected\n     * keys - the keys its not allowed to animate - to the latest version of this object.\n     */\n\n    var encounteredKeys = {};\n    /**\n     * If a variant has been removed at a given index, and this component is controlling\n     * variant animations, we want to ensure lower-priority variants are forced to animate.\n     */\n\n    var removedVariantIndex = Infinity;\n\n    var _loop_1 = function _loop_1(i) {\n      var type = reversePriorityOrder[i];\n      var typeState = state[type];\n      var prop = (_a = props[type]) !== null && _a !== void 0 ? _a : context[type];\n      var propIsVariant = isVariantLabel(prop);\n      /**\n       * If this type has *just* changed isActive status, set activeDelta\n       * to that status. Otherwise set to null.\n       */\n\n      var activeDelta = type === changedActiveType ? typeState.isActive : null;\n      if (activeDelta === false) removedVariantIndex = i;\n      /**\n       * If this prop is an inherited variant, rather than been set directly on the\n       * component itself, we want to make sure we allow the parent to trigger animations.\n       *\n       * TODO: Can probably change this to a !isControllingVariants check\n       */\n\n      var isInherited = prop === context[type] && prop !== props[type] && propIsVariant;\n      /**\n       *\n       */\n\n      if (isInherited && isInitialRender && visualElement.manuallyAnimateOnMount) {\n        isInherited = false;\n      }\n      /**\n       * Set all encountered keys so far as the protected keys for this type. This will\n       * be any key that has been animated or otherwise handled by active, higher-priortiy types.\n       */\n\n\n      typeState.protectedKeys = tslib.__assign({}, encounteredKeys); // Check if we can skip analysing this prop early\n\n      if ( // If it isn't active and hasn't *just* been set as inactive\n      !typeState.isActive && activeDelta === null || // If we didn't and don't have any defined prop for this animation type\n      !prop && !typeState.prevProp || // Or if the prop doesn't define an animation\n      isAnimationControls(prop) || typeof prop === \"boolean\") {\n        return \"continue\";\n      }\n      /**\n       * As we go look through the values defined on this type, if we detect\n       * a changed value or a value that was removed in a higher priority, we set\n       * this to true and add this prop to the animation list.\n       */\n\n\n      var variantDidChange = checkVariantsDidChange(typeState.prevProp, prop);\n      var shouldAnimateType = variantDidChange || // If we're making this variant active, we want to always make it active\n      type === changedActiveType && typeState.isActive && !isInherited && propIsVariant || // If we removed a higher-priority variant (i is in reverse order)\n      i > removedVariantIndex && propIsVariant;\n      /**\n       * As animations can be set as variant lists, variants or target objects, we\n       * coerce everything to an array if it isn't one already\n       */\n\n      var definitionList = Array.isArray(prop) ? prop : [prop];\n      /**\n       * Build an object of all the resolved values. We'll use this in the subsequent\n       * animateChanges calls to determine whether a value has changed.\n       */\n\n      var resolvedValues = definitionList.reduce(buildResolvedTypeValues, {});\n      if (activeDelta === false) resolvedValues = {};\n      /**\n       * Now we need to loop through all the keys in the prev prop and this prop,\n       * and decide:\n       * 1. If the value has changed, and needs animating\n       * 2. If it has been removed, and needs adding to the removedKeys set\n       * 3. If it has been removed in a higher priority type and needs animating\n       * 4. If it hasn't been removed in a higher priority but hasn't changed, and\n       *    needs adding to the type's protectedKeys list.\n       */\n\n      var _b = typeState.prevResolvedValues,\n          prevResolvedValues = _b === void 0 ? {} : _b;\n\n      var allKeys = tslib.__assign(tslib.__assign({}, prevResolvedValues), resolvedValues);\n\n      var markToAnimate = function markToAnimate(key) {\n        shouldAnimateType = true;\n        removedKeys.delete(key);\n        typeState.needsAnimating[key] = true;\n      };\n\n      for (var key in allKeys) {\n        var next = resolvedValues[key];\n        var prev = prevResolvedValues[key]; // If we've already handled this we can just skip ahead\n\n        if (encounteredKeys.hasOwnProperty(key)) continue;\n        /**\n         * If the value has changed, we probably want to animate it.\n         */\n\n        if (next !== prev) {\n          /**\n           * If both values are keyframes, we need to shallow compare them to\n           * detect whether any value has changed. If it has, we animate it.\n           */\n          if (isKeyframesTarget(next) && isKeyframesTarget(prev)) {\n            if (!shallowCompare(next, prev) || variantDidChange) {\n              markToAnimate(key);\n            } else {\n              /**\n               * If it hasn't changed, we want to ensure it doesn't animate by\n               * adding it to the list of protected keys.\n               */\n              typeState.protectedKeys[key] = true;\n            }\n          } else if (next !== undefined) {\n            // If next is defined and doesn't equal prev, it needs animating\n            markToAnimate(key);\n          } else {\n            // If it's undefined, it's been removed.\n            removedKeys.add(key);\n          }\n        } else if (next !== undefined && removedKeys.has(key)) {\n          /**\n           * If next hasn't changed and it isn't undefined, we want to check if it's\n           * been removed by a higher priority\n           */\n          markToAnimate(key);\n        } else {\n          /**\n           * If it hasn't changed, we add it to the list of protected values\n           * to ensure it doesn't get animated.\n           */\n          typeState.protectedKeys[key] = true;\n        }\n      }\n      /**\n       * Update the typeState so next time animateChanges is called we can compare the\n       * latest prop and resolvedValues to these.\n       */\n\n\n      typeState.prevProp = prop;\n      typeState.prevResolvedValues = resolvedValues;\n      /**\n       *\n       */\n\n      if (typeState.isActive) {\n        encounteredKeys = tslib.__assign(tslib.__assign({}, encounteredKeys), resolvedValues);\n      }\n\n      if (isInitialRender && visualElement.blockInitialAnimation) {\n        shouldAnimateType = false;\n      }\n      /**\n       * If this is an inherited prop we want to hard-block animations\n       * TODO: Test as this should probably still handle animations triggered\n       * by removed values?\n       */\n\n\n      if (shouldAnimateType && !isInherited) {\n        animations.push.apply(animations, tslib.__spreadArray([], tslib.__read(definitionList.map(function (animation) {\n          return {\n            animation: animation,\n            options: tslib.__assign({\n              type: type\n            }, options)\n          };\n        })), false));\n      }\n    };\n    /**\n     * Iterate through all animation types in reverse priority order. For each, we want to\n     * detect which values it's handling and whether or not they've changed (and therefore\n     * need to be animated). If any values have been removed, we want to detect those in\n     * lower priority props and flag for animation.\n     */\n\n\n    for (var i = 0; i < numAnimationTypes; i++) {\n      _loop_1(i);\n    }\n\n    allAnimatedKeys = tslib.__assign({}, encounteredKeys);\n    /**\n     * If there are some removed value that haven't been dealt with,\n     * we need to create a new animation that falls back either to the value\n     * defined in the style prop, or the last read value.\n     */\n\n    if (removedKeys.size) {\n      var fallbackAnimation_1 = {};\n      removedKeys.forEach(function (key) {\n        var fallbackTarget = visualElement.getBaseTarget(key);\n\n        if (fallbackTarget !== undefined) {\n          fallbackAnimation_1[key] = fallbackTarget;\n        }\n      });\n      animations.push({\n        animation: fallbackAnimation_1\n      });\n    }\n\n    var shouldAnimate = Boolean(animations.length);\n\n    if (isInitialRender && props.initial === false && !visualElement.manuallyAnimateOnMount) {\n      shouldAnimate = false;\n    }\n\n    isInitialRender = false;\n    return shouldAnimate ? animate(animations) : Promise.resolve();\n  }\n  /**\n   * Change whether a certain animation type is active.\n   */\n\n\n  function setActive(type, isActive, options) {\n    var _a; // If the active state hasn't changed, we can safely do nothing here\n\n\n    if (state[type].isActive === isActive) return Promise.resolve(); // Propagate active change to children\n\n    (_a = visualElement.variantChildren) === null || _a === void 0 ? void 0 : _a.forEach(function (child) {\n      var _a;\n\n      return (_a = child.animationState) === null || _a === void 0 ? void 0 : _a.setActive(type, isActive);\n    });\n    state[type].isActive = isActive;\n    var animations = animateChanges(options, type);\n\n    for (var key in state) {\n      state[key].protectedKeys = {};\n    }\n\n    return animations;\n  }\n\n  return {\n    isAnimated: isAnimated,\n    animateChanges: animateChanges,\n    setActive: setActive,\n    setAnimateFunction: setAnimateFunction,\n    getState: function getState() {\n      return state;\n    }\n  };\n}\n\nfunction checkVariantsDidChange(prev, next) {\n  if (typeof next === \"string\") {\n    return next !== prev;\n  } else if (isVariantLabels(next)) {\n    return !shallowCompare(next, prev);\n  }\n\n  return false;\n}\n\nfunction createTypeState(isActive) {\n  if (isActive === void 0) {\n    isActive = false;\n  }\n\n  return {\n    isActive: isActive,\n    protectedKeys: {},\n    needsAnimating: {},\n    prevResolvedValues: {}\n  };\n}\n\nfunction createState() {\n  var _a;\n\n  return _a = {}, _a[exports.AnimationType.Animate] = createTypeState(true), _a[exports.AnimationType.InView] = createTypeState(), _a[exports.AnimationType.Hover] = createTypeState(), _a[exports.AnimationType.Tap] = createTypeState(), _a[exports.AnimationType.Drag] = createTypeState(), _a[exports.AnimationType.Focus] = createTypeState(), _a[exports.AnimationType.Exit] = createTypeState(), _a;\n}\n\nvar animations = {\n  animation: makeRenderlessComponent(function (_a) {\n    var visualElement = _a.visualElement,\n        animate = _a.animate;\n    /**\n     * We dynamically generate the AnimationState manager as it contains a reference\n     * to the underlying animation library. We only want to load that if we load this,\n     * so people can optionally code split it out using the `m` component.\n     */\n\n    visualElement.animationState || (visualElement.animationState = createAnimationState(visualElement));\n    /**\n     * Subscribe any provided AnimationControls to the component's VisualElement\n     */\n\n    if (isAnimationControls(animate)) {\n      React.useEffect(function () {\n        return animate.subscribe(visualElement);\n      }, [animate]);\n    }\n  }),\n  exit: makeRenderlessComponent(function (props) {\n    var custom = props.custom,\n        visualElement = props.visualElement;\n\n    var _a = tslib.__read(usePresence(), 2),\n        isPresent = _a[0],\n        safeToRemove = _a[1];\n\n    var presenceContext = React.useContext(PresenceContext);\n    React.useEffect(function () {\n      var _a, _b;\n\n      visualElement.isPresent = isPresent;\n      var animation = (_a = visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.Exit, !isPresent, {\n        custom: (_b = presenceContext === null || presenceContext === void 0 ? void 0 : presenceContext.custom) !== null && _b !== void 0 ? _b : custom\n      });\n      !isPresent && (animation === null || animation === void 0 ? void 0 : animation.then(safeToRemove));\n    }, [isPresent]);\n  })\n};\n/**\n * @internal\n */\n\nvar PanSession =\n/** @class */\nfunction () {\n  function PanSession(event, handlers, _a) {\n    var _b = _a === void 0 ? {} : _a,\n        transformPagePoint = _b.transformPagePoint;\n\n    var _this = this;\n    /**\n     * @internal\n     */\n\n\n    this.startEvent = null;\n    /**\n     * @internal\n     */\n\n    this.lastMoveEvent = null;\n    /**\n     * @internal\n     */\n\n    this.lastMoveEventInfo = null;\n    /**\n     * @internal\n     */\n\n    this.handlers = {};\n\n    this.updatePoint = function () {\n      if (!(_this.lastMoveEvent && _this.lastMoveEventInfo)) return;\n      var info = getPanInfo(_this.lastMoveEventInfo, _this.history);\n      var isPanStarted = _this.startEvent !== null; // Only start panning if the offset is larger than 3 pixels. If we make it\n      // any larger than this we'll want to reset the pointer history\n      // on the first update to avoid visual snapping to the cursoe.\n\n      var isDistancePastThreshold = popmotion.distance(info.offset, {\n        x: 0,\n        y: 0\n      }) >= 3;\n      if (!isPanStarted && !isDistancePastThreshold) return;\n      var point = info.point;\n      var timestamp = sync.getFrameData().timestamp;\n\n      _this.history.push(tslib.__assign(tslib.__assign({}, point), {\n        timestamp: timestamp\n      }));\n\n      var _a = _this.handlers,\n          onStart = _a.onStart,\n          onMove = _a.onMove;\n\n      if (!isPanStarted) {\n        onStart && onStart(_this.lastMoveEvent, info);\n        _this.startEvent = _this.lastMoveEvent;\n      }\n\n      onMove && onMove(_this.lastMoveEvent, info);\n    };\n\n    this.handlePointerMove = function (event, info) {\n      _this.lastMoveEvent = event;\n      _this.lastMoveEventInfo = transformPoint(info, _this.transformPagePoint); // Because Safari doesn't trigger mouseup events when it's above a `<select>`\n\n      if (isMouseEvent(event) && event.buttons === 0) {\n        _this.handlePointerUp(event, info);\n\n        return;\n      } // Throttle mouse move event to once per frame\n\n\n      sync__default[\"default\"].update(_this.updatePoint, true);\n    };\n\n    this.handlePointerUp = function (event, info) {\n      _this.end();\n\n      var _a = _this.handlers,\n          onEnd = _a.onEnd,\n          onSessionEnd = _a.onSessionEnd;\n      var panInfo = getPanInfo(transformPoint(info, _this.transformPagePoint), _this.history);\n\n      if (_this.startEvent && onEnd) {\n        onEnd(event, panInfo);\n      }\n\n      onSessionEnd && onSessionEnd(event, panInfo);\n    }; // If we have more than one touch, don't start detecting this gesture\n\n\n    if (isTouchEvent(event) && event.touches.length > 1) return;\n    this.handlers = handlers;\n    this.transformPagePoint = transformPagePoint;\n    var info = extractEventInfo(event);\n    var initialInfo = transformPoint(info, this.transformPagePoint);\n    var point = initialInfo.point;\n    var timestamp = sync.getFrameData().timestamp;\n    this.history = [tslib.__assign(tslib.__assign({}, point), {\n      timestamp: timestamp\n    })];\n    var onSessionStart = handlers.onSessionStart;\n    onSessionStart && onSessionStart(event, getPanInfo(initialInfo, this.history));\n    this.removeListeners = popmotion.pipe(addPointerEvent(window, \"pointermove\", this.handlePointerMove), addPointerEvent(window, \"pointerup\", this.handlePointerUp), addPointerEvent(window, \"pointercancel\", this.handlePointerUp));\n  }\n\n  PanSession.prototype.updateHandlers = function (handlers) {\n    this.handlers = handlers;\n  };\n\n  PanSession.prototype.end = function () {\n    this.removeListeners && this.removeListeners();\n    sync.cancelSync.update(this.updatePoint);\n  };\n\n  return PanSession;\n}();\n\nfunction transformPoint(info, transformPagePoint) {\n  return transformPagePoint ? {\n    point: transformPagePoint(info.point)\n  } : info;\n}\n\nfunction subtractPoint(a, b) {\n  return {\n    x: a.x - b.x,\n    y: a.y - b.y\n  };\n}\n\nfunction getPanInfo(_a, history) {\n  var point = _a.point;\n  return {\n    point: point,\n    delta: subtractPoint(point, lastDevicePoint(history)),\n    offset: subtractPoint(point, startDevicePoint(history)),\n    velocity: getVelocity(history, 0.1)\n  };\n}\n\nfunction startDevicePoint(history) {\n  return history[0];\n}\n\nfunction lastDevicePoint(history) {\n  return history[history.length - 1];\n}\n\nfunction getVelocity(history, timeDelta) {\n  if (history.length < 2) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n\n  var i = history.length - 1;\n  var timestampedPoint = null;\n  var lastPoint = lastDevicePoint(history);\n\n  while (i >= 0) {\n    timestampedPoint = history[i];\n\n    if (lastPoint.timestamp - timestampedPoint.timestamp > secondsToMilliseconds(timeDelta)) {\n      break;\n    }\n\n    i--;\n  }\n\n  if (!timestampedPoint) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n\n  var time = (lastPoint.timestamp - timestampedPoint.timestamp) / 1000;\n\n  if (time === 0) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n\n  var currentVelocity = {\n    x: (lastPoint.x - timestampedPoint.x) / time,\n    y: (lastPoint.y - timestampedPoint.y) / time\n  };\n\n  if (currentVelocity.x === Infinity) {\n    currentVelocity.x = 0;\n  }\n\n  if (currentVelocity.y === Infinity) {\n    currentVelocity.y = 0;\n  }\n\n  return currentVelocity;\n}\n\nfunction calcLength(axis) {\n  return axis.max - axis.min;\n}\n\nfunction isNear(value, target, maxDistance) {\n  if (target === void 0) {\n    target = 0;\n  }\n\n  if (maxDistance === void 0) {\n    maxDistance = 0.01;\n  }\n\n  return popmotion.distance(value, target) < maxDistance;\n}\n\nfunction calcAxisDelta(delta, source, target, origin) {\n  if (origin === void 0) {\n    origin = 0.5;\n  }\n\n  delta.origin = origin;\n  delta.originPoint = popmotion.mix(source.min, source.max, delta.origin);\n  delta.scale = calcLength(target) / calcLength(source);\n  if (isNear(delta.scale, 1, 0.0001) || isNaN(delta.scale)) delta.scale = 1;\n  delta.translate = popmotion.mix(target.min, target.max, delta.origin) - delta.originPoint;\n  if (isNear(delta.translate) || isNaN(delta.translate)) delta.translate = 0;\n}\n\nfunction calcBoxDelta(delta, source, target, origin) {\n  calcAxisDelta(delta.x, source.x, target.x, origin === null || origin === void 0 ? void 0 : origin.originX);\n  calcAxisDelta(delta.y, source.y, target.y, origin === null || origin === void 0 ? void 0 : origin.originY);\n}\n\nfunction calcRelativeAxis(target, relative, parent) {\n  target.min = parent.min + relative.min;\n  target.max = target.min + calcLength(relative);\n}\n\nfunction calcRelativeBox(target, relative, parent) {\n  calcRelativeAxis(target.x, relative.x, parent.x);\n  calcRelativeAxis(target.y, relative.y, parent.y);\n}\n\nfunction calcRelativeAxisPosition(target, layout, parent) {\n  target.min = layout.min - parent.min;\n  target.max = target.min + calcLength(layout);\n}\n\nfunction calcRelativePosition(target, layout, parent) {\n  calcRelativeAxisPosition(target.x, layout.x, parent.x);\n  calcRelativeAxisPosition(target.y, layout.y, parent.y);\n}\n/**\n * Apply constraints to a point. These constraints are both physical along an\n * axis, and an elastic factor that determines how much to constrain the point\n * by if it does lie outside the defined parameters.\n */\n\n\nfunction applyConstraints(point, _a, elastic) {\n  var min = _a.min,\n      max = _a.max;\n\n  if (min !== undefined && point < min) {\n    // If we have a min point defined, and this is outside of that, constrain\n    point = elastic ? popmotion.mix(min, point, elastic.min) : Math.max(point, min);\n  } else if (max !== undefined && point > max) {\n    // If we have a max point defined, and this is outside of that, constrain\n    point = elastic ? popmotion.mix(max, point, elastic.max) : Math.min(point, max);\n  }\n\n  return point;\n}\n/**\n * Calculate constraints in terms of the viewport when defined relatively to the\n * measured axis. This is measured from the nearest edge, so a max constraint of 200\n * on an axis with a max value of 300 would return a constraint of 500 - axis length\n */\n\n\nfunction calcRelativeAxisConstraints(axis, min, max) {\n  return {\n    min: min !== undefined ? axis.min + min : undefined,\n    max: max !== undefined ? axis.max + max - (axis.max - axis.min) : undefined\n  };\n}\n/**\n * Calculate constraints in terms of the viewport when\n * defined relatively to the measured bounding box.\n */\n\n\nfunction calcRelativeConstraints(layoutBox, _a) {\n  var top = _a.top,\n      left = _a.left,\n      bottom = _a.bottom,\n      right = _a.right;\n  return {\n    x: calcRelativeAxisConstraints(layoutBox.x, left, right),\n    y: calcRelativeAxisConstraints(layoutBox.y, top, bottom)\n  };\n}\n/**\n * Calculate viewport constraints when defined as another viewport-relative axis\n */\n\n\nfunction calcViewportAxisConstraints(layoutAxis, constraintsAxis) {\n  var _a;\n\n  var min = constraintsAxis.min - layoutAxis.min;\n  var max = constraintsAxis.max - layoutAxis.max; // If the constraints axis is actually smaller than the layout axis then we can\n  // flip the constraints\n\n  if (constraintsAxis.max - constraintsAxis.min < layoutAxis.max - layoutAxis.min) {\n    _a = tslib.__read([max, min], 2), min = _a[0], max = _a[1];\n  }\n\n  return {\n    min: min,\n    max: max\n  };\n}\n/**\n * Calculate viewport constraints when defined as another viewport-relative box\n */\n\n\nfunction calcViewportConstraints(layoutBox, constraintsBox) {\n  return {\n    x: calcViewportAxisConstraints(layoutBox.x, constraintsBox.x),\n    y: calcViewportAxisConstraints(layoutBox.y, constraintsBox.y)\n  };\n}\n/**\n * Calculate a transform origin relative to the source axis, between 0-1, that results\n * in an asthetically pleasing scale/transform needed to project from source to target.\n */\n\n\nfunction calcOrigin(source, target) {\n  var origin = 0.5;\n  var sourceLength = calcLength(source);\n  var targetLength = calcLength(target);\n\n  if (targetLength > sourceLength) {\n    origin = popmotion.progress(target.min, target.max - sourceLength, source.min);\n  } else if (sourceLength > targetLength) {\n    origin = popmotion.progress(source.min, source.max - targetLength, target.min);\n  }\n\n  return popmotion.clamp(0, 1, origin);\n}\n/**\n * Rebase the calculated viewport constraints relative to the layout.min point.\n */\n\n\nfunction rebaseAxisConstraints(layout, constraints) {\n  var relativeConstraints = {};\n\n  if (constraints.min !== undefined) {\n    relativeConstraints.min = constraints.min - layout.min;\n  }\n\n  if (constraints.max !== undefined) {\n    relativeConstraints.max = constraints.max - layout.min;\n  }\n\n  return relativeConstraints;\n}\n\nvar defaultElastic = 0.35;\n/**\n * Accepts a dragElastic prop and returns resolved elastic values for each axis.\n */\n\nfunction resolveDragElastic(dragElastic) {\n  if (dragElastic === void 0) {\n    dragElastic = defaultElastic;\n  }\n\n  if (dragElastic === false) {\n    dragElastic = 0;\n  } else if (dragElastic === true) {\n    dragElastic = defaultElastic;\n  }\n\n  return {\n    x: resolveAxisElastic(dragElastic, \"left\", \"right\"),\n    y: resolveAxisElastic(dragElastic, \"top\", \"bottom\")\n  };\n}\n\nfunction resolveAxisElastic(dragElastic, minLabel, maxLabel) {\n  return {\n    min: resolvePointElastic(dragElastic, minLabel),\n    max: resolvePointElastic(dragElastic, maxLabel)\n  };\n}\n\nfunction resolvePointElastic(dragElastic, label) {\n  var _a;\n\n  return typeof dragElastic === \"number\" ? dragElastic : (_a = dragElastic[label]) !== null && _a !== void 0 ? _a : 0;\n}\n\nvar createAxisDelta = function createAxisDelta() {\n  return {\n    translate: 0,\n    scale: 1,\n    origin: 0,\n    originPoint: 0\n  };\n};\n\nvar createDelta = function createDelta() {\n  return {\n    x: createAxisDelta(),\n    y: createAxisDelta()\n  };\n};\n\nvar createAxis = function createAxis() {\n  return {\n    min: 0,\n    max: 0\n  };\n};\n\nvar createBox = function createBox() {\n  return {\n    x: createAxis(),\n    y: createAxis()\n  };\n};\n\nfunction eachAxis(callback) {\n  return [callback(\"x\"), callback(\"y\")];\n}\n/**\n * Bounding boxes tend to be defined as top, left, right, bottom. For various operations\n * it's easier to consider each axis individually. This function returns a bounding box\n * as a map of single-axis min/max values.\n */\n\n\nfunction convertBoundingBoxToBox(_a) {\n  var top = _a.top,\n      left = _a.left,\n      right = _a.right,\n      bottom = _a.bottom;\n  return {\n    x: {\n      min: left,\n      max: right\n    },\n    y: {\n      min: top,\n      max: bottom\n    }\n  };\n}\n\nfunction convertBoxToBoundingBox(_a) {\n  var x = _a.x,\n      y = _a.y;\n  return {\n    top: y.min,\n    right: x.max,\n    bottom: y.max,\n    left: x.min\n  };\n}\n/**\n * Applies a TransformPoint function to a bounding box. TransformPoint is usually a function\n * provided by Framer to allow measured points to be corrected for device scaling. This is used\n * when measuring DOM elements and DOM event points.\n */\n\n\nfunction transformBoxPoints(point, transformPoint) {\n  if (!transformPoint) return point;\n  var topLeft = transformPoint({\n    x: point.left,\n    y: point.top\n  });\n  var bottomRight = transformPoint({\n    x: point.right,\n    y: point.bottom\n  });\n  return {\n    top: topLeft.y,\n    left: topLeft.x,\n    bottom: bottomRight.y,\n    right: bottomRight.x\n  };\n}\n\nfunction isIdentityScale(scale) {\n  return scale === undefined || scale === 1;\n}\n\nfunction hasScale(_a) {\n  var scale = _a.scale,\n      scaleX = _a.scaleX,\n      scaleY = _a.scaleY;\n  return !isIdentityScale(scale) || !isIdentityScale(scaleX) || !isIdentityScale(scaleY);\n}\n\nfunction hasTransform(values) {\n  return hasScale(values) || hasTranslate(values.x) || hasTranslate(values.y) || values.z || values.rotate || values.rotateX || values.rotateY;\n}\n\nfunction hasTranslate(value) {\n  return value && value !== \"0%\";\n}\n/**\n * Scales a point based on a factor and an originPoint\n */\n\n\nfunction scalePoint(point, scale, originPoint) {\n  var distanceFromOrigin = point - originPoint;\n  var scaled = scale * distanceFromOrigin;\n  return originPoint + scaled;\n}\n/**\n * Applies a translate/scale delta to a point\n */\n\n\nfunction applyPointDelta(point, translate, scale, originPoint, boxScale) {\n  if (boxScale !== undefined) {\n    point = scalePoint(point, boxScale, originPoint);\n  }\n\n  return scalePoint(point, scale, originPoint) + translate;\n}\n/**\n * Applies a translate/scale delta to an axis\n */\n\n\nfunction applyAxisDelta(axis, translate, scale, originPoint, boxScale) {\n  if (translate === void 0) {\n    translate = 0;\n  }\n\n  if (scale === void 0) {\n    scale = 1;\n  }\n\n  axis.min = applyPointDelta(axis.min, translate, scale, originPoint, boxScale);\n  axis.max = applyPointDelta(axis.max, translate, scale, originPoint, boxScale);\n}\n/**\n * Applies a translate/scale delta to a box\n */\n\n\nfunction applyBoxDelta(box, _a) {\n  var x = _a.x,\n      y = _a.y;\n  applyAxisDelta(box.x, x.translate, x.scale, x.originPoint);\n  applyAxisDelta(box.y, y.translate, y.scale, y.originPoint);\n}\n/**\n * Apply a tree of deltas to a box. We do this to calculate the effect of all the transforms\n * in a tree upon our box before then calculating how to project it into our desired viewport-relative box\n *\n * This is the final nested loop within updateLayoutDelta for future refactoring\n */\n\n\nfunction applyTreeDeltas(box, treeScale, treePath, isSharedTransition) {\n  var _a, _b;\n\n  if (isSharedTransition === void 0) {\n    isSharedTransition = false;\n  }\n\n  var treeLength = treePath.length;\n  if (!treeLength) return; // Reset the treeScale\n\n  treeScale.x = treeScale.y = 1;\n  var node;\n  var delta;\n\n  for (var i = 0; i < treeLength; i++) {\n    node = treePath[i];\n    delta = node.projectionDelta;\n    if (((_b = (_a = node.instance) === null || _a === void 0 ? void 0 : _a.style) === null || _b === void 0 ? void 0 : _b.display) === \"contents\") continue;\n\n    if (isSharedTransition && node.options.layoutScroll && node.scroll && node !== node.root) {\n      transformBox(box, {\n        x: -node.scroll.x,\n        y: -node.scroll.y\n      });\n    }\n\n    if (delta) {\n      // Incoporate each ancestor's scale into a culmulative treeScale for this component\n      treeScale.x *= delta.x.scale;\n      treeScale.y *= delta.y.scale; // Apply each ancestor's calculated delta into this component's recorded layout box\n\n      applyBoxDelta(box, delta);\n    }\n\n    if (isSharedTransition && hasTransform(node.latestValues)) {\n      transformBox(box, node.latestValues);\n    }\n  }\n}\n\nfunction translateAxis(axis, distance) {\n  axis.min = axis.min + distance;\n  axis.max = axis.max + distance;\n}\n/**\n * Apply a transform to an axis from the latest resolved motion values.\n * This function basically acts as a bridge between a flat motion value map\n * and applyAxisDelta\n */\n\n\nfunction transformAxis(axis, transforms, _a) {\n  var _b = tslib.__read(_a, 3),\n      key = _b[0],\n      scaleKey = _b[1],\n      originKey = _b[2];\n\n  var axisOrigin = transforms[originKey] !== undefined ? transforms[originKey] : 0.5;\n  var originPoint = popmotion.mix(axis.min, axis.max, axisOrigin); // Apply the axis delta to the final axis\n\n  applyAxisDelta(axis, transforms[key], transforms[scaleKey], originPoint, transforms.scale);\n}\n/**\n * The names of the motion values we want to apply as translation, scale and origin.\n */\n\n\nvar xKeys$1 = [\"x\", \"scaleX\", \"originX\"];\nvar yKeys$1 = [\"y\", \"scaleY\", \"originY\"];\n/**\n * Apply a transform to a box from the latest resolved motion values.\n */\n\nfunction transformBox(box, transform) {\n  transformAxis(box.x, transform, xKeys$1);\n  transformAxis(box.y, transform, yKeys$1);\n}\n\nfunction _measureViewportBox2(instance, transformPoint) {\n  return convertBoundingBoxToBox(transformBoxPoints(instance.getBoundingClientRect(), transformPoint));\n}\n\nfunction measurePageBox(element, rootProjectionNode, transformPagePoint) {\n  var viewportBox = _measureViewportBox2(element, transformPagePoint);\n\n  var scroll = rootProjectionNode.scroll;\n\n  if (scroll) {\n    translateAxis(viewportBox.x, scroll.x);\n    translateAxis(viewportBox.y, scroll.y);\n  }\n\n  return viewportBox;\n}\n\nvar elementDragControls = new WeakMap();\n/**\n *\n */\n// let latestPointerEvent: AnyPointerEvent\n\nvar VisualElementDragControls =\n/** @class */\nfunction () {\n  function VisualElementDragControls(visualElement) {\n    // This is a reference to the global drag gesture lock, ensuring only one component\n    // can \"capture\" the drag of one or both axes.\n    // TODO: Look into moving this into pansession?\n    this.openGlobalLock = null;\n    this.isDragging = false;\n    this.currentDirection = null;\n    this.originPoint = {\n      x: 0,\n      y: 0\n    };\n    /**\n     * The permitted boundaries of travel, in pixels.\n     */\n\n    this.constraints = false;\n    this.hasMutatedConstraints = false;\n    /**\n     * The per-axis resolved elastic values.\n     */\n\n    this.elastic = createBox();\n    this.visualElement = visualElement;\n  }\n\n  VisualElementDragControls.prototype.start = function (originEvent, _a) {\n    var _this = this;\n\n    var _b = _a === void 0 ? {} : _a,\n        _c = _b.snapToCursor,\n        snapToCursor = _c === void 0 ? false : _c;\n    /**\n     * Don't start dragging if this component is exiting\n     */\n\n\n    if (this.visualElement.isPresent === false) return;\n\n    var onSessionStart = function onSessionStart(event) {\n      // Stop any animations on both axis values immediately. This allows the user to throw and catch\n      // the component.\n      _this.stopAnimation();\n\n      if (snapToCursor) {\n        _this.snapToCursor(extractEventInfo(event, \"page\").point);\n      }\n    };\n\n    var onStart = function onStart(event, info) {\n      var _a; // Attempt to grab the global drag gesture lock - maybe make this part of PanSession\n\n\n      var _b = _this.getProps(),\n          drag = _b.drag,\n          dragPropagation = _b.dragPropagation,\n          onDragStart = _b.onDragStart;\n\n      if (drag && !dragPropagation) {\n        if (_this.openGlobalLock) _this.openGlobalLock();\n        _this.openGlobalLock = getGlobalLock(drag); // If we don 't have the lock, don't start dragging\n\n        if (!_this.openGlobalLock) return;\n      }\n\n      _this.isDragging = true;\n      _this.currentDirection = null;\n\n      _this.resolveConstraints();\n\n      if (_this.visualElement.projection) {\n        _this.visualElement.projection.isAnimationBlocked = true;\n        _this.visualElement.projection.target = undefined;\n      }\n      /**\n       * Record gesture origin\n       */\n\n\n      eachAxis(function (axis) {\n        var _a, _b;\n\n        var current = _this.getAxisMotionValue(axis).get() || 0;\n        /**\n         * If the MotionValue is a percentage value convert to px\n         */\n\n        if (styleValueTypes.percent.test(current)) {\n          var measuredAxis = (_b = (_a = _this.visualElement.projection) === null || _a === void 0 ? void 0 : _a.layout) === null || _b === void 0 ? void 0 : _b.actual[axis];\n\n          if (measuredAxis) {\n            var length_1 = calcLength(measuredAxis);\n            current = length_1 * (parseFloat(current) / 100);\n          }\n        }\n\n        _this.originPoint[axis] = current;\n      }); // Fire onDragStart event\n\n      onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(event, info);\n      (_a = _this.visualElement.animationState) === null || _a === void 0 ? void 0 : _a.setActive(exports.AnimationType.Drag, true);\n    };\n\n    var onMove = function onMove(event, info) {\n      // latestPointerEvent = event\n      var _a = _this.getProps(),\n          dragPropagation = _a.dragPropagation,\n          dragDirectionLock = _a.dragDirectionLock,\n          onDirectionLock = _a.onDirectionLock,\n          onDrag = _a.onDrag; // If we didn't successfully receive the gesture lock, early return.\n\n\n      if (!dragPropagation && !_this.openGlobalLock) return;\n      var offset = info.offset; // Attempt to detect drag direction if directionLock is true\n\n      if (dragDirectionLock && _this.currentDirection === null) {\n        _this.currentDirection = getCurrentDirection(offset); // If we've successfully set a direction, notify listener\n\n        if (_this.currentDirection !== null) {\n          onDirectionLock === null || onDirectionLock === void 0 ? void 0 : onDirectionLock(_this.currentDirection);\n        }\n\n        return;\n      } // Update each point with the latest position\n\n\n      _this.updateAxis(\"x\", info.point, offset);\n\n      _this.updateAxis(\"y\", info.point, offset);\n      /**\n       * Ideally we would leave the renderer to fire naturally at the end of\n       * this frame but if the element is about to change layout as the result\n       * of a re-render we want to ensure the browser can read the latest\n       * bounding box to ensure the pointer and element don't fall out of sync.\n       */\n\n\n      _this.visualElement.syncRender();\n      /**\n       * This must fire after the syncRender call as it might trigger a state\n       * change which itself might trigger a layout update.\n       */\n\n\n      onDrag === null || onDrag === void 0 ? void 0 : onDrag(event, info);\n    };\n\n    var onSessionEnd = function onSessionEnd(event, info) {\n      return _this.stop(event, info);\n    };\n\n    this.panSession = new PanSession(originEvent, {\n      onSessionStart: onSessionStart,\n      onStart: onStart,\n      onMove: onMove,\n      onSessionEnd: onSessionEnd\n    }, {\n      transformPagePoint: this.visualElement.getTransformPagePoint()\n    });\n  };\n\n  VisualElementDragControls.prototype.stop = function (event, info) {\n    var isDragging = this.isDragging;\n    this.cancel();\n    if (!isDragging) return;\n    var velocity = info.velocity;\n    this.startAnimation(velocity);\n    var onDragEnd = this.getProps().onDragEnd;\n    onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(event, info);\n  };\n\n  VisualElementDragControls.prototype.cancel = function () {\n    var _a, _b;\n\n    this.isDragging = false;\n\n    if (this.visualElement.projection) {\n      this.visualElement.projection.isAnimationBlocked = false;\n    }\n\n    (_a = this.panSession) === null || _a === void 0 ? void 0 : _a.end();\n    this.panSession = undefined;\n    var dragPropagation = this.getProps().dragPropagation;\n\n    if (!dragPropagation && this.openGlobalLock) {\n      this.openGlobalLock();\n      this.openGlobalLock = null;\n    }\n\n    (_b = this.visualElement.animationState) === null || _b === void 0 ? void 0 : _b.setActive(exports.AnimationType.Drag, false);\n  };\n\n  VisualElementDragControls.prototype.updateAxis = function (axis, _point, offset) {\n    var drag = this.getProps().drag; // If we're not dragging this axis, do an early return.\n\n    if (!offset || !shouldDrag(axis, drag, this.currentDirection)) return;\n    var axisValue = this.getAxisMotionValue(axis);\n    var next = this.originPoint[axis] + offset[axis]; // Apply constraints\n\n    if (this.constraints && this.constraints[axis]) {\n      next = applyConstraints(next, this.constraints[axis], this.elastic[axis]);\n    }\n\n    axisValue.set(next);\n  };\n\n  VisualElementDragControls.prototype.resolveConstraints = function () {\n    var _this = this;\n\n    var _a = this.getProps(),\n        dragConstraints = _a.dragConstraints,\n        dragElastic = _a.dragElastic;\n\n    var layout = (this.visualElement.projection || {}).layout;\n    var prevConstraints = this.constraints;\n\n    if (dragConstraints && isRefObject(dragConstraints)) {\n      if (!this.constraints) {\n        this.constraints = this.resolveRefConstraints();\n      }\n    } else {\n      if (dragConstraints && layout) {\n        this.constraints = calcRelativeConstraints(layout.actual, dragConstraints);\n      } else {\n        this.constraints = false;\n      }\n    }\n\n    this.elastic = resolveDragElastic(dragElastic);\n    /**\n     * If we're outputting to external MotionValues, we want to rebase the measured constraints\n     * from viewport-relative to component-relative.\n     */\n\n    if (prevConstraints !== this.constraints && layout && this.constraints && !this.hasMutatedConstraints) {\n      eachAxis(function (axis) {\n        if (_this.getAxisMotionValue(axis)) {\n          _this.constraints[axis] = rebaseAxisConstraints(layout.actual[axis], _this.constraints[axis]);\n        }\n      });\n    }\n  };\n\n  VisualElementDragControls.prototype.resolveRefConstraints = function () {\n    var _a = this.getProps(),\n        constraints = _a.dragConstraints,\n        onMeasureDragConstraints = _a.onMeasureDragConstraints;\n\n    if (!constraints || !isRefObject(constraints)) return false;\n    var constraintsElement = constraints.current;\n    heyListen.invariant(constraintsElement !== null, \"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.\");\n    var projection = this.visualElement.projection; // TODO\n\n    if (!projection || !projection.layout) return false;\n    var constraintsBox = measurePageBox(constraintsElement, projection.root, this.visualElement.getTransformPagePoint());\n    var measuredConstraints = calcViewportConstraints(projection.layout.actual, constraintsBox);\n    /**\n     * If there's an onMeasureDragConstraints listener we call it and\n     * if different constraints are returned, set constraints to that\n     */\n\n    if (onMeasureDragConstraints) {\n      var userConstraints = onMeasureDragConstraints(convertBoxToBoundingBox(measuredConstraints));\n      this.hasMutatedConstraints = !!userConstraints;\n\n      if (userConstraints) {\n        measuredConstraints = convertBoundingBoxToBox(userConstraints);\n      }\n    }\n\n    return measuredConstraints;\n  };\n\n  VisualElementDragControls.prototype.startAnimation = function (velocity) {\n    var _this = this;\n\n    var _a = this.getProps(),\n        drag = _a.drag,\n        dragMomentum = _a.dragMomentum,\n        dragElastic = _a.dragElastic,\n        dragTransition = _a.dragTransition,\n        dragSnapToOrigin = _a.dragSnapToOrigin,\n        onDragTransitionEnd = _a.onDragTransitionEnd;\n\n    var constraints = this.constraints || {};\n    var momentumAnimations = eachAxis(function (axis) {\n      var _a;\n\n      if (!shouldDrag(axis, drag, _this.currentDirection)) {\n        return;\n      }\n\n      var transition = (_a = constraints === null || constraints === void 0 ? void 0 : constraints[axis]) !== null && _a !== void 0 ? _a : {};\n      if (dragSnapToOrigin) transition = {\n        min: 0,\n        max: 0\n      };\n      /**\n       * Overdamp the boundary spring if `dragElastic` is disabled. There's still a frame\n       * of spring animations so we should look into adding a disable spring option to `inertia`.\n       * We could do something here where we affect the `bounceStiffness` and `bounceDamping`\n       * using the value of `dragElastic`.\n       */\n\n      var bounceStiffness = dragElastic ? 200 : 1000000;\n      var bounceDamping = dragElastic ? 40 : 10000000;\n\n      var inertia = tslib.__assign(tslib.__assign({\n        type: \"inertia\",\n        velocity: dragMomentum ? velocity[axis] : 0,\n        bounceStiffness: bounceStiffness,\n        bounceDamping: bounceDamping,\n        timeConstant: 750,\n        restDelta: 1,\n        restSpeed: 10\n      }, dragTransition), transition); // If we're not animating on an externally-provided `MotionValue` we can use the\n      // component's animation controls which will handle interactions with whileHover (etc),\n      // otherwise we just have to animate the `MotionValue` itself.\n\n\n      return _this.startAxisValueAnimation(axis, inertia);\n    }); // Run all animations and then resolve the new drag constraints.\n\n    return Promise.all(momentumAnimations).then(onDragTransitionEnd);\n  };\n\n  VisualElementDragControls.prototype.startAxisValueAnimation = function (axis, transition) {\n    var axisValue = this.getAxisMotionValue(axis);\n    return startAnimation(axis, axisValue, 0, transition);\n  };\n\n  VisualElementDragControls.prototype.stopAnimation = function () {\n    var _this = this;\n\n    eachAxis(function (axis) {\n      return _this.getAxisMotionValue(axis).stop();\n    });\n  };\n  /**\n   * Drag works differently depending on which props are provided.\n   *\n   * - If _dragX and _dragY are provided, we output the gesture delta directly to those motion values.\n   * - Otherwise, we apply the delta to the x/y motion values.\n   */\n\n\n  VisualElementDragControls.prototype.getAxisMotionValue = function (axis) {\n    var _a, _b;\n\n    var dragKey = \"_drag\" + axis.toUpperCase();\n    var externalMotionValue = this.visualElement.getProps()[dragKey];\n    return externalMotionValue ? externalMotionValue : this.visualElement.getValue(axis, (_b = (_a = this.visualElement.getProps().initial) === null || _a === void 0 ? void 0 : _a[axis]) !== null && _b !== void 0 ? _b : 0);\n  };\n\n  VisualElementDragControls.prototype.snapToCursor = function (point) {\n    var _this = this;\n\n    eachAxis(function (axis) {\n      var drag = _this.getProps().drag; // If we're not dragging this axis, do an early return.\n\n\n      if (!shouldDrag(axis, drag, _this.currentDirection)) return;\n      var projection = _this.visualElement.projection;\n\n      var axisValue = _this.getAxisMotionValue(axis);\n\n      if (projection && projection.layout) {\n        var _a = projection.layout.actual[axis],\n            min = _a.min,\n            max = _a.max;\n        axisValue.set(point[axis] - popmotion.mix(min, max, 0.5));\n      }\n    });\n  };\n  /**\n   * When the viewport resizes we want to check if the measured constraints\n   * have changed and, if so, reposition the element within those new constraints\n   * relative to where it was before the resize.\n   */\n\n\n  VisualElementDragControls.prototype.scalePositionWithinConstraints = function () {\n    var _this = this;\n\n    var _a;\n\n    var _b = this.getProps(),\n        drag = _b.drag,\n        dragConstraints = _b.dragConstraints;\n\n    var projection = this.visualElement.projection;\n    if (!isRefObject(dragConstraints) || !projection || !this.constraints) return;\n    /**\n     * Stop current animations as there can be visual glitching if we try to do\n     * this mid-animation\n     */\n\n    this.stopAnimation();\n    /**\n     * Record the relative position of the dragged element relative to the\n     * constraints box and save as a progress value.\n     */\n\n    var boxProgress = {\n      x: 0,\n      y: 0\n    };\n    eachAxis(function (axis) {\n      var axisValue = _this.getAxisMotionValue(axis);\n\n      if (axisValue) {\n        var latest = axisValue.get();\n        boxProgress[axis] = calcOrigin({\n          min: latest,\n          max: latest\n        }, _this.constraints[axis]);\n      }\n    });\n    /**\n     * Update the layout of this element and resolve the latest drag constraints\n     */\n\n    var transformTemplate = this.visualElement.getProps().transformTemplate;\n    this.visualElement.getInstance().style.transform = transformTemplate ? transformTemplate({}, \"\") : \"none\";\n    (_a = projection.root) === null || _a === void 0 ? void 0 : _a.updateScroll();\n    projection.updateLayout();\n    this.resolveConstraints();\n    /**\n     * For each axis, calculate the current progress of the layout axis\n     * within the new constraints.\n     */\n\n    eachAxis(function (axis) {\n      if (!shouldDrag(axis, drag, null)) return;\n      /**\n       * Calculate a new transform based on the previous box progress\n       */\n\n      var axisValue = _this.getAxisMotionValue(axis);\n\n      var _a = _this.constraints[axis],\n          min = _a.min,\n          max = _a.max;\n      axisValue.set(popmotion.mix(min, max, boxProgress[axis]));\n    });\n  };\n\n  VisualElementDragControls.prototype.addListeners = function () {\n    var _this = this;\n\n    var _a;\n\n    elementDragControls.set(this.visualElement, this);\n    var element = this.visualElement.getInstance();\n    /**\n     * Attach a pointerdown event listener on this DOM element to initiate drag tracking.\n     */\n\n    var stopPointerListener = addPointerEvent(element, \"pointerdown\", function (event) {\n      var _a = _this.getProps(),\n          drag = _a.drag,\n          _b = _a.dragListener,\n          dragListener = _b === void 0 ? true : _b;\n\n      drag && dragListener && _this.start(event);\n    });\n\n    var measureDragConstraints = function measureDragConstraints() {\n      var dragConstraints = _this.getProps().dragConstraints;\n\n      if (isRefObject(dragConstraints)) {\n        _this.constraints = _this.resolveRefConstraints();\n      }\n    };\n\n    var projection = this.visualElement.projection;\n    var stopMeasureLayoutListener = projection.addEventListener(\"measure\", measureDragConstraints);\n\n    if (projection && !projection.layout) {\n      (_a = projection.root) === null || _a === void 0 ? void 0 : _a.updateScroll();\n      projection.updateLayout();\n    }\n\n    measureDragConstraints();\n    /**\n     * Attach a window resize listener to scale the draggable target within its defined\n     * constraints as the window resizes.\n     */\n\n    var stopResizeListener = addDomEvent(window, \"resize\", function () {\n      return _this.scalePositionWithinConstraints();\n    });\n    /**\n     * If the element's layout changes, calculate the delta and apply that to\n     * the drag gesture's origin point.\n     */\n\n    var stopLayoutUpdateListener = projection.addEventListener(\"didUpdate\", function (_a) {\n      var delta = _a.delta,\n          hasLayoutChanged = _a.hasLayoutChanged;\n\n      if (_this.isDragging && hasLayoutChanged) {\n        eachAxis(function (axis) {\n          var motionValue = _this.getAxisMotionValue(axis);\n\n          if (!motionValue) return;\n          _this.originPoint[axis] += delta[axis].translate;\n          motionValue.set(motionValue.get() + delta[axis].translate);\n        });\n\n        _this.visualElement.syncRender();\n      }\n    });\n    return function () {\n      stopResizeListener();\n      stopPointerListener();\n      stopMeasureLayoutListener();\n      stopLayoutUpdateListener === null || stopLayoutUpdateListener === void 0 ? void 0 : stopLayoutUpdateListener();\n    };\n  };\n\n  VisualElementDragControls.prototype.getProps = function () {\n    var props = this.visualElement.getProps();\n    var _a = props.drag,\n        drag = _a === void 0 ? false : _a,\n        _b = props.dragDirectionLock,\n        dragDirectionLock = _b === void 0 ? false : _b,\n        _c = props.dragPropagation,\n        dragPropagation = _c === void 0 ? false : _c,\n        _d = props.dragConstraints,\n        dragConstraints = _d === void 0 ? false : _d,\n        _e = props.dragElastic,\n        dragElastic = _e === void 0 ? defaultElastic : _e,\n        _f = props.dragMomentum,\n        dragMomentum = _f === void 0 ? true : _f;\n    return tslib.__assign(tslib.__assign({}, props), {\n      drag: drag,\n      dragDirectionLock: dragDirectionLock,\n      dragPropagation: dragPropagation,\n      dragConstraints: dragConstraints,\n      dragElastic: dragElastic,\n      dragMomentum: dragMomentum\n    });\n  };\n\n  return VisualElementDragControls;\n}();\n\nfunction shouldDrag(direction, drag, currentDirection) {\n  return (drag === true || drag === direction) && (currentDirection === null || currentDirection === direction);\n}\n/**\n * Based on an x/y offset determine the current drag direction. If both axis' offsets are lower\n * than the provided threshold, return `null`.\n *\n * @param offset - The x/y offset from origin.\n * @param lockThreshold - (Optional) - the minimum absolute offset before we can determine a drag direction.\n */\n\n\nfunction getCurrentDirection(offset, lockThreshold) {\n  if (lockThreshold === void 0) {\n    lockThreshold = 10;\n  }\n\n  var direction = null;\n\n  if (Math.abs(offset.y) > lockThreshold) {\n    direction = \"y\";\n  } else if (Math.abs(offset.x) > lockThreshold) {\n    direction = \"x\";\n  }\n\n  return direction;\n}\n/**\n * A hook that allows an element to be dragged.\n *\n * @internal\n */\n\n\nfunction useDrag(props) {\n  var groupDragControls = props.dragControls,\n      visualElement = props.visualElement;\n  var dragControls = useConstant(function () {\n    return new VisualElementDragControls(visualElement);\n  }); // If we've been provided a DragControls for manual control over the drag gesture,\n  // subscribe this component to it on mount.\n\n  React.useEffect(function () {\n    return groupDragControls && groupDragControls.subscribe(dragControls);\n  }, [dragControls, groupDragControls]); // Apply the event listeners to the element\n\n  React.useEffect(function () {\n    return dragControls.addListeners();\n  }, [dragControls]);\n}\n/**\n *\n * @param handlers -\n * @param ref -\n *\n * @privateRemarks\n * Currently this sets new pan gesture functions every render. The memo route has been explored\n * in the past but ultimately we're still creating new functions every render. An optimisation\n * to explore is creating the pan gestures and loading them into a `ref`.\n *\n * @internal\n */\n\n\nfunction usePanGesture(_a) {\n  var onPan = _a.onPan,\n      onPanStart = _a.onPanStart,\n      onPanEnd = _a.onPanEnd,\n      onPanSessionStart = _a.onPanSessionStart,\n      visualElement = _a.visualElement;\n  var hasPanEvents = onPan || onPanStart || onPanEnd || onPanSessionStart;\n  var panSession = React.useRef(null);\n  var transformPagePoint = React.useContext(MotionConfigContext).transformPagePoint;\n  var handlers = {\n    onSessionStart: onPanSessionStart,\n    onStart: onPanStart,\n    onMove: onPan,\n    onEnd: function onEnd(event, info) {\n      panSession.current = null;\n      onPanEnd && onPanEnd(event, info);\n    }\n  };\n  React.useEffect(function () {\n    if (panSession.current !== null) {\n      panSession.current.updateHandlers(handlers);\n    }\n  });\n\n  function onPointerDown(event) {\n    panSession.current = new PanSession(event, handlers, {\n      transformPagePoint: transformPagePoint\n    });\n  }\n\n  usePointerEvent(visualElement, \"pointerdown\", hasPanEvents && onPointerDown);\n  useUnmountEffect(function () {\n    return panSession.current && panSession.current.end();\n  });\n}\n\nvar drag = {\n  pan: makeRenderlessComponent(usePanGesture),\n  drag: makeRenderlessComponent(useDrag)\n};\nvar names = [\"LayoutMeasure\", \"BeforeLayoutMeasure\", \"LayoutUpdate\", \"ViewportBoxUpdate\", \"Update\", \"Render\", \"AnimationComplete\", \"LayoutAnimationComplete\", \"AnimationStart\", \"LayoutAnimationStart\", \"SetAxisTarget\", \"Unmount\"];\n\nfunction createLifecycles() {\n  var managers = names.map(function () {\n    return new SubscriptionManager();\n  });\n  var propSubscriptions = {};\n  var lifecycles = {\n    clearAllListeners: function clearAllListeners() {\n      return managers.forEach(function (manager) {\n        return manager.clear();\n      });\n    },\n    updatePropListeners: function updatePropListeners(props) {\n      names.forEach(function (name) {\n        var _a;\n\n        var on = \"on\" + name;\n        var propListener = props[on]; // Unsubscribe existing subscription\n\n        (_a = propSubscriptions[name]) === null || _a === void 0 ? void 0 : _a.call(propSubscriptions); // Add new subscription\n\n        if (propListener) {\n          propSubscriptions[name] = lifecycles[on](propListener);\n        }\n      });\n    }\n  };\n  managers.forEach(function (manager, i) {\n    lifecycles[\"on\" + names[i]] = function (handler) {\n      return manager.add(handler);\n    };\n\n    lifecycles[\"notify\" + names[i]] = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return manager.notify.apply(manager, tslib.__spreadArray([], tslib.__read(args), false));\n    };\n  });\n  return lifecycles;\n}\n\nfunction updateMotionValuesFromProps(element, next, prev) {\n  var _a;\n\n  for (var key in next) {\n    var nextValue = next[key];\n    var prevValue = prev[key];\n\n    if (isMotionValue(nextValue)) {\n      /**\n       * If this is a motion value found in props or style, we want to add it\n       * to our visual element's motion value map.\n       */\n      element.addValue(key, nextValue);\n      /**\n       * Check the version of the incoming motion value with this version\n       * and warn against mismatches.\n       */\n\n      if (process.env.NODE_ENV === \"development\") {\n        warnOnce(nextValue.version === \"7.0.0\", \"Attempting to mix Framer Motion versions \".concat(nextValue.version, \" with 7.0.0 may not work as expected.\"));\n      }\n    } else if (isMotionValue(prevValue)) {\n      /**\n       * If we're swapping to a new motion value, create a new motion value\n       * from that\n       */\n      element.addValue(key, motionValue(nextValue));\n    } else if (prevValue !== nextValue) {\n      /**\n       * If this is a flat value that has changed, update the motion value\n       * or create one if it doesn't exist. We only want to do this if we're\n       * not handling the value with our animation state.\n       */\n      if (element.hasValue(key)) {\n        var existingValue = element.getValue(key); // TODO: Only update values that aren't being animated or even looked at\n\n        !existingValue.hasAnimated && existingValue.set(nextValue);\n      } else {\n        element.addValue(key, motionValue((_a = element.getStaticValue(key)) !== null && _a !== void 0 ? _a : nextValue));\n      }\n    }\n  } // Handle removed values\n\n\n  for (var key in prev) {\n    if (next[key] === undefined) element.removeValue(key);\n  }\n\n  return next;\n}\n\nvar visualElement = function visualElement(_a) {\n  var _b = _a.treeType,\n      treeType = _b === void 0 ? \"\" : _b,\n      build = _a.build,\n      _getBaseTarget = _a.getBaseTarget,\n      _makeTargetAnimatable = _a.makeTargetAnimatable,\n      _measureViewportBox = _a.measureViewportBox,\n      renderInstance = _a.render,\n      readValueFromInstance = _a.readValueFromInstance,\n      removeValueFromRenderState = _a.removeValueFromRenderState,\n      _sortNodePosition = _a.sortNodePosition,\n      scrapeMotionValuesFromProps = _a.scrapeMotionValuesFromProps;\n  return function (_a, options) {\n    var parent = _a.parent,\n        props = _a.props,\n        presenceId = _a.presenceId,\n        blockInitialAnimation = _a.blockInitialAnimation,\n        visualState = _a.visualState,\n        shouldReduceMotion = _a.shouldReduceMotion;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var isMounted = false;\n    var latestValues = visualState.latestValues,\n        renderState = visualState.renderState;\n    /**\n     * The instance of the render-specific node that will be hydrated by the\n     * exposed React ref. So for example, this visual element can host a\n     * HTMLElement, plain object, or Three.js object. The functions provided\n     * in VisualElementConfig allow us to interface with this instance.\n     */\n\n    var instance;\n    /**\n     * Manages the subscriptions for a visual element's lifecycle, for instance\n     * onRender\n     */\n\n    var lifecycles = createLifecycles();\n    /**\n     * A map of all motion values attached to this visual element. Motion\n     * values are source of truth for any given animated value. A motion\n     * value might be provided externally by the component via props.\n     */\n\n    var values = new Map();\n    /**\n     * A map of every subscription that binds the provided or generated\n     * motion values onChange listeners to this visual element.\n     */\n\n    var valueSubscriptions = new Map();\n    /**\n     * A reference to the previously-provided motion values as returned\n     * from scrapeMotionValuesFromProps. We use the keys in here to determine\n     * if any motion values need to be removed after props are updated.\n     */\n\n    var prevMotionValues = {};\n    /**\n     * When values are removed from all animation props we need to search\n     * for a fallback value to animate to. These values are tracked in baseTarget.\n     */\n\n    var baseTarget = tslib.__assign({}, latestValues); // Internal methods ========================\n\n    /**\n     * On mount, this will be hydrated with a callback to disconnect\n     * this visual element from its parent on unmount.\n     */\n\n\n    var removeFromVariantTree;\n    /**\n     * Render the element with the latest styles outside of the React\n     * render lifecycle\n     */\n\n    function render() {\n      if (!instance || !isMounted) return;\n      triggerBuild();\n      renderInstance(instance, renderState, props.style, element.projection);\n    }\n\n    function triggerBuild() {\n      build(element, renderState, latestValues, options, props);\n    }\n\n    function update() {\n      lifecycles.notifyUpdate(latestValues);\n    }\n    /**\n     *\n     */\n\n\n    function bindToMotionValue(key, value) {\n      var removeOnChange = value.onChange(function (latestValue) {\n        latestValues[key] = latestValue;\n        props.onUpdate && sync__default[\"default\"].update(update, false, true);\n      });\n      var removeOnRenderRequest = value.onRenderRequest(element.scheduleRender);\n      valueSubscriptions.set(key, function () {\n        removeOnChange();\n        removeOnRenderRequest();\n      });\n    }\n    /**\n     * Any motion values that are provided to the element when created\n     * aren't yet bound to the element, as this would technically be impure.\n     * However, we iterate through the motion values and set them to the\n     * initial values for this component.\n     *\n     * TODO: This is impure and we should look at changing this to run on mount.\n     * Doing so will break some tests but this isn't neccessarily a breaking change,\n     * more a reflection of the test.\n     */\n\n\n    var initialMotionValues = scrapeMotionValuesFromProps(props);\n\n    for (var key in initialMotionValues) {\n      var value = initialMotionValues[key];\n\n      if (latestValues[key] !== undefined && isMotionValue(value)) {\n        value.set(latestValues[key], false);\n      }\n    }\n    /**\n     * Determine what role this visual element should take in the variant tree.\n     */\n\n\n    var isControllingVariants = checkIfControllingVariants(props);\n    var isVariantNode = checkIfVariantNode(props);\n\n    var element = tslib.__assign(tslib.__assign({\n      treeType: treeType,\n\n      /**\n       * This is a mirror of the internal instance prop, which keeps\n       * VisualElement type-compatible with React's RefObject.\n       */\n      current: null,\n\n      /**\n       * The depth of this visual element within the visual element tree.\n       */\n      depth: parent ? parent.depth + 1 : 0,\n      parent: parent,\n      children: new Set(),\n\n      /**\n       *\n       */\n      presenceId: presenceId,\n      shouldReduceMotion: shouldReduceMotion,\n\n      /**\n       * If this component is part of the variant tree, it should track\n       * any children that are also part of the tree. This is essentially\n       * a shadow tree to simplify logic around how to stagger over children.\n       */\n      variantChildren: isVariantNode ? new Set() : undefined,\n\n      /**\n       * Whether this instance is visible. This can be changed imperatively\n       * by the projection tree, is analogous to CSS's visibility in that\n       * hidden elements should take up layout, and needs enacting by the configured\n       * render function.\n       */\n      isVisible: undefined,\n\n      /**\n       * Normally, if a component is controlled by a parent's variants, it can\n       * rely on that ancestor to trigger animations further down the tree.\n       * However, if a component is created after its parent is mounted, the parent\n       * won't trigger that mount animation so the child needs to.\n       *\n       * TODO: This might be better replaced with a method isParentMounted\n       */\n      manuallyAnimateOnMount: Boolean(parent === null || parent === void 0 ? void 0 : parent.isMounted()),\n\n      /**\n       * This can be set by AnimatePresence to force components that mount\n       * at the same time as it to mount as if they have initial={false} set.\n       */\n      blockInitialAnimation: blockInitialAnimation,\n\n      /**\n       * Determine whether this component has mounted yet. This is mostly used\n       * by variant children to determine whether they need to trigger their\n       * own animations on mount.\n       */\n      isMounted: function isMounted() {\n        return Boolean(instance);\n      },\n      mount: function mount(newInstance) {\n        isMounted = true;\n        instance = element.current = newInstance;\n\n        if (element.projection) {\n          element.projection.mount(newInstance);\n        }\n\n        if (isVariantNode && parent && !isControllingVariants) {\n          removeFromVariantTree = parent === null || parent === void 0 ? void 0 : parent.addVariantChild(element);\n        }\n\n        values.forEach(function (value, key) {\n          return bindToMotionValue(key, value);\n        });\n        parent === null || parent === void 0 ? void 0 : parent.children.add(element);\n        element.setProps(props);\n      },\n\n      /**\n       *\n       */\n      unmount: function unmount() {\n        var _a;\n\n        (_a = element.projection) === null || _a === void 0 ? void 0 : _a.unmount();\n        sync.cancelSync.update(update);\n        sync.cancelSync.render(render);\n        valueSubscriptions.forEach(function (remove) {\n          return remove();\n        });\n        removeFromVariantTree === null || removeFromVariantTree === void 0 ? void 0 : removeFromVariantTree();\n        parent === null || parent === void 0 ? void 0 : parent.children.delete(element);\n        lifecycles.clearAllListeners();\n        instance = undefined;\n        isMounted = false;\n      },\n\n      /**\n       * Add a child visual element to our set of children.\n       */\n      addVariantChild: function addVariantChild(child) {\n        var _a;\n\n        var closestVariantNode = element.getClosestVariantNode();\n\n        if (closestVariantNode) {\n          (_a = closestVariantNode.variantChildren) === null || _a === void 0 ? void 0 : _a.add(child);\n          return function () {\n            return closestVariantNode.variantChildren.delete(child);\n          };\n        }\n      },\n      sortNodePosition: function sortNodePosition(other) {\n        /**\n         * If these nodes aren't even of the same type we can't compare their depth.\n         */\n        if (!_sortNodePosition || treeType !== other.treeType) return 0;\n        return _sortNodePosition(element.getInstance(), other.getInstance());\n      },\n\n      /**\n       * Returns the closest variant node in the tree starting from\n       * this visual element.\n       */\n      getClosestVariantNode: function getClosestVariantNode() {\n        return isVariantNode ? element : parent === null || parent === void 0 ? void 0 : parent.getClosestVariantNode();\n      },\n\n      /**\n       * Expose the latest layoutId prop.\n       */\n      getLayoutId: function getLayoutId() {\n        return props.layoutId;\n      },\n\n      /**\n       * Returns the current instance.\n       */\n      getInstance: function getInstance() {\n        return instance;\n      },\n\n      /**\n       * Get/set the latest static values.\n       */\n      getStaticValue: function getStaticValue(key) {\n        return latestValues[key];\n      },\n      setStaticValue: function setStaticValue(key, value) {\n        return latestValues[key] = value;\n      },\n\n      /**\n       * Returns the latest motion value state. Currently only used to take\n       * a snapshot of the visual element - perhaps this can return the whole\n       * visual state\n       */\n      getLatestValues: function getLatestValues() {\n        return latestValues;\n      },\n\n      /**\n       * Set the visiblity of the visual element. If it's changed, schedule\n       * a render to reflect these changes.\n       */\n      setVisibility: function setVisibility(visibility) {\n        if (element.isVisible === visibility) return;\n        element.isVisible = visibility;\n        element.scheduleRender();\n      },\n\n      /**\n       * Make a target animatable by Popmotion. For instance, if we're\n       * trying to animate width from 100px to 100vw we need to measure 100vw\n       * in pixels to determine what we really need to animate to. This is also\n       * pluggable to support Framer's custom value types like Color,\n       * and CSS variables.\n       */\n      makeTargetAnimatable: function makeTargetAnimatable(target, canMutate) {\n        if (canMutate === void 0) {\n          canMutate = true;\n        }\n\n        return _makeTargetAnimatable(element, target, props, canMutate);\n      },\n\n      /**\n       * Measure the current viewport box with or without transforms.\n       * Only measures axis-aligned boxes, rotate and skew must be manually\n       * removed with a re-render to work.\n       */\n      measureViewportBox: function measureViewportBox() {\n        return _measureViewportBox(instance, props);\n      },\n      // Motion values ========================\n\n      /**\n       * Add a motion value and bind it to this visual element.\n       */\n      addValue: function addValue(key, value) {\n        // Remove existing value if it exists\n        if (element.hasValue(key)) element.removeValue(key);\n        values.set(key, value);\n        latestValues[key] = value.get();\n        bindToMotionValue(key, value);\n      },\n\n      /**\n       * Remove a motion value and unbind any active subscriptions.\n       */\n      removeValue: function removeValue(key) {\n        var _a;\n\n        values.delete(key);\n        (_a = valueSubscriptions.get(key)) === null || _a === void 0 ? void 0 : _a();\n        valueSubscriptions.delete(key);\n        delete latestValues[key];\n        removeValueFromRenderState(key, renderState);\n      },\n\n      /**\n       * Check whether we have a motion value for this key\n       */\n      hasValue: function hasValue(key) {\n        return values.has(key);\n      },\n\n      /**\n       * Get a motion value for this key. If called with a default\n       * value, we'll create one if none exists.\n       */\n      getValue: function getValue(key, defaultValue) {\n        var value = values.get(key);\n\n        if (value === undefined && defaultValue !== undefined) {\n          value = motionValue(defaultValue);\n          element.addValue(key, value);\n        }\n\n        return value;\n      },\n\n      /**\n       * Iterate over our motion values.\n       */\n      forEachValue: function forEachValue(callback) {\n        return values.forEach(callback);\n      },\n\n      /**\n       * If we're trying to animate to a previously unencountered value,\n       * we need to check for it in our state and as a last resort read it\n       * directly from the instance (which might have performance implications).\n       */\n      readValue: function readValue(key) {\n        var _a;\n\n        return (_a = latestValues[key]) !== null && _a !== void 0 ? _a : readValueFromInstance(instance, key, options);\n      },\n\n      /**\n       * Set the base target to later animate back to. This is currently\n       * only hydrated on creation and when we first read a value.\n       */\n      setBaseTarget: function setBaseTarget(key, value) {\n        baseTarget[key] = value;\n      },\n\n      /**\n       * Find the base target for a value thats been removed from all animation\n       * props.\n       */\n      getBaseTarget: function getBaseTarget(key) {\n        if (_getBaseTarget) {\n          var target = _getBaseTarget(props, key);\n\n          if (target !== undefined && !isMotionValue(target)) return target;\n        }\n\n        return baseTarget[key];\n      }\n    }, lifecycles), {\n      /**\n       * Build the renderer state based on the latest visual state.\n       */\n      build: function build() {\n        triggerBuild();\n        return renderState;\n      },\n\n      /**\n       * Schedule a render on the next animation frame.\n       */\n      scheduleRender: function scheduleRender() {\n        sync__default[\"default\"].render(render, false, true);\n      },\n\n      /**\n       * Synchronously fire render. It's prefered that we batch renders but\n       * in many circumstances, like layout measurement, we need to run this\n       * synchronously. However in those instances other measures should be taken\n       * to batch reads/writes.\n       */\n      syncRender: render,\n\n      /**\n       * Update the provided props. Ensure any newly-added motion values are\n       * added to our map, old ones removed, and listeners updated.\n       */\n      setProps: function setProps(newProps) {\n        if (newProps.transformTemplate || props.transformTemplate) {\n          element.scheduleRender();\n        }\n\n        props = newProps;\n        lifecycles.updatePropListeners(newProps);\n        prevMotionValues = updateMotionValuesFromProps(element, scrapeMotionValuesFromProps(props), prevMotionValues);\n      },\n      getProps: function getProps() {\n        return props;\n      },\n      // Variants ==============================\n\n      /**\n       * Returns the variant definition with a given name.\n       */\n      getVariant: function getVariant(name) {\n        var _a;\n\n        return (_a = props.variants) === null || _a === void 0 ? void 0 : _a[name];\n      },\n\n      /**\n       * Returns the defined default transition on this component.\n       */\n      getDefaultTransition: function getDefaultTransition() {\n        return props.transition;\n      },\n      getTransformPagePoint: function getTransformPagePoint() {\n        return props.transformPagePoint;\n      },\n\n      /**\n       * Used by child variant nodes to get the closest ancestor variant props.\n       */\n      getVariantContext: function getVariantContext(startAtParent) {\n        if (startAtParent === void 0) {\n          startAtParent = false;\n        }\n\n        if (startAtParent) return parent === null || parent === void 0 ? void 0 : parent.getVariantContext();\n\n        if (!isControllingVariants) {\n          var context_1 = (parent === null || parent === void 0 ? void 0 : parent.getVariantContext()) || {};\n\n          if (props.initial !== undefined) {\n            context_1.initial = props.initial;\n          }\n\n          return context_1;\n        }\n\n        var context = {};\n\n        for (var i = 0; i < numVariantProps; i++) {\n          var name_1 = variantProps[i];\n          var prop = props[name_1];\n\n          if (isVariantLabel(prop) || prop === false) {\n            context[name_1] = prop;\n          }\n        }\n\n        return context;\n      }\n    });\n\n    return element;\n  };\n};\n\nvar variantProps = tslib.__spreadArray([\"initial\"], tslib.__read(variantPriorityOrder), false);\n\nvar numVariantProps = variantProps.length;\n\nfunction isCSSVariable(value) {\n  return typeof value === \"string\" && value.startsWith(\"var(--\");\n}\n/**\n * Parse Framer's special CSS variable format into a CSS token and a fallback.\n *\n * ```\n * `var(--foo, #fff)` => [`--foo`, '#fff']\n * ```\n *\n * @param current\n */\n\n\nvar cssVariableRegex = /var\\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\\)/;\n\nfunction parseCSSVariable(current) {\n  var match = cssVariableRegex.exec(current);\n  if (!match) return [,];\n\n  var _a = tslib.__read(match, 3),\n      token = _a[1],\n      fallback = _a[2];\n\n  return [token, fallback];\n}\n\nvar maxDepth = 4;\n\nfunction getVariableValue(current, element, depth) {\n  if (depth === void 0) {\n    depth = 1;\n  }\n\n  heyListen.invariant(depth <= maxDepth, \"Max CSS variable fallback depth detected in property \\\"\".concat(current, \"\\\". This may indicate a circular fallback dependency.\"));\n\n  var _a = tslib.__read(parseCSSVariable(current), 2),\n      token = _a[0],\n      fallback = _a[1]; // No CSS variable detected\n\n\n  if (!token) return; // Attempt to read this CSS variable off the element\n\n  var resolved = window.getComputedStyle(element).getPropertyValue(token);\n\n  if (resolved) {\n    return resolved.trim();\n  } else if (isCSSVariable(fallback)) {\n    // The fallback might itself be a CSS variable, in which case we attempt to resolve it too.\n    return getVariableValue(fallback, element, depth + 1);\n  } else {\n    return fallback;\n  }\n}\n/**\n * Resolve CSS variables from\n *\n * @internal\n */\n\n\nfunction resolveCSSVariables(visualElement, _a, transitionEnd) {\n  var _b;\n\n  var target = tslib.__rest(_a, []);\n\n  var element = visualElement.getInstance();\n  if (!(element instanceof Element)) return {\n    target: target,\n    transitionEnd: transitionEnd\n  }; // If `transitionEnd` isn't `undefined`, clone it. We could clone `target` and `transitionEnd`\n  // only if they change but I think this reads clearer and this isn't a performance-critical path.\n\n  if (transitionEnd) {\n    transitionEnd = tslib.__assign({}, transitionEnd);\n  } // Go through existing `MotionValue`s and ensure any existing CSS variables are resolved\n\n\n  visualElement.forEachValue(function (value) {\n    var current = value.get();\n    if (!isCSSVariable(current)) return;\n    var resolved = getVariableValue(current, element);\n    if (resolved) value.set(resolved);\n  }); // Cycle through every target property and resolve CSS variables. Currently\n  // we only read single-var properties like `var(--foo)`, not `calc(var(--foo) + 20px)`\n\n  for (var key in target) {\n    var current = target[key];\n    if (!isCSSVariable(current)) continue;\n    var resolved = getVariableValue(current, element);\n    if (!resolved) continue; // Clone target if it hasn't already been\n\n    target[key] = resolved; // If the user hasn't already set this key on `transitionEnd`, set it to the unresolved\n    // CSS variable. This will ensure that after the animation the component will reflect\n    // changes in the value of the CSS variable.\n\n    if (transitionEnd) (_b = transitionEnd[key]) !== null && _b !== void 0 ? _b : transitionEnd[key] = current;\n  }\n\n  return {\n    target: target,\n    transitionEnd: transitionEnd\n  };\n}\n\nvar positionalKeys = new Set([\"width\", \"height\", \"top\", \"left\", \"right\", \"bottom\", \"x\", \"y\"]);\n\nvar isPositionalKey = function isPositionalKey(key) {\n  return positionalKeys.has(key);\n};\n\nvar hasPositionalKey = function hasPositionalKey(target) {\n  return Object.keys(target).some(isPositionalKey);\n};\n\nvar setAndResetVelocity = function setAndResetVelocity(value, to) {\n  // Looks odd but setting it twice doesn't render, it'll just\n  // set both prev and current to the latest value\n  value.set(to, false);\n  value.set(to);\n};\n\nvar isNumOrPxType = function isNumOrPxType(v) {\n  return v === styleValueTypes.number || v === styleValueTypes.px;\n};\n\nvar BoundingBoxDimension;\n\n(function (BoundingBoxDimension) {\n  BoundingBoxDimension[\"width\"] = \"width\";\n  BoundingBoxDimension[\"height\"] = \"height\";\n  BoundingBoxDimension[\"left\"] = \"left\";\n  BoundingBoxDimension[\"right\"] = \"right\";\n  BoundingBoxDimension[\"top\"] = \"top\";\n  BoundingBoxDimension[\"bottom\"] = \"bottom\";\n})(BoundingBoxDimension || (BoundingBoxDimension = {}));\n\nvar getPosFromMatrix = function getPosFromMatrix(matrix, pos) {\n  return parseFloat(matrix.split(\", \")[pos]);\n};\n\nvar getTranslateFromMatrix = function getTranslateFromMatrix(pos2, pos3) {\n  return function (_bbox, _a) {\n    var transform = _a.transform;\n    if (transform === \"none\" || !transform) return 0;\n    var matrix3d = transform.match(/^matrix3d\\((.+)\\)$/);\n\n    if (matrix3d) {\n      return getPosFromMatrix(matrix3d[1], pos3);\n    } else {\n      var matrix = transform.match(/^matrix\\((.+)\\)$/);\n\n      if (matrix) {\n        return getPosFromMatrix(matrix[1], pos2);\n      } else {\n        return 0;\n      }\n    }\n  };\n};\n\nvar transformKeys = new Set([\"x\", \"y\", \"z\"]);\nvar nonTranslationalTransformKeys = transformProps.filter(function (key) {\n  return !transformKeys.has(key);\n});\n\nfunction removeNonTranslationalTransform(visualElement) {\n  var removedTransforms = [];\n  nonTranslationalTransformKeys.forEach(function (key) {\n    var value = visualElement.getValue(key);\n\n    if (value !== undefined) {\n      removedTransforms.push([key, value.get()]);\n      value.set(key.startsWith(\"scale\") ? 1 : 0);\n    }\n  }); // Apply changes to element before measurement\n\n  if (removedTransforms.length) visualElement.syncRender();\n  return removedTransforms;\n}\n\nvar positionalValues = {\n  // Dimensions\n  width: function width(_a, _b) {\n    var x = _a.x;\n    var _c = _b.paddingLeft,\n        paddingLeft = _c === void 0 ? \"0\" : _c,\n        _d = _b.paddingRight,\n        paddingRight = _d === void 0 ? \"0\" : _d;\n    return x.max - x.min - parseFloat(paddingLeft) - parseFloat(paddingRight);\n  },\n  height: function height(_a, _b) {\n    var y = _a.y;\n    var _c = _b.paddingTop,\n        paddingTop = _c === void 0 ? \"0\" : _c,\n        _d = _b.paddingBottom,\n        paddingBottom = _d === void 0 ? \"0\" : _d;\n    return y.max - y.min - parseFloat(paddingTop) - parseFloat(paddingBottom);\n  },\n  top: function top(_bbox, _a) {\n    var top = _a.top;\n    return parseFloat(top);\n  },\n  left: function left(_bbox, _a) {\n    var left = _a.left;\n    return parseFloat(left);\n  },\n  bottom: function bottom(_a, _b) {\n    var y = _a.y;\n    var top = _b.top;\n    return parseFloat(top) + (y.max - y.min);\n  },\n  right: function right(_a, _b) {\n    var x = _a.x;\n    var left = _b.left;\n    return parseFloat(left) + (x.max - x.min);\n  },\n  // Transform\n  x: getTranslateFromMatrix(4, 13),\n  y: getTranslateFromMatrix(5, 14)\n};\n\nvar convertChangedValueTypes = function convertChangedValueTypes(target, visualElement, changedKeys) {\n  var originBbox = visualElement.measureViewportBox();\n  var element = visualElement.getInstance();\n  var elementComputedStyle = getComputedStyle(element);\n  var display = elementComputedStyle.display;\n  var origin = {}; // If the element is currently set to display: \"none\", make it visible before\n  // measuring the target bounding box\n\n  if (display === \"none\") {\n    visualElement.setStaticValue(\"display\", target.display || \"block\");\n  }\n  /**\n   * Record origins before we render and update styles\n   */\n\n\n  changedKeys.forEach(function (key) {\n    origin[key] = positionalValues[key](originBbox, elementComputedStyle);\n  }); // Apply the latest values (as set in checkAndConvertChangedValueTypes)\n\n  visualElement.syncRender();\n  var targetBbox = visualElement.measureViewportBox();\n  changedKeys.forEach(function (key) {\n    // Restore styles to their **calculated computed style**, not their actual\n    // originally set style. This allows us to animate between equivalent pixel units.\n    var value = visualElement.getValue(key);\n    setAndResetVelocity(value, origin[key]);\n    target[key] = positionalValues[key](targetBbox, elementComputedStyle);\n  });\n  return target;\n};\n\nvar checkAndConvertChangedValueTypes = function checkAndConvertChangedValueTypes(visualElement, target, origin, transitionEnd) {\n  if (origin === void 0) {\n    origin = {};\n  }\n\n  if (transitionEnd === void 0) {\n    transitionEnd = {};\n  }\n\n  target = tslib.__assign({}, target);\n  transitionEnd = tslib.__assign({}, transitionEnd);\n  var targetPositionalKeys = Object.keys(target).filter(isPositionalKey); // We want to remove any transform values that could affect the element's bounding box before\n  // it's measured. We'll reapply these later.\n\n  var removedTransformValues = [];\n  var hasAttemptedToRemoveTransformValues = false;\n  var changedValueTypeKeys = [];\n  targetPositionalKeys.forEach(function (key) {\n    var value = visualElement.getValue(key);\n    if (!visualElement.hasValue(key)) return;\n    var from = origin[key];\n    var fromType = findDimensionValueType(from);\n    var to = target[key];\n    var toType; // TODO: The current implementation of this basically throws an error\n    // if you try and do value conversion via keyframes. There's probably\n    // a way of doing this but the performance implications would need greater scrutiny,\n    // as it'd be doing multiple resize-remeasure operations.\n\n    if (isKeyframesTarget(to)) {\n      var numKeyframes = to.length;\n      var fromIndex = to[0] === null ? 1 : 0;\n      from = to[fromIndex];\n      fromType = findDimensionValueType(from);\n\n      for (var i = fromIndex; i < numKeyframes; i++) {\n        if (!toType) {\n          toType = findDimensionValueType(to[i]);\n          heyListen.invariant(toType === fromType || isNumOrPxType(fromType) && isNumOrPxType(toType), \"Keyframes must be of the same dimension as the current value\");\n        } else {\n          heyListen.invariant(findDimensionValueType(to[i]) === toType, \"All keyframes must be of the same type\");\n        }\n      }\n    } else {\n      toType = findDimensionValueType(to);\n    }\n\n    if (fromType !== toType) {\n      // If they're both just number or px, convert them both to numbers rather than\n      // relying on resize/remeasure to convert (which is wasteful in this situation)\n      if (isNumOrPxType(fromType) && isNumOrPxType(toType)) {\n        var current = value.get();\n\n        if (typeof current === \"string\") {\n          value.set(parseFloat(current));\n        }\n\n        if (typeof to === \"string\") {\n          target[key] = parseFloat(to);\n        } else if (Array.isArray(to) && toType === styleValueTypes.px) {\n          target[key] = to.map(parseFloat);\n        }\n      } else if ((fromType === null || fromType === void 0 ? void 0 : fromType.transform) && (toType === null || toType === void 0 ? void 0 : toType.transform) && (from === 0 || to === 0)) {\n        // If one or the other value is 0, it's safe to coerce it to the\n        // type of the other without measurement\n        if (from === 0) {\n          value.set(toType.transform(from));\n        } else {\n          target[key] = fromType.transform(to);\n        }\n      } else {\n        // If we're going to do value conversion via DOM measurements, we first\n        // need to remove non-positional transform values that could affect the bbox measurements.\n        if (!hasAttemptedToRemoveTransformValues) {\n          removedTransformValues = removeNonTranslationalTransform(visualElement);\n          hasAttemptedToRemoveTransformValues = true;\n        }\n\n        changedValueTypeKeys.push(key);\n        transitionEnd[key] = transitionEnd[key] !== undefined ? transitionEnd[key] : target[key];\n        setAndResetVelocity(value, to);\n      }\n    }\n  });\n\n  if (changedValueTypeKeys.length) {\n    var scrollY_1 = changedValueTypeKeys.indexOf(\"height\") >= 0 ? window.pageYOffset : null;\n    var convertedTarget = convertChangedValueTypes(target, visualElement, changedValueTypeKeys); // If we removed transform values, reapply them before the next render\n\n    if (removedTransformValues.length) {\n      removedTransformValues.forEach(function (_a) {\n        var _b = tslib.__read(_a, 2),\n            key = _b[0],\n            value = _b[1];\n\n        visualElement.getValue(key).set(value);\n      });\n    } // Reapply original values\n\n\n    visualElement.syncRender(); // Restore scroll position\n\n    if (scrollY_1 !== null) window.scrollTo({\n      top: scrollY_1\n    });\n    return {\n      target: convertedTarget,\n      transitionEnd: transitionEnd\n    };\n  } else {\n    return {\n      target: target,\n      transitionEnd: transitionEnd\n    };\n  }\n};\n/**\n * Convert value types for x/y/width/height/top/left/bottom/right\n *\n * Allows animation between `'auto'` -> `'100%'` or `0` -> `'calc(50% - 10vw)'`\n *\n * @internal\n */\n\n\nfunction unitConversion(visualElement, target, origin, transitionEnd) {\n  return hasPositionalKey(target) ? checkAndConvertChangedValueTypes(visualElement, target, origin, transitionEnd) : {\n    target: target,\n    transitionEnd: transitionEnd\n  };\n}\n/**\n * Parse a DOM variant to make it animatable. This involves resolving CSS variables\n * and ensuring animations like \"20%\" => \"calc(50vw)\" are performed in pixels.\n */\n\n\nvar parseDomVariant = function parseDomVariant(visualElement, target, origin, transitionEnd) {\n  var resolved = resolveCSSVariables(visualElement, target, transitionEnd);\n  target = resolved.target;\n  transitionEnd = resolved.transitionEnd;\n  return unitConversion(visualElement, target, origin, transitionEnd);\n};\n\nfunction getComputedStyle$1(element) {\n  return window.getComputedStyle(element);\n}\n\nvar htmlConfig = {\n  treeType: \"dom\",\n  readValueFromInstance: function readValueFromInstance(domElement, key) {\n    if (isTransformProp(key)) {\n      var defaultType = getDefaultValueType(key);\n      return defaultType ? defaultType.default || 0 : 0;\n    } else {\n      var computedStyle = getComputedStyle$1(domElement);\n      return (isCSSVariable$1(key) ? computedStyle.getPropertyValue(key) : computedStyle[key]) || 0;\n    }\n  },\n  sortNodePosition: function sortNodePosition(a, b) {\n    /**\n     * compareDocumentPosition returns a bitmask, by using the bitwise &\n     * we're returning true if 2 in that bitmask is set to true. 2 is set\n     * to true if b preceeds a.\n     */\n    return a.compareDocumentPosition(b) & 2 ? 1 : -1;\n  },\n  getBaseTarget: function getBaseTarget(props, key) {\n    var _a;\n\n    return (_a = props.style) === null || _a === void 0 ? void 0 : _a[key];\n  },\n  measureViewportBox: function measureViewportBox(element, _a) {\n    var transformPagePoint = _a.transformPagePoint;\n    return _measureViewportBox2(element, transformPagePoint);\n  },\n\n  /**\n   * Reset the transform on the current Element. This is called as part\n   * of a batched process across the entire layout tree. To remove this write\n   * cycle it'd be interesting to see if it's possible to \"undo\" all the current\n   * layout transforms up the tree in the same way this.getBoundingBoxWithoutTransforms\n   * works\n   */\n  resetTransform: function resetTransform(element, domElement, props) {\n    var transformTemplate = props.transformTemplate;\n    domElement.style.transform = transformTemplate ? transformTemplate({}, \"\") : \"none\"; // Ensure that whatever happens next, we restore our transform on the next frame\n\n    element.scheduleRender();\n  },\n  restoreTransform: function restoreTransform(instance, mutableState) {\n    instance.style.transform = mutableState.style.transform;\n  },\n  removeValueFromRenderState: function removeValueFromRenderState(key, _a) {\n    var vars = _a.vars,\n        style = _a.style;\n    delete vars[key];\n    delete style[key];\n  },\n\n  /**\n   * Ensure that HTML and Framer-specific value types like `px`->`%` and `Color`\n   * can be animated by Motion.\n   */\n  makeTargetAnimatable: function makeTargetAnimatable(element, _a, _b, isMounted) {\n    var transition = _a.transition,\n        transitionEnd = _a.transitionEnd,\n        target = tslib.__rest(_a, [\"transition\", \"transitionEnd\"]);\n\n    var transformValues = _b.transformValues;\n\n    if (isMounted === void 0) {\n      isMounted = true;\n    }\n\n    var origin = getOrigin(target, transition || {}, element);\n    /**\n     * If Framer has provided a function to convert `Color` etc value types, convert them\n     */\n\n    if (transformValues) {\n      if (transitionEnd) transitionEnd = transformValues(transitionEnd);\n      if (target) target = transformValues(target);\n      if (origin) origin = transformValues(origin);\n    }\n\n    if (isMounted) {\n      checkTargetForNewValues(element, target, origin);\n      var parsed = parseDomVariant(element, target, origin, transitionEnd);\n      transitionEnd = parsed.transitionEnd;\n      target = parsed.target;\n    }\n\n    return tslib.__assign({\n      transition: transition,\n      transitionEnd: transitionEnd\n    }, target);\n  },\n  scrapeMotionValuesFromProps: scrapeMotionValuesFromProps$1,\n  build: function build(element, renderState, latestValues, options, props) {\n    if (element.isVisible !== undefined) {\n      renderState.style.visibility = element.isVisible ? \"visible\" : \"hidden\";\n    }\n\n    buildHTMLStyles(renderState, latestValues, options, props.transformTemplate);\n  },\n  render: renderHTML\n};\nvar htmlVisualElement = visualElement(htmlConfig);\nvar svgVisualElement = visualElement(tslib.__assign(tslib.__assign({}, htmlConfig), {\n  getBaseTarget: function getBaseTarget(props, key) {\n    return props[key];\n  },\n  readValueFromInstance: function readValueFromInstance(domElement, key) {\n    var _a;\n\n    if (isTransformProp(key)) {\n      return ((_a = getDefaultValueType(key)) === null || _a === void 0 ? void 0 : _a.default) || 0;\n    }\n\n    key = !camelCaseAttributes.has(key) ? camelToDash(key) : key;\n    return domElement.getAttribute(key);\n  },\n  scrapeMotionValuesFromProps: scrapeMotionValuesFromProps,\n  build: function build(_element, renderState, latestValues, options, props) {\n    buildSVGAttrs(renderState, latestValues, options, props.transformTemplate);\n  },\n  render: renderSVG\n}));\n\nvar createDomVisualElement = function createDomVisualElement(Component, options) {\n  return isSVGComponent(Component) ? svgVisualElement(options, {\n    enableHardwareAcceleration: false\n  }) : htmlVisualElement(options, {\n    enableHardwareAcceleration: true\n  });\n};\n\nfunction pixelsToPercent(pixels, axis) {\n  if (axis.max === axis.min) return 0;\n  return pixels / (axis.max - axis.min) * 100;\n}\n/**\n * We always correct borderRadius as a percentage rather than pixels to reduce paints.\n * For example, if you are projecting a box that is 100px wide with a 10px borderRadius\n * into a box that is 200px wide with a 20px borderRadius, that is actually a 10%\n * borderRadius in both states. If we animate between the two in pixels that will trigger\n * a paint each time. If we animate between the two in percentage we'll avoid a paint.\n */\n\n\nvar correctBorderRadius = {\n  correct: function correct(latest, node) {\n    if (!node.target) return latest;\n    /**\n     * If latest is a string, if it's a percentage we can return immediately as it's\n     * going to be stretched appropriately. Otherwise, if it's a pixel, convert it to a number.\n     */\n\n    if (typeof latest === \"string\") {\n      if (styleValueTypes.px.test(latest)) {\n        latest = parseFloat(latest);\n      } else {\n        return latest;\n      }\n    }\n    /**\n     * If latest is a number, it's a pixel value. We use the current viewportBox to calculate that\n     * pixel value as a percentage of each axis\n     */\n\n\n    var x = pixelsToPercent(latest, node.target.x);\n    var y = pixelsToPercent(latest, node.target.y);\n    return \"\".concat(x, \"% \").concat(y, \"%\");\n  }\n};\nvar varToken = \"_$css\";\nvar correctBoxShadow = {\n  correct: function correct(latest, _a) {\n    var treeScale = _a.treeScale,\n        projectionDelta = _a.projectionDelta;\n    var original = latest;\n    /**\n     * We need to first strip and store CSS variables from the string.\n     */\n\n    var containsCSSVariables = latest.includes(\"var(\");\n    var cssVariables = [];\n\n    if (containsCSSVariables) {\n      latest = latest.replace(cssVariableRegex, function (match) {\n        cssVariables.push(match);\n        return varToken;\n      });\n    }\n\n    var shadow = styleValueTypes.complex.parse(latest); // TODO: Doesn't support multiple shadows\n\n    if (shadow.length > 5) return original;\n    var template = styleValueTypes.complex.createTransformer(latest);\n    var offset = typeof shadow[0] !== \"number\" ? 1 : 0; // Calculate the overall context scale\n\n    var xScale = projectionDelta.x.scale * treeScale.x;\n    var yScale = projectionDelta.y.scale * treeScale.y;\n    shadow[0 + offset] /= xScale;\n    shadow[1 + offset] /= yScale;\n    /**\n     * Ideally we'd correct x and y scales individually, but because blur and\n     * spread apply to both we have to take a scale average and apply that instead.\n     * We could potentially improve the outcome of this by incorporating the ratio between\n     * the two scales.\n     */\n\n    var averageScale = popmotion.mix(xScale, yScale, 0.5); // Blur\n\n    if (typeof shadow[2 + offset] === \"number\") shadow[2 + offset] /= averageScale; // Spread\n\n    if (typeof shadow[3 + offset] === \"number\") shadow[3 + offset] /= averageScale;\n    var output = template(shadow);\n\n    if (containsCSSVariables) {\n      var i_1 = 0;\n      output = output.replace(varToken, function () {\n        var cssVariable = cssVariables[i_1];\n        i_1++;\n        return cssVariable;\n      });\n    }\n\n    return output;\n  }\n};\n\nvar MeasureLayoutWithContext =\n/** @class */\nfunction (_super) {\n  tslib.__extends(MeasureLayoutWithContext, _super);\n\n  function MeasureLayoutWithContext() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * This only mounts projection nodes for components that\n   * need measuring, we might want to do it for all components\n   * in order to incorporate transforms\n   */\n\n\n  MeasureLayoutWithContext.prototype.componentDidMount = function () {\n    var _this = this;\n\n    var _a = this.props,\n        visualElement = _a.visualElement,\n        layoutGroup = _a.layoutGroup,\n        switchLayoutGroup = _a.switchLayoutGroup,\n        layoutId = _a.layoutId;\n    var projection = visualElement.projection;\n    addScaleCorrector(defaultScaleCorrectors);\n\n    if (projection) {\n      if (layoutGroup === null || layoutGroup === void 0 ? void 0 : layoutGroup.group) layoutGroup.group.add(projection);\n\n      if ((switchLayoutGroup === null || switchLayoutGroup === void 0 ? void 0 : switchLayoutGroup.register) && layoutId) {\n        switchLayoutGroup.register(projection);\n      }\n\n      projection.root.didUpdate();\n      projection.addEventListener(\"animationComplete\", function () {\n        _this.safeToRemove();\n      });\n      projection.setOptions(tslib.__assign(tslib.__assign({}, projection.options), {\n        onExitComplete: function onExitComplete() {\n          return _this.safeToRemove();\n        }\n      }));\n    }\n\n    globalProjectionState.hasEverUpdated = true;\n  };\n\n  MeasureLayoutWithContext.prototype.getSnapshotBeforeUpdate = function (prevProps) {\n    var _this = this;\n\n    var _a = this.props,\n        layoutDependency = _a.layoutDependency,\n        visualElement = _a.visualElement,\n        drag = _a.drag,\n        isPresent = _a.isPresent;\n    var projection = visualElement.projection;\n    if (!projection) return null;\n    /**\n     * TODO: We use this data in relegate to determine whether to\n     * promote a previous element. There's no guarantee its presence data\n     * will have updated by this point - if a bug like this arises it will\n     * have to be that we markForRelegation and then find a new lead some other way,\n     * perhaps in didUpdate\n     */\n\n    projection.isPresent = isPresent;\n\n    if (drag || prevProps.layoutDependency !== layoutDependency || layoutDependency === undefined) {\n      projection.willUpdate();\n    } else {\n      this.safeToRemove();\n    }\n\n    if (prevProps.isPresent !== isPresent) {\n      if (isPresent) {\n        projection.promote();\n      } else if (!projection.relegate()) {\n        /**\n         * If there's another stack member taking over from this one,\n         * it's in charge of the exit animation and therefore should\n         * be in charge of the safe to remove. Otherwise we call it here.\n         */\n        sync__default[\"default\"].postRender(function () {\n          var _a;\n\n          if (!((_a = projection.getStack()) === null || _a === void 0 ? void 0 : _a.members.length)) {\n            _this.safeToRemove();\n          }\n        });\n      }\n    }\n\n    return null;\n  };\n\n  MeasureLayoutWithContext.prototype.componentDidUpdate = function () {\n    var projection = this.props.visualElement.projection;\n\n    if (projection) {\n      projection.root.didUpdate();\n\n      if (!projection.currentAnimation && projection.isLead()) {\n        this.safeToRemove();\n      }\n    }\n  };\n\n  MeasureLayoutWithContext.prototype.componentWillUnmount = function () {\n    var _a = this.props,\n        visualElement = _a.visualElement,\n        layoutGroup = _a.layoutGroup,\n        promoteContext = _a.switchLayoutGroup;\n    var projection = visualElement.projection;\n\n    if (projection) {\n      projection.scheduleCheckAfterUnmount();\n      if (layoutGroup === null || layoutGroup === void 0 ? void 0 : layoutGroup.group) layoutGroup.group.remove(projection);\n      if (promoteContext === null || promoteContext === void 0 ? void 0 : promoteContext.deregister) promoteContext.deregister(projection);\n    }\n  };\n\n  MeasureLayoutWithContext.prototype.safeToRemove = function () {\n    var safeToRemove = this.props.safeToRemove;\n    safeToRemove === null || safeToRemove === void 0 ? void 0 : safeToRemove();\n  };\n\n  MeasureLayoutWithContext.prototype.render = function () {\n    return null;\n  };\n\n  return MeasureLayoutWithContext;\n}(React__default[\"default\"].Component);\n\nfunction MeasureLayout(props) {\n  var _a = tslib.__read(usePresence(), 2),\n      isPresent = _a[0],\n      safeToRemove = _a[1];\n\n  var layoutGroup = React.useContext(LayoutGroupContext);\n  return React__default[\"default\"].createElement(MeasureLayoutWithContext, tslib.__assign({}, props, {\n    layoutGroup: layoutGroup,\n    switchLayoutGroup: React.useContext(SwitchLayoutGroupContext),\n    isPresent: isPresent,\n    safeToRemove: safeToRemove\n  }));\n}\n\nvar defaultScaleCorrectors = {\n  borderRadius: tslib.__assign(tslib.__assign({}, correctBorderRadius), {\n    applyTo: [\"borderTopLeftRadius\", \"borderTopRightRadius\", \"borderBottomLeftRadius\", \"borderBottomRightRadius\"]\n  }),\n  borderTopLeftRadius: correctBorderRadius,\n  borderTopRightRadius: correctBorderRadius,\n  borderBottomLeftRadius: correctBorderRadius,\n  borderBottomRightRadius: correctBorderRadius,\n  boxShadow: correctBoxShadow\n};\nvar layoutFeatures = {\n  measureLayout: MeasureLayout\n};\n/**\n * Animate a single value or a `MotionValue`.\n *\n * The first argument is either a `MotionValue` to animate, or an initial animation value.\n *\n * The second is either a value to animate to, or an array of keyframes to animate through.\n *\n * The third argument can be either tween or spring options, and optional lifecycle methods: `onUpdate`, `onPlay`, `onComplete`, `onRepeat` and `onStop`.\n *\n * Returns `AnimationPlaybackControls`, currently just a `stop` method.\n *\n * ```javascript\n * const x = useMotionValue(0)\n *\n * useEffect(() => {\n *   const controls = animate(x, 100, {\n *     type: \"spring\",\n *     stiffness: 2000,\n *     onComplete: v => {}\n *   })\n *\n *   return controls.stop\n * })\n * ```\n *\n * @public\n */\n\nfunction animate(from, to, transition) {\n  if (transition === void 0) {\n    transition = {};\n  }\n\n  var value = isMotionValue(from) ? from : motionValue(from);\n  startAnimation(\"\", value, to, transition);\n  return {\n    stop: function stop() {\n      return value.stop();\n    },\n    isAnimating: function isAnimating() {\n      return value.isAnimating();\n    }\n  };\n}\n\nvar borders = [\"TopLeft\", \"TopRight\", \"BottomLeft\", \"BottomRight\"];\nvar numBorders = borders.length;\n\nvar asNumber = function asNumber(value) {\n  return typeof value === \"string\" ? parseFloat(value) : value;\n};\n\nvar isPx = function isPx(value) {\n  return typeof value === \"number\" || styleValueTypes.px.test(value);\n};\n\nfunction mixValues(target, follow, lead, progress, shouldCrossfadeOpacity, isOnlyMember) {\n  var _a, _b, _c, _d;\n\n  if (shouldCrossfadeOpacity) {\n    target.opacity = popmotion.mix(0, // (follow?.opacity as number) ?? 0,\n    // TODO Reinstate this if only child\n    (_a = lead.opacity) !== null && _a !== void 0 ? _a : 1, easeCrossfadeIn(progress));\n    target.opacityExit = popmotion.mix((_b = follow.opacity) !== null && _b !== void 0 ? _b : 1, 0, easeCrossfadeOut(progress));\n  } else if (isOnlyMember) {\n    target.opacity = popmotion.mix((_c = follow.opacity) !== null && _c !== void 0 ? _c : 1, (_d = lead.opacity) !== null && _d !== void 0 ? _d : 1, progress);\n  }\n  /**\n   * Mix border radius\n   */\n\n\n  for (var i = 0; i < numBorders; i++) {\n    var borderLabel = \"border\".concat(borders[i], \"Radius\");\n    var followRadius = getRadius(follow, borderLabel);\n    var leadRadius = getRadius(lead, borderLabel);\n    if (followRadius === undefined && leadRadius === undefined) continue;\n    followRadius || (followRadius = 0);\n    leadRadius || (leadRadius = 0);\n    var canMix = followRadius === 0 || leadRadius === 0 || isPx(followRadius) === isPx(leadRadius);\n\n    if (canMix) {\n      target[borderLabel] = Math.max(popmotion.mix(asNumber(followRadius), asNumber(leadRadius), progress), 0);\n\n      if (styleValueTypes.percent.test(leadRadius) || styleValueTypes.percent.test(followRadius)) {\n        target[borderLabel] += \"%\";\n      }\n    } else {\n      target[borderLabel] = leadRadius;\n    }\n  }\n  /**\n   * Mix rotation\n   */\n\n\n  if (follow.rotate || lead.rotate) {\n    target.rotate = popmotion.mix(follow.rotate || 0, lead.rotate || 0, progress);\n  }\n}\n\nfunction getRadius(values, radiusName) {\n  var _a;\n\n  return (_a = values[radiusName]) !== null && _a !== void 0 ? _a : values.borderRadius;\n} // /**\n//  * We only want to mix the background color if there's a follow element\n//  * that we're not crossfading opacity between. For instance with switch\n//  * AnimateSharedLayout animations, this helps the illusion of a continuous\n//  * element being animated but also cuts down on the number of paints triggered\n//  * for elements where opacity is doing that work for us.\n//  */\n// if (\n//     !hasFollowElement &&\n//     latestLeadValues.backgroundColor &&\n//     latestFollowValues.backgroundColor\n// ) {\n//     /**\n//      * This isn't ideal performance-wise as mixColor is creating a new function every frame.\n//      * We could probably create a mixer that runs at the start of the animation but\n//      * the idea behind the crossfader is that it runs dynamically between two potentially\n//      * changing targets (ie opacity or borderRadius may be animating independently via variants)\n//      */\n//     leadState.backgroundColor = followState.backgroundColor = mixColor(\n//         latestFollowValues.backgroundColor as string,\n//         latestLeadValues.backgroundColor as string\n//     )(p)\n// }\n\n\nvar easeCrossfadeIn = compress(0, 0.5, popmotion.circOut);\nvar easeCrossfadeOut = compress(0.5, 0.95, popmotion.linear);\n\nfunction compress(min, max, easing) {\n  return function (p) {\n    // Could replace ifs with clamp\n    if (p < min) return 0;\n    if (p > max) return 1;\n    return easing(popmotion.progress(min, max, p));\n  };\n}\n/**\n * Reset an axis to the provided origin box.\n *\n * This is a mutative operation.\n */\n\n\nfunction copyAxisInto(axis, originAxis) {\n  axis.min = originAxis.min;\n  axis.max = originAxis.max;\n}\n/**\n * Reset a box to the provided origin box.\n *\n * This is a mutative operation.\n */\n\n\nfunction copyBoxInto(box, originBox) {\n  copyAxisInto(box.x, originBox.x);\n  copyAxisInto(box.y, originBox.y);\n}\n/**\n * Remove a delta from a point. This is essentially the steps of applyPointDelta in reverse\n */\n\n\nfunction removePointDelta(point, translate, scale, originPoint, boxScale) {\n  point -= translate;\n  point = scalePoint(point, 1 / scale, originPoint);\n\n  if (boxScale !== undefined) {\n    point = scalePoint(point, 1 / boxScale, originPoint);\n  }\n\n  return point;\n}\n/**\n * Remove a delta from an axis. This is essentially the steps of applyAxisDelta in reverse\n */\n\n\nfunction removeAxisDelta(axis, translate, scale, origin, boxScale, originAxis, sourceAxis) {\n  if (translate === void 0) {\n    translate = 0;\n  }\n\n  if (scale === void 0) {\n    scale = 1;\n  }\n\n  if (origin === void 0) {\n    origin = 0.5;\n  }\n\n  if (originAxis === void 0) {\n    originAxis = axis;\n  }\n\n  if (sourceAxis === void 0) {\n    sourceAxis = axis;\n  }\n\n  if (styleValueTypes.percent.test(translate)) {\n    translate = parseFloat(translate);\n    var relativeProgress = popmotion.mix(sourceAxis.min, sourceAxis.max, translate / 100);\n    translate = relativeProgress - sourceAxis.min;\n  }\n\n  if (typeof translate !== \"number\") return;\n  var originPoint = popmotion.mix(originAxis.min, originAxis.max, origin);\n  if (axis === originAxis) originPoint -= translate;\n  axis.min = removePointDelta(axis.min, translate, scale, originPoint, boxScale);\n  axis.max = removePointDelta(axis.max, translate, scale, originPoint, boxScale);\n}\n/**\n * Remove a transforms from an axis. This is essentially the steps of applyAxisTransforms in reverse\n * and acts as a bridge between motion values and removeAxisDelta\n */\n\n\nfunction removeAxisTransforms(axis, transforms, _a, origin, sourceAxis) {\n  var _b = tslib.__read(_a, 3),\n      key = _b[0],\n      scaleKey = _b[1],\n      originKey = _b[2];\n\n  removeAxisDelta(axis, transforms[key], transforms[scaleKey], transforms[originKey], transforms.scale, origin, sourceAxis);\n}\n/**\n * The names of the motion values we want to apply as translation, scale and origin.\n */\n\n\nvar xKeys = [\"x\", \"scaleX\", \"originX\"];\nvar yKeys = [\"y\", \"scaleY\", \"originY\"];\n/**\n * Remove a transforms from an box. This is essentially the steps of applyAxisBox in reverse\n * and acts as a bridge between motion values and removeAxisDelta\n */\n\nfunction removeBoxTransforms(box, transforms, originBox, sourceBox) {\n  removeAxisTransforms(box.x, transforms, xKeys, originBox === null || originBox === void 0 ? void 0 : originBox.x, sourceBox === null || sourceBox === void 0 ? void 0 : sourceBox.x);\n  removeAxisTransforms(box.y, transforms, yKeys, originBox === null || originBox === void 0 ? void 0 : originBox.y, sourceBox === null || sourceBox === void 0 ? void 0 : sourceBox.y);\n}\n\nfunction isAxisDeltaZero(delta) {\n  return delta.translate === 0 && delta.scale === 1;\n}\n\nfunction isDeltaZero(delta) {\n  return isAxisDeltaZero(delta.x) && isAxisDeltaZero(delta.y);\n}\n\nfunction boxEquals(a, b) {\n  return a.x.min === b.x.min && a.x.max === b.x.max && a.y.min === b.y.min && a.y.max === b.y.max;\n}\n\nvar NodeStack =\n/** @class */\nfunction () {\n  function NodeStack() {\n    this.members = [];\n  }\n\n  NodeStack.prototype.add = function (node) {\n    addUniqueItem(this.members, node);\n    node.scheduleRender();\n  };\n\n  NodeStack.prototype.remove = function (node) {\n    removeItem(this.members, node);\n\n    if (node === this.prevLead) {\n      this.prevLead = undefined;\n    }\n\n    if (node === this.lead) {\n      var prevLead = this.members[this.members.length - 1];\n\n      if (prevLead) {\n        this.promote(prevLead);\n      }\n    }\n  };\n\n  NodeStack.prototype.relegate = function (node) {\n    var indexOfNode = this.members.findIndex(function (member) {\n      return node === member;\n    });\n    if (indexOfNode === 0) return false;\n    /**\n     * Find the next projection node that is present\n     */\n\n    var prevLead;\n\n    for (var i = indexOfNode; i >= 0; i--) {\n      var member = this.members[i];\n\n      if (member.isPresent !== false) {\n        prevLead = member;\n        break;\n      }\n    }\n\n    if (prevLead) {\n      this.promote(prevLead);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  NodeStack.prototype.promote = function (node, preserveFollowOpacity) {\n    var _a;\n\n    var prevLead = this.lead;\n    if (node === prevLead) return;\n    this.prevLead = prevLead;\n    this.lead = node;\n    node.show();\n\n    if (prevLead) {\n      prevLead.instance && prevLead.scheduleRender();\n      node.scheduleRender();\n      node.resumeFrom = prevLead;\n\n      if (preserveFollowOpacity) {\n        node.resumeFrom.preserveOpacity = true;\n      }\n\n      if (prevLead.snapshot) {\n        node.snapshot = prevLead.snapshot;\n        node.snapshot.latestValues = prevLead.animationValues || prevLead.latestValues;\n        node.snapshot.isShared = true;\n      }\n\n      if ((_a = node.root) === null || _a === void 0 ? void 0 : _a.isUpdating) {\n        node.isLayoutDirty = true;\n      }\n\n      var crossfade = node.options.crossfade;\n\n      if (crossfade === false) {\n        prevLead.hide();\n      }\n      /**\n       * TODO:\n       *   - Test border radius when previous node was deleted\n       *   - boxShadow mixing\n       *   - Shared between element A in scrolled container and element B (scroll stays the same or changes)\n       *   - Shared between element A in transformed container and element B (transform stays the same or changes)\n       *   - Shared between element A in scrolled page and element B (scroll stays the same or changes)\n       * ---\n       *   - Crossfade opacity of root nodes\n       *   - layoutId changes after animation\n       *   - layoutId changes mid animation\n       */\n\n    }\n  };\n\n  NodeStack.prototype.exitAnimationComplete = function () {\n    this.members.forEach(function (node) {\n      var _a, _b, _c, _d, _e;\n\n      (_b = (_a = node.options).onExitComplete) === null || _b === void 0 ? void 0 : _b.call(_a);\n      (_e = (_c = node.resumingFrom) === null || _c === void 0 ? void 0 : (_d = _c.options).onExitComplete) === null || _e === void 0 ? void 0 : _e.call(_d);\n    });\n  };\n\n  NodeStack.prototype.scheduleRender = function () {\n    this.members.forEach(function (node) {\n      node.instance && node.scheduleRender(false);\n    });\n  };\n  /**\n   * Clear any leads that have been removed this render to prevent them from being\n   * used in future animations and to prevent memory leaks\n   */\n\n\n  NodeStack.prototype.removeLeadSnapshot = function () {\n    if (this.lead && this.lead.snapshot) {\n      this.lead.snapshot = undefined;\n    }\n  };\n\n  return NodeStack;\n}();\n\nvar identityProjection = \"translate3d(0px, 0px, 0) scale(1, 1) scale(1, 1)\";\n\nfunction buildProjectionTransform(delta, treeScale, latestTransform) {\n  /**\n   * The translations we use to calculate are always relative to the viewport coordinate space.\n   * But when we apply scales, we also scale the coordinate space of an element and its children.\n   * For instance if we have a treeScale (the culmination of all parent scales) of 0.5 and we need\n   * to move an element 100 pixels, we actually need to move it 200 in within that scaled space.\n   */\n  var xTranslate = delta.x.translate / treeScale.x;\n  var yTranslate = delta.y.translate / treeScale.y;\n  var transform = \"translate3d(\".concat(xTranslate, \"px, \").concat(yTranslate, \"px, 0) \");\n  /**\n   * Apply scale correction for the tree transform.\n   * This will apply scale to the screen-orientated axes.\n   */\n\n  transform += \"scale(\".concat(1 / treeScale.x, \", \").concat(1 / treeScale.y, \") \");\n\n  if (latestTransform) {\n    var rotate = latestTransform.rotate,\n        rotateX = latestTransform.rotateX,\n        rotateY = latestTransform.rotateY;\n    if (rotate) transform += \"rotate(\".concat(rotate, \"deg) \");\n    if (rotateX) transform += \"rotateX(\".concat(rotateX, \"deg) \");\n    if (rotateY) transform += \"rotateY(\".concat(rotateY, \"deg) \");\n  }\n  /**\n   * Apply scale to match the size of the element to the size we want it.\n   * This will apply scale to the element-orientated axes.\n   */\n\n\n  var elementScaleX = delta.x.scale * treeScale.x;\n  var elementScaleY = delta.y.scale * treeScale.y;\n  transform += \"scale(\".concat(elementScaleX, \", \").concat(elementScaleY, \")\");\n  return transform === identityProjection ? \"none\" : transform;\n}\n\nvar compareByDepth = function compareByDepth(a, b) {\n  return a.depth - b.depth;\n};\n\nvar FlatTree =\n/** @class */\nfunction () {\n  function FlatTree() {\n    this.children = [];\n    this.isDirty = false;\n  }\n\n  FlatTree.prototype.add = function (child) {\n    addUniqueItem(this.children, child);\n    this.isDirty = true;\n  };\n\n  FlatTree.prototype.remove = function (child) {\n    removeItem(this.children, child);\n    this.isDirty = true;\n  };\n\n  FlatTree.prototype.forEach = function (callback) {\n    this.isDirty && this.children.sort(compareByDepth);\n    this.isDirty = false;\n    this.children.forEach(callback);\n  };\n\n  return FlatTree;\n}();\n/**\n * We use 1000 as the animation target as 0-1000 maps better to pixels than 0-1\n * which has a noticeable difference in spring animations\n */\n\n\nvar animationTarget = 1000;\n\nfunction createProjectionNode(_a) {\n  var attachResizeListener = _a.attachResizeListener,\n      defaultParent = _a.defaultParent,\n      measureScroll = _a.measureScroll,\n      checkIsScrollRoot = _a.checkIsScrollRoot,\n      resetTransform = _a.resetTransform;\n  return (\n    /** @class */\n    function () {\n      function ProjectionNode(id, latestValues, parent) {\n        if (latestValues === void 0) {\n          latestValues = {};\n        }\n\n        if (parent === void 0) {\n          parent = defaultParent === null || defaultParent === void 0 ? void 0 : defaultParent();\n        }\n\n        var _this = this;\n        /**\n         * A Set containing all this component's children. This is used to iterate\n         * through the children.\n         *\n         * TODO: This could be faster to iterate as a flat array stored on the root node.\n         */\n\n\n        this.children = new Set();\n        /**\n         * Options for the node. We use this to configure what kind of layout animations\n         * we should perform (if any).\n         */\n\n        this.options = {};\n        /**\n         * We use this to detect when its safe to shut down part of a projection tree.\n         * We have to keep projecting children for scale correction and relative projection\n         * until all their parents stop performing layout animations.\n         */\n\n        this.isTreeAnimating = false;\n        this.isAnimationBlocked = false;\n        /**\n         * Flag to true if we think this layout has been changed. We can't always know this,\n         * currently we set it to true every time a component renders, or if it has a layoutDependency\n         * if that has changed between renders. Additionally, components can be grouped by LayoutGroup\n         * and if one node is dirtied, they all are.\n         */\n\n        this.isLayoutDirty = false;\n        /**\n         * Block layout updates for instant layout transitions throughout the tree.\n         */\n\n        this.updateManuallyBlocked = false;\n        this.updateBlockedByResize = false;\n        /**\n         * Set to true between the start of the first `willUpdate` call and the end of the `didUpdate`\n         * call.\n         */\n\n        this.isUpdating = false;\n        /**\n         * If this is an SVG element we currently disable projection transforms\n         */\n\n        this.isSVG = false;\n        /**\n         * Flag to true (during promotion) if a node doing an instant layout transition needs to reset\n         * its projection styles.\n         */\n\n        this.needsReset = false;\n        /**\n         * Flags whether this node should have its transform reset prior to measuring.\n         */\n\n        this.shouldResetTransform = false;\n        /**\n         * An object representing the calculated contextual/accumulated/tree scale.\n         * This will be used to scale calculcated projection transforms, as these are\n         * calculated in screen-space but need to be scaled for elements to actually\n         * make it to their calculated destinations.\n         *\n         * TODO: Lazy-init\n         */\n\n        this.treeScale = {\n          x: 1,\n          y: 1\n        };\n        /**\n         *\n         */\n\n        this.eventHandlers = new Map(); // Note: Currently only running on root node\n\n        this.potentialNodes = new Map();\n\n        this.checkUpdateFailed = function () {\n          if (_this.isUpdating) {\n            _this.isUpdating = false;\n\n            _this.clearAllSnapshots();\n          }\n        };\n\n        this.updateProjection = function () {\n          _this.nodes.forEach(resolveTargetDelta);\n\n          _this.nodes.forEach(calcProjection);\n        };\n\n        this.hasProjected = false;\n        this.isVisible = true;\n        this.animationProgress = 0;\n        /**\n         * Shared layout\n         */\n        // TODO Only running on root node\n\n        this.sharedNodes = new Map();\n        this.id = id;\n        this.latestValues = latestValues;\n        this.root = parent ? parent.root || parent : this;\n        this.path = parent ? tslib.__spreadArray(tslib.__spreadArray([], tslib.__read(parent.path), false), [parent], false) : [];\n        this.parent = parent;\n        this.depth = parent ? parent.depth + 1 : 0;\n        id && this.root.registerPotentialNode(id, this);\n\n        for (var i = 0; i < this.path.length; i++) {\n          this.path[i].shouldResetTransform = true;\n        }\n\n        if (this.root === this) this.nodes = new FlatTree();\n      }\n\n      ProjectionNode.prototype.addEventListener = function (name, handler) {\n        if (!this.eventHandlers.has(name)) {\n          this.eventHandlers.set(name, new SubscriptionManager());\n        }\n\n        return this.eventHandlers.get(name).add(handler);\n      };\n\n      ProjectionNode.prototype.notifyListeners = function (name) {\n        var args = [];\n\n        for (var _i = 1; _i < arguments.length; _i++) {\n          args[_i - 1] = arguments[_i];\n        }\n\n        var subscriptionManager = this.eventHandlers.get(name);\n        subscriptionManager === null || subscriptionManager === void 0 ? void 0 : subscriptionManager.notify.apply(subscriptionManager, tslib.__spreadArray([], tslib.__read(args), false));\n      };\n\n      ProjectionNode.prototype.hasListeners = function (name) {\n        return this.eventHandlers.has(name);\n      };\n\n      ProjectionNode.prototype.registerPotentialNode = function (id, node) {\n        this.potentialNodes.set(id, node);\n      };\n      /**\n       * Lifecycles\n       */\n\n\n      ProjectionNode.prototype.mount = function (instance, isLayoutDirty) {\n        var _this = this;\n\n        var _a;\n\n        if (isLayoutDirty === void 0) {\n          isLayoutDirty = false;\n        }\n\n        if (this.instance) return;\n        this.isSVG = instance instanceof SVGElement && instance.tagName !== \"svg\";\n        this.instance = instance;\n        var _b = this.options,\n            layoutId = _b.layoutId,\n            layout = _b.layout,\n            visualElement = _b.visualElement;\n\n        if (visualElement && !visualElement.getInstance()) {\n          visualElement.mount(instance);\n        }\n\n        this.root.nodes.add(this);\n        (_a = this.parent) === null || _a === void 0 ? void 0 : _a.children.add(this);\n        this.id && this.root.potentialNodes.delete(this.id);\n\n        if (isLayoutDirty && (layout || layoutId)) {\n          this.isLayoutDirty = true;\n        }\n\n        if (attachResizeListener) {\n          var unblockTimeout_1;\n\n          var resizeUnblockUpdate_1 = function resizeUnblockUpdate_1() {\n            return _this.root.updateBlockedByResize = false;\n          };\n\n          attachResizeListener(instance, function () {\n            _this.root.updateBlockedByResize = true;\n            clearTimeout(unblockTimeout_1);\n            unblockTimeout_1 = window.setTimeout(resizeUnblockUpdate_1, 250);\n\n            if (globalProjectionState.hasAnimatedSinceResize) {\n              globalProjectionState.hasAnimatedSinceResize = false;\n\n              _this.nodes.forEach(finishAnimation);\n            }\n          });\n        }\n\n        if (layoutId) {\n          this.root.registerSharedNode(layoutId, this);\n        } // Only register the handler if it requires layout animation\n\n\n        if (this.options.animate !== false && visualElement && (layoutId || layout)) {\n          this.addEventListener(\"didUpdate\", function (_a) {\n            var _b, _c, _d, _e, _f;\n\n            var delta = _a.delta,\n                hasLayoutChanged = _a.hasLayoutChanged,\n                hasRelativeTargetChanged = _a.hasRelativeTargetChanged,\n                newLayout = _a.layout;\n\n            if (_this.isTreeAnimationBlocked()) {\n              _this.target = undefined;\n              _this.relativeTarget = undefined;\n              return;\n            } // TODO: Check here if an animation exists\n\n\n            var layoutTransition = (_c = (_b = _this.options.transition) !== null && _b !== void 0 ? _b : visualElement.getDefaultTransition()) !== null && _c !== void 0 ? _c : defaultLayoutTransition;\n\n            var _g = visualElement.getProps(),\n                onLayoutAnimationStart = _g.onLayoutAnimationStart,\n                onLayoutAnimationComplete = _g.onLayoutAnimationComplete;\n            /**\n             * The target layout of the element might stay the same,\n             * but its position relative to its parent has changed.\n             */\n\n\n            var targetChanged = !_this.targetLayout || !boxEquals(_this.targetLayout, newLayout) || hasRelativeTargetChanged;\n            /**\n             * If the layout hasn't seemed to have changed, it might be that the\n             * element is visually in the same place in the document but its position\n             * relative to its parent has indeed changed. So here we check for that.\n             */\n\n            var hasOnlyRelativeTargetChanged = !hasLayoutChanged && hasRelativeTargetChanged;\n\n            if (((_d = _this.resumeFrom) === null || _d === void 0 ? void 0 : _d.instance) || hasOnlyRelativeTargetChanged || hasLayoutChanged && (targetChanged || !_this.currentAnimation)) {\n              if (_this.resumeFrom) {\n                _this.resumingFrom = _this.resumeFrom;\n                _this.resumingFrom.resumingFrom = undefined;\n              }\n\n              _this.setAnimationOrigin(delta, hasOnlyRelativeTargetChanged);\n\n              var animationOptions = tslib.__assign(tslib.__assign({}, getValueTransition(layoutTransition, \"layout\")), {\n                onPlay: onLayoutAnimationStart,\n                onComplete: onLayoutAnimationComplete\n              });\n\n              if (visualElement.shouldReduceMotion) {\n                animationOptions.delay = 0;\n                animationOptions.type = false;\n              }\n\n              _this.startAnimation(animationOptions);\n            } else {\n              /**\n               * If the layout hasn't changed and we have an animation that hasn't started yet,\n               * finish it immediately. Otherwise it will be animating from a location\n               * that was probably never commited to screen and look like a jumpy box.\n               */\n              if (!hasLayoutChanged && _this.animationProgress === 0) {\n                _this.finishAnimation();\n              }\n\n              _this.isLead() && ((_f = (_e = _this.options).onExitComplete) === null || _f === void 0 ? void 0 : _f.call(_e));\n            }\n\n            _this.targetLayout = newLayout;\n          });\n        }\n      };\n\n      ProjectionNode.prototype.unmount = function () {\n        var _a, _b;\n\n        this.options.layoutId && this.willUpdate();\n        this.root.nodes.remove(this);\n        (_a = this.getStack()) === null || _a === void 0 ? void 0 : _a.remove(this);\n        (_b = this.parent) === null || _b === void 0 ? void 0 : _b.children.delete(this);\n        this.instance = undefined;\n        sync.cancelSync.preRender(this.updateProjection);\n      }; // only on the root\n\n\n      ProjectionNode.prototype.blockUpdate = function () {\n        this.updateManuallyBlocked = true;\n      };\n\n      ProjectionNode.prototype.unblockUpdate = function () {\n        this.updateManuallyBlocked = false;\n      };\n\n      ProjectionNode.prototype.isUpdateBlocked = function () {\n        return this.updateManuallyBlocked || this.updateBlockedByResize;\n      };\n\n      ProjectionNode.prototype.isTreeAnimationBlocked = function () {\n        var _a;\n\n        return this.isAnimationBlocked || ((_a = this.parent) === null || _a === void 0 ? void 0 : _a.isTreeAnimationBlocked()) || false;\n      }; // Note: currently only running on root node\n\n\n      ProjectionNode.prototype.startUpdate = function () {\n        var _a;\n\n        if (this.isUpdateBlocked()) return;\n        this.isUpdating = true;\n        (_a = this.nodes) === null || _a === void 0 ? void 0 : _a.forEach(resetRotation);\n      };\n\n      ProjectionNode.prototype.willUpdate = function (shouldNotifyListeners) {\n        var _a, _b, _c;\n\n        if (shouldNotifyListeners === void 0) {\n          shouldNotifyListeners = true;\n        }\n\n        if (this.root.isUpdateBlocked()) {\n          (_b = (_a = this.options).onExitComplete) === null || _b === void 0 ? void 0 : _b.call(_a);\n          return;\n        }\n\n        !this.root.isUpdating && this.root.startUpdate();\n        if (this.isLayoutDirty) return;\n        this.isLayoutDirty = true;\n\n        for (var i = 0; i < this.path.length; i++) {\n          var node = this.path[i];\n          node.shouldResetTransform = true;\n          /**\n           * TODO: Check we haven't updated the scroll\n           * since the last didUpdate\n           */\n\n          node.updateScroll();\n        }\n\n        var _d = this.options,\n            layoutId = _d.layoutId,\n            layout = _d.layout;\n        if (layoutId === undefined && !layout) return;\n        var transformTemplate = (_c = this.options.visualElement) === null || _c === void 0 ? void 0 : _c.getProps().transformTemplate;\n        this.prevTransformTemplateValue = transformTemplate === null || transformTemplate === void 0 ? void 0 : transformTemplate(this.latestValues, \"\");\n        this.updateSnapshot();\n        shouldNotifyListeners && this.notifyListeners(\"willUpdate\");\n      }; // Note: Currently only running on root node\n\n\n      ProjectionNode.prototype.didUpdate = function () {\n        var updateWasBlocked = this.isUpdateBlocked(); // When doing an instant transition, we skip the layout update,\n        // but should still clean up the measurements so that the next\n        // snapshot could be taken correctly.\n\n        if (updateWasBlocked) {\n          this.unblockUpdate();\n          this.clearAllSnapshots();\n          this.nodes.forEach(clearMeasurements);\n          return;\n        }\n\n        if (!this.isUpdating) return;\n        this.isUpdating = false;\n        /**\n         * Search for and mount newly-added projection elements.\n         *\n         * TODO: Every time a new component is rendered we could search up the tree for\n         * the closest mounted node and query from there rather than document.\n         */\n\n        if (this.potentialNodes.size) {\n          this.potentialNodes.forEach(mountNodeEarly);\n          this.potentialNodes.clear();\n        }\n        /**\n         * Write\n         */\n\n\n        this.nodes.forEach(resetTransformStyle);\n        /**\n         * Read ==================\n         */\n        // Update layout measurements of updated children\n\n        this.nodes.forEach(updateLayout);\n        /**\n         * Write\n         */\n        // Notify listeners that the layout is updated\n\n        this.nodes.forEach(notifyLayoutUpdate);\n        this.clearAllSnapshots(); // Flush any scheduled updates\n\n        sync.flushSync.update();\n        sync.flushSync.preRender();\n        sync.flushSync.render();\n      };\n\n      ProjectionNode.prototype.clearAllSnapshots = function () {\n        this.nodes.forEach(clearSnapshot);\n        this.sharedNodes.forEach(removeLeadSnapshots);\n      };\n\n      ProjectionNode.prototype.scheduleUpdateProjection = function () {\n        sync__default[\"default\"].preRender(this.updateProjection, false, true);\n      };\n\n      ProjectionNode.prototype.scheduleCheckAfterUnmount = function () {\n        var _this = this;\n        /**\n         * If the unmounting node is in a layoutGroup and did trigger a willUpdate,\n         * we manually call didUpdate to give a chance to the siblings to animate.\n         * Otherwise, cleanup all snapshots to prevents future nodes from reusing them.\n         */\n\n\n        sync__default[\"default\"].postRender(function () {\n          if (_this.isLayoutDirty) {\n            _this.root.didUpdate();\n          } else {\n            _this.root.checkUpdateFailed();\n          }\n        });\n      };\n      /**\n       * Update measurements\n       */\n\n\n      ProjectionNode.prototype.updateSnapshot = function () {\n        if (this.snapshot || !this.instance) return;\n        var measured = this.measure();\n        var layout = this.removeTransform(this.removeElementScroll(measured));\n        roundBox(layout);\n        this.snapshot = {\n          measured: measured,\n          layout: layout,\n          latestValues: {}\n        };\n      };\n\n      ProjectionNode.prototype.updateLayout = function () {\n        var _a;\n\n        if (!this.instance) return; // TODO: Incorporate into a forwarded scroll offset\n\n        this.updateScroll();\n\n        if (!(this.options.alwaysMeasureLayout && this.isLead()) && !this.isLayoutDirty) {\n          return;\n        }\n        /**\n         * When a node is mounted, it simply resumes from the prevLead's\n         * snapshot instead of taking a new one, but the ancestors scroll\n         * might have updated while the prevLead is unmounted. We need to\n         * update the scroll again to make sure the layout we measure is\n         * up to date.\n         */\n\n\n        if (this.resumeFrom && !this.resumeFrom.instance) {\n          for (var i = 0; i < this.path.length; i++) {\n            var node = this.path[i];\n            node.updateScroll();\n          }\n        }\n\n        var measured = this.measure();\n        roundBox(measured);\n        var prevLayout = this.layout;\n        this.layout = {\n          measured: measured,\n          actual: this.removeElementScroll(measured)\n        };\n        this.layoutCorrected = createBox();\n        this.isLayoutDirty = false;\n        this.projectionDelta = undefined;\n        this.notifyListeners(\"measure\", this.layout.actual);\n        (_a = this.options.visualElement) === null || _a === void 0 ? void 0 : _a.notifyLayoutMeasure(this.layout.actual, prevLayout === null || prevLayout === void 0 ? void 0 : prevLayout.actual);\n      };\n\n      ProjectionNode.prototype.updateScroll = function () {\n        if (this.options.layoutScroll && this.instance) {\n          this.isScrollRoot = checkIsScrollRoot(this.instance);\n          this.scroll = measureScroll(this.instance);\n        }\n      };\n\n      ProjectionNode.prototype.resetTransform = function () {\n        var _a;\n\n        if (!resetTransform) return;\n        var isResetRequested = this.isLayoutDirty || this.shouldResetTransform;\n        var hasProjection = this.projectionDelta && !isDeltaZero(this.projectionDelta);\n        var transformTemplate = (_a = this.options.visualElement) === null || _a === void 0 ? void 0 : _a.getProps().transformTemplate;\n        var transformTemplateValue = transformTemplate === null || transformTemplate === void 0 ? void 0 : transformTemplate(this.latestValues, \"\");\n        var transformTemplateHasChanged = transformTemplateValue !== this.prevTransformTemplateValue;\n\n        if (isResetRequested && (hasProjection || hasTransform(this.latestValues) || transformTemplateHasChanged)) {\n          resetTransform(this.instance, transformTemplateValue);\n          this.shouldResetTransform = false;\n          this.scheduleRender();\n        }\n      };\n\n      ProjectionNode.prototype.measure = function () {\n        var visualElement = this.options.visualElement;\n        if (!visualElement) return createBox();\n        var box = visualElement.measureViewportBox(); // Remove viewport scroll to give page-relative coordinates\n\n        var scroll = this.root.scroll;\n\n        if (scroll) {\n          translateAxis(box.x, scroll.x);\n          translateAxis(box.y, scroll.y);\n        }\n\n        return box;\n      };\n\n      ProjectionNode.prototype.removeElementScroll = function (box) {\n        var boxWithoutScroll = createBox();\n        copyBoxInto(boxWithoutScroll, box);\n        /**\n         * Performance TODO: Keep a cumulative scroll offset down the tree\n         * rather than loop back up the path.\n         */\n\n        for (var i = 0; i < this.path.length; i++) {\n          var node = this.path[i];\n          var scroll_1 = node.scroll,\n              options = node.options,\n              isScrollRoot = node.isScrollRoot;\n\n          if (node !== this.root && scroll_1 && options.layoutScroll) {\n            /**\n             * If this is a new scroll root, we want to remove all previous scrolls\n             * from the viewport box.\n             */\n            if (isScrollRoot) {\n              copyBoxInto(boxWithoutScroll, box);\n              var rootScroll = this.root.scroll;\n              /**\n               * Undo the application of page scroll that was originally added\n               * to the measured bounding box.\n               */\n\n              if (rootScroll) {\n                translateAxis(boxWithoutScroll.x, -rootScroll.x);\n                translateAxis(boxWithoutScroll.y, -rootScroll.y);\n              }\n            }\n\n            translateAxis(boxWithoutScroll.x, scroll_1.x);\n            translateAxis(boxWithoutScroll.y, scroll_1.y);\n          }\n        }\n\n        return boxWithoutScroll;\n      };\n\n      ProjectionNode.prototype.applyTransform = function (box, transformOnly) {\n        if (transformOnly === void 0) {\n          transformOnly = false;\n        }\n\n        var withTransforms = createBox();\n        copyBoxInto(withTransforms, box);\n\n        for (var i = 0; i < this.path.length; i++) {\n          var node = this.path[i];\n\n          if (!transformOnly && node.options.layoutScroll && node.scroll && node !== node.root) {\n            transformBox(withTransforms, {\n              x: -node.scroll.x,\n              y: -node.scroll.y\n            });\n          }\n\n          if (!hasTransform(node.latestValues)) continue;\n          transformBox(withTransforms, node.latestValues);\n        }\n\n        if (hasTransform(this.latestValues)) {\n          transformBox(withTransforms, this.latestValues);\n        }\n\n        return withTransforms;\n      };\n\n      ProjectionNode.prototype.removeTransform = function (box) {\n        var _a;\n\n        var boxWithoutTransform = createBox();\n        copyBoxInto(boxWithoutTransform, box);\n\n        for (var i = 0; i < this.path.length; i++) {\n          var node = this.path[i];\n          if (!node.instance) continue;\n          if (!hasTransform(node.latestValues)) continue;\n          hasScale(node.latestValues) && node.updateSnapshot();\n          var sourceBox = createBox();\n          var nodeBox = node.measure();\n          copyBoxInto(sourceBox, nodeBox);\n          removeBoxTransforms(boxWithoutTransform, node.latestValues, (_a = node.snapshot) === null || _a === void 0 ? void 0 : _a.layout, sourceBox);\n        }\n\n        if (hasTransform(this.latestValues)) {\n          removeBoxTransforms(boxWithoutTransform, this.latestValues);\n        }\n\n        return boxWithoutTransform;\n      };\n      /**\n       *\n       */\n\n\n      ProjectionNode.prototype.setTargetDelta = function (delta) {\n        this.targetDelta = delta;\n        this.root.scheduleUpdateProjection();\n      };\n\n      ProjectionNode.prototype.setOptions = function (options) {\n        var _a;\n\n        this.options = tslib.__assign(tslib.__assign(tslib.__assign({}, this.options), options), {\n          crossfade: (_a = options.crossfade) !== null && _a !== void 0 ? _a : true\n        });\n      };\n\n      ProjectionNode.prototype.clearMeasurements = function () {\n        this.scroll = undefined;\n        this.layout = undefined;\n        this.snapshot = undefined;\n        this.prevTransformTemplateValue = undefined;\n        this.targetDelta = undefined;\n        this.target = undefined;\n        this.isLayoutDirty = false;\n      };\n      /**\n       * Frame calculations\n       */\n\n\n      ProjectionNode.prototype.resolveTargetDelta = function () {\n        var _a;\n\n        var _b = this.options,\n            layout = _b.layout,\n            layoutId = _b.layoutId;\n        /**\n         * If we have no layout, we can't perform projection, so early return\n         */\n\n        if (!this.layout || !(layout || layoutId)) return;\n        /**\n         * If we don't have a targetDelta but do have a layout, we can attempt to resolve\n         * a relativeParent. This will allow a component to perform scale correction\n         * even if no animation has started.\n         */\n        // TODO If this is unsuccessful this currently happens every frame\n\n        if (!this.targetDelta && !this.relativeTarget) {\n          // TODO: This is a semi-repetition of further down this function, make DRY\n          this.relativeParent = this.getClosestProjectingParent();\n\n          if (this.relativeParent && this.relativeParent.layout) {\n            this.relativeTarget = createBox();\n            this.relativeTargetOrigin = createBox();\n            calcRelativePosition(this.relativeTargetOrigin, this.layout.actual, this.relativeParent.layout.actual);\n            copyBoxInto(this.relativeTarget, this.relativeTargetOrigin);\n          }\n        }\n        /**\n         * If we have no relative target or no target delta our target isn't valid\n         * for this frame.\n         */\n\n\n        if (!this.relativeTarget && !this.targetDelta) return;\n        /**\n         * Lazy-init target data structure\n         */\n\n        if (!this.target) {\n          this.target = createBox();\n          this.targetWithTransforms = createBox();\n        }\n        /**\n         * If we've got a relative box for this component, resolve it into a target relative to the parent.\n         */\n\n\n        if (this.relativeTarget && this.relativeTargetOrigin && ((_a = this.relativeParent) === null || _a === void 0 ? void 0 : _a.target)) {\n          calcRelativeBox(this.target, this.relativeTarget, this.relativeParent.target);\n          /**\n           * If we've only got a targetDelta, resolve it into a target\n           */\n        } else if (this.targetDelta) {\n          if (Boolean(this.resumingFrom)) {\n            // TODO: This is creating a new object every frame\n            this.target = this.applyTransform(this.layout.actual);\n          } else {\n            copyBoxInto(this.target, this.layout.actual);\n          }\n\n          applyBoxDelta(this.target, this.targetDelta);\n        } else {\n          /**\n           * If no target, use own layout as target\n           */\n          copyBoxInto(this.target, this.layout.actual);\n        }\n        /**\n         * If we've been told to attempt to resolve a relative target, do so.\n         */\n\n\n        if (this.attemptToResolveRelativeTarget) {\n          this.attemptToResolveRelativeTarget = false;\n          this.relativeParent = this.getClosestProjectingParent();\n\n          if (this.relativeParent && Boolean(this.relativeParent.resumingFrom) === Boolean(this.resumingFrom) && !this.relativeParent.options.layoutScroll && this.relativeParent.target) {\n            this.relativeTarget = createBox();\n            this.relativeTargetOrigin = createBox();\n            calcRelativePosition(this.relativeTargetOrigin, this.target, this.relativeParent.target);\n            copyBoxInto(this.relativeTarget, this.relativeTargetOrigin);\n          }\n        }\n      };\n\n      ProjectionNode.prototype.getClosestProjectingParent = function () {\n        if (!this.parent || hasTransform(this.parent.latestValues)) return undefined;\n\n        if ((this.parent.relativeTarget || this.parent.targetDelta) && this.parent.layout) {\n          return this.parent;\n        } else {\n          return this.parent.getClosestProjectingParent();\n        }\n      };\n\n      ProjectionNode.prototype.calcProjection = function () {\n        var _a;\n\n        var _b = this.options,\n            layout = _b.layout,\n            layoutId = _b.layoutId;\n        /**\n         * If this section of the tree isn't animating we can\n         * delete our target sources for the following frame.\n         */\n\n        this.isTreeAnimating = Boolean(((_a = this.parent) === null || _a === void 0 ? void 0 : _a.isTreeAnimating) || this.currentAnimation || this.pendingAnimation);\n\n        if (!this.isTreeAnimating) {\n          this.targetDelta = this.relativeTarget = undefined;\n        }\n\n        if (!this.layout || !(layout || layoutId)) return;\n        var lead = this.getLead();\n        /**\n         * Reset the corrected box with the latest values from box, as we're then going\n         * to perform mutative operations on it.\n         */\n\n        copyBoxInto(this.layoutCorrected, this.layout.actual);\n        /**\n         * Apply all the parent deltas to this box to produce the corrected box. This\n         * is the layout box, as it will appear on screen as a result of the transforms of its parents.\n         */\n\n        applyTreeDeltas(this.layoutCorrected, this.treeScale, this.path, Boolean(this.resumingFrom) || this !== lead);\n        var target = lead.target;\n        if (!target) return;\n\n        if (!this.projectionDelta) {\n          this.projectionDelta = createDelta();\n          this.projectionDeltaWithTransform = createDelta();\n        }\n\n        var prevTreeScaleX = this.treeScale.x;\n        var prevTreeScaleY = this.treeScale.y;\n        var prevProjectionTransform = this.projectionTransform;\n        /**\n         * Update the delta between the corrected box and the target box before user-set transforms were applied.\n         * This will allow us to calculate the corrected borderRadius and boxShadow to compensate\n         * for our layout reprojection, but still allow them to be scaled correctly by the user.\n         * It might be that to simplify this we may want to accept that user-set scale is also corrected\n         * and we wouldn't have to keep and calc both deltas, OR we could support a user setting\n         * to allow people to choose whether these styles are corrected based on just the\n         * layout reprojection or the final bounding box.\n         */\n\n        calcBoxDelta(this.projectionDelta, this.layoutCorrected, target, this.latestValues);\n        this.projectionTransform = buildProjectionTransform(this.projectionDelta, this.treeScale);\n\n        if (this.projectionTransform !== prevProjectionTransform || this.treeScale.x !== prevTreeScaleX || this.treeScale.y !== prevTreeScaleY) {\n          this.hasProjected = true;\n          this.scheduleRender();\n          this.notifyListeners(\"projectionUpdate\", target);\n        }\n      };\n\n      ProjectionNode.prototype.hide = function () {\n        this.isVisible = false; // TODO: Schedule render\n      };\n\n      ProjectionNode.prototype.show = function () {\n        this.isVisible = true; // TODO: Schedule render\n      };\n\n      ProjectionNode.prototype.scheduleRender = function (notifyAll) {\n        var _a, _b, _c;\n\n        if (notifyAll === void 0) {\n          notifyAll = true;\n        }\n\n        (_b = (_a = this.options).scheduleRender) === null || _b === void 0 ? void 0 : _b.call(_a);\n        notifyAll && ((_c = this.getStack()) === null || _c === void 0 ? void 0 : _c.scheduleRender());\n\n        if (this.resumingFrom && !this.resumingFrom.instance) {\n          this.resumingFrom = undefined;\n        }\n      };\n\n      ProjectionNode.prototype.setAnimationOrigin = function (delta, hasOnlyRelativeTargetChanged) {\n        var _this = this;\n\n        var _a;\n\n        if (hasOnlyRelativeTargetChanged === void 0) {\n          hasOnlyRelativeTargetChanged = false;\n        }\n\n        var snapshot = this.snapshot;\n        var snapshotLatestValues = (snapshot === null || snapshot === void 0 ? void 0 : snapshot.latestValues) || {};\n\n        var mixedValues = tslib.__assign({}, this.latestValues);\n\n        var targetDelta = createDelta();\n        this.relativeTarget = this.relativeTargetOrigin = undefined;\n        this.attemptToResolveRelativeTarget = !hasOnlyRelativeTargetChanged;\n        var relativeLayout = createBox();\n        var isSharedLayoutAnimation = snapshot === null || snapshot === void 0 ? void 0 : snapshot.isShared;\n        var isOnlyMember = (((_a = this.getStack()) === null || _a === void 0 ? void 0 : _a.members.length) || 0) <= 1;\n        var shouldCrossfadeOpacity = Boolean(isSharedLayoutAnimation && !isOnlyMember && this.options.crossfade === true && !this.path.some(hasOpacityCrossfade));\n        this.animationProgress = 0;\n\n        this.mixTargetDelta = function (latest) {\n          var _a;\n\n          var progress = latest / 1000;\n          mixAxisDelta(targetDelta.x, delta.x, progress);\n          mixAxisDelta(targetDelta.y, delta.y, progress);\n\n          _this.setTargetDelta(targetDelta);\n\n          if (_this.relativeTarget && _this.relativeTargetOrigin && _this.layout && ((_a = _this.relativeParent) === null || _a === void 0 ? void 0 : _a.layout)) {\n            calcRelativePosition(relativeLayout, _this.layout.actual, _this.relativeParent.layout.actual);\n            mixBox(_this.relativeTarget, _this.relativeTargetOrigin, relativeLayout, progress);\n          }\n\n          if (isSharedLayoutAnimation) {\n            _this.animationValues = mixedValues;\n            mixValues(mixedValues, snapshotLatestValues, _this.latestValues, progress, shouldCrossfadeOpacity, isOnlyMember);\n          }\n\n          _this.root.scheduleUpdateProjection();\n\n          _this.scheduleRender();\n\n          _this.animationProgress = progress;\n        };\n\n        this.mixTargetDelta(0);\n      };\n\n      ProjectionNode.prototype.startAnimation = function (options) {\n        var _this = this;\n\n        var _a, _b;\n\n        this.notifyListeners(\"animationStart\");\n        (_a = this.currentAnimation) === null || _a === void 0 ? void 0 : _a.stop();\n\n        if (this.resumingFrom) {\n          (_b = this.resumingFrom.currentAnimation) === null || _b === void 0 ? void 0 : _b.stop();\n        }\n\n        if (this.pendingAnimation) {\n          sync.cancelSync.update(this.pendingAnimation);\n          this.pendingAnimation = undefined;\n        }\n        /**\n         * Start the animation in the next frame to have a frame with progress 0,\n         * where the target is the same as when the animation started, so we can\n         * calculate the relative positions correctly for instant transitions.\n         */\n\n\n        this.pendingAnimation = sync__default[\"default\"].update(function () {\n          globalProjectionState.hasAnimatedSinceResize = true;\n          _this.currentAnimation = animate(0, animationTarget, tslib.__assign(tslib.__assign({}, options), {\n            onUpdate: function onUpdate(latest) {\n              var _a;\n\n              _this.mixTargetDelta(latest);\n\n              (_a = options.onUpdate) === null || _a === void 0 ? void 0 : _a.call(options, latest);\n            },\n            onComplete: function onComplete() {\n              var _a;\n\n              (_a = options.onComplete) === null || _a === void 0 ? void 0 : _a.call(options);\n\n              _this.completeAnimation();\n            }\n          }));\n\n          if (_this.resumingFrom) {\n            _this.resumingFrom.currentAnimation = _this.currentAnimation;\n          }\n\n          _this.pendingAnimation = undefined;\n        });\n      };\n\n      ProjectionNode.prototype.completeAnimation = function () {\n        var _a;\n\n        if (this.resumingFrom) {\n          this.resumingFrom.currentAnimation = undefined;\n          this.resumingFrom.preserveOpacity = undefined;\n        }\n\n        (_a = this.getStack()) === null || _a === void 0 ? void 0 : _a.exitAnimationComplete();\n        this.resumingFrom = this.currentAnimation = this.animationValues = undefined;\n        this.notifyListeners(\"animationComplete\");\n      };\n\n      ProjectionNode.prototype.finishAnimation = function () {\n        var _a;\n\n        if (this.currentAnimation) {\n          (_a = this.mixTargetDelta) === null || _a === void 0 ? void 0 : _a.call(this, animationTarget);\n          this.currentAnimation.stop();\n        }\n\n        this.completeAnimation();\n      };\n\n      ProjectionNode.prototype.applyTransformsToTarget = function () {\n        var _a = this.getLead(),\n            targetWithTransforms = _a.targetWithTransforms,\n            target = _a.target,\n            layout = _a.layout,\n            latestValues = _a.latestValues;\n\n        if (!targetWithTransforms || !target || !layout) return;\n        copyBoxInto(targetWithTransforms, target);\n        /**\n         * Apply the latest user-set transforms to the targetBox to produce the targetBoxFinal.\n         * This is the final box that we will then project into by calculating a transform delta and\n         * applying it to the corrected box.\n         */\n\n        transformBox(targetWithTransforms, latestValues);\n        /**\n         * Update the delta between the corrected box and the final target box, after\n         * user-set transforms are applied to it. This will be used by the renderer to\n         * create a transform style that will reproject the element from its actual layout\n         * into the desired bounding box.\n         */\n\n        calcBoxDelta(this.projectionDeltaWithTransform, this.layoutCorrected, targetWithTransforms, latestValues);\n      };\n\n      ProjectionNode.prototype.registerSharedNode = function (layoutId, node) {\n        var _a, _b, _c;\n\n        if (!this.sharedNodes.has(layoutId)) {\n          this.sharedNodes.set(layoutId, new NodeStack());\n        }\n\n        var stack = this.sharedNodes.get(layoutId);\n        stack.add(node);\n        node.promote({\n          transition: (_a = node.options.initialPromotionConfig) === null || _a === void 0 ? void 0 : _a.transition,\n          preserveFollowOpacity: (_c = (_b = node.options.initialPromotionConfig) === null || _b === void 0 ? void 0 : _b.shouldPreserveFollowOpacity) === null || _c === void 0 ? void 0 : _c.call(_b, node)\n        });\n      };\n\n      ProjectionNode.prototype.isLead = function () {\n        var stack = this.getStack();\n        return stack ? stack.lead === this : true;\n      };\n\n      ProjectionNode.prototype.getLead = function () {\n        var _a;\n\n        var layoutId = this.options.layoutId;\n        return layoutId ? ((_a = this.getStack()) === null || _a === void 0 ? void 0 : _a.lead) || this : this;\n      };\n\n      ProjectionNode.prototype.getPrevLead = function () {\n        var _a;\n\n        var layoutId = this.options.layoutId;\n        return layoutId ? (_a = this.getStack()) === null || _a === void 0 ? void 0 : _a.prevLead : undefined;\n      };\n\n      ProjectionNode.prototype.getStack = function () {\n        var layoutId = this.options.layoutId;\n        if (layoutId) return this.root.sharedNodes.get(layoutId);\n      };\n\n      ProjectionNode.prototype.promote = function (_a) {\n        var _b = _a === void 0 ? {} : _a,\n            needsReset = _b.needsReset,\n            transition = _b.transition,\n            preserveFollowOpacity = _b.preserveFollowOpacity;\n\n        var stack = this.getStack();\n        if (stack) stack.promote(this, preserveFollowOpacity);\n\n        if (needsReset) {\n          this.projectionDelta = undefined;\n          this.needsReset = true;\n        }\n\n        if (transition) this.setOptions({\n          transition: transition\n        });\n      };\n\n      ProjectionNode.prototype.relegate = function () {\n        var stack = this.getStack();\n\n        if (stack) {\n          return stack.relegate(this);\n        } else {\n          return false;\n        }\n      };\n\n      ProjectionNode.prototype.resetRotation = function () {\n        var visualElement = this.options.visualElement;\n        if (!visualElement) return; // If there's no detected rotation values, we can early return without a forced render.\n\n        var hasRotate = false; // Keep a record of all the values we've reset\n\n        var resetValues = {}; // Check the rotate value of all axes and reset to 0\n\n        for (var i = 0; i < transformAxes.length; i++) {\n          var axis = transformAxes[i];\n          var key = \"rotate\" + axis; // If this rotation doesn't exist as a motion value, then we don't\n          // need to reset it\n\n          if (!visualElement.getStaticValue(key)) {\n            continue;\n          }\n\n          hasRotate = true; // Record the rotation and then temporarily set it to 0\n\n          resetValues[key] = visualElement.getStaticValue(key);\n          visualElement.setStaticValue(key, 0);\n        } // If there's no rotation values, we don't need to do any more.\n\n\n        if (!hasRotate) return; // Force a render of this element to apply the transform with all rotations\n        // set to 0.\n\n        visualElement === null || visualElement === void 0 ? void 0 : visualElement.syncRender(); // Put back all the values we reset\n\n        for (var key in resetValues) {\n          visualElement.setStaticValue(key, resetValues[key]);\n        } // Schedule a render for the next frame. This ensures we won't visually\n        // see the element with the reset rotate value applied.\n\n\n        visualElement.scheduleRender();\n      };\n\n      ProjectionNode.prototype.getProjectionStyles = function (styleProp) {\n        var _a, _b, _c, _d, _e, _f;\n\n        if (styleProp === void 0) {\n          styleProp = {};\n        } // TODO: Return lifecycle-persistent object\n\n\n        var styles = {};\n        if (!this.instance || this.isSVG) return styles;\n\n        if (!this.isVisible) {\n          return {\n            visibility: \"hidden\"\n          };\n        } else {\n          styles.visibility = \"\";\n        }\n\n        var transformTemplate = (_a = this.options.visualElement) === null || _a === void 0 ? void 0 : _a.getProps().transformTemplate;\n\n        if (this.needsReset) {\n          this.needsReset = false;\n          styles.opacity = \"\";\n          styles.pointerEvents = resolveMotionValue(styleProp.pointerEvents) || \"\";\n          styles.transform = transformTemplate ? transformTemplate(this.latestValues, \"\") : \"none\";\n          return styles;\n        }\n\n        var lead = this.getLead();\n\n        if (!this.projectionDelta || !this.layout || !lead.target) {\n          var emptyStyles = {};\n\n          if (this.options.layoutId) {\n            emptyStyles.opacity = (_b = this.latestValues.opacity) !== null && _b !== void 0 ? _b : 1;\n            emptyStyles.pointerEvents = resolveMotionValue(styleProp.pointerEvents) || \"\";\n          }\n\n          if (this.hasProjected && !hasTransform(this.latestValues)) {\n            emptyStyles.transform = transformTemplate ? transformTemplate({}, \"\") : \"none\";\n            this.hasProjected = false;\n          }\n\n          return emptyStyles;\n        }\n\n        var valuesToRender = lead.animationValues || lead.latestValues;\n        this.applyTransformsToTarget();\n        styles.transform = buildProjectionTransform(this.projectionDeltaWithTransform, this.treeScale, valuesToRender);\n\n        if (transformTemplate) {\n          styles.transform = transformTemplate(valuesToRender, styles.transform);\n        }\n\n        var _g = this.projectionDelta,\n            x = _g.x,\n            y = _g.y;\n        styles.transformOrigin = \"\".concat(x.origin * 100, \"% \").concat(y.origin * 100, \"% 0\");\n\n        if (lead.animationValues) {\n          /**\n           * If the lead component is animating, assign this either the entering/leaving\n           * opacity\n           */\n          styles.opacity = lead === this ? (_d = (_c = valuesToRender.opacity) !== null && _c !== void 0 ? _c : this.latestValues.opacity) !== null && _d !== void 0 ? _d : 1 : this.preserveOpacity ? this.latestValues.opacity : valuesToRender.opacityExit;\n        } else {\n          /**\n           * Or we're not animating at all, set the lead component to its actual\n           * opacity and other components to hidden.\n           */\n          styles.opacity = lead === this ? (_e = valuesToRender.opacity) !== null && _e !== void 0 ? _e : \"\" : (_f = valuesToRender.opacityExit) !== null && _f !== void 0 ? _f : 0;\n        }\n        /**\n         * Apply scale correction\n         */\n\n\n        for (var key in scaleCorrectors) {\n          if (valuesToRender[key] === undefined) continue;\n          var _h = scaleCorrectors[key],\n              correct = _h.correct,\n              applyTo = _h.applyTo;\n          var corrected = correct(valuesToRender[key], lead);\n\n          if (applyTo) {\n            var num = applyTo.length;\n\n            for (var i = 0; i < num; i++) {\n              styles[applyTo[i]] = corrected;\n            }\n          } else {\n            styles[key] = corrected;\n          }\n        }\n        /**\n         * Disable pointer events on follow components. This is to ensure\n         * that if a follow component covers a lead component it doesn't block\n         * pointer events on the lead.\n         */\n\n\n        if (this.options.layoutId) {\n          styles.pointerEvents = lead === this ? resolveMotionValue(styleProp.pointerEvents) || \"\" : \"none\";\n        }\n\n        return styles;\n      };\n\n      ProjectionNode.prototype.clearSnapshot = function () {\n        this.resumeFrom = this.snapshot = undefined;\n      }; // Only run on root\n\n\n      ProjectionNode.prototype.resetTree = function () {\n        this.root.nodes.forEach(function (node) {\n          var _a;\n\n          return (_a = node.currentAnimation) === null || _a === void 0 ? void 0 : _a.stop();\n        });\n        this.root.nodes.forEach(clearMeasurements);\n        this.root.sharedNodes.clear();\n      };\n\n      return ProjectionNode;\n    }()\n  );\n}\n\nfunction updateLayout(node) {\n  node.updateLayout();\n}\n\nfunction notifyLayoutUpdate(node) {\n  var _a, _b, _c, _d;\n\n  var snapshot = (_b = (_a = node.resumeFrom) === null || _a === void 0 ? void 0 : _a.snapshot) !== null && _b !== void 0 ? _b : node.snapshot;\n\n  if (node.isLead() && node.layout && snapshot && node.hasListeners(\"didUpdate\")) {\n    var _e = node.layout,\n        layout_1 = _e.actual,\n        measuredLayout = _e.measured; // TODO Maybe we want to also resize the layout snapshot so we don't trigger\n    // animations for instance if layout=\"size\" and an element has only changed position\n\n    if (node.options.animationType === \"size\") {\n      eachAxis(function (axis) {\n        var axisSnapshot = snapshot.isShared ? snapshot.measured[axis] : snapshot.layout[axis];\n        var length = calcLength(axisSnapshot);\n        axisSnapshot.min = layout_1[axis].min;\n        axisSnapshot.max = axisSnapshot.min + length;\n      });\n    } else if (node.options.animationType === \"position\") {\n      eachAxis(function (axis) {\n        var axisSnapshot = snapshot.isShared ? snapshot.measured[axis] : snapshot.layout[axis];\n        var length = calcLength(layout_1[axis]);\n        axisSnapshot.max = axisSnapshot.min + length;\n      });\n    }\n\n    var layoutDelta = createDelta();\n    calcBoxDelta(layoutDelta, layout_1, snapshot.layout);\n    var visualDelta = createDelta();\n\n    if (snapshot.isShared) {\n      calcBoxDelta(visualDelta, node.applyTransform(measuredLayout, true), snapshot.measured);\n    } else {\n      calcBoxDelta(visualDelta, layout_1, snapshot.layout);\n    }\n\n    var hasLayoutChanged = !isDeltaZero(layoutDelta);\n    var hasRelativeTargetChanged = false;\n\n    if (!node.resumeFrom) {\n      node.relativeParent = node.getClosestProjectingParent();\n      /**\n       * If the relativeParent is itself resuming from a different element then\n       * the relative snapshot is not relavent\n       */\n\n      if (node.relativeParent && !node.relativeParent.resumeFrom) {\n        var _f = node.relativeParent,\n            parentSnapshot = _f.snapshot,\n            parentLayout = _f.layout;\n\n        if (parentSnapshot && parentLayout) {\n          var relativeSnapshot = createBox();\n          calcRelativePosition(relativeSnapshot, snapshot.layout, parentSnapshot.layout);\n          var relativeLayout = createBox();\n          calcRelativePosition(relativeLayout, layout_1, parentLayout.actual);\n\n          if (!boxEquals(relativeSnapshot, relativeLayout)) {\n            hasRelativeTargetChanged = true;\n          }\n        }\n      }\n    }\n\n    node.notifyListeners(\"didUpdate\", {\n      layout: layout_1,\n      snapshot: snapshot,\n      delta: visualDelta,\n      layoutDelta: layoutDelta,\n      hasLayoutChanged: hasLayoutChanged,\n      hasRelativeTargetChanged: hasRelativeTargetChanged\n    });\n  } else if (node.isLead()) {\n    (_d = (_c = node.options).onExitComplete) === null || _d === void 0 ? void 0 : _d.call(_c);\n  }\n  /**\n   * Clearing transition\n   * TODO: Investigate why this transition is being passed in as {type: false } from Framer\n   * and why we need it at all\n   */\n\n\n  node.options.transition = undefined;\n}\n\nfunction clearSnapshot(node) {\n  node.clearSnapshot();\n}\n\nfunction clearMeasurements(node) {\n  node.clearMeasurements();\n}\n\nfunction resetTransformStyle(node) {\n  var visualElement = node.options.visualElement;\n\n  if (visualElement === null || visualElement === void 0 ? void 0 : visualElement.getProps().onBeforeLayoutMeasure) {\n    visualElement.notifyBeforeLayoutMeasure();\n  }\n\n  node.resetTransform();\n}\n\nfunction finishAnimation(node) {\n  node.finishAnimation();\n  node.targetDelta = node.relativeTarget = node.target = undefined;\n}\n\nfunction resolveTargetDelta(node) {\n  node.resolveTargetDelta();\n}\n\nfunction calcProjection(node) {\n  node.calcProjection();\n}\n\nfunction resetRotation(node) {\n  node.resetRotation();\n}\n\nfunction removeLeadSnapshots(stack) {\n  stack.removeLeadSnapshot();\n}\n\nfunction mixAxisDelta(output, delta, p) {\n  output.translate = popmotion.mix(delta.translate, 0, p);\n  output.scale = popmotion.mix(delta.scale, 1, p);\n  output.origin = delta.origin;\n  output.originPoint = delta.originPoint;\n}\n\nfunction mixAxis(output, from, to, p) {\n  output.min = popmotion.mix(from.min, to.min, p);\n  output.max = popmotion.mix(from.max, to.max, p);\n}\n\nfunction mixBox(output, from, to, p) {\n  mixAxis(output.x, from.x, to.x, p);\n  mixAxis(output.y, from.y, to.y, p);\n}\n\nfunction hasOpacityCrossfade(node) {\n  return node.animationValues && node.animationValues.opacityExit !== undefined;\n}\n\nvar defaultLayoutTransition = {\n  duration: 0.45,\n  ease: [0.4, 0, 0.1, 1]\n};\n\nfunction mountNodeEarly(node, id) {\n  /**\n   * Rather than searching the DOM from document we can search the\n   * path for the deepest mounted ancestor and search from there\n   */\n  var searchNode = node.root;\n\n  for (var i = node.path.length - 1; i >= 0; i--) {\n    if (Boolean(node.path[i].instance)) {\n      searchNode = node.path[i];\n      break;\n    }\n  }\n\n  var searchElement = searchNode && searchNode !== node.root ? searchNode.instance : document;\n  var element = searchElement.querySelector(\"[data-projection-id=\\\"\".concat(id, \"\\\"]\"));\n  if (element) node.mount(element, true);\n}\n\nfunction roundAxis(axis) {\n  axis.min = Math.round(axis.min);\n  axis.max = Math.round(axis.max);\n}\n\nfunction roundBox(box) {\n  roundAxis(box.x);\n  roundAxis(box.y);\n}\n\nvar DocumentProjectionNode = createProjectionNode({\n  attachResizeListener: function attachResizeListener(ref, notify) {\n    return addDomEvent(ref, \"resize\", notify);\n  },\n  measureScroll: function measureScroll() {\n    return {\n      x: document.documentElement.scrollLeft || document.body.scrollLeft,\n      y: document.documentElement.scrollTop || document.body.scrollTop\n    };\n  },\n  checkIsScrollRoot: function checkIsScrollRoot() {\n    return true;\n  }\n});\nvar rootProjectionNode = {\n  current: undefined\n};\nvar HTMLProjectionNode = createProjectionNode({\n  measureScroll: function measureScroll(instance) {\n    return {\n      x: instance.scrollLeft,\n      y: instance.scrollTop\n    };\n  },\n  defaultParent: function defaultParent() {\n    if (!rootProjectionNode.current) {\n      var documentNode = new DocumentProjectionNode(0, {});\n      documentNode.mount(window);\n      documentNode.setOptions({\n        layoutScroll: true\n      });\n      rootProjectionNode.current = documentNode;\n    }\n\n    return rootProjectionNode.current;\n  },\n  resetTransform: function resetTransform(instance, value) {\n    instance.style.transform = value !== null && value !== void 0 ? value : \"none\";\n  },\n  checkIsScrollRoot: function checkIsScrollRoot(instance) {\n    return Boolean(window.getComputedStyle(instance).position === \"fixed\");\n  }\n});\n\nvar featureBundle = tslib.__assign(tslib.__assign(tslib.__assign(tslib.__assign({}, animations), gestureAnimations), drag), layoutFeatures);\n/**\n * HTML & SVG components, optimised for use with gestures and animation. These can be used as\n * drop-in replacements for any HTML & SVG component, all CSS & SVG properties are supported.\n *\n * @public\n */\n\n\nvar motion = /*@__PURE__*/createMotionProxy(function (Component, config) {\n  return createDomMotionConfig(Component, config, featureBundle, createDomVisualElement, HTMLProjectionNode);\n});\n/**\n * Create a DOM `motion` component with the provided string. This is primarily intended\n * as a full alternative to `motion` for consumers who have to support environments that don't\n * support `Proxy`.\n *\n * ```javascript\n * import { createDomMotionComponent } from \"framer-motion\"\n *\n * const motion = {\n *   div: createDomMotionComponent('div')\n * }\n * ```\n *\n * @public\n */\n\nfunction createDomMotionComponent(key) {\n  return createMotionComponent(createDomMotionConfig(key, {\n    forwardMotionProps: false\n  }, featureBundle, createDomVisualElement, HTMLProjectionNode));\n}\n/**\n * @public\n */\n\n\nvar m = createMotionProxy(createDomMotionConfig);\n\nfunction useIsMounted() {\n  var isMounted = React.useRef(false);\n  useIsomorphicLayoutEffect(function () {\n    isMounted.current = true;\n    return function () {\n      isMounted.current = false;\n    };\n  }, []);\n  return isMounted;\n}\n\nfunction useForceUpdate() {\n  var isMounted = useIsMounted();\n\n  var _a = tslib.__read(React.useState(0), 2),\n      forcedRenderCount = _a[0],\n      setForcedRenderCount = _a[1];\n\n  var forceRender = React.useCallback(function () {\n    isMounted.current && setForcedRenderCount(forcedRenderCount + 1);\n  }, [forcedRenderCount]);\n  /**\n   * Defer this to the end of the next animation frame in case there are multiple\n   * synchronous calls.\n   */\n\n  var deferredForceRender = React.useCallback(function () {\n    return sync__default[\"default\"].postRender(forceRender);\n  }, [forceRender]);\n  return [deferredForceRender, forcedRenderCount];\n}\n\nvar PresenceChild = function PresenceChild(_a) {\n  var children = _a.children,\n      initial = _a.initial,\n      isPresent = _a.isPresent,\n      _onExitComplete = _a.onExitComplete,\n      custom = _a.custom,\n      presenceAffectsLayout = _a.presenceAffectsLayout;\n  var presenceChildren = useConstant(newChildrenMap);\n  var id = useId();\n  var context = React.useMemo(function () {\n    return {\n      id: id,\n      initial: initial,\n      isPresent: isPresent,\n      custom: custom,\n      onExitComplete: function onExitComplete(childId) {\n        var e_1, _a;\n\n        presenceChildren.set(childId, true);\n\n        try {\n          for (var _b = tslib.__values(presenceChildren.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var isComplete = _c.value;\n            if (!isComplete) return; // can stop searching when any is incomplete\n          }\n        } catch (e_1_1) {\n          e_1 = {\n            error: e_1_1\n          };\n        } finally {\n          try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n          } finally {\n            if (e_1) throw e_1.error;\n          }\n        }\n\n        _onExitComplete === null || _onExitComplete === void 0 ? void 0 : _onExitComplete();\n      },\n      register: function register(childId) {\n        presenceChildren.set(childId, false);\n        return function () {\n          return presenceChildren.delete(childId);\n        };\n      }\n    };\n  },\n  /**\n   * If the presence of a child affects the layout of the components around it,\n   * we want to make a new context value to ensure they get re-rendered\n   * so they can detect that layout change.\n   */\n  presenceAffectsLayout ? undefined : [isPresent]);\n  React.useMemo(function () {\n    presenceChildren.forEach(function (_, key) {\n      return presenceChildren.set(key, false);\n    });\n  }, [isPresent]);\n  /**\n   * If there's no `motion` components to fire exit animations, we want to remove this\n   * component immediately.\n   */\n\n  React__namespace.useEffect(function () {\n    !isPresent && !presenceChildren.size && (_onExitComplete === null || _onExitComplete === void 0 ? void 0 : _onExitComplete());\n  }, [isPresent]);\n  return React__namespace.createElement(PresenceContext.Provider, {\n    value: context\n  }, children);\n};\n\nfunction newChildrenMap() {\n  return new Map();\n}\n\nvar getChildKey = function getChildKey(child) {\n  return child.key || \"\";\n};\n\nfunction updateChildLookup(children, allChildren) {\n  children.forEach(function (child) {\n    var key = getChildKey(child);\n    allChildren.set(key, child);\n  });\n}\n\nfunction onlyElements(children) {\n  var filtered = []; // We use forEach here instead of map as map mutates the component key by preprending `.$`\n\n  React.Children.forEach(children, function (child) {\n    if (React.isValidElement(child)) filtered.push(child);\n  });\n  return filtered;\n}\n/**\n * `AnimatePresence` enables the animation of components that have been removed from the tree.\n *\n * When adding/removing more than a single child, every child **must** be given a unique `key` prop.\n *\n * Any `motion` components that have an `exit` property defined will animate out when removed from\n * the tree.\n *\n * ```jsx\n * import { motion, AnimatePresence } from 'framer-motion'\n *\n * export const Items = ({ items }) => (\n *   <AnimatePresence>\n *     {items.map(item => (\n *       <motion.div\n *         key={item.id}\n *         initial={{ opacity: 0 }}\n *         animate={{ opacity: 1 }}\n *         exit={{ opacity: 0 }}\n *       />\n *     ))}\n *   </AnimatePresence>\n * )\n * ```\n *\n * You can sequence exit animations throughout a tree using variants.\n *\n * If a child contains multiple `motion` components with `exit` props, it will only unmount the child\n * once all `motion` components have finished animating out. Likewise, any components using\n * `usePresence` all need to call `safeToRemove`.\n *\n * @public\n */\n\n\nvar AnimatePresence = function AnimatePresence(_a) {\n  var children = _a.children,\n      custom = _a.custom,\n      _b = _a.initial,\n      initial = _b === void 0 ? true : _b,\n      onExitComplete = _a.onExitComplete,\n      exitBeforeEnter = _a.exitBeforeEnter,\n      _c = _a.presenceAffectsLayout,\n      presenceAffectsLayout = _c === void 0 ? true : _c; // We want to force a re-render once all exiting animations have finished. We\n  // either use a local forceRender function, or one from a parent context if it exists.\n\n  var _d = tslib.__read(useForceUpdate(), 1),\n      forceRender = _d[0];\n\n  var forceRenderLayoutGroup = React.useContext(LayoutGroupContext).forceRender;\n  if (forceRenderLayoutGroup) forceRender = forceRenderLayoutGroup;\n  var isMounted = useIsMounted(); // Filter out any children that aren't ReactElements. We can only track ReactElements with a props.key\n\n  var filteredChildren = onlyElements(children);\n  var childrenToRender = filteredChildren;\n  var exiting = new Set(); // Keep a living record of the children we're actually rendering so we\n  // can diff to figure out which are entering and exiting\n\n  var presentChildren = React.useRef(childrenToRender); // A lookup table to quickly reference components by key\n\n  var allChildren = React.useRef(new Map()).current; // If this is the initial component render, just deal with logic surrounding whether\n  // we play onMount animations or not.\n\n  var isInitialRender = React.useRef(true);\n  useIsomorphicLayoutEffect(function () {\n    isInitialRender.current = false;\n    updateChildLookup(filteredChildren, allChildren);\n    presentChildren.current = childrenToRender;\n  });\n  useUnmountEffect(function () {\n    isInitialRender.current = true;\n    allChildren.clear();\n    exiting.clear();\n  });\n\n  if (isInitialRender.current) {\n    return React__namespace.createElement(React__namespace.Fragment, null, childrenToRender.map(function (child) {\n      return React__namespace.createElement(PresenceChild, {\n        key: getChildKey(child),\n        isPresent: true,\n        initial: initial ? undefined : false,\n        presenceAffectsLayout: presenceAffectsLayout\n      }, child);\n    }));\n  } // If this is a subsequent render, deal with entering and exiting children\n\n\n  childrenToRender = tslib.__spreadArray([], tslib.__read(childrenToRender), false); // Diff the keys of the currently-present and target children to update our\n  // exiting list.\n\n  var presentKeys = presentChildren.current.map(getChildKey);\n  var targetKeys = filteredChildren.map(getChildKey); // Diff the present children with our target children and mark those that are exiting\n\n  var numPresent = presentKeys.length;\n\n  for (var i = 0; i < numPresent; i++) {\n    var key = presentKeys[i];\n\n    if (targetKeys.indexOf(key) === -1) {\n      exiting.add(key);\n    }\n  } // If we currently have exiting children, and we're deferring rendering incoming children\n  // until after all current children have exiting, empty the childrenToRender array\n\n\n  if (exitBeforeEnter && exiting.size) {\n    childrenToRender = [];\n  } // Loop through all currently exiting components and clone them to overwrite `animate`\n  // with any `exit` prop they might have defined.\n\n\n  exiting.forEach(function (key) {\n    // If this component is actually entering again, early return\n    if (targetKeys.indexOf(key) !== -1) return;\n    var child = allChildren.get(key);\n    if (!child) return;\n    var insertionIndex = presentKeys.indexOf(key);\n\n    var onExit = function onExit() {\n      allChildren.delete(key);\n      exiting.delete(key); // Remove this child from the present children\n\n      var removeIndex = presentChildren.current.findIndex(function (presentChild) {\n        return presentChild.key === key;\n      });\n      presentChildren.current.splice(removeIndex, 1); // Defer re-rendering until all exiting children have indeed left\n\n      if (!exiting.size) {\n        presentChildren.current = filteredChildren;\n        if (isMounted.current === false) return;\n        forceRender();\n        onExitComplete && onExitComplete();\n      }\n    };\n\n    childrenToRender.splice(insertionIndex, 0, React__namespace.createElement(PresenceChild, {\n      key: getChildKey(child),\n      isPresent: false,\n      onExitComplete: onExit,\n      custom: custom,\n      presenceAffectsLayout: presenceAffectsLayout\n    }, child));\n  }); // Add `MotionContext` even to children that don't need it to ensure we're rendering\n  // the same tree between renders\n\n  childrenToRender = childrenToRender.map(function (child) {\n    var key = child.key;\n    return exiting.has(key) ? child : React__namespace.createElement(PresenceChild, {\n      key: getChildKey(child),\n      isPresent: true,\n      presenceAffectsLayout: presenceAffectsLayout\n    }, child);\n  });\n\n  if (env !== \"production\" && exitBeforeEnter && childrenToRender.length > 1) {\n    console.warn(\"You're attempting to animate multiple children within AnimatePresence, but its exitBeforeEnter prop is set to true. This will lead to odd visual behaviour.\");\n  }\n\n  return React__namespace.createElement(React__namespace.Fragment, null, exiting.size ? childrenToRender : childrenToRender.map(function (child) {\n    return React.cloneElement(child);\n  }));\n};\n/**\n * @deprecated\n */\n\n\nvar DeprecatedLayoutGroupContext = React.createContext(null);\n\nvar notify = function notify(node) {\n  return !node.isLayoutDirty && node.willUpdate(false);\n};\n\nfunction nodeGroup() {\n  var nodes = new Set();\n  var subscriptions = new WeakMap();\n\n  var dirtyAll = function dirtyAll() {\n    return nodes.forEach(notify);\n  };\n\n  return {\n    add: function add(node) {\n      nodes.add(node);\n      subscriptions.set(node, node.addEventListener(\"willUpdate\", dirtyAll));\n    },\n    remove: function remove(node) {\n      var _a;\n\n      nodes.delete(node);\n      (_a = subscriptions.get(node)) === null || _a === void 0 ? void 0 : _a();\n      subscriptions.delete(node);\n      dirtyAll();\n    },\n    dirty: dirtyAll\n  };\n}\n\nvar shouldInheritGroup = function shouldInheritGroup(inherit) {\n  return inherit === true;\n};\n\nvar shouldInheritId = function shouldInheritId(inherit) {\n  return shouldInheritGroup(inherit === true) || inherit === \"id\";\n};\n\nvar LayoutGroup = function LayoutGroup(_a) {\n  var _b, _c;\n\n  var children = _a.children,\n      id = _a.id,\n      inheritId = _a.inheritId,\n      _d = _a.inherit,\n      inherit = _d === void 0 ? true : _d; // Maintain backwards-compatibility with inheritId until 7.0\n\n  if (inheritId !== undefined) inherit = inheritId;\n  var layoutGroupContext = React.useContext(LayoutGroupContext);\n  var deprecatedLayoutGroupContext = React.useContext(DeprecatedLayoutGroupContext);\n\n  var _e = tslib.__read(useForceUpdate(), 2),\n      forceRender = _e[0],\n      key = _e[1];\n\n  var context = React.useRef(null);\n  var upstreamId = (_b = layoutGroupContext.id) !== null && _b !== void 0 ? _b : deprecatedLayoutGroupContext;\n\n  if (context.current === null) {\n    if (shouldInheritId(inherit) && upstreamId) {\n      id = id ? upstreamId + \"-\" + id : upstreamId;\n    }\n\n    context.current = {\n      id: id,\n      group: shouldInheritGroup(inherit) ? (_c = layoutGroupContext === null || layoutGroupContext === void 0 ? void 0 : layoutGroupContext.group) !== null && _c !== void 0 ? _c : nodeGroup() : nodeGroup()\n    };\n  }\n\n  var memoizedContext = React.useMemo(function () {\n    return tslib.__assign(tslib.__assign({}, context.current), {\n      forceRender: forceRender\n    });\n  }, [key]);\n  return React__namespace.createElement(LayoutGroupContext.Provider, {\n    value: memoizedContext\n  }, children);\n};\n\nvar id = 0;\n\nvar AnimateSharedLayout = function AnimateSharedLayout(_a) {\n  var children = _a.children;\n  React__namespace.useEffect(function () {\n    heyListen.warning(false, \"AnimateSharedLayout is deprecated: https://www.framer.com/docs/guide-upgrade/##shared-layout-animations\");\n  }, []);\n  return React__namespace.createElement(LayoutGroup, {\n    id: useConstant(function () {\n      return \"asl-\".concat(id++);\n    })\n  }, children);\n};\n/**\n * `MotionConfig` is used to set configuration options for all children `motion` components.\n *\n * ```jsx\n * import { motion, MotionConfig } from \"framer-motion\"\n *\n * export function App() {\n *   return (\n *     <MotionConfig transition={{ type: \"spring\" }}>\n *       <motion.div animate={{ x: 100 }} />\n *     </MotionConfig>\n *   )\n * }\n * ```\n *\n * @public\n */\n\n\nfunction MotionConfig(_a) {\n  var children = _a.children,\n      isValidProp = _a.isValidProp,\n      config = tslib.__rest(_a, [\"children\", \"isValidProp\"]);\n\n  isValidProp && loadExternalIsValidProp(isValidProp);\n  /**\n   * Inherit props from any parent MotionConfig components\n   */\n\n  config = tslib.__assign(tslib.__assign({}, React.useContext(MotionConfigContext)), config);\n  /**\n   * Don't allow isStatic to change between renders as it affects how many hooks\n   * motion components fire.\n   */\n\n  config.isStatic = useConstant(function () {\n    return config.isStatic;\n  });\n  /**\n   * Creating a new config context object will re-render every `motion` component\n   * every time it renders. So we only want to create a new one sparingly.\n   */\n\n  var context = React.useMemo(function () {\n    return config;\n  }, [JSON.stringify(config.transition), config.transformPagePoint, config.reducedMotion]);\n  return React__namespace.createElement(MotionConfigContext.Provider, {\n    value: context\n  }, children);\n}\n/**\n * Used in conjunction with the `m` component to reduce bundle size.\n *\n * `m` is a version of the `motion` component that only loads functionality\n * critical for the initial render.\n *\n * `LazyMotion` can then be used to either synchronously or asynchronously\n * load animation and gesture support.\n *\n * ```jsx\n * // Synchronous loading\n * import { LazyMotion, m, domAnimations } from \"framer-motion\"\n *\n * function App() {\n *   return (\n *     <LazyMotion features={domAnimations}>\n *       <m.div animate={{ scale: 2 }} />\n *     </LazyMotion>\n *   )\n * }\n *\n * // Asynchronous loading\n * import { LazyMotion, m } from \"framer-motion\"\n *\n * function App() {\n *   return (\n *     <LazyMotion features={() => import('./path/to/domAnimations')}>\n *       <m.div animate={{ scale: 2 }} />\n *     </LazyMotion>\n *   )\n * }\n * ```\n *\n * @public\n */\n\n\nfunction LazyMotion(_a) {\n  var children = _a.children,\n      features = _a.features,\n      _b = _a.strict,\n      strict = _b === void 0 ? false : _b;\n\n  var _c = tslib.__read(React.useState(!isLazyBundle(features)), 2),\n      setIsLoaded = _c[1];\n\n  var loadedRenderer = React.useRef(undefined);\n  /**\n   * If this is a synchronous load, load features immediately\n   */\n\n  if (!isLazyBundle(features)) {\n    var renderer = features.renderer,\n        loadedFeatures = tslib.__rest(features, [\"renderer\"]);\n\n    loadedRenderer.current = renderer;\n    loadFeatures(loadedFeatures);\n  }\n\n  React.useEffect(function () {\n    if (isLazyBundle(features)) {\n      features().then(function (_a) {\n        var renderer = _a.renderer,\n            loadedFeatures = tslib.__rest(_a, [\"renderer\"]);\n\n        loadFeatures(loadedFeatures);\n        loadedRenderer.current = renderer;\n        setIsLoaded(true);\n      });\n    }\n  }, []);\n  return React__namespace.createElement(LazyContext.Provider, {\n    value: {\n      renderer: loadedRenderer.current,\n      strict: strict\n    }\n  }, children);\n}\n\nfunction isLazyBundle(features) {\n  return typeof features === \"function\";\n}\n\nvar ReorderContext = React.createContext(null);\n\nfunction checkReorder(order, value, offset, velocity) {\n  if (!velocity) return order;\n  var index = order.findIndex(function (item) {\n    return item.value === value;\n  });\n  if (index === -1) return order;\n  var nextOffset = velocity > 0 ? 1 : -1;\n  var nextItem = order[index + nextOffset];\n  if (!nextItem) return order;\n  var item = order[index];\n  var nextLayout = nextItem.layout;\n  var nextItemCenter = popmotion.mix(nextLayout.min, nextLayout.max, 0.5);\n\n  if (nextOffset === 1 && item.layout.max + offset > nextItemCenter || nextOffset === -1 && item.layout.min + offset < nextItemCenter) {\n    return moveItem(order, index, index + nextOffset);\n  }\n\n  return order;\n}\n\nfunction ReorderGroup(_a, externalRef) {\n  var children = _a.children,\n      _b = _a.as,\n      as = _b === void 0 ? \"ul\" : _b,\n      _c = _a.axis,\n      axis = _c === void 0 ? \"y\" : _c,\n      onReorder = _a.onReorder,\n      values = _a.values,\n      props = tslib.__rest(_a, [\"children\", \"as\", \"axis\", \"onReorder\", \"values\"]);\n\n  var Component = useConstant(function () {\n    return motion(as);\n  });\n  var order = [];\n  var isReordering = React.useRef(false);\n  heyListen.invariant(Boolean(values), \"Reorder.Group must be provided a values prop\");\n  var context = {\n    axis: axis,\n    registerItem: function registerItem(value, layout) {\n      /**\n       * Ensure entries can't add themselves more than once\n       */\n      if (layout && order.findIndex(function (entry) {\n        return value === entry.value;\n      }) === -1) {\n        order.push({\n          value: value,\n          layout: layout[axis]\n        });\n        order.sort(compareMin);\n      }\n    },\n    updateOrder: function updateOrder(id, offset, velocity) {\n      if (isReordering.current) return;\n      var newOrder = checkReorder(order, id, offset, velocity);\n\n      if (order !== newOrder) {\n        isReordering.current = true;\n        onReorder(newOrder.map(getValue).filter(function (value) {\n          return values.indexOf(value) !== -1;\n        }));\n      }\n    }\n  };\n  React.useEffect(function () {\n    isReordering.current = false;\n  });\n  return React__namespace.createElement(Component, tslib.__assign({}, props, {\n    ref: externalRef\n  }), React__namespace.createElement(ReorderContext.Provider, {\n    value: context\n  }, children));\n}\n\nvar Group = React.forwardRef(ReorderGroup);\n\nfunction getValue(item) {\n  return item.value;\n}\n\nfunction compareMin(a, b) {\n  return a.layout.min - b.layout.min;\n}\n/**\n * Creates a `MotionValue` to track the state and velocity of a value.\n *\n * Usually, these are created automatically. For advanced use-cases, like use with `useTransform`, you can create `MotionValue`s externally and pass them into the animated component via the `style` prop.\n *\n * ```jsx\n * export const MyComponent = () => {\n *   const scale = useMotionValue(1)\n *\n *   return <motion.div style={{ scale }} />\n * }\n * ```\n *\n * @param initial - The initial state.\n *\n * @public\n */\n\n\nfunction useMotionValue(initial) {\n  var value = useConstant(function () {\n    return motionValue(initial);\n  });\n  /**\n   * If this motion value is being used in static mode, like on\n   * the Framer canvas, force components to rerender when the motion\n   * value is updated.\n   */\n\n  var isStatic = React.useContext(MotionConfigContext).isStatic;\n\n  if (isStatic) {\n    var _a = tslib.__read(React.useState(initial), 2),\n        setLatest_1 = _a[1];\n\n    React.useEffect(function () {\n      return value.onChange(setLatest_1);\n    }, []);\n  }\n\n  return value;\n}\n\nvar isCustomValueType = function isCustomValueType(v) {\n  return typeof v === \"object\" && v.mix;\n};\n\nvar getMixer = function getMixer(v) {\n  return isCustomValueType(v) ? v.mix : undefined;\n};\n\nfunction transform() {\n  var args = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n\n  var useImmediate = !Array.isArray(args[0]);\n  var argOffset = useImmediate ? 0 : -1;\n  var inputValue = args[0 + argOffset];\n  var inputRange = args[1 + argOffset];\n  var outputRange = args[2 + argOffset];\n  var options = args[3 + argOffset];\n  var interpolator = popmotion.interpolate(inputRange, outputRange, tslib.__assign({\n    mixer: getMixer(outputRange[0])\n  }, options));\n  return useImmediate ? interpolator(inputValue) : interpolator;\n}\n\nfunction useOnChange(value, callback) {\n  useIsomorphicLayoutEffect(function () {\n    if (isMotionValue(value)) return value.onChange(callback);\n  }, [callback]);\n}\n\nfunction useMultiOnChange(values, handler) {\n  useIsomorphicLayoutEffect(function () {\n    var subscriptions = values.map(function (value) {\n      return value.onChange(handler);\n    });\n    return function () {\n      return subscriptions.forEach(function (unsubscribe) {\n        return unsubscribe();\n      });\n    };\n  });\n}\n\nfunction useCombineMotionValues(values, combineValues) {\n  /**\n   * Initialise the returned motion value. This remains the same between renders.\n   */\n  var value = useMotionValue(combineValues());\n  /**\n   * Create a function that will update the template motion value with the latest values.\n   * This is pre-bound so whenever a motion value updates it can schedule its\n   * execution in Framesync. If it's already been scheduled it won't be fired twice\n   * in a single frame.\n   */\n\n  var updateValue = function updateValue() {\n    return value.set(combineValues());\n  };\n  /**\n   * Synchronously update the motion value with the latest values during the render.\n   * This ensures that within a React render, the styles applied to the DOM are up-to-date.\n   */\n\n\n  updateValue();\n  /**\n   * Subscribe to all motion values found within the template. Whenever any of them change,\n   * schedule an update.\n   */\n\n  useMultiOnChange(values, function () {\n    return sync__default[\"default\"].update(updateValue, false, true);\n  });\n  return value;\n}\n\nfunction useTransform(input, inputRangeOrTransformer, outputRange, options) {\n  var transformer = typeof inputRangeOrTransformer === \"function\" ? inputRangeOrTransformer : transform(inputRangeOrTransformer, outputRange, options);\n  return Array.isArray(input) ? useListTransform(input, transformer) : useListTransform([input], function (_a) {\n    var _b = tslib.__read(_a, 1),\n        latest = _b[0];\n\n    return transformer(latest);\n  });\n}\n\nfunction useListTransform(values, transformer) {\n  var latest = useConstant(function () {\n    return [];\n  });\n  return useCombineMotionValues(values, function () {\n    latest.length = 0;\n    var numValues = values.length;\n\n    for (var i = 0; i < numValues; i++) {\n      latest[i] = values[i].get();\n    }\n\n    return transformer(latest);\n  });\n}\n\nfunction useDefaultMotionValue(value, defaultValue) {\n  if (defaultValue === void 0) {\n    defaultValue = 0;\n  }\n\n  return isMotionValue(value) ? value : useMotionValue(defaultValue);\n}\n\nfunction ReorderItem(_a, externalRef) {\n  var children = _a.children,\n      style = _a.style,\n      value = _a.value,\n      _b = _a.as,\n      as = _b === void 0 ? \"li\" : _b,\n      _onDrag = _a.onDrag,\n      _c = _a.layout,\n      layout = _c === void 0 ? true : _c,\n      props = tslib.__rest(_a, [\"children\", \"style\", \"value\", \"as\", \"onDrag\", \"layout\"]);\n\n  var Component = useConstant(function () {\n    return motion(as);\n  });\n  var context = React.useContext(ReorderContext);\n  var point = {\n    x: useDefaultMotionValue(style === null || style === void 0 ? void 0 : style.x),\n    y: useDefaultMotionValue(style === null || style === void 0 ? void 0 : style.y)\n  };\n  var zIndex = useTransform([point.x, point.y], function (_a) {\n    var _b = tslib.__read(_a, 2),\n        latestX = _b[0],\n        latestY = _b[1];\n\n    return latestX || latestY ? 1 : \"unset\";\n  });\n  var measuredLayout = React.useRef(null);\n  heyListen.invariant(Boolean(context), \"Reorder.Item must be a child of Reorder.Group\");\n  var _d = context,\n      axis = _d.axis,\n      registerItem = _d.registerItem,\n      updateOrder = _d.updateOrder;\n  React.useEffect(function () {\n    registerItem(value, measuredLayout.current);\n  }, [context]);\n  return React__namespace.createElement(Component, tslib.__assign({\n    drag: axis\n  }, props, {\n    dragSnapToOrigin: true,\n    style: tslib.__assign(tslib.__assign({}, style), {\n      x: point.x,\n      y: point.y,\n      zIndex: zIndex\n    }),\n    layout: layout,\n    onDrag: function onDrag(event, gesturePoint) {\n      var velocity = gesturePoint.velocity;\n      velocity[axis] && updateOrder(value, point[axis].get(), velocity[axis]);\n      _onDrag === null || _onDrag === void 0 ? void 0 : _onDrag(event, gesturePoint);\n    },\n    onLayoutMeasure: function onLayoutMeasure(measured) {\n      measuredLayout.current = measured;\n    },\n    ref: externalRef\n  }), children);\n}\n\nvar Item = React.forwardRef(ReorderItem);\nvar Reorder = {\n  Group: Group,\n  Item: Item\n};\n/**\n * @public\n */\n\nvar domAnimation = tslib.__assign(tslib.__assign({\n  renderer: createDomVisualElement\n}, animations), gestureAnimations);\n/**\n * @public\n */\n\n\nvar domMax = tslib.__assign(tslib.__assign(tslib.__assign(tslib.__assign({}, domAnimation), drag), layoutFeatures), {\n  projectionNodeConstructor: HTMLProjectionNode\n});\n/**\n * Combine multiple motion values into a new one using a string template literal.\n *\n * ```jsx\n * import {\n *   motion,\n *   useSpring,\n *   useMotionValue,\n *   useMotionTemplate\n * } from \"framer-motion\"\n *\n * function Component() {\n *   const shadowX = useSpring(0)\n *   const shadowY = useMotionValue(0)\n *   const shadow = useMotionTemplate`drop-shadow(${shadowX}px ${shadowY}px 20px rgba(0,0,0,0.3))`\n *\n *   return <motion.div style={{ filter: shadow }} />\n * }\n * ```\n *\n * @public\n */\n\n\nfunction useMotionTemplate(fragments) {\n  var values = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    values[_i - 1] = arguments[_i];\n  }\n  /**\n   * Create a function that will build a string from the latest motion values.\n   */\n\n\n  var numFragments = fragments.length;\n\n  function buildValue() {\n    var output = \"\";\n\n    for (var i = 0; i < numFragments; i++) {\n      output += fragments[i];\n      var value = values[i];\n      if (value) output += values[i].get();\n    }\n\n    return output;\n  }\n\n  return useCombineMotionValues(values, buildValue);\n}\n/**\n * Creates a `MotionValue` that, when `set`, will use a spring animation to animate to its new state.\n *\n * It can either work as a stand-alone `MotionValue` by initialising it with a value, or as a subscriber\n * to another `MotionValue`.\n *\n * @remarks\n *\n * ```jsx\n * const x = useSpring(0, { stiffness: 300 })\n * const y = useSpring(x, { damping: 10 })\n * ```\n *\n * @param inputValue - `MotionValue` or number. If provided a `MotionValue`, when the input `MotionValue` changes, the created `MotionValue` will spring towards that value.\n * @param springConfig - Configuration options for the spring.\n * @returns `MotionValue`\n *\n * @public\n */\n\n\nfunction useSpring(source, config) {\n  if (config === void 0) {\n    config = {};\n  }\n\n  var isStatic = React.useContext(MotionConfigContext).isStatic;\n  var activeSpringAnimation = React.useRef(null);\n  var value = useMotionValue(isMotionValue(source) ? source.get() : source);\n  React.useMemo(function () {\n    return value.attach(function (v, set) {\n      /**\n       * A more hollistic approach to this might be to use isStatic to fix VisualElement animations\n       * at that level, but this will work for now\n       */\n      if (isStatic) return set(v);\n\n      if (activeSpringAnimation.current) {\n        activeSpringAnimation.current.stop();\n      }\n\n      activeSpringAnimation.current = popmotion.animate(tslib.__assign(tslib.__assign({\n        from: value.get(),\n        to: v,\n        velocity: value.getVelocity()\n      }, config), {\n        onUpdate: set\n      }));\n      return value.get();\n    });\n  }, [JSON.stringify(config)]);\n  useOnChange(source, function (v) {\n    return value.set(parseFloat(v));\n  });\n  return value;\n}\n/**\n * Creates a `MotionValue` that updates when the velocity of the provided `MotionValue` changes.\n *\n * ```javascript\n * const x = useMotionValue(0)\n * const xVelocity = useVelocity(x)\n * const xAcceleration = useVelocity(xVelocity)\n * ```\n *\n * @public\n */\n\n\nfunction useVelocity(value) {\n  var velocity = useMotionValue(value.getVelocity());\n  React.useEffect(function () {\n    return value.velocityUpdateSubscribers.add(function (newVelocity) {\n      velocity.set(newVelocity);\n    });\n  }, [value]);\n  return velocity;\n}\n\nvar createScrollMotionValues = function createScrollMotionValues() {\n  return {\n    scrollX: motionValue(0),\n    scrollY: motionValue(0),\n    scrollXProgress: motionValue(0),\n    scrollYProgress: motionValue(0)\n  };\n};\n\nfunction useScroll(_a) {\n  if (_a === void 0) {\n    _a = {};\n  }\n\n  var container = _a.container,\n      target = _a.target,\n      options = tslib.__rest(_a, [\"container\", \"target\"]);\n\n  var values = useConstant(createScrollMotionValues);\n  useIsomorphicLayoutEffect(function () {\n    return dom.scroll(function (_a) {\n      var x = _a.x,\n          y = _a.y;\n      values.scrollX.set(x.current);\n      values.scrollXProgress.set(x.progress);\n      values.scrollY.set(y.current);\n      values.scrollYProgress.set(y.progress);\n    }, tslib.__assign(tslib.__assign({}, options), {\n      container: (container === null || container === void 0 ? void 0 : container.current) || undefined,\n      target: (target === null || target === void 0 ? void 0 : target.current) || undefined\n    }));\n  }, []);\n  return values;\n}\n/**\n * @deprecated useElementScroll is deprecated. Convert to useScroll({ container: ref })\n */\n\n\nfunction useElementScroll(ref) {\n  warnOnce(false, \"useElementScroll is deprecated. Convert to useScroll({ container: ref }).\");\n  return useScroll({\n    container: ref\n  });\n}\n/**\n * @deprecated useViewportScroll is deprecated. Convert to useScroll()\n */\n\n\nfunction useViewportScroll() {\n  warnOnce(false, \"useViewportScroll is deprecated. Convert to useScroll().\");\n  return useScroll();\n}\n\nfunction useAnimationFrame(callback) {\n  var initialTimestamp = React.useRef(0);\n  var isStatic = React.useContext(MotionConfigContext).isStatic;\n  React.useEffect(function () {\n    if (isStatic) return;\n\n    var provideTimeSinceStart = function provideTimeSinceStart(_a) {\n      var timestamp = _a.timestamp;\n      if (!initialTimestamp.current) initialTimestamp.current = timestamp;\n      callback(timestamp - initialTimestamp.current);\n    };\n\n    sync__default[\"default\"].update(provideTimeSinceStart, true);\n    return function () {\n      return sync.cancelSync.update(provideTimeSinceStart);\n    };\n  }, [callback]);\n}\n\nfunction useTime() {\n  var time = useMotionValue(0);\n  useAnimationFrame(function (t) {\n    return time.set(t);\n  });\n  return time;\n}\n/**\n * @public\n */\n\n\nfunction animationControls() {\n  /**\n   * Track whether the host component has mounted.\n   */\n  var hasMounted = false;\n  /**\n   * Pending animations that are started before a component is mounted.\n   * TODO: Remove this as animations should only run in effects\n   */\n\n  var pendingAnimations = [];\n  /**\n   * A collection of linked component animation controls.\n   */\n\n  var subscribers = new Set();\n  var controls = {\n    subscribe: function subscribe(visualElement) {\n      subscribers.add(visualElement);\n      return function () {\n        return void subscribers.delete(visualElement);\n      };\n    },\n    start: function start(definition, transitionOverride) {\n      /**\n       * TODO: We only perform this hasMounted check because in Framer we used to\n       * encourage the ability to start an animation within the render phase. This\n       * isn't behaviour concurrent-safe so when we make Framer concurrent-safe\n       * we can ditch this.\n       */\n      if (hasMounted) {\n        var animations_1 = [];\n        subscribers.forEach(function (visualElement) {\n          animations_1.push(animateVisualElement(visualElement, definition, {\n            transitionOverride: transitionOverride\n          }));\n        });\n        return Promise.all(animations_1);\n      } else {\n        return new Promise(function (resolve) {\n          pendingAnimations.push({\n            animation: [definition, transitionOverride],\n            resolve: resolve\n          });\n        });\n      }\n    },\n    set: function set(definition) {\n      heyListen.invariant(hasMounted, \"controls.set() should only be called after a component has mounted. Consider calling within a useEffect hook.\");\n      return subscribers.forEach(function (visualElement) {\n        setValues(visualElement, definition);\n      });\n    },\n    stop: function stop() {\n      subscribers.forEach(function (visualElement) {\n        stopAnimation(visualElement);\n      });\n    },\n    mount: function mount() {\n      hasMounted = true;\n      pendingAnimations.forEach(function (_a) {\n        var animation = _a.animation,\n            resolve = _a.resolve;\n        controls.start.apply(controls, tslib.__spreadArray([], tslib.__read(animation), false)).then(resolve);\n      });\n      return function () {\n        hasMounted = false;\n        controls.stop();\n      };\n    }\n  };\n  return controls;\n}\n/**\n * Creates `AnimationControls`, which can be used to manually start, stop\n * and sequence animations on one or more components.\n *\n * The returned `AnimationControls` should be passed to the `animate` property\n * of the components you want to animate.\n *\n * These components can then be animated with the `start` method.\n *\n * ```jsx\n * import * as React from 'react'\n * import { motion, useAnimation } from 'framer-motion'\n *\n * export function MyComponent(props) {\n *    const controls = useAnimation()\n *\n *    controls.start({\n *        x: 100,\n *        transition: { duration: 0.5 },\n *    })\n *\n *    return <motion.div animate={controls} />\n * }\n * ```\n *\n * @returns Animation controller with `start` and `stop` methods\n *\n * @public\n */\n\n\nfunction useAnimationControls() {\n  var controls = useConstant(animationControls);\n  React.useEffect(controls.mount, []);\n  return controls;\n}\n\nvar useAnimation = useAnimationControls;\n/**\n * Cycles through a series of visual properties. Can be used to toggle between or cycle through animations. It works similar to `useState` in React. It is provided an initial array of possible states, and returns an array of two arguments.\n *\n * An index value can be passed to the returned `cycle` function to cycle to a specific index.\n *\n * ```jsx\n * import * as React from \"react\"\n * import { motion, useCycle } from \"framer-motion\"\n *\n * export const MyComponent = () => {\n *   const [x, cycleX] = useCycle(0, 50, 100)\n *\n *   return (\n *     <motion.div\n *       animate={{ x: x }}\n *       onTap={() => cycleX()}\n *      />\n *    )\n * }\n * ```\n *\n * @param items - items to cycle through\n * @returns [currentState, cycleState]\n *\n * @public\n */\n\nfunction useCycle() {\n  var items = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    items[_i] = arguments[_i];\n  }\n\n  var index = React.useRef(0);\n\n  var _a = tslib.__read(React.useState(items[index.current]), 2),\n      item = _a[0],\n      setItem = _a[1];\n\n  var runCycle = React.useCallback(function (next) {\n    index.current = typeof next !== \"number\" ? popmotion.wrap(0, items.length, index.current + 1) : next;\n    setItem(items[index.current]);\n  }, tslib.__spreadArray([items.length], tslib.__read(items), false));\n  return [item, runCycle];\n}\n\nfunction useInView(ref, _a) {\n  var _b = _a === void 0 ? {} : _a,\n      root = _b.root,\n      margin = _b.margin,\n      amount = _b.amount,\n      _c = _b.once,\n      once = _c === void 0 ? false : _c;\n\n  var _d = tslib.__read(React.useState(false), 2),\n      isInView = _d[0],\n      setInView = _d[1];\n\n  React.useEffect(function () {\n    var _a;\n\n    if (!ref.current || once && isInView) return;\n\n    var onEnter = function onEnter() {\n      setInView(true);\n      return once ? undefined : function () {\n        return setInView(false);\n      };\n    };\n\n    var options = {\n      root: (_a = root === null || root === void 0 ? void 0 : root.current) !== null && _a !== void 0 ? _a : undefined,\n      margin: margin,\n      amount: amount === \"some\" ? \"any\" : amount\n    };\n    return dom.inView(ref.current, onEnter, options);\n  }, [root, ref, margin, once]);\n  return isInView;\n}\n/**\n * Can manually trigger a drag gesture on one or more `drag`-enabled `motion` components.\n *\n * ```jsx\n * const dragControls = useDragControls()\n *\n * function startDrag(event) {\n *   dragControls.start(event, { snapToCursor: true })\n * }\n *\n * return (\n *   <>\n *     <div onPointerDown={startDrag} />\n *     <motion.div drag=\"x\" dragControls={dragControls} />\n *   </>\n * )\n * ```\n *\n * @public\n */\n\n\nvar DragControls =\n/** @class */\nfunction () {\n  function DragControls() {\n    this.componentControls = new Set();\n  }\n  /**\n   * Subscribe a component's internal `VisualElementDragControls` to the user-facing API.\n   *\n   * @internal\n   */\n\n\n  DragControls.prototype.subscribe = function (controls) {\n    var _this = this;\n\n    this.componentControls.add(controls);\n    return function () {\n      return _this.componentControls.delete(controls);\n    };\n  };\n  /**\n   * Start a drag gesture on every `motion` component that has this set of drag controls\n   * passed into it via the `dragControls` prop.\n   *\n   * ```jsx\n   * dragControls.start(e, {\n   *   snapToCursor: true\n   * })\n   * ```\n   *\n   * @param event - PointerEvent\n   * @param options - Options\n   *\n   * @public\n   */\n\n\n  DragControls.prototype.start = function (event, options) {\n    this.componentControls.forEach(function (controls) {\n      controls.start(event.nativeEvent || event, options);\n    });\n  };\n\n  return DragControls;\n}();\n\nvar createDragControls = function createDragControls() {\n  return new DragControls();\n};\n/**\n * Usually, dragging is initiated by pressing down on a `motion` component with a `drag` prop\n * and moving it. For some use-cases, for instance clicking at an arbitrary point on a video scrubber, we\n * might want to initiate that dragging from a different component than the draggable one.\n *\n * By creating a `dragControls` using the `useDragControls` hook, we can pass this into\n * the draggable component's `dragControls` prop. It exposes a `start` method\n * that can start dragging from pointer events on other components.\n *\n * ```jsx\n * const dragControls = useDragControls()\n *\n * function startDrag(event) {\n *   dragControls.start(event, { snapToCursor: true })\n * }\n *\n * return (\n *   <>\n *     <div onPointerDown={startDrag} />\n *     <motion.div drag=\"x\" dragControls={dragControls} />\n *   </>\n * )\n * ```\n *\n * @public\n */\n\n\nfunction useDragControls() {\n  return useConstant(createDragControls);\n}\n\nfunction useInstantLayoutTransition() {\n  return startTransition;\n}\n\nfunction startTransition(cb) {\n  if (!rootProjectionNode.current) return;\n  rootProjectionNode.current.isUpdating = false;\n  rootProjectionNode.current.blockUpdate();\n  cb === null || cb === void 0 ? void 0 : cb();\n}\n\nfunction useInstantTransition() {\n  var _a = tslib.__read(useForceUpdate(), 2),\n      forceUpdate = _a[0],\n      forcedRenderCount = _a[1];\n\n  var startInstantLayoutTransition = useInstantLayoutTransition();\n  React.useEffect(function () {\n    /**\n     * Unblock after two animation frames, otherwise this will unblock too soon.\n     */\n    sync__default[\"default\"].postRender(function () {\n      return sync__default[\"default\"].postRender(function () {\n        return instantAnimationState.current = false;\n      });\n    });\n  }, [forcedRenderCount]);\n  return function (callback) {\n    startInstantLayoutTransition(function () {\n      instantAnimationState.current = true;\n      forceUpdate();\n      callback();\n    });\n  };\n}\n\nfunction useResetProjection() {\n  var reset = React__namespace.useCallback(function () {\n    var root = rootProjectionNode.current;\n    if (!root) return;\n    root.resetTree();\n  }, []);\n  return reset;\n}\n\nvar createObject = function createObject() {\n  return {};\n};\n\nvar stateVisualElement = visualElement({\n  build: function build() {},\n  measureViewportBox: createBox,\n  resetTransform: function resetTransform() {},\n  restoreTransform: function restoreTransform() {},\n  removeValueFromRenderState: function removeValueFromRenderState() {},\n  render: function render() {},\n  scrapeMotionValuesFromProps: createObject,\n  readValueFromInstance: function readValueFromInstance(_state, key, options) {\n    return options.initialState[key] || 0;\n  },\n  makeTargetAnimatable: function makeTargetAnimatable(element, _a) {\n    var transition = _a.transition,\n        transitionEnd = _a.transitionEnd,\n        target = tslib.__rest(_a, [\"transition\", \"transitionEnd\"]);\n\n    var origin = getOrigin(target, transition || {}, element);\n    checkTargetForNewValues(element, target, origin);\n    return tslib.__assign({\n      transition: transition,\n      transitionEnd: transitionEnd\n    }, target);\n  }\n});\nvar useVisualState = makeUseVisualState({\n  scrapeMotionValuesFromProps: createObject,\n  createRenderState: createObject\n});\n/**\n * This is not an officially supported API and may be removed\n * on any version.\n */\n\nfunction useAnimatedState(initialState) {\n  var _a = tslib.__read(React.useState(initialState), 2),\n      animationState = _a[0],\n      setAnimationState = _a[1];\n\n  var visualState = useVisualState({}, false);\n  var element = useConstant(function () {\n    return stateVisualElement({\n      props: {},\n      visualState: visualState\n    }, {\n      initialState: initialState\n    });\n  });\n  React.useEffect(function () {\n    element.mount({});\n    return element.unmount;\n  }, [element]);\n  React.useEffect(function () {\n    element.setProps({\n      onUpdate: function onUpdate(v) {\n        setAnimationState(tslib.__assign({}, v));\n      }\n    });\n  }, [setAnimationState, element]);\n  var startAnimation = useConstant(function () {\n    return function (animationDefinition) {\n      return animateVisualElement(element, animationDefinition);\n    };\n  });\n  return [animationState, startAnimation];\n} // Keep things reasonable and avoid scale: Infinity. In practise we might need\n// to add another value, opacity, that could interpolate scaleX/Y [0,0.01] => [0,1]\n// to simply hide content at unreasonable scales.\n\n\nvar maxScale = 100000;\n\nvar invertScale = function invertScale(scale) {\n  return scale > 0.001 ? 1 / scale : maxScale;\n};\n\nvar hasWarned = false;\n/**\n * Returns a `MotionValue` each for `scaleX` and `scaleY` that update with the inverse\n * of their respective parent scales.\n *\n * This is useful for undoing the distortion of content when scaling a parent component.\n *\n * By default, `useInvertedScale` will automatically fetch `scaleX` and `scaleY` from the nearest parent.\n * By passing other `MotionValue`s in as `useInvertedScale({ scaleX, scaleY })`, it will invert the output\n * of those instead.\n *\n * ```jsx\n * const MyComponent = () => {\n *   const { scaleX, scaleY } = useInvertedScale()\n *   return <motion.div style={{ scaleX, scaleY }} />\n * }\n * ```\n *\n * @deprecated\n */\n\nfunction useInvertedScale(scale) {\n  var parentScaleX = useMotionValue(1);\n  var parentScaleY = useMotionValue(1);\n  var visualElement = useVisualElementContext();\n  heyListen.invariant(!!(scale || visualElement), \"If no scale values are provided, useInvertedScale must be used within a child of another motion component.\");\n  heyListen.warning(hasWarned, \"useInvertedScale is deprecated and will be removed in 3.0. Use the layout prop instead.\");\n  hasWarned = true;\n\n  if (scale) {\n    parentScaleX = scale.scaleX || parentScaleX;\n    parentScaleY = scale.scaleY || parentScaleY;\n  } else if (visualElement) {\n    parentScaleX = visualElement.getValue(\"scaleX\", 1);\n    parentScaleY = visualElement.getValue(\"scaleY\", 1);\n  }\n\n  var scaleX = useTransform(parentScaleX, invertScale);\n  var scaleY = useTransform(parentScaleY, invertScale);\n  return {\n    scaleX: scaleX,\n    scaleY: scaleY\n  };\n}\n\nexports.AnimatePresence = AnimatePresence;\nexports.AnimateSharedLayout = AnimateSharedLayout;\nexports.DeprecatedLayoutGroupContext = DeprecatedLayoutGroupContext;\nexports.DragControls = DragControls;\nexports.FlatTree = FlatTree;\nexports.LayoutGroup = LayoutGroup;\nexports.LayoutGroupContext = LayoutGroupContext;\nexports.LazyMotion = LazyMotion;\nexports.MotionConfig = MotionConfig;\nexports.MotionConfigContext = MotionConfigContext;\nexports.MotionContext = MotionContext;\nexports.MotionValue = MotionValue;\nexports.PresenceContext = PresenceContext;\nexports.Reorder = Reorder;\nexports.SwitchLayoutGroupContext = SwitchLayoutGroupContext;\nexports.addPointerEvent = addPointerEvent;\nexports.addScaleCorrector = addScaleCorrector;\nexports.animate = animate;\nexports.animateVisualElement = animateVisualElement;\nexports.animationControls = animationControls;\nexports.animations = animations;\nexports.calcLength = calcLength;\nexports.checkTargetForNewValues = checkTargetForNewValues;\nexports.createBox = createBox;\nexports.createDomMotionComponent = createDomMotionComponent;\nexports.createMotionComponent = createMotionComponent;\nexports.domAnimation = domAnimation;\nexports.domMax = domMax;\nexports.filterProps = filterProps;\nexports.isBrowser = isBrowser;\nexports.isDragActive = isDragActive;\nexports.isMotionValue = isMotionValue;\nexports.isValidMotionProp = isValidMotionProp;\nexports.m = m;\nexports.makeUseVisualState = makeUseVisualState;\nexports.motion = motion;\nexports.motionValue = motionValue;\nexports.resolveMotionValue = resolveMotionValue;\nexports.transform = transform;\nexports.useAnimation = useAnimation;\nexports.useAnimationControls = useAnimationControls;\nexports.useAnimationFrame = useAnimationFrame;\nexports.useCycle = useCycle;\nexports.useDeprecatedAnimatedState = useAnimatedState;\nexports.useDeprecatedInvertedScale = useInvertedScale;\nexports.useDomEvent = useDomEvent;\nexports.useDragControls = useDragControls;\nexports.useElementScroll = useElementScroll;\nexports.useForceUpdate = useForceUpdate;\nexports.useInView = useInView;\nexports.useInstantLayoutTransition = useInstantLayoutTransition;\nexports.useInstantTransition = useInstantTransition;\nexports.useIsPresent = useIsPresent;\nexports.useIsomorphicLayoutEffect = useIsomorphicLayoutEffect;\nexports.useMotionTemplate = useMotionTemplate;\nexports.useMotionValue = useMotionValue;\nexports.usePresence = usePresence;\nexports.useReducedMotion = useReducedMotion;\nexports.useReducedMotionConfig = useReducedMotionConfig;\nexports.useResetProjection = useResetProjection;\nexports.useScroll = useScroll;\nexports.useSpring = useSpring;\nexports.useTime = useTime;\nexports.useTransform = useTransform;\nexports.useUnmountEffect = useUnmountEffect;\nexports.useVelocity = useVelocity;\nexports.useViewportScroll = useViewportScroll;\nexports.useVisualElementContext = useVisualElementContext;\nexports.visualElement = visualElement;\nexports.wrapHandler = wrapHandler;"],"names":["Object","defineProperty","exports","value","tslib","React","heyListen","styleValueTypes","popmotion","sync","dom","_interopDefaultLegacy","e","_interopNamespace","__esModule","n","create","keys","forEach","k","d","getOwnPropertyDescriptor","get","enumerable","freeze","React__namespace","React__default","sync__default","createDefinition","propNames","isEnabled","props","some","name","featureDefinitions","measureLayout","animation","exit","drag","focus","hover","tap","pan","inView","loadFeatures","features","key","projectionNodeConstructor","Component","LazyContext","createContext","strict","featureNames","numFeatures","length","MotionConfigContext","transformPagePoint","p","isStatic","reducedMotion","MotionContext","useVisualElementContext","useContext","visualElement","PresenceContext","isBrowser","document","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","prefersReducedMotion","current","hasDetected","useReducedMotion","window","matchMedia","motionMediaQuery_1","setReducedMotionPreferences","matches","addListener","initPrefersReducedMotion","__read","useState","useReducedMotionConfig","reducedMotionPreference","isRefObject","ref","prototype","hasOwnProperty","call","isVariantLabels","v","Array","isArray","isVariantLabel","resolveVariantFromProps","definition","custom","currentValues","currentVelocity","_a","variants","resolveVariant","getProps","forEachValue","getCurrent","velocity","getVelocity","getVelocity$1","checkIfControllingVariants","animate","start","initial","whileHover","whileDrag","whileTap","whileFocus","checkIfVariantNode","Boolean","useCreateMotionContext","context","undefined","inherit","getCurrentTreeVariants","useMemo","variantLabelsAsDependency","prop","join","useConstant","init","useRef","globalProjectionState","hasAnimatedSinceResize","hasEverUpdated","id$1","LayoutGroupContext","SwitchLayoutGroupContext","VisualElementHandler","_super","apply","this","arguments","__extends","getSnapshotBeforeUpdate","updateProps","componentDidUpdate","setProps","render","children","createMotionComponent","preloadedFeatures","createVisualElement","useRender","useVisualState","forwardRef","externalRef","layoutId","_b","layoutGroupId","id","useLayoutId","__assign","config","projectionId","visualState","lazyContext","parent","presenceContext","shouldReduceMotion","visualElementRef","renderer","presenceId","blockInitialAnimation","syncRender","animationState","animateChanges","notifyUnmount","useVisualElement","ProjectionNodeConstructor","layout","dragConstraints","layoutScroll","initialPromotionConfig","projection","getLatestValues","setOptions","alwaysMeasureLayout","scheduleRender","animationType","useProjection","i","name_1","push","createElement","useFeatures","Provider","useCallback","instance","mount","unmount","useMotionRef","createMotionProxy","createConfig","customMotionComponentConfig","Proxy","componentCache","Map","_target","has","set","lowercaseSVGElements","isSVGComponent","includes","indexOf","test","scaleCorrectors","addScaleCorrector","correctors","assign","transformAxes","transformProps","sortTransformProps","a","b","operationKey","axesKey","transformPropSet","Set","isTransformProp","transformOriginProps","isTransformOriginProp","isForcedMotionValue","isMotionValue","translateAlias","x","y","z","transformPerspective","isCSSVariable$1","startsWith","getValueAsType","type","transform","int","number","Math","round","numberValueTypes","borderWidth","px","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderRadius","radius","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","width","maxWidth","height","maxHeight","size","top","right","bottom","left","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","margin","marginTop","marginRight","marginBottom","marginLeft","rotate","degrees","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","distance","translateX","translateY","translateZ","perspective","opacity","alpha","originX","progressPercentage","originY","originZ","zIndex","fillOpacity","strokeOpacity","numOctaves","buildHTMLStyles","state","latestValues","options","transformTemplate","style","vars","transformKeys","transformOrigin","hasTransform","hasTransformOrigin","transformIsNone","valueType","valueAsType","default","transformIsDefault","_c","enableHardwareAcceleration","_d","allowTransformNone","transformString","sort","transformHasZ","numTransformKeys","concat","trim","buildTransform","buildTransformOrigin","createHtmlRenderState","copyRawValuesOnly","target","source","useStyle","useInitialMotionValues","transformValues","useHTMLProps","htmlProps","dragListener","draggable","userSelect","WebkitUserSelect","WebkitTouchCallout","touchAction","validMotionProps","isValidMotionProp","shouldForward","loadExternalIsValidProp","isValidProp","filterProps","isDom","forwardMotionProps","filteredProps","calcOrigin$1","origin","offset","dashKeys","array","camelKeys","buildSVGAttrs","attrX","attrY","pathLength","pathSpacing","pathOffset","__rest","attrs","dimensions","pxOriginX","pxOriginY","calcSVGTransformOrigin","spacing","useDashCase","buildSVGPath","createSvgRenderState","useSVGProps","visualProps","rawStyles","createUseRender","elementProps","CAMEL_CASE_PATTERN","camelToDash","str","replace","toLowerCase","renderHTML","element","styleProp","getProjectionStyles","setProperty","camelCaseAttributes","renderSVG","renderState","_styleProp","setAttribute","scrapeMotionValuesFromProps$1","newValues","scrapeMotionValuesFromProps","toUpperCase","isAnimationControls","isKeyframesTarget","resolveFinalValueInKeyframes","resolveMotionValue","unwrappedValue","mix","toValue","makeState","createRenderState","onMount","makeLatestValues","makeUseVisualState","scrapeMotionValues","values","motionValues","isControllingVariants","isVariantNode","initialAnimationIsBlocked","variantToSet","resolved","transitionEnd","transition","valueTarget","AnimationType","svgMotionConfig","getBBox","getBoundingClientRect","htmlMotionConfig","createDomMotionConfig","baseConfig","addDomEvent","eventName","handler","passive","addEventListener","removeEventListener","useDomEvent","isMouseEvent","event","PointerEvent","pointerType","MouseEvent","isTouchEvent","touches","defaultPagePoint","pageX","pageY","pointFromTouch","pointType","point","changedTouches","pointFromMouse","extractEventInfo","wrapHandler","shouldFilterPrimaryPointer","eventHandler","listener","button","mouseEventNames","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","pointerenter","pointerleave","touchEventNames","getPointerEventName","onpointerdown","ontouchstart","onmousedown","addPointerEvent","usePointerEvent","createLock","lock","globalHorizontalLock","globalVerticalLock","getGlobalLock","openHorizontal_1","openVertical_1","isDragActive","openGestureLock","createHoverEvent","isActive","callback","info","setActive","Hover","isNodeOrChild","child","parentElement","useUnmountEffect","warned","warnOnce","condition","message","console","warn","add","observerCallbacks","WeakMap","observers","fireObserverCallback","entry","fireAllObserverCallbacks","entries","observeIntersection","rootInteresectionObserver","root","lookupRoot","rootObservers","JSON","stringify","IntersectionObserver","initIntersectionObserver","observe","delete","unobserve","thresholdNames","all","useIntersectionObserver","shouldObserve","rootMargin","amount","once","threshold","getInstance","isIntersecting","isInView","hasEnteredView","InView","onViewportEnter","onViewportLeave","useMissingIntersectionObserver","fallback","requestAnimationFrame","makeRenderlessComponent","hook","gestureAnimations","whileInView","viewport","onTap","onTapStart","onTapCancel","hasPressListeners","isPressing","cancelPointerEndListeners","eventOptions","onPointerDown","removePointerEndListener","checkPointerEnd","Tap","onPointerUp","onPointerCancel","pipe","Focus","onHoverStart","onHoverEnd","counter","incrementId","useId","usePresence","isPresent","onExitComplete","register","shallowCompare","next","prev","prevLength","secondsToMilliseconds","seconds","easingLookup","linear","easeIn","easeInOut","easeOut","circIn","circInOut","circOut","backIn","backInOut","backOut","anticipate","bounceIn","bounceInOut","bounceOut","easingDefinitionToFunction","invariant","x1","y1","x2","y2","cubicBezier","isAnimatable","complex","underDampedSpring","stiffness","damping","restSpeed","criticallyDampedSpring","to","sqrt","linearTween","ease","duration","keyframes","defaultTransitions","backgroundColor","color","defaultValueTypes","outlineColor","fill","stroke","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","filter","WebkitFilter","getDefaultValueType","getAnimatableNone","defaultValueType","instantAnimationState","legacyRepeatWarning","convertTransitionToAnimationOptions","times","yoyo","flip","loop","repeatDelay","isEasingArray","map","warning","repeatType","repeat","getPopmotionAnimationOptions","valueKey","transitionFactory","__spreadArray","from","hydrateKeyframes","when","delay","delayChildren","staggerChildren","staggerDirection","isTransitionDefined","isZero","parseFloat","getZeroUnit","potentialUnitType","getValueTransition","startAnimation","onComplete","delayTimer","controls","valueTransition","isTargetAnimatable","isOriginAnimatable","onUpdate","inertia","finalTarget","stop","getAnimation","getDelayFromTransition","setTimeout","clearTimeout","isZeroValueString","addUniqueItem","arr","item","removeItem","index","splice","SubscriptionManager","subscriptions","_this","notify","c","numSubscriptions","getSize","clear","MotionValue","version","timeDelta","lastUpdated","updateSubscribers","velocityUpdateSubscribers","renderSubscribers","canTrackVelocity","updateAndNotify","getFrameData","delta","timestamp","postRender","scheduleVelocityCheck","velocityCheck","hasAnimated","isNaN","onChange","subscription","clearListeners","onRenderRequest","attach","passiveEffect","getPrevious","velocityPerSecond","Promise","resolve","stopAnimation","then","clearAnimation","isAnimating","destroy","motionValue","testValueType","dimensionValueTypes","percent","vw","vh","parse","findDimensionValueType","find","valueTypes","findValueType","setMotionValue","hasValue","getValue","addValue","setTarget","makeTargetAnimatable","setVariants","variantLabels","reverse","variant","getVariant","variantChildren","checkTargetForNewValues","newValueKeys","numNewValues","targetValue","readValue","setBaseTarget","getOriginFromTransition","getOrigin","animateVisualElement","notifyAnimationStart","animations","animateVariant","resolvedDefinition","animateTarget","notifyAnimationComplete","getDefaultTransition","transitionOverride","getChildAnimations","forwardDelay","maxStaggerDuration","generateStaggerDuration","sortByTreeOrder","animateChildren","first","last","_e","_f","animationTypeState","getState","shouldBlockAnimation","sortNodePosition","protectedKeys","needsAnimating","shouldBlock","variantPriorityOrder","Animate","Drag","Exit","reversePriorityOrder","numAnimationTypes","createAnimationState","animateList","createTypeState","allAnimatedKeys","isInitialRender","buildResolvedTypeValues","acc","changedActiveType","getVariantContext","removedKeys","encounteredKeys","removedVariantIndex","Infinity","_loop_1","typeState","propIsVariant","activeDelta","isInherited","manuallyAnimateOnMount","prevProp","variantDidChange","checkVariantsDidChange","shouldAnimateType","definitionList","resolvedValues","reduce","prevResolvedValues","allKeys","markToAnimate","fallbackAnimation_1","fallbackTarget","getBaseTarget","shouldAnimate","isAnimated","setAnimateFunction","makeAnimator","subscribe","safeToRemove","PanSession","handlers","startEvent","lastMoveEvent","lastMoveEventInfo","updatePoint","getPanInfo","history","isPanStarted","isDistancePastThreshold","onStart","onMove","handlePointerMove","transformPoint","buttons","handlePointerUp","update","end","onEnd","onSessionEnd","panInfo","initialInfo","onSessionStart","removeListeners","updateHandlers","cancelSync","subtractPoint","lastDevicePoint","startDevicePoint","timestampedPoint","lastPoint","time","calcLength","axis","max","min","isNear","maxDistance","calcAxisDelta","originPoint","translate","calcBoxDelta","calcRelativeAxis","relative","calcRelativeAxisPosition","calcRelativePosition","calcRelativeAxisConstraints","calcViewportAxisConstraints","layoutAxis","constraintsAxis","defaultElastic","resolveAxisElastic","dragElastic","minLabel","maxLabel","resolvePointElastic","label","createBox","eachAxis","convertBoundingBoxToBox","isIdentityScale","hasScale","hasTranslate","scalePoint","applyPointDelta","boxScale","applyAxisDelta","applyBoxDelta","box","translateAxis","transformAxis","transforms","scaleKey","originKey","axisOrigin","xKeys$1","yKeys$1","transformBox","_measureViewportBox2","topLeft","bottomRight","transformBoxPoints","elementDragControls","VisualElementDragControls","openGlobalLock","isDragging","currentDirection","constraints","hasMutatedConstraints","elastic","originEvent","snapToCursor","panSession","dragPropagation","onDragStart","resolveConstraints","isAnimationBlocked","getAxisMotionValue","measuredAxis","actual","dragDirectionLock","onDirectionLock","onDrag","lockThreshold","direction","abs","getCurrentDirection","updateAxis","getTransformPagePoint","cancel","onDragEnd","_point","shouldDrag","axisValue","prevConstraints","resolveRefConstraints","layoutBox","calcRelativeConstraints","resolveDragElastic","relativeConstraints","rebaseAxisConstraints","onMeasureDragConstraints","constraintsElement","constraintsBox","rootProjectionNode","viewportBox","scroll","measurePageBox","measuredConstraints","calcViewportConstraints","userConstraints","convertBoxToBoundingBox","dragMomentum","dragTransition","dragSnapToOrigin","onDragTransitionEnd","momentumAnimations","bounceStiffness","bounceDamping","timeConstant","restDelta","startAxisValueAnimation","dragKey","externalMotionValue","scalePositionWithinConstraints","boxProgress","sourceLength","targetLength","latest","progress","clamp","updateScroll","updateLayout","addListeners","stopPointerListener","measureDragConstraints","stopMeasureLayoutListener","stopResizeListener","stopLayoutUpdateListener","hasLayoutChanged","onPan","onPanStart","onPanEnd","onPanSessionStart","hasPanEvents","groupDragControls","dragControls","names","treeType","build","_getBaseTarget","_makeTargetAnimatable","_measureViewportBox","measureViewportBox","renderInstance","readValueFromInstance","removeValueFromRenderState","_sortNodePosition","removeFromVariantTree","isMounted","lifecycles","managers","propSubscriptions","clearAllListeners","manager","updatePropListeners","on","propListener","args","_i","createLifecycles","valueSubscriptions","prevMotionValues","baseTarget","triggerBuild","notifyUpdate","bindToMotionValue","removeOnChange","latestValue","removeOnRenderRequest","initialMotionValues","depth","isVisible","newInstance","addVariantChild","remove","closestVariantNode","getClosestVariantNode","other","getLayoutId","getStaticValue","setStaticValue","setVisibility","visibility","canMutate","removeValue","defaultValue","newProps","nextValue","prevValue","existingValue","updateMotionValuesFromProps","startAtParent","context_1","numVariantProps","variantProps","isCSSVariable","cssVariableRegex","getVariableValue","match","exec","parseCSSVariable","token","getComputedStyle","getPropertyValue","BoundingBoxDimension","positionalKeys","isPositionalKey","setAndResetVelocity","isNumOrPxType","getPosFromMatrix","matrix","pos","split","getTranslateFromMatrix","pos2","pos3","_bbox","matrix3d","nonTranslationalTransformKeys","positionalValues","checkAndConvertChangedValueTypes","targetPositionalKeys","removedTransformValues","hasAttemptedToRemoveTransformValues","changedValueTypeKeys","toType","fromType","numKeyframes","fromIndex","removedTransforms","removeNonTranslationalTransform","scrollY_1","pageYOffset","convertedTarget","changedKeys","originBbox","elementComputedStyle","display","targetBbox","convertChangedValueTypes","scrollTo","unitConversion","hasPositionalKey","parseDomVariant","Element","resolveCSSVariables","htmlConfig","domElement","defaultType","computedStyle","compareDocumentPosition","resetTransform","restoreTransform","mutableState","parsed","htmlVisualElement","svgVisualElement","getAttribute","_element","createDomVisualElement","pixelsToPercent","pixels","correctBorderRadius","correct","node","varToken","correctBoxShadow","treeScale","projectionDelta","original","containsCSSVariables","cssVariables","shadow","template","createTransformer","xScale","yScale","averageScale","output","i_1","cssVariable","MeasureLayoutWithContext","componentDidMount","layoutGroup","switchLayoutGroup","defaultScaleCorrectors","group","didUpdate","prevProps","layoutDependency","willUpdate","promote","relegate","getStack","members","currentAnimation","isLead","componentWillUnmount","promoteContext","scheduleCheckAfterUnmount","deregister","applyTo","boxShadow","layoutFeatures","borders","numBorders","asNumber","isPx","getRadius","radiusName","easeCrossfadeIn","compress","easeCrossfadeOut","easing","copyAxisInto","originAxis","copyBoxInto","originBox","removePointDelta","removeAxisTransforms","sourceAxis","removeAxisDelta","xKeys","yKeys","removeBoxTransforms","sourceBox","isAxisDeltaZero","isDeltaZero","boxEquals","NodeStack","prevLead","lead","indexOfNode","findIndex","member","preserveFollowOpacity","show","resumeFrom","preserveOpacity","snapshot","animationValues","isShared","isUpdating","isLayoutDirty","crossfade","hide","exitAnimationComplete","resumingFrom","removeLeadSnapshot","buildProjectionTransform","latestTransform","xTranslate","yTranslate","elementScaleX","elementScaleY","compareByDepth","FlatTree","isDirty","createProjectionNode","attachResizeListener","defaultParent","measureScroll","checkIsScrollRoot","ProjectionNode","isTreeAnimating","updateManuallyBlocked","updateBlockedByResize","isSVG","needsReset","shouldResetTransform","eventHandlers","potentialNodes","checkUpdateFailed","clearAllSnapshots","updateProjection","nodes","resolveTargetDelta","calcProjection","hasProjected","animationProgress","sharedNodes","path","registerPotentialNode","notifyListeners","subscriptionManager","hasListeners","SVGElement","tagName","unblockTimeout_1","resizeUnblockUpdate_1","finishAnimation","registerSharedNode","hasRelativeTargetChanged","newLayout","isTreeAnimationBlocked","relativeTarget","layoutTransition","defaultLayoutTransition","_g","onLayoutAnimationStart","onLayoutAnimationComplete","targetChanged","targetLayout","hasOnlyRelativeTargetChanged","setAnimationOrigin","animationOptions","onPlay","preRender","blockUpdate","unblockUpdate","isUpdateBlocked","startUpdate","resetRotation","shouldNotifyListeners","prevTransformTemplateValue","updateSnapshot","clearMeasurements","mountNodeEarly","resetTransformStyle","notifyLayoutUpdate","flushSync","clearSnapshot","removeLeadSnapshots","scheduleUpdateProjection","measured","measure","removeTransform","removeElementScroll","roundBox","prevLayout","layoutCorrected","notifyLayoutMeasure","isScrollRoot","isResetRequested","hasProjection","transformTemplateValue","transformTemplateHasChanged","boxWithoutScroll","scroll_1","rootScroll","applyTransform","transformOnly","withTransforms","boxWithoutTransform","setTargetDelta","targetDelta","relativeParent","getClosestProjectingParent","relativeTargetOrigin","targetWithTransforms","attemptToResolveRelativeTarget","pendingAnimation","getLead","treePath","isSharedTransition","treeLength","applyTreeDeltas","projectionDeltaWithTransform","prevTreeScaleX","prevTreeScaleY","prevProjectionTransform","projectionTransform","notifyAll","snapshotLatestValues","mixedValues","relativeLayout","isSharedLayoutAnimation","isOnlyMember","shouldCrossfadeOpacity","hasOpacityCrossfade","mixTargetDelta","mixAxisDelta","mixAxis","follow","opacityExit","borderLabel","followRadius","leadRadius","mixValues","completeAnimation","applyTransformsToTarget","shouldPreserveFollowOpacity","stack","getPrevLead","hasRotate","resetValues","styles","pointerEvents","emptyStyles","valuesToRender","_h","corrected","num","resetTree","layout_1","measuredLayout","axisSnapshot","layoutDelta","visualDelta","parentSnapshot","parentLayout","relativeSnapshot","onBeforeLayoutMeasure","notifyBeforeLayoutMeasure","searchNode","querySelector","roundAxis","DocumentProjectionNode","documentElement","scrollLeft","body","scrollTop","HTMLProjectionNode","documentNode","position","featureBundle","motion","m","useIsMounted","useForceUpdate","forcedRenderCount","setForcedRenderCount","forceRender","PresenceChild","_onExitComplete","presenceAffectsLayout","presenceChildren","newChildrenMap","childId","e_1","__values","done","e_1_1","error","return","_","getChildKey","DeprecatedLayoutGroupContext","nodeGroup","dirtyAll","dirty","shouldInheritGroup","LayoutGroup","inheritId","layoutGroupContext","deprecatedLayoutGroupContext","upstreamId","shouldInheritId","memoizedContext","isLazyBundle","ReorderContext","checkReorder","order","nextOffset","nextItem","nextLayout","nextItemCenter","toIndex","slice","startIndex","endIndex","moveItem","Group","as","onReorder","isReordering","registerItem","compareMin","updateOrder","newOrder","useMotionValue","setLatest_1","getMixer","isCustomValueType","useImmediate","argOffset","inputValue","inputRange","outputRange","interpolator","interpolate","mixer","useCombineMotionValues","combineValues","updateValue","unsubscribe","useMultiOnChange","useTransform","input","inputRangeOrTransformer","transformer","useListTransform","numValues","useDefaultMotionValue","Reorder","Item","_onDrag","latestX","latestY","gesturePoint","onLayoutMeasure","domAnimation","domMax","createScrollMotionValues","scrollX","scrollY","scrollXProgress","scrollYProgress","useScroll","container","useAnimationFrame","initialTimestamp","provideTimeSinceStart","animationControls","hasMounted","pendingAnimations","subscribers","animations_1","setValues","useAnimationControls","useAnimation","DragControls","componentControls","nativeEvent","createDragControls","useInstantLayoutTransition","startTransition","cb","createObject","stateVisualElement","_state","initialState","invertScale","hasWarned","AnimatePresence","exitBeforeEnter","forceRenderLayoutGroup","filteredChildren","filtered","Children","isValidElement","onlyElements","childrenToRender","exiting","presentChildren","allChildren","updateChildLookup","Fragment","presentKeys","targetKeys","numPresent","insertionIndex","removeIndex","presentChild","cloneElement","AnimateSharedLayout","LazyMotion","setIsLoaded","loadedRenderer","loadedFeatures","MotionConfig","createDomMotionComponent","useCycle","items","setItem","runCycle","wrap","useDeprecatedAnimatedState","setAnimationState","animationDefinition","useDeprecatedInvertedScale","parentScaleX","parentScaleY","useDragControls","useElementScroll","useInView","setInView","useInstantTransition","forceUpdate","startInstantLayoutTransition","useIsPresent","useMotionTemplate","fragments","numFragments","buildValue","useResetProjection","useSpring","activeSpringAnimation","useOnChange","useTime","t","useVelocity","newVelocity","useViewportScroll"],"sourceRoot":""}